<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/tldraw.svg" />
		<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-e7a45d77.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tldraw Application</title>
    <script type="module" crossorigin>
var QA=Object.defineProperty;var ZA=(e,n,t)=>n in e?QA(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var v=(e,n,t)=>(ZA(e,typeof n!="symbol"?n+"":n,t),t);function JA(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in e)){const s=Object.getOwnPropertyDescriptor(r,o);s&&Object.defineProperty(e,o,s.get?s:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=t(o);fetch(o.href,s)}})();var tn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qa(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var lE={exports:{}},Bf={},cE={exports:{}},ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var au=Symbol.for("react.element"),e5=Symbol.for("react.portal"),t5=Symbol.for("react.fragment"),n5=Symbol.for("react.strict_mode"),r5=Symbol.for("react.profiler"),o5=Symbol.for("react.provider"),s5=Symbol.for("react.context"),i5=Symbol.for("react.forward_ref"),a5=Symbol.for("react.suspense"),l5=Symbol.for("react.memo"),c5=Symbol.for("react.lazy"),px=Symbol.iterator;function u5(e){return e===null||typeof e!="object"?null:(e=px&&e[px]||e["@@iterator"],typeof e=="function"?e:null)}var uE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},dE=Object.assign,hE={};function Za(e,n,t){this.props=e,this.context=n,this.refs=hE,this.updater=t||uE}Za.prototype.isReactComponent={};Za.prototype.setState=function(e,n){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")};Za.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function fE(){}fE.prototype=Za.prototype;function lv(e,n,t){this.props=e,this.context=n,this.refs=hE,this.updater=t||uE}var cv=lv.prototype=new fE;cv.constructor=lv;dE(cv,Za.prototype);cv.isPureReactComponent=!0;var gx=Array.isArray,pE=Object.prototype.hasOwnProperty,uv={current:null},gE={key:!0,ref:!0,__self:!0,__source:!0};function mE(e,n,t){var r,o={},s=null,i=null;if(n!=null)for(r in n.ref!==void 0&&(i=n.ref),n.key!==void 0&&(s=""+n.key),n)pE.call(n,r)&&!gE.hasOwnProperty(r)&&(o[r]=n[r]);var a=arguments.length-2;if(a===1)o.children=t;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];o.children=l}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)o[r]===void 0&&(o[r]=a[r]);return{$$typeof:au,type:e,key:s,ref:i,props:o,_owner:uv.current}}function d5(e,n){return{$$typeof:au,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}function dv(e){return typeof e=="object"&&e!==null&&e.$$typeof===au}function h5(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(t){return n[t]})}var mx=/\/+/g;function Qp(e,n){return typeof e=="object"&&e!==null&&e.key!=null?h5(""+e.key):n.toString(36)}function Kd(e,n,t,r,o){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case au:case e5:i=!0}}if(i)return i=e,o=o(i),e=r===""?"."+Qp(i,0):r,gx(o)?(t="",e!=null&&(t=e.replace(mx,"$&/")+"/"),Kd(o,n,t,"",function(c){return c})):o!=null&&(dv(o)&&(o=d5(o,t+(!o.key||i&&i.key===o.key?"":(""+o.key).replace(mx,"$&/")+"/")+e)),n.push(o)),1;if(i=0,r=r===""?".":r+":",gx(e))for(var a=0;a<e.length;a++){s=e[a];var l=r+Qp(s,a);i+=Kd(s,n,t,l,o)}else if(l=u5(e),typeof l=="function")for(e=l.call(e),a=0;!(s=e.next()).done;)s=s.value,l=r+Qp(s,a++),i+=Kd(s,n,t,l,o);else if(s==="object")throw n=String(e),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return i}function Hu(e,n,t){if(e==null)return e;var r=[],o=0;return Kd(e,r,"","",function(s){return n.call(t,s,o++)}),r}function f5(e){if(e._status===-1){var n=e._result;n=n(),n.then(function(t){(e._status===0||e._status===-1)&&(e._status=1,e._result=t)},function(t){(e._status===0||e._status===-1)&&(e._status=2,e._result=t)}),e._status===-1&&(e._status=0,e._result=n)}if(e._status===1)return e._result.default;throw e._result}var on={current:null},Hd={transition:null},p5={ReactCurrentDispatcher:on,ReactCurrentBatchConfig:Hd,ReactCurrentOwner:uv};ve.Children={map:Hu,forEach:function(e,n,t){Hu(e,function(){n.apply(this,arguments)},t)},count:function(e){var n=0;return Hu(e,function(){n++}),n},toArray:function(e){return Hu(e,function(n){return n})||[]},only:function(e){if(!dv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ve.Component=Za;ve.Fragment=t5;ve.Profiler=r5;ve.PureComponent=lv;ve.StrictMode=n5;ve.Suspense=a5;ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=p5;ve.cloneElement=function(e,n,t){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=dE({},e.props),o=e.key,s=e.ref,i=e._owner;if(n!=null){if(n.ref!==void 0&&(s=n.ref,i=uv.current),n.key!==void 0&&(o=""+n.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in n)pE.call(n,l)&&!gE.hasOwnProperty(l)&&(r[l]=n[l]===void 0&&a!==void 0?a[l]:n[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:au,type:e.type,key:o,ref:s,props:r,_owner:i}};ve.createContext=function(e){return e={$$typeof:s5,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:o5,_context:e},e.Consumer=e};ve.createElement=mE;ve.createFactory=function(e){var n=mE.bind(null,e);return n.type=e,n};ve.createRef=function(){return{current:null}};ve.forwardRef=function(e){return{$$typeof:i5,render:e}};ve.isValidElement=dv;ve.lazy=function(e){return{$$typeof:c5,_payload:{_status:-1,_result:e},_init:f5}};ve.memo=function(e,n){return{$$typeof:l5,type:e,compare:n===void 0?null:n}};ve.startTransition=function(e){var n=Hd.transition;Hd.transition={};try{e()}finally{Hd.transition=n}};ve.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ve.useCallback=function(e,n){return on.current.useCallback(e,n)};ve.useContext=function(e){return on.current.useContext(e)};ve.useDebugValue=function(){};ve.useDeferredValue=function(e){return on.current.useDeferredValue(e)};ve.useEffect=function(e,n){return on.current.useEffect(e,n)};ve.useId=function(){return on.current.useId()};ve.useImperativeHandle=function(e,n,t){return on.current.useImperativeHandle(e,n,t)};ve.useInsertionEffect=function(e,n){return on.current.useInsertionEffect(e,n)};ve.useLayoutEffect=function(e,n){return on.current.useLayoutEffect(e,n)};ve.useMemo=function(e,n){return on.current.useMemo(e,n)};ve.useReducer=function(e,n,t){return on.current.useReducer(e,n,t)};ve.useRef=function(e){return on.current.useRef(e)};ve.useState=function(e){return on.current.useState(e)};ve.useSyncExternalStore=function(e,n,t){return on.current.useSyncExternalStore(e,n,t)};ve.useTransition=function(){return on.current.useTransition()};ve.version="18.2.0";cE.exports=ve;var w=cE.exports;const oe=Qa(w),yE=JA({__proto__:null,default:oe},[w]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g5=w,m5=Symbol.for("react.element"),y5=Symbol.for("react.fragment"),v5=Object.prototype.hasOwnProperty,w5=g5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,x5={key:!0,ref:!0,__self:!0,__source:!0};function vE(e,n,t){var r,o={},s=null,i=null;t!==void 0&&(s=""+t),n.key!==void 0&&(s=""+n.key),n.ref!==void 0&&(i=n.ref);for(r in n)v5.call(n,r)&&!x5.hasOwnProperty(r)&&(o[r]=n[r]);if(e&&e.defaultProps)for(r in n=e.defaultProps,n)o[r]===void 0&&(o[r]=n[r]);return{$$typeof:m5,type:e,key:s,ref:i,props:o,_owner:w5.current}}Bf.Fragment=y5;Bf.jsx=vE;Bf.jsxs=vE;lE.exports=Bf;var g=lE.exports,cy={},wE={exports:{}},jn={},xE={exports:{}},SE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function n(L,N){var H=L.length;L.push(N);e:for(;0<H;){var Q=H-1>>>1,Z=L[Q];if(0<o(Z,N))L[Q]=N,L[H]=Z,H=Q;else break e}}function t(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var N=L[0],H=L.pop();if(H!==N){L[0]=H;e:for(var Q=0,Z=L.length,Ee=Z>>>1;Q<Ee;){var ke=2*(Q+1)-1,ue=L[ke],He=ke+1,Ve=L[He];if(0>o(ue,H))He<Z&&0>o(Ve,ue)?(L[Q]=Ve,L[He]=H,Q=He):(L[Q]=ue,L[ke]=H,Q=ke);else if(He<Z&&0>o(Ve,H))L[Q]=Ve,L[He]=H,Q=He;else break e}}return N}function o(L,N){var H=L.sortIndex-N.sortIndex;return H!==0?H:L.id-N.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,a=i.now();e.unstable_now=function(){return i.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(L){for(var N=t(c);N!==null;){if(N.callback===null)r(c);else if(N.startTime<=L)r(c),N.sortIndex=N.expirationTime,n(l,N);else break;N=t(c)}}function P(L){if(m=!1,b(L),!p)if(t(l)!==null)p=!0,V(C);else{var N=t(c);N!==null&&q(P,N.startTime-L)}}function C(L,N){p=!1,m&&(m=!1,x(k),k=-1),f=!0;var H=h;try{for(b(N),d=t(l);d!==null&&(!(d.expirationTime>N)||L&&!O());){var Q=d.callback;if(typeof Q=="function"){d.callback=null,h=d.priorityLevel;var Z=Q(d.expirationTime<=N);N=e.unstable_now(),typeof Z=="function"?d.callback=Z:d===t(l)&&r(l),b(N)}else r(l);d=t(l)}if(d!==null)var Ee=!0;else{var ke=t(c);ke!==null&&q(P,ke.startTime-N),Ee=!1}return Ee}finally{d=null,h=H,f=!1}}var _=!1,I=null,k=-1,T=5,M=-1;function O(){return!(e.unstable_now()-M<T)}function z(){if(I!==null){var L=e.unstable_now();M=L;var N=!0;try{N=I(!0,L)}finally{N?B():(_=!1,I=null)}}else _=!1}var B;if(typeof S=="function")B=function(){S(z)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,F=D.port2;D.port1.onmessage=z,B=function(){F.postMessage(null)}}else B=function(){y(z,0)};function V(L){I=L,_||(_=!0,B())}function q(L,N){k=y(function(){L(e.unstable_now())},N)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(L){L.callback=null},e.unstable_continueExecution=function(){p||f||(p=!0,V(C))},e.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<L?Math.floor(1e3/L):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return t(l)},e.unstable_next=function(L){switch(h){case 1:case 2:case 3:var N=3;break;default:N=h}var H=h;h=N;try{return L()}finally{h=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(L,N){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var H=h;h=L;try{return N()}finally{h=H}},e.unstable_scheduleCallback=function(L,N,H){var Q=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?Q+H:Q):H=Q,L){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=H+Z,L={id:u++,callback:N,priorityLevel:L,startTime:H,expirationTime:Z,sortIndex:-1},H>Q?(L.sortIndex=H,n(c,L),t(l)===null&&L===t(c)&&(m?(x(k),k=-1):m=!0,q(P,H-Q))):(L.sortIndex=Z,n(l,L),p||f||(p=!0,V(C))),L},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(L){var N=h;return function(){var H=h;h=N;try{return L.apply(this,arguments)}finally{h=H}}}})(SE);xE.exports=SE;var S5=xE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bE=w,Ln=S5;function X(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,t=1;t<arguments.length;t++)n+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var PE=new Set,mc={};function Ti(e,n){ja(e,n),ja(e+"Capture",n)}function ja(e,n){for(mc[e]=n,e=0;e<n.length;e++)PE.add(n[e])}var Io=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),uy=Object.prototype.hasOwnProperty,b5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,yx={},vx={};function P5(e){return uy.call(vx,e)?!0:uy.call(yx,e)?!1:b5.test(e)?vx[e]=!0:(yx[e]=!0,!1)}function E5(e,n,t,r){if(t!==null&&t.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function _5(e,n,t,r){if(n===null||typeof n>"u"||E5(e,n,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function sn(e,n,t,r,o,s,i){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=t,this.propertyName=e,this.type=n,this.sanitizeURL=s,this.removeEmptyString=i}var Rt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Rt[e]=new sn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];Rt[n]=new sn(n,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Rt[e]=new sn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Rt[e]=new sn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Rt[e]=new sn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Rt[e]=new sn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Rt[e]=new sn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Rt[e]=new sn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Rt[e]=new sn(e,5,!1,e.toLowerCase(),null,!1,!1)});var hv=/[\-:]([a-z])/g;function fv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(hv,fv);Rt[n]=new sn(n,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(hv,fv);Rt[n]=new sn(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(hv,fv);Rt[n]=new sn(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Rt[e]=new sn(e,1,!1,e.toLowerCase(),null,!1,!1)});Rt.xlinkHref=new sn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Rt[e]=new sn(e,1,!1,e.toLowerCase(),null,!0,!0)});function pv(e,n,t,r){var o=Rt.hasOwnProperty(n)?Rt[n]:null;(o!==null?o.type!==0:r||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(_5(n,t,o,r)&&(t=null),r||o===null?P5(n)&&(t===null?e.removeAttribute(n):e.setAttribute(n,""+t)):o.mustUseProperty?e[o.propertyName]=t===null?o.type===3?!1:"":t:(n=o.attributeName,r=o.attributeNamespace,t===null?e.removeAttribute(n):(o=o.type,t=o===3||o===4&&t===!0?"":""+t,r?e.setAttributeNS(r,n,t):e.setAttribute(n,t))))}var Ro=bE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vu=Symbol.for("react.element"),aa=Symbol.for("react.portal"),la=Symbol.for("react.fragment"),gv=Symbol.for("react.strict_mode"),dy=Symbol.for("react.profiler"),EE=Symbol.for("react.provider"),_E=Symbol.for("react.context"),mv=Symbol.for("react.forward_ref"),hy=Symbol.for("react.suspense"),fy=Symbol.for("react.suspense_list"),yv=Symbol.for("react.memo"),es=Symbol.for("react.lazy"),CE=Symbol.for("react.offscreen"),wx=Symbol.iterator;function wl(e){return e===null||typeof e!="object"?null:(e=wx&&e[wx]||e["@@iterator"],typeof e=="function"?e:null)}var st=Object.assign,Zp;function Vl(e){if(Zp===void 0)try{throw Error()}catch(t){var n=t.stack.trim().match(/\n( *(at )?)/);Zp=n&&n[1]||""}return`
`+Zp+e}var Jp=!1;function eg(e,n){if(!e||Jp)return"";Jp=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(c){var r=c}Reflect.construct(e,[],n)}else{try{n.call()}catch(c){r=c}e.call(n.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var o=c.stack.split(`
`),s=r.stack.split(`
`),i=o.length-1,a=s.length-1;1<=i&&0<=a&&o[i]!==s[a];)a--;for(;1<=i&&0<=a;i--,a--)if(o[i]!==s[a]){if(i!==1||a!==1)do if(i--,a--,0>a||o[i]!==s[a]){var l=`
`+o[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=a);break}}}finally{Jp=!1,Error.prepareStackTrace=t}return(e=e?e.displayName||e.name:"")?Vl(e):""}function C5(e){switch(e.tag){case 5:return Vl(e.type);case 16:return Vl("Lazy");case 13:return Vl("Suspense");case 19:return Vl("SuspenseList");case 0:case 2:case 15:return e=eg(e.type,!1),e;case 11:return e=eg(e.type.render,!1),e;case 1:return e=eg(e.type,!0),e;default:return""}}function py(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case la:return"Fragment";case aa:return"Portal";case dy:return"Profiler";case gv:return"StrictMode";case hy:return"Suspense";case fy:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case _E:return(e.displayName||"Context")+".Consumer";case EE:return(e._context.displayName||"Context")+".Provider";case mv:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case yv:return n=e.displayName||null,n!==null?n:py(e.type)||"Memo";case es:n=e._payload,e=e._init;try{return py(e(n))}catch{}}return null}function I5(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return py(n);case 8:return n===gv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function Es(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function IE(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function k5(e){var n=IE(e)?"checked":"value",t=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),r=""+e[n];if(!e.hasOwnProperty(n)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var o=t.get,s=t.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return o.call(this)},set:function(i){r=""+i,s.call(this,i)}}),Object.defineProperty(e,n,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function Wu(e){e._valueTracker||(e._valueTracker=k5(e))}function kE(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var t=n.getValue(),r="";return e&&(r=IE(e)?e.checked?"true":"false":e.value),e=r,e!==t?(n.setValue(e),!0):!1}function kh(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function gy(e,n){var t=n.checked;return st({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??e._wrapperState.initialChecked})}function xx(e,n){var t=n.defaultValue==null?"":n.defaultValue,r=n.checked!=null?n.checked:n.defaultChecked;t=Es(n.value!=null?n.value:t),e._wrapperState={initialChecked:r,initialValue:t,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function $E(e,n){n=n.checked,n!=null&&pv(e,"checked",n,!1)}function my(e,n){$E(e,n);var t=Es(n.value),r=n.type;if(t!=null)r==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+t):e.value!==""+t&&(e.value=""+t);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?yy(e,n.type,t):n.hasOwnProperty("defaultValue")&&yy(e,n.type,Es(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function Sx(e,n,t){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var r=n.type;if(!(r!=="submit"&&r!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,t||n===e.value||(e.value=n),e.defaultValue=n}t=e.name,t!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,t!==""&&(e.name=t)}function yy(e,n,t){(n!=="number"||kh(e.ownerDocument)!==e)&&(t==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+t&&(e.defaultValue=""+t))}var Wl=Array.isArray;function _a(e,n,t,r){if(e=e.options,n){n={};for(var o=0;o<t.length;o++)n["$"+t[o]]=!0;for(t=0;t<e.length;t++)o=n.hasOwnProperty("$"+e[t].value),e[t].selected!==o&&(e[t].selected=o),o&&r&&(e[t].defaultSelected=!0)}else{for(t=""+Es(t),n=null,o=0;o<e.length;o++){if(e[o].value===t){e[o].selected=!0,r&&(e[o].defaultSelected=!0);return}n!==null||e[o].disabled||(n=e[o])}n!==null&&(n.selected=!0)}}function vy(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(X(91));return st({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function bx(e,n){var t=n.value;if(t==null){if(t=n.children,n=n.defaultValue,t!=null){if(n!=null)throw Error(X(92));if(Wl(t)){if(1<t.length)throw Error(X(93));t=t[0]}n=t}n==null&&(n=""),t=n}e._wrapperState={initialValue:Es(t)}}function TE(e,n){var t=Es(n.value),r=Es(n.defaultValue);t!=null&&(t=""+t,t!==e.value&&(e.value=t),n.defaultValue==null&&e.defaultValue!==t&&(e.defaultValue=t)),r!=null&&(e.defaultValue=""+r)}function Px(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function ME(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function wy(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?ME(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Yu,AE=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,t,r,o){MSApp.execUnsafeLocalFunction(function(){return e(n,t,r,o)})}:e}(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(Yu=Yu||document.createElement("div"),Yu.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=Yu.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function yc(e,n){if(n){var t=e.firstChild;if(t&&t===e.lastChild&&t.nodeType===3){t.nodeValue=n;return}}e.textContent=n}var ec={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$5=["Webkit","ms","Moz","O"];Object.keys(ec).forEach(function(e){$5.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),ec[n]=ec[e]})});function OE(e,n,t){return n==null||typeof n=="boolean"||n===""?"":t||typeof n!="number"||n===0||ec.hasOwnProperty(e)&&ec[e]?(""+n).trim():n+"px"}function RE(e,n){e=e.style;for(var t in n)if(n.hasOwnProperty(t)){var r=t.indexOf("--")===0,o=OE(t,n[t],r);t==="float"&&(t="cssFloat"),r?e.setProperty(t,o):e[t]=o}}var T5=st({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xy(e,n){if(n){if(T5[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(X(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(X(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(X(61))}if(n.style!=null&&typeof n.style!="object")throw Error(X(62))}}function Sy(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var by=null;function vv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Py=null,Ca=null,Ia=null;function Ex(e){if(e=uu(e)){if(typeof Py!="function")throw Error(X(280));var n=e.stateNode;n&&(n=Vf(n),Py(e.stateNode,e.type,n))}}function DE(e){Ca?Ia?Ia.push(e):Ia=[e]:Ca=e}function LE(){if(Ca){var e=Ca,n=Ia;if(Ia=Ca=null,Ex(e),n)for(e=0;e<n.length;e++)Ex(n[e])}}function jE(e,n){return e(n)}function NE(){}var tg=!1;function zE(e,n,t){if(tg)return e(n,t);tg=!0;try{return jE(e,n,t)}finally{tg=!1,(Ca!==null||Ia!==null)&&(NE(),LE())}}function vc(e,n){var t=e.stateNode;if(t===null)return null;var r=Vf(t);if(r===null)return null;t=r[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(t&&typeof t!="function")throw Error(X(231,n,typeof t));return t}var Ey=!1;if(Io)try{var xl={};Object.defineProperty(xl,"passive",{get:function(){Ey=!0}}),window.addEventListener("test",xl,xl),window.removeEventListener("test",xl,xl)}catch{Ey=!1}function M5(e,n,t,r,o,s,i,a,l){var c=Array.prototype.slice.call(arguments,3);try{n.apply(t,c)}catch(u){this.onError(u)}}var tc=!1,$h=null,Th=!1,_y=null,A5={onError:function(e){tc=!0,$h=e}};function O5(e,n,t,r,o,s,i,a,l){tc=!1,$h=null,M5.apply(A5,arguments)}function R5(e,n,t,r,o,s,i,a,l){if(O5.apply(this,arguments),tc){if(tc){var c=$h;tc=!1,$h=null}else throw Error(X(198));Th||(Th=!0,_y=c)}}function Mi(e){var n=e,t=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,n.flags&4098&&(t=n.return),e=n.return;while(e)}return n.tag===3?t:null}function BE(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function _x(e){if(Mi(e)!==e)throw Error(X(188))}function D5(e){var n=e.alternate;if(!n){if(n=Mi(e),n===null)throw Error(X(188));return n!==e?null:e}for(var t=e,r=n;;){var o=t.return;if(o===null)break;var s=o.alternate;if(s===null){if(r=o.return,r!==null){t=r;continue}break}if(o.child===s.child){for(s=o.child;s;){if(s===t)return _x(o),e;if(s===r)return _x(o),n;s=s.sibling}throw Error(X(188))}if(t.return!==r.return)t=o,r=s;else{for(var i=!1,a=o.child;a;){if(a===t){i=!0,t=o,r=s;break}if(a===r){i=!0,r=o,t=s;break}a=a.sibling}if(!i){for(a=s.child;a;){if(a===t){i=!0,t=s,r=o;break}if(a===r){i=!0,r=s,t=o;break}a=a.sibling}if(!i)throw Error(X(189))}}if(t.alternate!==r)throw Error(X(190))}if(t.tag!==3)throw Error(X(188));return t.stateNode.current===t?e:n}function FE(e){return e=D5(e),e!==null?UE(e):null}function UE(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=UE(e);if(n!==null)return n;e=e.sibling}return null}var KE=Ln.unstable_scheduleCallback,Cx=Ln.unstable_cancelCallback,L5=Ln.unstable_shouldYield,j5=Ln.unstable_requestPaint,ht=Ln.unstable_now,N5=Ln.unstable_getCurrentPriorityLevel,wv=Ln.unstable_ImmediatePriority,HE=Ln.unstable_UserBlockingPriority,Mh=Ln.unstable_NormalPriority,z5=Ln.unstable_LowPriority,VE=Ln.unstable_IdlePriority,Ff=null,Ur=null;function B5(e){if(Ur&&typeof Ur.onCommitFiberRoot=="function")try{Ur.onCommitFiberRoot(Ff,e,void 0,(e.current.flags&128)===128)}catch{}}var _r=Math.clz32?Math.clz32:K5,F5=Math.log,U5=Math.LN2;function K5(e){return e>>>=0,e===0?32:31-(F5(e)/U5|0)|0}var Xu=64,Gu=4194304;function Yl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ah(e,n){var t=e.pendingLanes;if(t===0)return 0;var r=0,o=e.suspendedLanes,s=e.pingedLanes,i=t&268435455;if(i!==0){var a=i&~o;a!==0?r=Yl(a):(s&=i,s!==0&&(r=Yl(s)))}else i=t&~o,i!==0?r=Yl(i):s!==0&&(r=Yl(s));if(r===0)return 0;if(n!==0&&n!==r&&!(n&o)&&(o=r&-r,s=n&-n,o>=s||o===16&&(s&4194240)!==0))return n;if(r&4&&(r|=t&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=r;0<n;)t=31-_r(n),o=1<<t,r|=e[t],n&=~o;return r}function H5(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function V5(e,n){for(var t=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-_r(s),a=1<<i,l=o[i];l===-1?(!(a&t)||a&r)&&(o[i]=H5(a,n)):l<=n&&(e.expiredLanes|=a),s&=~a}}function Cy(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function WE(){var e=Xu;return Xu<<=1,!(Xu&4194240)&&(Xu=64),e}function ng(e){for(var n=[],t=0;31>t;t++)n.push(e);return n}function lu(e,n,t){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-_r(n),e[n]=t}function W5(e,n){var t=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<t;){var o=31-_r(t),s=1<<o;n[o]=0,r[o]=-1,e[o]=-1,t&=~s}}function xv(e,n){var t=e.entangledLanes|=n;for(e=e.entanglements;t;){var r=31-_r(t),o=1<<r;o&n|e[r]&n&&(e[r]|=n),t&=~o}}var Ie=0;function YE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var XE,Sv,GE,qE,QE,Iy=!1,qu=[],hs=null,fs=null,ps=null,wc=new Map,xc=new Map,rs=[],Y5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ix(e,n){switch(e){case"focusin":case"focusout":hs=null;break;case"dragenter":case"dragleave":fs=null;break;case"mouseover":case"mouseout":ps=null;break;case"pointerover":case"pointerout":wc.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":xc.delete(n.pointerId)}}function Sl(e,n,t,r,o,s){return e===null||e.nativeEvent!==s?(e={blockedOn:n,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[o]},n!==null&&(n=uu(n),n!==null&&Sv(n)),e):(e.eventSystemFlags|=r,n=e.targetContainers,o!==null&&n.indexOf(o)===-1&&n.push(o),e)}function X5(e,n,t,r,o){switch(n){case"focusin":return hs=Sl(hs,e,n,t,r,o),!0;case"dragenter":return fs=Sl(fs,e,n,t,r,o),!0;case"mouseover":return ps=Sl(ps,e,n,t,r,o),!0;case"pointerover":var s=o.pointerId;return wc.set(s,Sl(wc.get(s)||null,e,n,t,r,o)),!0;case"gotpointercapture":return s=o.pointerId,xc.set(s,Sl(xc.get(s)||null,e,n,t,r,o)),!0}return!1}function ZE(e){var n=si(e.target);if(n!==null){var t=Mi(n);if(t!==null){if(n=t.tag,n===13){if(n=BE(t),n!==null){e.blockedOn=n,QE(e.priority,function(){GE(t)});return}}else if(n===3&&t.stateNode.current.memoizedState.isDehydrated){e.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Vd(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var t=ky(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(t===null){t=e.nativeEvent;var r=new t.constructor(t.type,t);by=r,t.target.dispatchEvent(r),by=null}else return n=uu(t),n!==null&&Sv(n),e.blockedOn=t,!1;n.shift()}return!0}function kx(e,n,t){Vd(e)&&t.delete(n)}function G5(){Iy=!1,hs!==null&&Vd(hs)&&(hs=null),fs!==null&&Vd(fs)&&(fs=null),ps!==null&&Vd(ps)&&(ps=null),wc.forEach(kx),xc.forEach(kx)}function bl(e,n){e.blockedOn===n&&(e.blockedOn=null,Iy||(Iy=!0,Ln.unstable_scheduleCallback(Ln.unstable_NormalPriority,G5)))}function Sc(e){function n(o){return bl(o,e)}if(0<qu.length){bl(qu[0],e);for(var t=1;t<qu.length;t++){var r=qu[t];r.blockedOn===e&&(r.blockedOn=null)}}for(hs!==null&&bl(hs,e),fs!==null&&bl(fs,e),ps!==null&&bl(ps,e),wc.forEach(n),xc.forEach(n),t=0;t<rs.length;t++)r=rs[t],r.blockedOn===e&&(r.blockedOn=null);for(;0<rs.length&&(t=rs[0],t.blockedOn===null);)ZE(t),t.blockedOn===null&&rs.shift()}var ka=Ro.ReactCurrentBatchConfig,Oh=!0;function q5(e,n,t,r){var o=Ie,s=ka.transition;ka.transition=null;try{Ie=1,bv(e,n,t,r)}finally{Ie=o,ka.transition=s}}function Q5(e,n,t,r){var o=Ie,s=ka.transition;ka.transition=null;try{Ie=4,bv(e,n,t,r)}finally{Ie=o,ka.transition=s}}function bv(e,n,t,r){if(Oh){var o=ky(e,n,t,r);if(o===null)hg(e,n,r,Rh,t),Ix(e,r);else if(X5(o,e,n,t,r))r.stopPropagation();else if(Ix(e,r),n&4&&-1<Y5.indexOf(e)){for(;o!==null;){var s=uu(o);if(s!==null&&XE(s),s=ky(e,n,t,r),s===null&&hg(e,n,r,Rh,t),s===o)break;o=s}o!==null&&r.stopPropagation()}else hg(e,n,r,null,t)}}var Rh=null;function ky(e,n,t,r){if(Rh=null,e=vv(r),e=si(e),e!==null)if(n=Mi(e),n===null)e=null;else if(t=n.tag,t===13){if(e=BE(n),e!==null)return e;e=null}else if(t===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return Rh=e,null}function JE(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(N5()){case wv:return 1;case HE:return 4;case Mh:case z5:return 16;case VE:return 536870912;default:return 16}default:return 16}}var is=null,Pv=null,Wd=null;function e_(){if(Wd)return Wd;var e,n=Pv,t=n.length,r,o="value"in is?is.value:is.textContent,s=o.length;for(e=0;e<t&&n[e]===o[e];e++);var i=t-e;for(r=1;r<=i&&n[t-r]===o[s-r];r++);return Wd=o.slice(e,1<r?1-r:void 0)}function Yd(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Qu(){return!0}function $x(){return!1}function Nn(e){function n(t,r,o,s,i){this._reactName=t,this._targetInst=o,this.type=r,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Qu:$x,this.isPropagationStopped=$x,this}return st(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Qu)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Qu)},persist:function(){},isPersistent:Qu}),n}var Ja={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ev=Nn(Ja),cu=st({},Ja,{view:0,detail:0}),Z5=Nn(cu),rg,og,Pl,Uf=st({},cu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_v,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Pl&&(Pl&&e.type==="mousemove"?(rg=e.screenX-Pl.screenX,og=e.screenY-Pl.screenY):og=rg=0,Pl=e),rg)},movementY:function(e){return"movementY"in e?e.movementY:og}}),Tx=Nn(Uf),J5=st({},Uf,{dataTransfer:0}),e6=Nn(J5),t6=st({},cu,{relatedTarget:0}),sg=Nn(t6),n6=st({},Ja,{animationName:0,elapsedTime:0,pseudoElement:0}),r6=Nn(n6),o6=st({},Ja,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),s6=Nn(o6),i6=st({},Ja,{data:0}),Mx=Nn(i6),a6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},l6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},c6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function u6(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=c6[e])?!!n[e]:!1}function _v(){return u6}var d6=st({},cu,{key:function(e){if(e.key){var n=a6[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=Yd(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?l6[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_v,charCode:function(e){return e.type==="keypress"?Yd(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Yd(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),h6=Nn(d6),f6=st({},Uf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ax=Nn(f6),p6=st({},cu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_v}),g6=Nn(p6),m6=st({},Ja,{propertyName:0,elapsedTime:0,pseudoElement:0}),y6=Nn(m6),v6=st({},Uf,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),w6=Nn(v6),x6=[9,13,27,32],Cv=Io&&"CompositionEvent"in window,nc=null;Io&&"documentMode"in document&&(nc=document.documentMode);var S6=Io&&"TextEvent"in window&&!nc,t_=Io&&(!Cv||nc&&8<nc&&11>=nc),Ox=String.fromCharCode(32),Rx=!1;function n_(e,n){switch(e){case"keyup":return x6.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function r_(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ca=!1;function b6(e,n){switch(e){case"compositionend":return r_(n);case"keypress":return n.which!==32?null:(Rx=!0,Ox);case"textInput":return e=n.data,e===Ox&&Rx?null:e;default:return null}}function P6(e,n){if(ca)return e==="compositionend"||!Cv&&n_(e,n)?(e=e_(),Wd=Pv=is=null,ca=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return t_&&n.locale!=="ko"?null:n.data;default:return null}}var E6={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dx(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!E6[e.type]:n==="textarea"}function o_(e,n,t,r){DE(r),n=Dh(n,"onChange"),0<n.length&&(t=new Ev("onChange","change",null,t,r),e.push({event:t,listeners:n}))}var rc=null,bc=null;function _6(e){g_(e,0)}function Kf(e){var n=ha(e);if(kE(n))return e}function C6(e,n){if(e==="change")return n}var s_=!1;if(Io){var ig;if(Io){var ag="oninput"in document;if(!ag){var Lx=document.createElement("div");Lx.setAttribute("oninput","return;"),ag=typeof Lx.oninput=="function"}ig=ag}else ig=!1;s_=ig&&(!document.documentMode||9<document.documentMode)}function jx(){rc&&(rc.detachEvent("onpropertychange",i_),bc=rc=null)}function i_(e){if(e.propertyName==="value"&&Kf(bc)){var n=[];o_(n,bc,e,vv(e)),zE(_6,n)}}function I6(e,n,t){e==="focusin"?(jx(),rc=n,bc=t,rc.attachEvent("onpropertychange",i_)):e==="focusout"&&jx()}function k6(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Kf(bc)}function $6(e,n){if(e==="click")return Kf(n)}function T6(e,n){if(e==="input"||e==="change")return Kf(n)}function M6(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Tr=typeof Object.is=="function"?Object.is:M6;function Pc(e,n){if(Tr(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var t=Object.keys(e),r=Object.keys(n);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var o=t[r];if(!uy.call(n,o)||!Tr(e[o],n[o]))return!1}return!0}function Nx(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function zx(e,n){var t=Nx(e);e=0;for(var r;t;){if(t.nodeType===3){if(r=e+t.textContent.length,e<=n&&r>=n)return{node:t,offset:n-e};e=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Nx(t)}}function a_(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?a_(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function l_(){for(var e=window,n=kh();n instanceof e.HTMLIFrameElement;){try{var t=typeof n.contentWindow.location.href=="string"}catch{t=!1}if(t)e=n.contentWindow;else break;n=kh(e.document)}return n}function Iv(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function A6(e){var n=l_(),t=e.focusedElem,r=e.selectionRange;if(n!==t&&t&&t.ownerDocument&&a_(t.ownerDocument.documentElement,t)){if(r!==null&&Iv(t)){if(n=r.start,e=r.end,e===void 0&&(e=n),"selectionStart"in t)t.selectionStart=n,t.selectionEnd=Math.min(e,t.value.length);else if(e=(n=t.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var o=t.textContent.length,s=Math.min(r.start,o);r=r.end===void 0?s:Math.min(r.end,o),!e.extend&&s>r&&(o=r,r=s,s=o),o=zx(t,s);var i=zx(t,r);o&&i&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(n=n.createRange(),n.setStart(o.node,o.offset),e.removeAllRanges(),s>r?(e.addRange(n),e.extend(i.node,i.offset)):(n.setEnd(i.node,i.offset),e.addRange(n)))}}for(n=[],e=t;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<n.length;t++)e=n[t],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var O6=Io&&"documentMode"in document&&11>=document.documentMode,ua=null,$y=null,oc=null,Ty=!1;function Bx(e,n,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Ty||ua==null||ua!==kh(r)||(r=ua,"selectionStart"in r&&Iv(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),oc&&Pc(oc,r)||(oc=r,r=Dh($y,"onSelect"),0<r.length&&(n=new Ev("onSelect","select",null,n,t),e.push({event:n,listeners:r}),n.target=ua)))}function Zu(e,n){var t={};return t[e.toLowerCase()]=n.toLowerCase(),t["Webkit"+e]="webkit"+n,t["Moz"+e]="moz"+n,t}var da={animationend:Zu("Animation","AnimationEnd"),animationiteration:Zu("Animation","AnimationIteration"),animationstart:Zu("Animation","AnimationStart"),transitionend:Zu("Transition","TransitionEnd")},lg={},c_={};Io&&(c_=document.createElement("div").style,"AnimationEvent"in window||(delete da.animationend.animation,delete da.animationiteration.animation,delete da.animationstart.animation),"TransitionEvent"in window||delete da.transitionend.transition);function Hf(e){if(lg[e])return lg[e];if(!da[e])return e;var n=da[e],t;for(t in n)if(n.hasOwnProperty(t)&&t in c_)return lg[e]=n[t];return e}var u_=Hf("animationend"),d_=Hf("animationiteration"),h_=Hf("animationstart"),f_=Hf("transitionend"),p_=new Map,Fx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ds(e,n){p_.set(e,n),Ti(n,[e])}for(var cg=0;cg<Fx.length;cg++){var ug=Fx[cg],R6=ug.toLowerCase(),D6=ug[0].toUpperCase()+ug.slice(1);Ds(R6,"on"+D6)}Ds(u_,"onAnimationEnd");Ds(d_,"onAnimationIteration");Ds(h_,"onAnimationStart");Ds("dblclick","onDoubleClick");Ds("focusin","onFocus");Ds("focusout","onBlur");Ds(f_,"onTransitionEnd");ja("onMouseEnter",["mouseout","mouseover"]);ja("onMouseLeave",["mouseout","mouseover"]);ja("onPointerEnter",["pointerout","pointerover"]);ja("onPointerLeave",["pointerout","pointerover"]);Ti("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ti("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ti("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ti("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ti("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ti("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),L6=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xl));function Ux(e,n,t){var r=e.type||"unknown-event";e.currentTarget=t,R5(r,n,void 0,e),e.currentTarget=null}function g_(e,n){n=(n&4)!==0;for(var t=0;t<e.length;t++){var r=e[t],o=r.event;r=r.listeners;e:{var s=void 0;if(n)for(var i=r.length-1;0<=i;i--){var a=r[i],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&o.isPropagationStopped())break e;Ux(o,a,c),s=l}else for(i=0;i<r.length;i++){if(a=r[i],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&o.isPropagationStopped())break e;Ux(o,a,c),s=l}}}if(Th)throw e=_y,Th=!1,_y=null,e}function Be(e,n){var t=n[Dy];t===void 0&&(t=n[Dy]=new Set);var r=e+"__bubble";t.has(r)||(m_(n,e,2,!1),t.add(r))}function dg(e,n,t){var r=0;n&&(r|=4),m_(t,e,r,n)}var Ju="_reactListening"+Math.random().toString(36).slice(2);function Ec(e){if(!e[Ju]){e[Ju]=!0,PE.forEach(function(t){t!=="selectionchange"&&(L6.has(t)||dg(t,!1,e),dg(t,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Ju]||(n[Ju]=!0,dg("selectionchange",!1,n))}}function m_(e,n,t,r){switch(JE(n)){case 1:var o=q5;break;case 4:o=Q5;break;default:o=bv}t=o.bind(null,n,t,e),o=void 0,!Ey||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(o=!0),r?o!==void 0?e.addEventListener(n,t,{capture:!0,passive:o}):e.addEventListener(n,t,!0):o!==void 0?e.addEventListener(n,t,{passive:o}):e.addEventListener(n,t,!1)}function hg(e,n,t,r,o){var s=r;if(!(n&1)&&!(n&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var a=r.stateNode.containerInfo;if(a===o||a.nodeType===8&&a.parentNode===o)break;if(i===4)for(i=r.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===o||l.nodeType===8&&l.parentNode===o))return;i=i.return}for(;a!==null;){if(i=si(a),i===null)return;if(l=i.tag,l===5||l===6){r=s=i;continue e}a=a.parentNode}}r=r.return}zE(function(){var c=s,u=vv(t),d=[];e:{var h=p_.get(e);if(h!==void 0){var f=Ev,p=e;switch(e){case"keypress":if(Yd(t)===0)break e;case"keydown":case"keyup":f=h6;break;case"focusin":p="focus",f=sg;break;case"focusout":p="blur",f=sg;break;case"beforeblur":case"afterblur":f=sg;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Tx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=e6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=g6;break;case u_:case d_:case h_:f=r6;break;case f_:f=y6;break;case"scroll":f=Z5;break;case"wheel":f=w6;break;case"copy":case"cut":case"paste":f=s6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=Ax}var m=(n&4)!==0,y=!m&&e==="scroll",x=m?h!==null?h+"Capture":null:h;m=[];for(var S=c,b;S!==null;){b=S;var P=b.stateNode;if(b.tag===5&&P!==null&&(b=P,x!==null&&(P=vc(S,x),P!=null&&m.push(_c(S,P,b)))),y)break;S=S.return}0<m.length&&(h=new f(h,p,null,t,u),d.push({event:h,listeners:m}))}}if(!(n&7)){e:{if(h=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",h&&t!==by&&(p=t.relatedTarget||t.fromElement)&&(si(p)||p[ko]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=t.relatedTarget||t.toElement,f=c,p=p?si(p):null,p!==null&&(y=Mi(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(m=Tx,P="onMouseLeave",x="onMouseEnter",S="mouse",(e==="pointerout"||e==="pointerover")&&(m=Ax,P="onPointerLeave",x="onPointerEnter",S="pointer"),y=f==null?h:ha(f),b=p==null?h:ha(p),h=new m(P,S+"leave",f,t,u),h.target=y,h.relatedTarget=b,P=null,si(u)===c&&(m=new m(x,S+"enter",p,t,u),m.target=b,m.relatedTarget=y,P=m),y=P,f&&p)t:{for(m=f,x=p,S=0,b=m;b;b=Hi(b))S++;for(b=0,P=x;P;P=Hi(P))b++;for(;0<S-b;)m=Hi(m),S--;for(;0<b-S;)x=Hi(x),b--;for(;S--;){if(m===x||x!==null&&m===x.alternate)break t;m=Hi(m),x=Hi(x)}m=null}else m=null;f!==null&&Kx(d,h,f,m,!1),p!==null&&y!==null&&Kx(d,y,p,m,!0)}}e:{if(h=c?ha(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var C=C6;else if(Dx(h))if(s_)C=T6;else{C=k6;var _=I6}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(C=$6);if(C&&(C=C(e,c))){o_(d,C,t,u);break e}_&&_(e,h,c),e==="focusout"&&(_=h._wrapperState)&&_.controlled&&h.type==="number"&&yy(h,"number",h.value)}switch(_=c?ha(c):window,e){case"focusin":(Dx(_)||_.contentEditable==="true")&&(ua=_,$y=c,oc=null);break;case"focusout":oc=$y=ua=null;break;case"mousedown":Ty=!0;break;case"contextmenu":case"mouseup":case"dragend":Ty=!1,Bx(d,t,u);break;case"selectionchange":if(O6)break;case"keydown":case"keyup":Bx(d,t,u)}var I;if(Cv)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else ca?n_(e,t)&&(k="onCompositionEnd"):e==="keydown"&&t.keyCode===229&&(k="onCompositionStart");k&&(t_&&t.locale!=="ko"&&(ca||k!=="onCompositionStart"?k==="onCompositionEnd"&&ca&&(I=e_()):(is=u,Pv="value"in is?is.value:is.textContent,ca=!0)),_=Dh(c,k),0<_.length&&(k=new Mx(k,e,null,t,u),d.push({event:k,listeners:_}),I?k.data=I:(I=r_(t),I!==null&&(k.data=I)))),(I=S6?b6(e,t):P6(e,t))&&(c=Dh(c,"onBeforeInput"),0<c.length&&(u=new Mx("onBeforeInput","beforeinput",null,t,u),d.push({event:u,listeners:c}),u.data=I))}g_(d,n)})}function _c(e,n,t){return{instance:e,listener:n,currentTarget:t}}function Dh(e,n){for(var t=n+"Capture",r=[];e!==null;){var o=e,s=o.stateNode;o.tag===5&&s!==null&&(o=s,s=vc(e,t),s!=null&&r.unshift(_c(e,s,o)),s=vc(e,n),s!=null&&r.push(_c(e,s,o))),e=e.return}return r}function Hi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Kx(e,n,t,r,o){for(var s=n._reactName,i=[];t!==null&&t!==r;){var a=t,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,o?(l=vc(t,s),l!=null&&i.unshift(_c(t,l,a))):o||(l=vc(t,s),l!=null&&i.push(_c(t,l,a)))),t=t.return}i.length!==0&&e.push({event:n,listeners:i})}var j6=/\r\n?/g,N6=/\u0000|\uFFFD/g;function Hx(e){return(typeof e=="string"?e:""+e).replace(j6,`
`).replace(N6,"")}function ed(e,n,t){if(n=Hx(n),Hx(e)!==n&&t)throw Error(X(425))}function Lh(){}var My=null,Ay=null;function Oy(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Ry=typeof setTimeout=="function"?setTimeout:void 0,z6=typeof clearTimeout=="function"?clearTimeout:void 0,Vx=typeof Promise=="function"?Promise:void 0,B6=typeof queueMicrotask=="function"?queueMicrotask:typeof Vx<"u"?function(e){return Vx.resolve(null).then(e).catch(F6)}:Ry;function F6(e){setTimeout(function(){throw e})}function fg(e,n){var t=n,r=0;do{var o=t.nextSibling;if(e.removeChild(t),o&&o.nodeType===8)if(t=o.data,t==="/$"){if(r===0){e.removeChild(o),Sc(n);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=o}while(t);Sc(n)}function gs(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function Wx(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var t=e.data;if(t==="$"||t==="$!"||t==="$?"){if(n===0)return e;n--}else t==="/$"&&n++}e=e.previousSibling}return null}var el=Math.random().toString(36).slice(2),Br="__reactFiber$"+el,Cc="__reactProps$"+el,ko="__reactContainer$"+el,Dy="__reactEvents$"+el,U6="__reactListeners$"+el,K6="__reactHandles$"+el;function si(e){var n=e[Br];if(n)return n;for(var t=e.parentNode;t;){if(n=t[ko]||t[Br]){if(t=n.alternate,n.child!==null||t!==null&&t.child!==null)for(e=Wx(e);e!==null;){if(t=e[Br])return t;e=Wx(e)}return n}e=t,t=e.parentNode}return null}function uu(e){return e=e[Br]||e[ko],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ha(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(X(33))}function Vf(e){return e[Cc]||null}var Ly=[],fa=-1;function Ls(e){return{current:e}}function Ke(e){0>fa||(e.current=Ly[fa],Ly[fa]=null,fa--)}function Ne(e,n){fa++,Ly[fa]=e.current,e.current=n}var _s={},Ht=Ls(_s),pn=Ls(!1),wi=_s;function Na(e,n){var t=e.type.contextTypes;if(!t)return _s;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===n)return r.__reactInternalMemoizedMaskedChildContext;var o={},s;for(s in t)o[s]=n[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=o),o}function gn(e){return e=e.childContextTypes,e!=null}function jh(){Ke(pn),Ke(Ht)}function Yx(e,n,t){if(Ht.current!==_s)throw Error(X(168));Ne(Ht,n),Ne(pn,t)}function y_(e,n,t){var r=e.stateNode;if(n=n.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var o in r)if(!(o in n))throw Error(X(108,I5(e)||"Unknown",o));return st({},t,r)}function Nh(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_s,wi=Ht.current,Ne(Ht,e),Ne(pn,pn.current),!0}function Xx(e,n,t){var r=e.stateNode;if(!r)throw Error(X(169));t?(e=y_(e,n,wi),r.__reactInternalMemoizedMergedChildContext=e,Ke(pn),Ke(Ht),Ne(Ht,e)):Ke(pn),Ne(pn,t)}var fo=null,Wf=!1,pg=!1;function v_(e){fo===null?fo=[e]:fo.push(e)}function H6(e){Wf=!0,v_(e)}function js(){if(!pg&&fo!==null){pg=!0;var e=0,n=Ie;try{var t=fo;for(Ie=1;e<t.length;e++){var r=t[e];do r=r(!0);while(r!==null)}fo=null,Wf=!1}catch(o){throw fo!==null&&(fo=fo.slice(e+1)),KE(wv,js),o}finally{Ie=n,pg=!1}}return null}var pa=[],ga=0,zh=null,Bh=0,Yn=[],Xn=0,xi=null,yo=1,vo="";function ei(e,n){pa[ga++]=Bh,pa[ga++]=zh,zh=e,Bh=n}function w_(e,n,t){Yn[Xn++]=yo,Yn[Xn++]=vo,Yn[Xn++]=xi,xi=e;var r=yo;e=vo;var o=32-_r(r)-1;r&=~(1<<o),t+=1;var s=32-_r(n)+o;if(30<s){var i=o-o%5;s=(r&(1<<i)-1).toString(32),r>>=i,o-=i,yo=1<<32-_r(n)+o|t<<o|r,vo=s+e}else yo=1<<s|t<<o|r,vo=e}function kv(e){e.return!==null&&(ei(e,1),w_(e,1,0))}function $v(e){for(;e===zh;)zh=pa[--ga],pa[ga]=null,Bh=pa[--ga],pa[ga]=null;for(;e===xi;)xi=Yn[--Xn],Yn[Xn]=null,vo=Yn[--Xn],Yn[Xn]=null,yo=Yn[--Xn],Yn[Xn]=null}var On=null,An=null,Xe=!1,vr=null;function x_(e,n){var t=er(5,null,null,0);t.elementType="DELETED",t.stateNode=n,t.return=e,n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)}function Gx(e,n){switch(e.tag){case 5:var t=e.type;return n=n.nodeType!==1||t.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,On=e,An=gs(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,On=e,An=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(t=xi!==null?{id:yo,overflow:vo}:null,e.memoizedState={dehydrated:n,treeContext:t,retryLane:1073741824},t=er(18,null,null,0),t.stateNode=n,t.return=e,e.child=t,On=e,An=null,!0):!1;default:return!1}}function jy(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ny(e){if(Xe){var n=An;if(n){var t=n;if(!Gx(e,n)){if(jy(e))throw Error(X(418));n=gs(t.nextSibling);var r=On;n&&Gx(e,n)?x_(r,t):(e.flags=e.flags&-4097|2,Xe=!1,On=e)}}else{if(jy(e))throw Error(X(418));e.flags=e.flags&-4097|2,Xe=!1,On=e}}}function qx(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;On=e}function td(e){if(e!==On)return!1;if(!Xe)return qx(e),Xe=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!Oy(e.type,e.memoizedProps)),n&&(n=An)){if(jy(e))throw S_(),Error(X(418));for(;n;)x_(e,n),n=gs(n.nextSibling)}if(qx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(X(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var t=e.data;if(t==="/$"){if(n===0){An=gs(e.nextSibling);break e}n--}else t!=="$"&&t!=="$!"&&t!=="$?"||n++}e=e.nextSibling}An=null}}else An=On?gs(e.stateNode.nextSibling):null;return!0}function S_(){for(var e=An;e;)e=gs(e.nextSibling)}function za(){An=On=null,Xe=!1}function Tv(e){vr===null?vr=[e]:vr.push(e)}var V6=Ro.ReactCurrentBatchConfig;function pr(e,n){if(e&&e.defaultProps){n=st({},n),e=e.defaultProps;for(var t in e)n[t]===void 0&&(n[t]=e[t]);return n}return n}var Fh=Ls(null),Uh=null,ma=null,Mv=null;function Av(){Mv=ma=Uh=null}function Ov(e){var n=Fh.current;Ke(Fh),e._currentValue=n}function zy(e,n,t){for(;e!==null;){var r=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,r!==null&&(r.childLanes|=n)):r!==null&&(r.childLanes&n)!==n&&(r.childLanes|=n),e===t)break;e=e.return}}function $a(e,n){Uh=e,Mv=ma=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&n&&(fn=!0),e.firstContext=null)}function nr(e){var n=e._currentValue;if(Mv!==e)if(e={context:e,memoizedValue:n,next:null},ma===null){if(Uh===null)throw Error(X(308));ma=e,Uh.dependencies={lanes:0,firstContext:e}}else ma=ma.next=e;return n}var ii=null;function Rv(e){ii===null?ii=[e]:ii.push(e)}function b_(e,n,t,r){var o=n.interleaved;return o===null?(t.next=t,Rv(n)):(t.next=o.next,o.next=t),n.interleaved=t,$o(e,r)}function $o(e,n){e.lanes|=n;var t=e.alternate;for(t!==null&&(t.lanes|=n),t=e,e=e.return;e!==null;)e.childLanes|=n,t=e.alternate,t!==null&&(t.childLanes|=n),t=e,e=e.return;return t.tag===3?t.stateNode:null}var ts=!1;function Dv(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function P_(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function wo(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function ms(e,n,t){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,xe&2){var o=r.pending;return o===null?n.next=n:(n.next=o.next,o.next=n),r.pending=n,$o(e,t)}return o=r.interleaved,o===null?(n.next=n,Rv(r)):(n.next=o.next,o.next=n),r.interleaved=n,$o(e,t)}function Xd(e,n,t){if(n=n.updateQueue,n!==null&&(n=n.shared,(t&4194240)!==0)){var r=n.lanes;r&=e.pendingLanes,t|=r,n.lanes=t,xv(e,t)}}function Qx(e,n){var t=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var o=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var i={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?o=s=i:s=s.next=i,t=t.next}while(t!==null);s===null?o=s=n:s=s.next=n}else o=s=n;t={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=t;return}e=t.lastBaseUpdate,e===null?t.firstBaseUpdate=n:e.next=n,t.lastBaseUpdate=n}function Kh(e,n,t,r){var o=e.updateQueue;ts=!1;var s=o.firstBaseUpdate,i=o.lastBaseUpdate,a=o.shared.pending;if(a!==null){o.shared.pending=null;var l=a,c=l.next;l.next=null,i===null?s=c:i.next=c,i=l;var u=e.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==i&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=o.baseState;i=0,u=c=l=null,a=s;do{var h=a.lane,f=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,m=a;switch(h=n,f=t,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=st({},d,h);break e;case 2:ts=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,h=o.effects,h===null?o.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,i|=h;if(a=a.next,a===null){if(a=o.shared.pending,a===null)break;h=a,a=h.next,h.next=null,o.lastBaseUpdate=h,o.shared.pending=null}}while(1);if(u===null&&(l=d),o.baseState=l,o.firstBaseUpdate=c,o.lastBaseUpdate=u,n=o.shared.interleaved,n!==null){o=n;do i|=o.lane,o=o.next;while(o!==n)}else s===null&&(o.shared.lanes=0);bi|=i,e.lanes=i,e.memoizedState=d}}function Zx(e,n,t){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var r=e[n],o=r.callback;if(o!==null){if(r.callback=null,r=t,typeof o!="function")throw Error(X(191,o));o.call(r)}}}var E_=new bE.Component().refs;function By(e,n,t,r){n=e.memoizedState,t=t(r,n),t=t==null?n:st({},n,t),e.memoizedState=t,e.lanes===0&&(e.updateQueue.baseState=t)}var Yf={isMounted:function(e){return(e=e._reactInternals)?Mi(e)===e:!1},enqueueSetState:function(e,n,t){e=e._reactInternals;var r=nn(),o=vs(e),s=wo(r,o);s.payload=n,t!=null&&(s.callback=t),n=ms(e,s,o),n!==null&&(Cr(n,e,o,r),Xd(n,e,o))},enqueueReplaceState:function(e,n,t){e=e._reactInternals;var r=nn(),o=vs(e),s=wo(r,o);s.tag=1,s.payload=n,t!=null&&(s.callback=t),n=ms(e,s,o),n!==null&&(Cr(n,e,o,r),Xd(n,e,o))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var t=nn(),r=vs(e),o=wo(t,r);o.tag=2,n!=null&&(o.callback=n),n=ms(e,o,r),n!==null&&(Cr(n,e,r,t),Xd(n,e,r))}};function Jx(e,n,t,r,o,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,i):n.prototype&&n.prototype.isPureReactComponent?!Pc(t,r)||!Pc(o,s):!0}function __(e,n,t){var r=!1,o=_s,s=n.contextType;return typeof s=="object"&&s!==null?s=nr(s):(o=gn(n)?wi:Ht.current,r=n.contextTypes,s=(r=r!=null)?Na(e,o):_s),n=new n(t,s),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=Yf,e.stateNode=n,n._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=s),n}function eS(e,n,t,r){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(t,r),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(t,r),n.state!==e&&Yf.enqueueReplaceState(n,n.state,null)}function Fy(e,n,t,r){var o=e.stateNode;o.props=t,o.state=e.memoizedState,o.refs=E_,Dv(e);var s=n.contextType;typeof s=="object"&&s!==null?o.context=nr(s):(s=gn(n)?wi:Ht.current,o.context=Na(e,s)),o.state=e.memoizedState,s=n.getDerivedStateFromProps,typeof s=="function"&&(By(e,n,s,t),o.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(n=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),n!==o.state&&Yf.enqueueReplaceState(o,o.state,null),Kh(e,t,o,r),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function El(e,n,t){if(e=t.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(X(309));var r=t.stateNode}if(!r)throw Error(X(147,e));var o=r,s=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===s?n.ref:(n=function(i){var a=o.refs;a===E_&&(a=o.refs={}),i===null?delete a[s]:a[s]=i},n._stringRef=s,n)}if(typeof e!="string")throw Error(X(284));if(!t._owner)throw Error(X(290,e))}return e}function nd(e,n){throw e=Object.prototype.toString.call(n),Error(X(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function tS(e){var n=e._init;return n(e._payload)}function C_(e){function n(x,S){if(e){var b=x.deletions;b===null?(x.deletions=[S],x.flags|=16):b.push(S)}}function t(x,S){if(!e)return null;for(;S!==null;)n(x,S),S=S.sibling;return null}function r(x,S){for(x=new Map;S!==null;)S.key!==null?x.set(S.key,S):x.set(S.index,S),S=S.sibling;return x}function o(x,S){return x=ws(x,S),x.index=0,x.sibling=null,x}function s(x,S,b){return x.index=b,e?(b=x.alternate,b!==null?(b=b.index,b<S?(x.flags|=2,S):b):(x.flags|=2,S)):(x.flags|=1048576,S)}function i(x){return e&&x.alternate===null&&(x.flags|=2),x}function a(x,S,b,P){return S===null||S.tag!==6?(S=Sg(b,x.mode,P),S.return=x,S):(S=o(S,b),S.return=x,S)}function l(x,S,b,P){var C=b.type;return C===la?u(x,S,b.props.children,P,b.key):S!==null&&(S.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===es&&tS(C)===S.type)?(P=o(S,b.props),P.ref=El(x,S,b),P.return=x,P):(P=eh(b.type,b.key,b.props,null,x.mode,P),P.ref=El(x,S,b),P.return=x,P)}function c(x,S,b,P){return S===null||S.tag!==4||S.stateNode.containerInfo!==b.containerInfo||S.stateNode.implementation!==b.implementation?(S=bg(b,x.mode,P),S.return=x,S):(S=o(S,b.children||[]),S.return=x,S)}function u(x,S,b,P,C){return S===null||S.tag!==7?(S=fi(b,x.mode,P,C),S.return=x,S):(S=o(S,b),S.return=x,S)}function d(x,S,b){if(typeof S=="string"&&S!==""||typeof S=="number")return S=Sg(""+S,x.mode,b),S.return=x,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Vu:return b=eh(S.type,S.key,S.props,null,x.mode,b),b.ref=El(x,null,S),b.return=x,b;case aa:return S=bg(S,x.mode,b),S.return=x,S;case es:var P=S._init;return d(x,P(S._payload),b)}if(Wl(S)||wl(S))return S=fi(S,x.mode,b,null),S.return=x,S;nd(x,S)}return null}function h(x,S,b,P){var C=S!==null?S.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return C!==null?null:a(x,S,""+b,P);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Vu:return b.key===C?l(x,S,b,P):null;case aa:return b.key===C?c(x,S,b,P):null;case es:return C=b._init,h(x,S,C(b._payload),P)}if(Wl(b)||wl(b))return C!==null?null:u(x,S,b,P,null);nd(x,b)}return null}function f(x,S,b,P,C){if(typeof P=="string"&&P!==""||typeof P=="number")return x=x.get(b)||null,a(S,x,""+P,C);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Vu:return x=x.get(P.key===null?b:P.key)||null,l(S,x,P,C);case aa:return x=x.get(P.key===null?b:P.key)||null,c(S,x,P,C);case es:var _=P._init;return f(x,S,b,_(P._payload),C)}if(Wl(P)||wl(P))return x=x.get(b)||null,u(S,x,P,C,null);nd(S,P)}return null}function p(x,S,b,P){for(var C=null,_=null,I=S,k=S=0,T=null;I!==null&&k<b.length;k++){I.index>k?(T=I,I=null):T=I.sibling;var M=h(x,I,b[k],P);if(M===null){I===null&&(I=T);break}e&&I&&M.alternate===null&&n(x,I),S=s(M,S,k),_===null?C=M:_.sibling=M,_=M,I=T}if(k===b.length)return t(x,I),Xe&&ei(x,k),C;if(I===null){for(;k<b.length;k++)I=d(x,b[k],P),I!==null&&(S=s(I,S,k),_===null?C=I:_.sibling=I,_=I);return Xe&&ei(x,k),C}for(I=r(x,I);k<b.length;k++)T=f(I,x,k,b[k],P),T!==null&&(e&&T.alternate!==null&&I.delete(T.key===null?k:T.key),S=s(T,S,k),_===null?C=T:_.sibling=T,_=T);return e&&I.forEach(function(O){return n(x,O)}),Xe&&ei(x,k),C}function m(x,S,b,P){var C=wl(b);if(typeof C!="function")throw Error(X(150));if(b=C.call(b),b==null)throw Error(X(151));for(var _=C=null,I=S,k=S=0,T=null,M=b.next();I!==null&&!M.done;k++,M=b.next()){I.index>k?(T=I,I=null):T=I.sibling;var O=h(x,I,M.value,P);if(O===null){I===null&&(I=T);break}e&&I&&O.alternate===null&&n(x,I),S=s(O,S,k),_===null?C=O:_.sibling=O,_=O,I=T}if(M.done)return t(x,I),Xe&&ei(x,k),C;if(I===null){for(;!M.done;k++,M=b.next())M=d(x,M.value,P),M!==null&&(S=s(M,S,k),_===null?C=M:_.sibling=M,_=M);return Xe&&ei(x,k),C}for(I=r(x,I);!M.done;k++,M=b.next())M=f(I,x,k,M.value,P),M!==null&&(e&&M.alternate!==null&&I.delete(M.key===null?k:M.key),S=s(M,S,k),_===null?C=M:_.sibling=M,_=M);return e&&I.forEach(function(z){return n(x,z)}),Xe&&ei(x,k),C}function y(x,S,b,P){if(typeof b=="object"&&b!==null&&b.type===la&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Vu:e:{for(var C=b.key,_=S;_!==null;){if(_.key===C){if(C=b.type,C===la){if(_.tag===7){t(x,_.sibling),S=o(_,b.props.children),S.return=x,x=S;break e}}else if(_.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===es&&tS(C)===_.type){t(x,_.sibling),S=o(_,b.props),S.ref=El(x,_,b),S.return=x,x=S;break e}t(x,_);break}else n(x,_);_=_.sibling}b.type===la?(S=fi(b.props.children,x.mode,P,b.key),S.return=x,x=S):(P=eh(b.type,b.key,b.props,null,x.mode,P),P.ref=El(x,S,b),P.return=x,x=P)}return i(x);case aa:e:{for(_=b.key;S!==null;){if(S.key===_)if(S.tag===4&&S.stateNode.containerInfo===b.containerInfo&&S.stateNode.implementation===b.implementation){t(x,S.sibling),S=o(S,b.children||[]),S.return=x,x=S;break e}else{t(x,S);break}else n(x,S);S=S.sibling}S=bg(b,x.mode,P),S.return=x,x=S}return i(x);case es:return _=b._init,y(x,S,_(b._payload),P)}if(Wl(b))return p(x,S,b,P);if(wl(b))return m(x,S,b,P);nd(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,S!==null&&S.tag===6?(t(x,S.sibling),S=o(S,b),S.return=x,x=S):(t(x,S),S=Sg(b,x.mode,P),S.return=x,x=S),i(x)):t(x,S)}return y}var Ba=C_(!0),I_=C_(!1),du={},Kr=Ls(du),Ic=Ls(du),kc=Ls(du);function ai(e){if(e===du)throw Error(X(174));return e}function Lv(e,n){switch(Ne(kc,n),Ne(Ic,e),Ne(Kr,du),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:wy(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=wy(n,e)}Ke(Kr),Ne(Kr,n)}function Fa(){Ke(Kr),Ke(Ic),Ke(kc)}function k_(e){ai(kc.current);var n=ai(Kr.current),t=wy(n,e.type);n!==t&&(Ne(Ic,e),Ne(Kr,t))}function jv(e){Ic.current===e&&(Ke(Kr),Ke(Ic))}var tt=Ls(0);function Hh(e){for(var n=e;n!==null;){if(n.tag===13){var t=n.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var gg=[];function Nv(){for(var e=0;e<gg.length;e++)gg[e]._workInProgressVersionPrimary=null;gg.length=0}var Gd=Ro.ReactCurrentDispatcher,mg=Ro.ReactCurrentBatchConfig,Si=0,ot=null,gt=null,xt=null,Vh=!1,sc=!1,$c=0,W6=0;function jt(){throw Error(X(321))}function zv(e,n){if(n===null)return!1;for(var t=0;t<n.length&&t<e.length;t++)if(!Tr(e[t],n[t]))return!1;return!0}function Bv(e,n,t,r,o,s){if(Si=s,ot=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Gd.current=e===null||e.memoizedState===null?q6:Q6,e=t(r,o),sc){s=0;do{if(sc=!1,$c=0,25<=s)throw Error(X(301));s+=1,xt=gt=null,n.updateQueue=null,Gd.current=Z6,e=t(r,o)}while(sc)}if(Gd.current=Wh,n=gt!==null&&gt.next!==null,Si=0,xt=gt=ot=null,Vh=!1,n)throw Error(X(300));return e}function Fv(){var e=$c!==0;return $c=0,e}function Lr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xt===null?ot.memoizedState=xt=e:xt=xt.next=e,xt}function rr(){if(gt===null){var e=ot.alternate;e=e!==null?e.memoizedState:null}else e=gt.next;var n=xt===null?ot.memoizedState:xt.next;if(n!==null)xt=n,gt=e;else{if(e===null)throw Error(X(310));gt=e,e={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},xt===null?ot.memoizedState=xt=e:xt=xt.next=e}return xt}function Tc(e,n){return typeof n=="function"?n(e):n}function yg(e){var n=rr(),t=n.queue;if(t===null)throw Error(X(311));t.lastRenderedReducer=e;var r=gt,o=r.baseQueue,s=t.pending;if(s!==null){if(o!==null){var i=o.next;o.next=s.next,s.next=i}r.baseQueue=o=s,t.pending=null}if(o!==null){s=o.next,r=r.baseState;var a=i=null,l=null,c=s;do{var u=c.lane;if((Si&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,i=r):l=l.next=d,ot.lanes|=u,bi|=u}c=c.next}while(c!==null&&c!==s);l===null?i=r:l.next=a,Tr(r,n.memoizedState)||(fn=!0),n.memoizedState=r,n.baseState=i,n.baseQueue=l,t.lastRenderedState=r}if(e=t.interleaved,e!==null){o=e;do s=o.lane,ot.lanes|=s,bi|=s,o=o.next;while(o!==e)}else o===null&&(t.lanes=0);return[n.memoizedState,t.dispatch]}function vg(e){var n=rr(),t=n.queue;if(t===null)throw Error(X(311));t.lastRenderedReducer=e;var r=t.dispatch,o=t.pending,s=n.memoizedState;if(o!==null){t.pending=null;var i=o=o.next;do s=e(s,i.action),i=i.next;while(i!==o);Tr(s,n.memoizedState)||(fn=!0),n.memoizedState=s,n.baseQueue===null&&(n.baseState=s),t.lastRenderedState=s}return[s,r]}function $_(){}function T_(e,n){var t=ot,r=rr(),o=n(),s=!Tr(r.memoizedState,o);if(s&&(r.memoizedState=o,fn=!0),r=r.queue,Uv(O_.bind(null,t,r,e),[e]),r.getSnapshot!==n||s||xt!==null&&xt.memoizedState.tag&1){if(t.flags|=2048,Mc(9,A_.bind(null,t,r,o,n),void 0,null),bt===null)throw Error(X(349));Si&30||M_(t,n,o)}return o}function M_(e,n,t){e.flags|=16384,e={getSnapshot:n,value:t},n=ot.updateQueue,n===null?(n={lastEffect:null,stores:null},ot.updateQueue=n,n.stores=[e]):(t=n.stores,t===null?n.stores=[e]:t.push(e))}function A_(e,n,t,r){n.value=t,n.getSnapshot=r,R_(n)&&D_(e)}function O_(e,n,t){return t(function(){R_(n)&&D_(e)})}function R_(e){var n=e.getSnapshot;e=e.value;try{var t=n();return!Tr(e,t)}catch{return!0}}function D_(e){var n=$o(e,1);n!==null&&Cr(n,e,1,-1)}function nS(e){var n=Lr();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Tc,lastRenderedState:e},n.queue=e,e=e.dispatch=G6.bind(null,ot,e),[n.memoizedState,e]}function Mc(e,n,t,r){return e={tag:e,create:n,destroy:t,deps:r,next:null},n=ot.updateQueue,n===null?(n={lastEffect:null,stores:null},ot.updateQueue=n,n.lastEffect=e.next=e):(t=n.lastEffect,t===null?n.lastEffect=e.next=e:(r=t.next,t.next=e,e.next=r,n.lastEffect=e)),e}function L_(){return rr().memoizedState}function qd(e,n,t,r){var o=Lr();ot.flags|=e,o.memoizedState=Mc(1|n,t,void 0,r===void 0?null:r)}function Xf(e,n,t,r){var o=rr();r=r===void 0?null:r;var s=void 0;if(gt!==null){var i=gt.memoizedState;if(s=i.destroy,r!==null&&zv(r,i.deps)){o.memoizedState=Mc(n,t,s,r);return}}ot.flags|=e,o.memoizedState=Mc(1|n,t,s,r)}function rS(e,n){return qd(8390656,8,e,n)}function Uv(e,n){return Xf(2048,8,e,n)}function j_(e,n){return Xf(4,2,e,n)}function N_(e,n){return Xf(4,4,e,n)}function z_(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function B_(e,n,t){return t=t!=null?t.concat([e]):null,Xf(4,4,z_.bind(null,n,e),t)}function Kv(){}function F_(e,n){var t=rr();n=n===void 0?null:n;var r=t.memoizedState;return r!==null&&n!==null&&zv(n,r[1])?r[0]:(t.memoizedState=[e,n],e)}function U_(e,n){var t=rr();n=n===void 0?null:n;var r=t.memoizedState;return r!==null&&n!==null&&zv(n,r[1])?r[0]:(e=e(),t.memoizedState=[e,n],e)}function K_(e,n,t){return Si&21?(Tr(t,n)||(t=WE(),ot.lanes|=t,bi|=t,e.baseState=!0),n):(e.baseState&&(e.baseState=!1,fn=!0),e.memoizedState=t)}function Y6(e,n){var t=Ie;Ie=t!==0&&4>t?t:4,e(!0);var r=mg.transition;mg.transition={};try{e(!1),n()}finally{Ie=t,mg.transition=r}}function H_(){return rr().memoizedState}function X6(e,n,t){var r=vs(e);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},V_(e))W_(n,t);else if(t=b_(e,n,t,r),t!==null){var o=nn();Cr(t,e,r,o),Y_(t,n,r)}}function G6(e,n,t){var r=vs(e),o={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(V_(e))W_(n,o);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=n.lastRenderedReducer,s!==null))try{var i=n.lastRenderedState,a=s(i,t);if(o.hasEagerState=!0,o.eagerState=a,Tr(a,i)){var l=n.interleaved;l===null?(o.next=o,Rv(n)):(o.next=l.next,l.next=o),n.interleaved=o;return}}catch{}finally{}t=b_(e,n,o,r),t!==null&&(o=nn(),Cr(t,e,r,o),Y_(t,n,r))}}function V_(e){var n=e.alternate;return e===ot||n!==null&&n===ot}function W_(e,n){sc=Vh=!0;var t=e.pending;t===null?n.next=n:(n.next=t.next,t.next=n),e.pending=n}function Y_(e,n,t){if(t&4194240){var r=n.lanes;r&=e.pendingLanes,t|=r,n.lanes=t,xv(e,t)}}var Wh={readContext:nr,useCallback:jt,useContext:jt,useEffect:jt,useImperativeHandle:jt,useInsertionEffect:jt,useLayoutEffect:jt,useMemo:jt,useReducer:jt,useRef:jt,useState:jt,useDebugValue:jt,useDeferredValue:jt,useTransition:jt,useMutableSource:jt,useSyncExternalStore:jt,useId:jt,unstable_isNewReconciler:!1},q6={readContext:nr,useCallback:function(e,n){return Lr().memoizedState=[e,n===void 0?null:n],e},useContext:nr,useEffect:rS,useImperativeHandle:function(e,n,t){return t=t!=null?t.concat([e]):null,qd(4194308,4,z_.bind(null,n,e),t)},useLayoutEffect:function(e,n){return qd(4194308,4,e,n)},useInsertionEffect:function(e,n){return qd(4,2,e,n)},useMemo:function(e,n){var t=Lr();return n=n===void 0?null:n,e=e(),t.memoizedState=[e,n],e},useReducer:function(e,n,t){var r=Lr();return n=t!==void 0?t(n):n,r.memoizedState=r.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},r.queue=e,e=e.dispatch=X6.bind(null,ot,e),[r.memoizedState,e]},useRef:function(e){var n=Lr();return e={current:e},n.memoizedState=e},useState:nS,useDebugValue:Kv,useDeferredValue:function(e){return Lr().memoizedState=e},useTransition:function(){var e=nS(!1),n=e[0];return e=Y6.bind(null,e[1]),Lr().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,t){var r=ot,o=Lr();if(Xe){if(t===void 0)throw Error(X(407));t=t()}else{if(t=n(),bt===null)throw Error(X(349));Si&30||M_(r,n,t)}o.memoizedState=t;var s={value:t,getSnapshot:n};return o.queue=s,rS(O_.bind(null,r,s,e),[e]),r.flags|=2048,Mc(9,A_.bind(null,r,s,t,n),void 0,null),t},useId:function(){var e=Lr(),n=bt.identifierPrefix;if(Xe){var t=vo,r=yo;t=(r&~(1<<32-_r(r)-1)).toString(32)+t,n=":"+n+"R"+t,t=$c++,0<t&&(n+="H"+t.toString(32)),n+=":"}else t=W6++,n=":"+n+"r"+t.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},Q6={readContext:nr,useCallback:F_,useContext:nr,useEffect:Uv,useImperativeHandle:B_,useInsertionEffect:j_,useLayoutEffect:N_,useMemo:U_,useReducer:yg,useRef:L_,useState:function(){return yg(Tc)},useDebugValue:Kv,useDeferredValue:function(e){var n=rr();return K_(n,gt.memoizedState,e)},useTransition:function(){var e=yg(Tc)[0],n=rr().memoizedState;return[e,n]},useMutableSource:$_,useSyncExternalStore:T_,useId:H_,unstable_isNewReconciler:!1},Z6={readContext:nr,useCallback:F_,useContext:nr,useEffect:Uv,useImperativeHandle:B_,useInsertionEffect:j_,useLayoutEffect:N_,useMemo:U_,useReducer:vg,useRef:L_,useState:function(){return vg(Tc)},useDebugValue:Kv,useDeferredValue:function(e){var n=rr();return gt===null?n.memoizedState=e:K_(n,gt.memoizedState,e)},useTransition:function(){var e=vg(Tc)[0],n=rr().memoizedState;return[e,n]},useMutableSource:$_,useSyncExternalStore:T_,useId:H_,unstable_isNewReconciler:!1};function Ua(e,n){try{var t="",r=n;do t+=C5(r),r=r.return;while(r);var o=t}catch(s){o=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:n,stack:o,digest:null}}function wg(e,n,t){return{value:e,source:null,stack:t??null,digest:n??null}}function Uy(e,n){try{console.error(n.value)}catch(t){setTimeout(function(){throw t})}}var J6=typeof WeakMap=="function"?WeakMap:Map;function X_(e,n,t){t=wo(-1,t),t.tag=3,t.payload={element:null};var r=n.value;return t.callback=function(){Xh||(Xh=!0,Zy=r),Uy(e,n)},t}function G_(e,n,t){t=wo(-1,t),t.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var o=n.value;t.payload=function(){return r(o)},t.callback=function(){Uy(e,n)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){Uy(e,n),typeof r!="function"&&(ys===null?ys=new Set([this]):ys.add(this));var i=n.stack;this.componentDidCatch(n.value,{componentStack:i!==null?i:""})}),t}function oS(e,n,t){var r=e.pingCache;if(r===null){r=e.pingCache=new J6;var o=new Set;r.set(n,o)}else o=r.get(n),o===void 0&&(o=new Set,r.set(n,o));o.has(t)||(o.add(t),e=f4.bind(null,e,n,t),n.then(e,e))}function sS(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function iS(e,n,t,r,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===n?e.flags|=65536:(e.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(n=wo(-1,1),n.tag=2,ms(t,n,1))),t.lanes|=1),e)}var e4=Ro.ReactCurrentOwner,fn=!1;function Jt(e,n,t,r){n.child=e===null?I_(n,null,t,r):Ba(n,e.child,t,r)}function aS(e,n,t,r,o){t=t.render;var s=n.ref;return $a(n,o),r=Bv(e,n,t,r,s,o),t=Fv(),e!==null&&!fn?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~o,To(e,n,o)):(Xe&&t&&kv(n),n.flags|=1,Jt(e,n,r,o),n.child)}function lS(e,n,t,r,o){if(e===null){var s=t.type;return typeof s=="function"&&!Qv(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(n.tag=15,n.type=s,q_(e,n,s,r,o)):(e=eh(t.type,null,r,n,n.mode,o),e.ref=n.ref,e.return=n,n.child=e)}if(s=e.child,!(e.lanes&o)){var i=s.memoizedProps;if(t=t.compare,t=t!==null?t:Pc,t(i,r)&&e.ref===n.ref)return To(e,n,o)}return n.flags|=1,e=ws(s,r),e.ref=n.ref,e.return=n,n.child=e}function q_(e,n,t,r,o){if(e!==null){var s=e.memoizedProps;if(Pc(s,r)&&e.ref===n.ref)if(fn=!1,n.pendingProps=r=s,(e.lanes&o)!==0)e.flags&131072&&(fn=!0);else return n.lanes=e.lanes,To(e,n,o)}return Ky(e,n,t,r,o)}function Q_(e,n,t){var r=n.pendingProps,o=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ne(va,In),In|=t;else{if(!(t&1073741824))return e=s!==null?s.baseLanes|t:t,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,Ne(va,In),In|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,Ne(va,In),In|=r}else s!==null?(r=s.baseLanes|t,n.memoizedState=null):r=t,Ne(va,In),In|=r;return Jt(e,n,o,t),n.child}function Z_(e,n){var t=n.ref;(e===null&&t!==null||e!==null&&e.ref!==t)&&(n.flags|=512,n.flags|=2097152)}function Ky(e,n,t,r,o){var s=gn(t)?wi:Ht.current;return s=Na(n,s),$a(n,o),t=Bv(e,n,t,r,s,o),r=Fv(),e!==null&&!fn?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~o,To(e,n,o)):(Xe&&r&&kv(n),n.flags|=1,Jt(e,n,t,o),n.child)}function cS(e,n,t,r,o){if(gn(t)){var s=!0;Nh(n)}else s=!1;if($a(n,o),n.stateNode===null)Qd(e,n),__(n,t,r),Fy(n,t,r,o),r=!0;else if(e===null){var i=n.stateNode,a=n.memoizedProps;i.props=a;var l=i.context,c=t.contextType;typeof c=="object"&&c!==null?c=nr(c):(c=gn(t)?wi:Ht.current,c=Na(n,c));var u=t.getDerivedStateFromProps,d=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==r||l!==c)&&eS(n,i,r,c),ts=!1;var h=n.memoizedState;i.state=h,Kh(n,r,i,o),l=n.memoizedState,a!==r||h!==l||pn.current||ts?(typeof u=="function"&&(By(n,t,u,r),l=n.memoizedState),(a=ts||Jx(n,t,a,r,h,l,c))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(n.flags|=4194308)):(typeof i.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=r,n.memoizedState=l),i.props=r,i.state=l,i.context=c,r=a):(typeof i.componentDidMount=="function"&&(n.flags|=4194308),r=!1)}else{i=n.stateNode,P_(e,n),a=n.memoizedProps,c=n.type===n.elementType?a:pr(n.type,a),i.props=c,d=n.pendingProps,h=i.context,l=t.contextType,typeof l=="object"&&l!==null?l=nr(l):(l=gn(t)?wi:Ht.current,l=Na(n,l));var f=t.getDerivedStateFromProps;(u=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==d||h!==l)&&eS(n,i,r,l),ts=!1,h=n.memoizedState,i.state=h,Kh(n,r,i,o);var p=n.memoizedState;a!==d||h!==p||pn.current||ts?(typeof f=="function"&&(By(n,t,f,r),p=n.memoizedState),(c=ts||Jx(n,t,c,r,h,p,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,p,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,p,l)),typeof i.componentDidUpdate=="function"&&(n.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(n.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(n.flags|=1024),n.memoizedProps=r,n.memoizedState=p),i.props=r,i.state=p,i.context=l,r=c):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(n.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(n.flags|=1024),r=!1)}return Hy(e,n,t,r,s,o)}function Hy(e,n,t,r,o,s){Z_(e,n);var i=(n.flags&128)!==0;if(!r&&!i)return o&&Xx(n,t,!1),To(e,n,s);r=n.stateNode,e4.current=n;var a=i&&typeof t.getDerivedStateFromError!="function"?null:r.render();return n.flags|=1,e!==null&&i?(n.child=Ba(n,e.child,null,s),n.child=Ba(n,null,a,s)):Jt(e,n,a,s),n.memoizedState=r.state,o&&Xx(n,t,!0),n.child}function J_(e){var n=e.stateNode;n.pendingContext?Yx(e,n.pendingContext,n.pendingContext!==n.context):n.context&&Yx(e,n.context,!1),Lv(e,n.containerInfo)}function uS(e,n,t,r,o){return za(),Tv(o),n.flags|=256,Jt(e,n,t,r),n.child}var Vy={dehydrated:null,treeContext:null,retryLane:0};function Wy(e){return{baseLanes:e,cachePool:null,transitions:null}}function eC(e,n,t){var r=n.pendingProps,o=tt.current,s=!1,i=(n.flags&128)!==0,a;if((a=i)||(a=e!==null&&e.memoizedState===null?!1:(o&2)!==0),a?(s=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Ne(tt,o&1),e===null)return Ny(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(n.mode&1?e.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(i=r.children,e=r.fallback,s?(r=n.mode,s=n.child,i={mode:"hidden",children:i},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=Qf(i,r,0,null),e=fi(e,r,t,null),s.return=n,e.return=n,s.sibling=e,n.child=s,n.child.memoizedState=Wy(t),n.memoizedState=Vy,e):Hv(n,i));if(o=e.memoizedState,o!==null&&(a=o.dehydrated,a!==null))return t4(e,n,i,r,a,o,t);if(s){s=r.fallback,i=n.mode,o=e.child,a=o.sibling;var l={mode:"hidden",children:r.children};return!(i&1)&&n.child!==o?(r=n.child,r.childLanes=0,r.pendingProps=l,n.deletions=null):(r=ws(o,l),r.subtreeFlags=o.subtreeFlags&14680064),a!==null?s=ws(a,s):(s=fi(s,i,t,null),s.flags|=2),s.return=n,r.return=n,r.sibling=s,n.child=r,r=s,s=n.child,i=e.child.memoizedState,i=i===null?Wy(t):{baseLanes:i.baseLanes|t,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~t,n.memoizedState=Vy,r}return s=e.child,e=s.sibling,r=ws(s,{mode:"visible",children:r.children}),!(n.mode&1)&&(r.lanes=t),r.return=n,r.sibling=null,e!==null&&(t=n.deletions,t===null?(n.deletions=[e],n.flags|=16):t.push(e)),n.child=r,n.memoizedState=null,r}function Hv(e,n){return n=Qf({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function rd(e,n,t,r){return r!==null&&Tv(r),Ba(n,e.child,null,t),e=Hv(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function t4(e,n,t,r,o,s,i){if(t)return n.flags&256?(n.flags&=-257,r=wg(Error(X(422))),rd(e,n,i,r)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(s=r.fallback,o=n.mode,r=Qf({mode:"visible",children:r.children},o,0,null),s=fi(s,o,i,null),s.flags|=2,r.return=n,s.return=n,r.sibling=s,n.child=r,n.mode&1&&Ba(n,e.child,null,i),n.child.memoizedState=Wy(i),n.memoizedState=Vy,s);if(!(n.mode&1))return rd(e,n,i,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(X(419)),r=wg(s,r,void 0),rd(e,n,i,r)}if(a=(i&e.childLanes)!==0,fn||a){if(r=bt,r!==null){switch(i&-i){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|i)?0:o,o!==0&&o!==s.retryLane&&(s.retryLane=o,$o(e,o),Cr(r,e,o,-1))}return qv(),r=wg(Error(X(421))),rd(e,n,i,r)}return o.data==="$?"?(n.flags|=128,n.child=e.child,n=p4.bind(null,e),o._reactRetry=n,null):(e=s.treeContext,An=gs(o.nextSibling),On=n,Xe=!0,vr=null,e!==null&&(Yn[Xn++]=yo,Yn[Xn++]=vo,Yn[Xn++]=xi,yo=e.id,vo=e.overflow,xi=n),n=Hv(n,r.children),n.flags|=4096,n)}function dS(e,n,t){e.lanes|=n;var r=e.alternate;r!==null&&(r.lanes|=n),zy(e.return,n,t)}function xg(e,n,t,r,o){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:o}:(s.isBackwards=n,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=o)}function tC(e,n,t){var r=n.pendingProps,o=r.revealOrder,s=r.tail;if(Jt(e,n,r.children,t),r=tt.current,r&2)r=r&1|2,n.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&dS(e,t,n);else if(e.tag===19)dS(e,t,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ne(tt,r),!(n.mode&1))n.memoizedState=null;else switch(o){case"forwards":for(t=n.child,o=null;t!==null;)e=t.alternate,e!==null&&Hh(e)===null&&(o=t),t=t.sibling;t=o,t===null?(o=n.child,n.child=null):(o=t.sibling,t.sibling=null),xg(n,!1,o,t,s);break;case"backwards":for(t=null,o=n.child,n.child=null;o!==null;){if(e=o.alternate,e!==null&&Hh(e)===null){n.child=o;break}e=o.sibling,o.sibling=t,t=o,o=e}xg(n,!0,t,null,s);break;case"together":xg(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Qd(e,n){!(n.mode&1)&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function To(e,n,t){if(e!==null&&(n.dependencies=e.dependencies),bi|=n.lanes,!(t&n.childLanes))return null;if(e!==null&&n.child!==e.child)throw Error(X(153));if(n.child!==null){for(e=n.child,t=ws(e,e.pendingProps),n.child=t,t.return=n;e.sibling!==null;)e=e.sibling,t=t.sibling=ws(e,e.pendingProps),t.return=n;t.sibling=null}return n.child}function n4(e,n,t){switch(n.tag){case 3:J_(n),za();break;case 5:k_(n);break;case 1:gn(n.type)&&Nh(n);break;case 4:Lv(n,n.stateNode.containerInfo);break;case 10:var r=n.type._context,o=n.memoizedProps.value;Ne(Fh,r._currentValue),r._currentValue=o;break;case 13:if(r=n.memoizedState,r!==null)return r.dehydrated!==null?(Ne(tt,tt.current&1),n.flags|=128,null):t&n.child.childLanes?eC(e,n,t):(Ne(tt,tt.current&1),e=To(e,n,t),e!==null?e.sibling:null);Ne(tt,tt.current&1);break;case 19:if(r=(t&n.childLanes)!==0,e.flags&128){if(r)return tC(e,n,t);n.flags|=128}if(o=n.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Ne(tt,tt.current),r)break;return null;case 22:case 23:return n.lanes=0,Q_(e,n,t)}return To(e,n,t)}var nC,Yy,rC,oC;nC=function(e,n){for(var t=n.child;t!==null;){if(t.tag===5||t.tag===6)e.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break;for(;t.sibling===null;){if(t.return===null||t.return===n)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Yy=function(){};rC=function(e,n,t,r){var o=e.memoizedProps;if(o!==r){e=n.stateNode,ai(Kr.current);var s=null;switch(t){case"input":o=gy(e,o),r=gy(e,r),s=[];break;case"select":o=st({},o,{value:void 0}),r=st({},r,{value:void 0}),s=[];break;case"textarea":o=vy(e,o),r=vy(e,r),s=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Lh)}xy(t,r);var i;t=null;for(c in o)if(!r.hasOwnProperty(c)&&o.hasOwnProperty(c)&&o[c]!=null)if(c==="style"){var a=o[c];for(i in a)a.hasOwnProperty(i)&&(t||(t={}),t[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(mc.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=o!=null?o[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(i in a)!a.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(t||(t={}),t[i]="");for(i in l)l.hasOwnProperty(i)&&a[i]!==l[i]&&(t||(t={}),t[i]=l[i])}else t||(s||(s=[]),s.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(mc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Be("scroll",e),s||a===l||(s=[])):(s=s||[]).push(c,l))}t&&(s=s||[]).push("style",t);var c=s;(n.updateQueue=c)&&(n.flags|=4)}};oC=function(e,n,t,r){t!==r&&(n.flags|=4)};function _l(e,n){if(!Xe)switch(e.tailMode){case"hidden":n=e.tail;for(var t=null;n!==null;)n.alternate!==null&&(t=n),n=n.sibling;t===null?e.tail=null:t.sibling=null;break;case"collapsed":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Nt(e){var n=e.alternate!==null&&e.alternate.child===e.child,t=0,r=0;if(n)for(var o=e.child;o!==null;)t|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)t|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=t,n}function r4(e,n,t){var r=n.pendingProps;switch($v(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(n),null;case 1:return gn(n.type)&&jh(),Nt(n),null;case 3:return r=n.stateNode,Fa(),Ke(pn),Ke(Ht),Nv(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(td(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,vr!==null&&(t0(vr),vr=null))),Yy(e,n),Nt(n),null;case 5:jv(n);var o=ai(kc.current);if(t=n.type,e!==null&&n.stateNode!=null)rC(e,n,t,r,o),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!r){if(n.stateNode===null)throw Error(X(166));return Nt(n),null}if(e=ai(Kr.current),td(n)){r=n.stateNode,t=n.type;var s=n.memoizedProps;switch(r[Br]=n,r[Cc]=s,e=(n.mode&1)!==0,t){case"dialog":Be("cancel",r),Be("close",r);break;case"iframe":case"object":case"embed":Be("load",r);break;case"video":case"audio":for(o=0;o<Xl.length;o++)Be(Xl[o],r);break;case"source":Be("error",r);break;case"img":case"image":case"link":Be("error",r),Be("load",r);break;case"details":Be("toggle",r);break;case"input":xx(r,s),Be("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Be("invalid",r);break;case"textarea":bx(r,s),Be("invalid",r)}xy(t,s),o=null;for(var i in s)if(s.hasOwnProperty(i)){var a=s[i];i==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&ed(r.textContent,a,e),o=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&ed(r.textContent,a,e),o=["children",""+a]):mc.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&Be("scroll",r)}switch(t){case"input":Wu(r),Sx(r,s,!0);break;case"textarea":Wu(r),Px(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Lh)}r=o,n.updateQueue=r,r!==null&&(n.flags|=4)}else{i=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ME(t)),e==="http://www.w3.org/1999/xhtml"?t==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=i.createElement(t,{is:r.is}):(e=i.createElement(t),t==="select"&&(i=e,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):e=i.createElementNS(e,t),e[Br]=n,e[Cc]=r,nC(e,n,!1,!1),n.stateNode=e;e:{switch(i=Sy(t,r),t){case"dialog":Be("cancel",e),Be("close",e),o=r;break;case"iframe":case"object":case"embed":Be("load",e),o=r;break;case"video":case"audio":for(o=0;o<Xl.length;o++)Be(Xl[o],e);o=r;break;case"source":Be("error",e),o=r;break;case"img":case"image":case"link":Be("error",e),Be("load",e),o=r;break;case"details":Be("toggle",e),o=r;break;case"input":xx(e,r),o=gy(e,r),Be("invalid",e);break;case"option":o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=st({},r,{value:void 0}),Be("invalid",e);break;case"textarea":bx(e,r),o=vy(e,r),Be("invalid",e);break;default:o=r}xy(t,o),a=o;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?RE(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&AE(e,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&yc(e,l):typeof l=="number"&&yc(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(mc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Be("scroll",e):l!=null&&pv(e,s,l,i))}switch(t){case"input":Wu(e),Sx(e,r,!1);break;case"textarea":Wu(e),Px(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Es(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?_a(e,!!r.multiple,s,!1):r.defaultValue!=null&&_a(e,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=Lh)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return Nt(n),null;case 6:if(e&&n.stateNode!=null)oC(e,n,e.memoizedProps,r);else{if(typeof r!="string"&&n.stateNode===null)throw Error(X(166));if(t=ai(kc.current),ai(Kr.current),td(n)){if(r=n.stateNode,t=n.memoizedProps,r[Br]=n,(s=r.nodeValue!==t)&&(e=On,e!==null))switch(e.tag){case 3:ed(r.nodeValue,t,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ed(r.nodeValue,t,(e.mode&1)!==0)}s&&(n.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Br]=n,n.stateNode=r}return Nt(n),null;case 13:if(Ke(tt),r=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Xe&&An!==null&&n.mode&1&&!(n.flags&128))S_(),za(),n.flags|=98560,s=!1;else if(s=td(n),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(X(318));if(s=n.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(X(317));s[Br]=n}else za(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;Nt(n),s=!1}else vr!==null&&(t0(vr),vr=null),s=!0;if(!s)return n.flags&65536?n:null}return n.flags&128?(n.lanes=t,n):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(n.child.flags|=8192,n.mode&1&&(e===null||tt.current&1?yt===0&&(yt=3):qv())),n.updateQueue!==null&&(n.flags|=4),Nt(n),null);case 4:return Fa(),Yy(e,n),e===null&&Ec(n.stateNode.containerInfo),Nt(n),null;case 10:return Ov(n.type._context),Nt(n),null;case 17:return gn(n.type)&&jh(),Nt(n),null;case 19:if(Ke(tt),s=n.memoizedState,s===null)return Nt(n),null;if(r=(n.flags&128)!==0,i=s.rendering,i===null)if(r)_l(s,!1);else{if(yt!==0||e!==null&&e.flags&128)for(e=n.child;e!==null;){if(i=Hh(e),i!==null){for(n.flags|=128,_l(s,!1),r=i.updateQueue,r!==null&&(n.updateQueue=r,n.flags|=4),n.subtreeFlags=0,r=t,t=n.child;t!==null;)s=t,e=r,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),t=t.sibling;return Ne(tt,tt.current&1|2),n.child}e=e.sibling}s.tail!==null&&ht()>Ka&&(n.flags|=128,r=!0,_l(s,!1),n.lanes=4194304)}else{if(!r)if(e=Hh(i),e!==null){if(n.flags|=128,r=!0,t=e.updateQueue,t!==null&&(n.updateQueue=t,n.flags|=4),_l(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!Xe)return Nt(n),null}else 2*ht()-s.renderingStartTime>Ka&&t!==1073741824&&(n.flags|=128,r=!0,_l(s,!1),n.lanes=4194304);s.isBackwards?(i.sibling=n.child,n.child=i):(t=s.last,t!==null?t.sibling=i:n.child=i,s.last=i)}return s.tail!==null?(n=s.tail,s.rendering=n,s.tail=n.sibling,s.renderingStartTime=ht(),n.sibling=null,t=tt.current,Ne(tt,r?t&1|2:t&1),n):(Nt(n),null);case 22:case 23:return Gv(),r=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(n.flags|=8192),r&&n.mode&1?In&1073741824&&(Nt(n),n.subtreeFlags&6&&(n.flags|=8192)):Nt(n),null;case 24:return null;case 25:return null}throw Error(X(156,n.tag))}function o4(e,n){switch($v(n),n.tag){case 1:return gn(n.type)&&jh(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Fa(),Ke(pn),Ke(Ht),Nv(),e=n.flags,e&65536&&!(e&128)?(n.flags=e&-65537|128,n):null;case 5:return jv(n),null;case 13:if(Ke(tt),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(X(340));za()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return Ke(tt),null;case 4:return Fa(),null;case 10:return Ov(n.type._context),null;case 22:case 23:return Gv(),null;case 24:return null;default:return null}}var od=!1,Ut=!1,s4=typeof WeakSet=="function"?WeakSet:Set,te=null;function ya(e,n){var t=e.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){ct(e,n,r)}else t.current=null}function Xy(e,n,t){try{t()}catch(r){ct(e,n,r)}}var hS=!1;function i4(e,n){if(My=Oh,e=l_(),Iv(e)){if("selectionStart"in e)var t={start:e.selectionStart,end:e.selectionEnd};else e:{t=(t=e.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var o=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var i=0,a=-1,l=-1,c=0,u=0,d=e,h=null;t:for(;;){for(var f;d!==t||o!==0&&d.nodeType!==3||(a=i+o),d!==s||r!==0&&d.nodeType!==3||(l=i+r),d.nodeType===3&&(i+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===e)break t;if(h===t&&++c===o&&(a=i),h===s&&++u===r&&(l=i),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Ay={focusedElem:e,selectionRange:t},Oh=!1,te=n;te!==null;)if(n=te,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,te=e;else for(;te!==null;){n=te;try{var p=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,y=p.memoizedState,x=n.stateNode,S=x.getSnapshotBeforeUpdate(n.elementType===n.type?m:pr(n.type,m),y);x.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var b=n.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(X(163))}}catch(P){ct(n,n.return,P)}if(e=n.sibling,e!==null){e.return=n.return,te=e;break}te=n.return}return p=hS,hS=!1,p}function ic(e,n,t){var r=n.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var s=o.destroy;o.destroy=void 0,s!==void 0&&Xy(n,t,s)}o=o.next}while(o!==r)}}function Gf(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var t=n=n.next;do{if((t.tag&e)===e){var r=t.create;t.destroy=r()}t=t.next}while(t!==n)}}function Gy(e){var n=e.ref;if(n!==null){var t=e.stateNode;switch(e.tag){case 5:e=t;break;default:e=t}typeof n=="function"?n(e):n.current=e}}function sC(e){var n=e.alternate;n!==null&&(e.alternate=null,sC(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[Br],delete n[Cc],delete n[Dy],delete n[U6],delete n[K6])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function iC(e){return e.tag===5||e.tag===3||e.tag===4}function fS(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||iC(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function qy(e,n,t){var r=e.tag;if(r===5||r===6)e=e.stateNode,n?t.nodeType===8?t.parentNode.insertBefore(e,n):t.insertBefore(e,n):(t.nodeType===8?(n=t.parentNode,n.insertBefore(e,t)):(n=t,n.appendChild(e)),t=t._reactRootContainer,t!=null||n.onclick!==null||(n.onclick=Lh));else if(r!==4&&(e=e.child,e!==null))for(qy(e,n,t),e=e.sibling;e!==null;)qy(e,n,t),e=e.sibling}function Qy(e,n,t){var r=e.tag;if(r===5||r===6)e=e.stateNode,n?t.insertBefore(e,n):t.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Qy(e,n,t),e=e.sibling;e!==null;)Qy(e,n,t),e=e.sibling}var Ct=null,gr=!1;function qo(e,n,t){for(t=t.child;t!==null;)aC(e,n,t),t=t.sibling}function aC(e,n,t){if(Ur&&typeof Ur.onCommitFiberUnmount=="function")try{Ur.onCommitFiberUnmount(Ff,t)}catch{}switch(t.tag){case 5:Ut||ya(t,n);case 6:var r=Ct,o=gr;Ct=null,qo(e,n,t),Ct=r,gr=o,Ct!==null&&(gr?(e=Ct,t=t.stateNode,e.nodeType===8?e.parentNode.removeChild(t):e.removeChild(t)):Ct.removeChild(t.stateNode));break;case 18:Ct!==null&&(gr?(e=Ct,t=t.stateNode,e.nodeType===8?fg(e.parentNode,t):e.nodeType===1&&fg(e,t),Sc(e)):fg(Ct,t.stateNode));break;case 4:r=Ct,o=gr,Ct=t.stateNode.containerInfo,gr=!0,qo(e,n,t),Ct=r,gr=o;break;case 0:case 11:case 14:case 15:if(!Ut&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var s=o,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&Xy(t,n,i),o=o.next}while(o!==r)}qo(e,n,t);break;case 1:if(!Ut&&(ya(t,n),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){ct(t,n,a)}qo(e,n,t);break;case 21:qo(e,n,t);break;case 22:t.mode&1?(Ut=(r=Ut)||t.memoizedState!==null,qo(e,n,t),Ut=r):qo(e,n,t);break;default:qo(e,n,t)}}function pS(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var t=e.stateNode;t===null&&(t=e.stateNode=new s4),n.forEach(function(r){var o=g4.bind(null,e,r);t.has(r)||(t.add(r),r.then(o,o))})}}function hr(e,n){var t=n.deletions;if(t!==null)for(var r=0;r<t.length;r++){var o=t[r];try{var s=e,i=n,a=i;e:for(;a!==null;){switch(a.tag){case 5:Ct=a.stateNode,gr=!1;break e;case 3:Ct=a.stateNode.containerInfo,gr=!0;break e;case 4:Ct=a.stateNode.containerInfo,gr=!0;break e}a=a.return}if(Ct===null)throw Error(X(160));aC(s,i,o),Ct=null,gr=!1;var l=o.alternate;l!==null&&(l.return=null),o.return=null}catch(c){ct(o,n,c)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)lC(n,e),n=n.sibling}function lC(e,n){var t=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(hr(n,e),Rr(e),r&4){try{ic(3,e,e.return),Gf(3,e)}catch(m){ct(e,e.return,m)}try{ic(5,e,e.return)}catch(m){ct(e,e.return,m)}}break;case 1:hr(n,e),Rr(e),r&512&&t!==null&&ya(t,t.return);break;case 5:if(hr(n,e),Rr(e),r&512&&t!==null&&ya(t,t.return),e.flags&32){var o=e.stateNode;try{yc(o,"")}catch(m){ct(e,e.return,m)}}if(r&4&&(o=e.stateNode,o!=null)){var s=e.memoizedProps,i=t!==null?t.memoizedProps:s,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&$E(o,s),Sy(a,i);var c=Sy(a,s);for(i=0;i<l.length;i+=2){var u=l[i],d=l[i+1];u==="style"?RE(o,d):u==="dangerouslySetInnerHTML"?AE(o,d):u==="children"?yc(o,d):pv(o,u,d,c)}switch(a){case"input":my(o,s);break;case"textarea":TE(o,s);break;case"select":var h=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?_a(o,!!s.multiple,f,!1):h!==!!s.multiple&&(s.defaultValue!=null?_a(o,!!s.multiple,s.defaultValue,!0):_a(o,!!s.multiple,s.multiple?[]:"",!1))}o[Cc]=s}catch(m){ct(e,e.return,m)}}break;case 6:if(hr(n,e),Rr(e),r&4){if(e.stateNode===null)throw Error(X(162));o=e.stateNode,s=e.memoizedProps;try{o.nodeValue=s}catch(m){ct(e,e.return,m)}}break;case 3:if(hr(n,e),Rr(e),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Sc(n.containerInfo)}catch(m){ct(e,e.return,m)}break;case 4:hr(n,e),Rr(e);break;case 13:hr(n,e),Rr(e),o=e.child,o.flags&8192&&(s=o.memoizedState!==null,o.stateNode.isHidden=s,!s||o.alternate!==null&&o.alternate.memoizedState!==null||(Yv=ht())),r&4&&pS(e);break;case 22:if(u=t!==null&&t.memoizedState!==null,e.mode&1?(Ut=(c=Ut)||u,hr(n,e),Ut=c):hr(n,e),Rr(e),r&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(te=e,u=e.child;u!==null;){for(d=te=u;te!==null;){switch(h=te,f=h.child,h.tag){case 0:case 11:case 14:case 15:ic(4,h,h.return);break;case 1:ya(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){r=h,t=h.return;try{n=r,p.props=n.memoizedProps,p.state=n.memoizedState,p.componentWillUnmount()}catch(m){ct(r,t,m)}}break;case 5:ya(h,h.return);break;case 22:if(h.memoizedState!==null){mS(d);continue}}f!==null?(f.return=h,te=f):mS(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{o=d.stateNode,c?(s=o.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=OE("display",i))}catch(m){ct(e,e.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){ct(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:hr(n,e),Rr(e),r&4&&pS(e);break;case 21:break;default:hr(n,e),Rr(e)}}function Rr(e){var n=e.flags;if(n&2){try{e:{for(var t=e.return;t!==null;){if(iC(t)){var r=t;break e}t=t.return}throw Error(X(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(yc(o,""),r.flags&=-33);var s=fS(e);Qy(e,s,o);break;case 3:case 4:var i=r.stateNode.containerInfo,a=fS(e);qy(e,a,i);break;default:throw Error(X(161))}}catch(l){ct(e,e.return,l)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function a4(e,n,t){te=e,cC(e)}function cC(e,n,t){for(var r=(e.mode&1)!==0;te!==null;){var o=te,s=o.child;if(o.tag===22&&r){var i=o.memoizedState!==null||od;if(!i){var a=o.alternate,l=a!==null&&a.memoizedState!==null||Ut;a=od;var c=Ut;if(od=i,(Ut=l)&&!c)for(te=o;te!==null;)i=te,l=i.child,i.tag===22&&i.memoizedState!==null?yS(o):l!==null?(l.return=i,te=l):yS(o);for(;s!==null;)te=s,cC(s),s=s.sibling;te=o,od=a,Ut=c}gS(e)}else o.subtreeFlags&8772&&s!==null?(s.return=o,te=s):gS(e)}}function gS(e){for(;te!==null;){var n=te;if(n.flags&8772){var t=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:Ut||Gf(5,n);break;case 1:var r=n.stateNode;if(n.flags&4&&!Ut)if(t===null)r.componentDidMount();else{var o=n.elementType===n.type?t.memoizedProps:pr(n.type,t.memoizedProps);r.componentDidUpdate(o,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=n.updateQueue;s!==null&&Zx(n,s,r);break;case 3:var i=n.updateQueue;if(i!==null){if(t=null,n.child!==null)switch(n.child.tag){case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}Zx(n,i,t)}break;case 5:var a=n.stateNode;if(t===null&&n.flags&4){t=a;var l=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var c=n.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Sc(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(X(163))}Ut||n.flags&512&&Gy(n)}catch(h){ct(n,n.return,h)}}if(n===e){te=null;break}if(t=n.sibling,t!==null){t.return=n.return,te=t;break}te=n.return}}function mS(e){for(;te!==null;){var n=te;if(n===e){te=null;break}var t=n.sibling;if(t!==null){t.return=n.return,te=t;break}te=n.return}}function yS(e){for(;te!==null;){var n=te;try{switch(n.tag){case 0:case 11:case 15:var t=n.return;try{Gf(4,n)}catch(l){ct(n,t,l)}break;case 1:var r=n.stateNode;if(typeof r.componentDidMount=="function"){var o=n.return;try{r.componentDidMount()}catch(l){ct(n,o,l)}}var s=n.return;try{Gy(n)}catch(l){ct(n,s,l)}break;case 5:var i=n.return;try{Gy(n)}catch(l){ct(n,i,l)}}}catch(l){ct(n,n.return,l)}if(n===e){te=null;break}var a=n.sibling;if(a!==null){a.return=n.return,te=a;break}te=n.return}}var l4=Math.ceil,Yh=Ro.ReactCurrentDispatcher,Vv=Ro.ReactCurrentOwner,tr=Ro.ReactCurrentBatchConfig,xe=0,bt=null,ft=null,Ot=0,In=0,va=Ls(0),yt=0,Ac=null,bi=0,qf=0,Wv=0,ac=null,dn=null,Yv=0,Ka=1/0,ho=null,Xh=!1,Zy=null,ys=null,sd=!1,as=null,Gh=0,lc=0,Jy=null,Zd=-1,Jd=0;function nn(){return xe&6?ht():Zd!==-1?Zd:Zd=ht()}function vs(e){return e.mode&1?xe&2&&Ot!==0?Ot&-Ot:V6.transition!==null?(Jd===0&&(Jd=WE()),Jd):(e=Ie,e!==0||(e=window.event,e=e===void 0?16:JE(e.type)),e):1}function Cr(e,n,t,r){if(50<lc)throw lc=0,Jy=null,Error(X(185));lu(e,t,r),(!(xe&2)||e!==bt)&&(e===bt&&(!(xe&2)&&(qf|=t),yt===4&&os(e,Ot)),mn(e,r),t===1&&xe===0&&!(n.mode&1)&&(Ka=ht()+500,Wf&&js()))}function mn(e,n){var t=e.callbackNode;V5(e,n);var r=Ah(e,e===bt?Ot:0);if(r===0)t!==null&&Cx(t),e.callbackNode=null,e.callbackPriority=0;else if(n=r&-r,e.callbackPriority!==n){if(t!=null&&Cx(t),n===1)e.tag===0?H6(vS.bind(null,e)):v_(vS.bind(null,e)),B6(function(){!(xe&6)&&js()}),t=null;else{switch(YE(r)){case 1:t=wv;break;case 4:t=HE;break;case 16:t=Mh;break;case 536870912:t=VE;break;default:t=Mh}t=yC(t,uC.bind(null,e))}e.callbackPriority=n,e.callbackNode=t}}function uC(e,n){if(Zd=-1,Jd=0,xe&6)throw Error(X(327));var t=e.callbackNode;if(Ta()&&e.callbackNode!==t)return null;var r=Ah(e,e===bt?Ot:0);if(r===0)return null;if(r&30||r&e.expiredLanes||n)n=qh(e,r);else{n=r;var o=xe;xe|=2;var s=hC();(bt!==e||Ot!==n)&&(ho=null,Ka=ht()+500,hi(e,n));do try{d4();break}catch(a){dC(e,a)}while(1);Av(),Yh.current=s,xe=o,ft!==null?n=0:(bt=null,Ot=0,n=yt)}if(n!==0){if(n===2&&(o=Cy(e),o!==0&&(r=o,n=e0(e,o))),n===1)throw t=Ac,hi(e,0),os(e,r),mn(e,ht()),t;if(n===6)os(e,r);else{if(o=e.current.alternate,!(r&30)&&!c4(o)&&(n=qh(e,r),n===2&&(s=Cy(e),s!==0&&(r=s,n=e0(e,s))),n===1))throw t=Ac,hi(e,0),os(e,r),mn(e,ht()),t;switch(e.finishedWork=o,e.finishedLanes=r,n){case 0:case 1:throw Error(X(345));case 2:ti(e,dn,ho);break;case 3:if(os(e,r),(r&130023424)===r&&(n=Yv+500-ht(),10<n)){if(Ah(e,0)!==0)break;if(o=e.suspendedLanes,(o&r)!==r){nn(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Ry(ti.bind(null,e,dn,ho),n);break}ti(e,dn,ho);break;case 4:if(os(e,r),(r&4194240)===r)break;for(n=e.eventTimes,o=-1;0<r;){var i=31-_r(r);s=1<<i,i=n[i],i>o&&(o=i),r&=~s}if(r=o,r=ht()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*l4(r/1960))-r,10<r){e.timeoutHandle=Ry(ti.bind(null,e,dn,ho),r);break}ti(e,dn,ho);break;case 5:ti(e,dn,ho);break;default:throw Error(X(329))}}}return mn(e,ht()),e.callbackNode===t?uC.bind(null,e):null}function e0(e,n){var t=ac;return e.current.memoizedState.isDehydrated&&(hi(e,n).flags|=256),e=qh(e,n),e!==2&&(n=dn,dn=t,n!==null&&t0(n)),e}function t0(e){dn===null?dn=e:dn.push.apply(dn,e)}function c4(e){for(var n=e;;){if(n.flags&16384){var t=n.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var o=t[r],s=o.getSnapshot;o=o.value;try{if(!Tr(s(),o))return!1}catch{return!1}}}if(t=n.child,n.subtreeFlags&16384&&t!==null)t.return=n,n=t;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function os(e,n){for(n&=~Wv,n&=~qf,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var t=31-_r(n),r=1<<t;e[t]=-1,n&=~r}}function vS(e){if(xe&6)throw Error(X(327));Ta();var n=Ah(e,0);if(!(n&1))return mn(e,ht()),null;var t=qh(e,n);if(e.tag!==0&&t===2){var r=Cy(e);r!==0&&(n=r,t=e0(e,r))}if(t===1)throw t=Ac,hi(e,0),os(e,n),mn(e,ht()),t;if(t===6)throw Error(X(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,ti(e,dn,ho),mn(e,ht()),null}function Xv(e,n){var t=xe;xe|=1;try{return e(n)}finally{xe=t,xe===0&&(Ka=ht()+500,Wf&&js())}}function Pi(e){as!==null&&as.tag===0&&!(xe&6)&&Ta();var n=xe;xe|=1;var t=tr.transition,r=Ie;try{if(tr.transition=null,Ie=1,e)return e()}finally{Ie=r,tr.transition=t,xe=n,!(xe&6)&&js()}}function Gv(){In=va.current,Ke(va)}function hi(e,n){e.finishedWork=null,e.finishedLanes=0;var t=e.timeoutHandle;if(t!==-1&&(e.timeoutHandle=-1,z6(t)),ft!==null)for(t=ft.return;t!==null;){var r=t;switch($v(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&jh();break;case 3:Fa(),Ke(pn),Ke(Ht),Nv();break;case 5:jv(r);break;case 4:Fa();break;case 13:Ke(tt);break;case 19:Ke(tt);break;case 10:Ov(r.type._context);break;case 22:case 23:Gv()}t=t.return}if(bt=e,ft=e=ws(e.current,null),Ot=In=n,yt=0,Ac=null,Wv=qf=bi=0,dn=ac=null,ii!==null){for(n=0;n<ii.length;n++)if(t=ii[n],r=t.interleaved,r!==null){t.interleaved=null;var o=r.next,s=t.pending;if(s!==null){var i=s.next;s.next=o,r.next=i}t.pending=r}ii=null}return e}function dC(e,n){do{var t=ft;try{if(Av(),Gd.current=Wh,Vh){for(var r=ot.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Vh=!1}if(Si=0,xt=gt=ot=null,sc=!1,$c=0,Vv.current=null,t===null||t.return===null){yt=1,Ac=n,ft=null;break}e:{var s=e,i=t.return,a=t,l=n;if(n=Ot,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=sS(i);if(f!==null){f.flags&=-257,iS(f,i,a,s,n),f.mode&1&&oS(s,c,n),n=f,l=c;var p=n.updateQueue;if(p===null){var m=new Set;m.add(l),n.updateQueue=m}else p.add(l);break e}else{if(!(n&1)){oS(s,c,n),qv();break e}l=Error(X(426))}}else if(Xe&&a.mode&1){var y=sS(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),iS(y,i,a,s,n),Tv(Ua(l,a));break e}}s=l=Ua(l,a),yt!==4&&(yt=2),ac===null?ac=[s]:ac.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,n&=-n,s.lanes|=n;var x=X_(s,l,n);Qx(s,x);break e;case 1:a=l;var S=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof S.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(ys===null||!ys.has(b)))){s.flags|=65536,n&=-n,s.lanes|=n;var P=G_(s,a,n);Qx(s,P);break e}}s=s.return}while(s!==null)}pC(t)}catch(C){n=C,ft===t&&t!==null&&(ft=t=t.return);continue}break}while(1)}function hC(){var e=Yh.current;return Yh.current=Wh,e===null?Wh:e}function qv(){(yt===0||yt===3||yt===2)&&(yt=4),bt===null||!(bi&268435455)&&!(qf&268435455)||os(bt,Ot)}function qh(e,n){var t=xe;xe|=2;var r=hC();(bt!==e||Ot!==n)&&(ho=null,hi(e,n));do try{u4();break}catch(o){dC(e,o)}while(1);if(Av(),xe=t,Yh.current=r,ft!==null)throw Error(X(261));return bt=null,Ot=0,yt}function u4(){for(;ft!==null;)fC(ft)}function d4(){for(;ft!==null&&!L5();)fC(ft)}function fC(e){var n=mC(e.alternate,e,In);e.memoizedProps=e.pendingProps,n===null?pC(e):ft=n,Vv.current=null}function pC(e){var n=e;do{var t=n.alternate;if(e=n.return,n.flags&32768){if(t=o4(t,n),t!==null){t.flags&=32767,ft=t;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{yt=6,ft=null;return}}else if(t=r4(t,n,In),t!==null){ft=t;return}if(n=n.sibling,n!==null){ft=n;return}ft=n=e}while(n!==null);yt===0&&(yt=5)}function ti(e,n,t){var r=Ie,o=tr.transition;try{tr.transition=null,Ie=1,h4(e,n,t,r)}finally{tr.transition=o,Ie=r}return null}function h4(e,n,t,r){do Ta();while(as!==null);if(xe&6)throw Error(X(327));t=e.finishedWork;var o=e.finishedLanes;if(t===null)return null;if(e.finishedWork=null,e.finishedLanes=0,t===e.current)throw Error(X(177));e.callbackNode=null,e.callbackPriority=0;var s=t.lanes|t.childLanes;if(W5(e,s),e===bt&&(ft=bt=null,Ot=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||sd||(sd=!0,yC(Mh,function(){return Ta(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=tr.transition,tr.transition=null;var i=Ie;Ie=1;var a=xe;xe|=4,Vv.current=null,i4(e,t),lC(t,e),A6(Ay),Oh=!!My,Ay=My=null,e.current=t,a4(t),j5(),xe=a,Ie=i,tr.transition=s}else e.current=t;if(sd&&(sd=!1,as=e,Gh=o),s=e.pendingLanes,s===0&&(ys=null),B5(t.stateNode),mn(e,ht()),n!==null)for(r=e.onRecoverableError,t=0;t<n.length;t++)o=n[t],r(o.value,{componentStack:o.stack,digest:o.digest});if(Xh)throw Xh=!1,e=Zy,Zy=null,e;return Gh&1&&e.tag!==0&&Ta(),s=e.pendingLanes,s&1?e===Jy?lc++:(lc=0,Jy=e):lc=0,js(),null}function Ta(){if(as!==null){var e=YE(Gh),n=tr.transition,t=Ie;try{if(tr.transition=null,Ie=16>e?16:e,as===null)var r=!1;else{if(e=as,as=null,Gh=0,xe&6)throw Error(X(331));var o=xe;for(xe|=4,te=e.current;te!==null;){var s=te,i=s.child;if(te.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(te=c;te!==null;){var u=te;switch(u.tag){case 0:case 11:case 15:ic(8,u,s)}var d=u.child;if(d!==null)d.return=u,te=d;else for(;te!==null;){u=te;var h=u.sibling,f=u.return;if(sC(u),u===c){te=null;break}if(h!==null){h.return=f,te=h;break}te=f}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}te=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,te=i;else e:for(;te!==null;){if(s=te,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ic(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,te=x;break e}te=s.return}}var S=e.current;for(te=S;te!==null;){i=te;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,te=b;else e:for(i=S;te!==null;){if(a=te,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Gf(9,a)}}catch(C){ct(a,a.return,C)}if(a===i){te=null;break e}var P=a.sibling;if(P!==null){P.return=a.return,te=P;break e}te=a.return}}if(xe=o,js(),Ur&&typeof Ur.onPostCommitFiberRoot=="function")try{Ur.onPostCommitFiberRoot(Ff,e)}catch{}r=!0}return r}finally{Ie=t,tr.transition=n}}return!1}function wS(e,n,t){n=Ua(t,n),n=X_(e,n,1),e=ms(e,n,1),n=nn(),e!==null&&(lu(e,1,n),mn(e,n))}function ct(e,n,t){if(e.tag===3)wS(e,e,t);else for(;n!==null;){if(n.tag===3){wS(n,e,t);break}else if(n.tag===1){var r=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ys===null||!ys.has(r))){e=Ua(t,e),e=G_(n,e,1),n=ms(n,e,1),e=nn(),n!==null&&(lu(n,1,e),mn(n,e));break}}n=n.return}}function f4(e,n,t){var r=e.pingCache;r!==null&&r.delete(n),n=nn(),e.pingedLanes|=e.suspendedLanes&t,bt===e&&(Ot&t)===t&&(yt===4||yt===3&&(Ot&130023424)===Ot&&500>ht()-Yv?hi(e,0):Wv|=t),mn(e,n)}function gC(e,n){n===0&&(e.mode&1?(n=Gu,Gu<<=1,!(Gu&130023424)&&(Gu=4194304)):n=1);var t=nn();e=$o(e,n),e!==null&&(lu(e,n,t),mn(e,t))}function p4(e){var n=e.memoizedState,t=0;n!==null&&(t=n.retryLane),gC(e,t)}function g4(e,n){var t=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;o!==null&&(t=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(X(314))}r!==null&&r.delete(n),gC(e,t)}var mC;mC=function(e,n,t){if(e!==null)if(e.memoizedProps!==n.pendingProps||pn.current)fn=!0;else{if(!(e.lanes&t)&&!(n.flags&128))return fn=!1,n4(e,n,t);fn=!!(e.flags&131072)}else fn=!1,Xe&&n.flags&1048576&&w_(n,Bh,n.index);switch(n.lanes=0,n.tag){case 2:var r=n.type;Qd(e,n),e=n.pendingProps;var o=Na(n,Ht.current);$a(n,t),o=Bv(null,n,r,e,o,t);var s=Fv();return n.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,gn(r)?(s=!0,Nh(n)):s=!1,n.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,Dv(n),o.updater=Yf,n.stateNode=o,o._reactInternals=n,Fy(n,r,e,t),n=Hy(null,n,r,!0,s,t)):(n.tag=0,Xe&&s&&kv(n),Jt(null,n,o,t),n=n.child),n;case 16:r=n.elementType;e:{switch(Qd(e,n),e=n.pendingProps,o=r._init,r=o(r._payload),n.type=r,o=n.tag=y4(r),e=pr(r,e),o){case 0:n=Ky(null,n,r,e,t);break e;case 1:n=cS(null,n,r,e,t);break e;case 11:n=aS(null,n,r,e,t);break e;case 14:n=lS(null,n,r,pr(r.type,e),t);break e}throw Error(X(306,r,""))}return n;case 0:return r=n.type,o=n.pendingProps,o=n.elementType===r?o:pr(r,o),Ky(e,n,r,o,t);case 1:return r=n.type,o=n.pendingProps,o=n.elementType===r?o:pr(r,o),cS(e,n,r,o,t);case 3:e:{if(J_(n),e===null)throw Error(X(387));r=n.pendingProps,s=n.memoizedState,o=s.element,P_(e,n),Kh(n,r,null,t);var i=n.memoizedState;if(r=i.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},n.updateQueue.baseState=s,n.memoizedState=s,n.flags&256){o=Ua(Error(X(423)),n),n=uS(e,n,r,t,o);break e}else if(r!==o){o=Ua(Error(X(424)),n),n=uS(e,n,r,t,o);break e}else for(An=gs(n.stateNode.containerInfo.firstChild),On=n,Xe=!0,vr=null,t=I_(n,null,r,t),n.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(za(),r===o){n=To(e,n,t);break e}Jt(e,n,r,t)}n=n.child}return n;case 5:return k_(n),e===null&&Ny(n),r=n.type,o=n.pendingProps,s=e!==null?e.memoizedProps:null,i=o.children,Oy(r,o)?i=null:s!==null&&Oy(r,s)&&(n.flags|=32),Z_(e,n),Jt(e,n,i,t),n.child;case 6:return e===null&&Ny(n),null;case 13:return eC(e,n,t);case 4:return Lv(n,n.stateNode.containerInfo),r=n.pendingProps,e===null?n.child=Ba(n,null,r,t):Jt(e,n,r,t),n.child;case 11:return r=n.type,o=n.pendingProps,o=n.elementType===r?o:pr(r,o),aS(e,n,r,o,t);case 7:return Jt(e,n,n.pendingProps,t),n.child;case 8:return Jt(e,n,n.pendingProps.children,t),n.child;case 12:return Jt(e,n,n.pendingProps.children,t),n.child;case 10:e:{if(r=n.type._context,o=n.pendingProps,s=n.memoizedProps,i=o.value,Ne(Fh,r._currentValue),r._currentValue=i,s!==null)if(Tr(s.value,i)){if(s.children===o.children&&!pn.current){n=To(e,n,t);break e}}else for(s=n.child,s!==null&&(s.return=n);s!==null;){var a=s.dependencies;if(a!==null){i=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=wo(-1,t&-t),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),zy(s.return,t,n),a.lanes|=t;break}l=l.next}}else if(s.tag===10)i=s.type===n.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(X(341));i.lanes|=t,a=i.alternate,a!==null&&(a.lanes|=t),zy(i,t,n),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===n){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}Jt(e,n,o.children,t),n=n.child}return n;case 9:return o=n.type,r=n.pendingProps.children,$a(n,t),o=nr(o),r=r(o),n.flags|=1,Jt(e,n,r,t),n.child;case 14:return r=n.type,o=pr(r,n.pendingProps),o=pr(r.type,o),lS(e,n,r,o,t);case 15:return q_(e,n,n.type,n.pendingProps,t);case 17:return r=n.type,o=n.pendingProps,o=n.elementType===r?o:pr(r,o),Qd(e,n),n.tag=1,gn(r)?(e=!0,Nh(n)):e=!1,$a(n,t),__(n,r,o),Fy(n,r,o,t),Hy(null,n,r,!0,e,t);case 19:return tC(e,n,t);case 22:return Q_(e,n,t)}throw Error(X(156,n.tag))};function yC(e,n){return KE(e,n)}function m4(e,n,t,r){this.tag=e,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function er(e,n,t,r){return new m4(e,n,t,r)}function Qv(e){return e=e.prototype,!(!e||!e.isReactComponent)}function y4(e){if(typeof e=="function")return Qv(e)?1:0;if(e!=null){if(e=e.$$typeof,e===mv)return 11;if(e===yv)return 14}return 2}function ws(e,n){var t=e.alternate;return t===null?(t=er(e.tag,n,e.key,e.mode),t.elementType=e.elementType,t.type=e.type,t.stateNode=e.stateNode,t.alternate=e,e.alternate=t):(t.pendingProps=n,t.type=e.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=e.flags&14680064,t.childLanes=e.childLanes,t.lanes=e.lanes,t.child=e.child,t.memoizedProps=e.memoizedProps,t.memoizedState=e.memoizedState,t.updateQueue=e.updateQueue,n=e.dependencies,t.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},t.sibling=e.sibling,t.index=e.index,t.ref=e.ref,t}function eh(e,n,t,r,o,s){var i=2;if(r=e,typeof e=="function")Qv(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case la:return fi(t.children,o,s,n);case gv:i=8,o|=8;break;case dy:return e=er(12,t,n,o|2),e.elementType=dy,e.lanes=s,e;case hy:return e=er(13,t,n,o),e.elementType=hy,e.lanes=s,e;case fy:return e=er(19,t,n,o),e.elementType=fy,e.lanes=s,e;case CE:return Qf(t,o,s,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case EE:i=10;break e;case _E:i=9;break e;case mv:i=11;break e;case yv:i=14;break e;case es:i=16,r=null;break e}throw Error(X(130,e==null?e:typeof e,""))}return n=er(i,t,n,o),n.elementType=e,n.type=r,n.lanes=s,n}function fi(e,n,t,r){return e=er(7,e,r,n),e.lanes=t,e}function Qf(e,n,t,r){return e=er(22,e,r,n),e.elementType=CE,e.lanes=t,e.stateNode={isHidden:!1},e}function Sg(e,n,t){return e=er(6,e,null,n),e.lanes=t,e}function bg(e,n,t){return n=er(4,e.children!==null?e.children:[],e.key,n),n.lanes=t,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function v4(e,n,t,r,o){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ng(0),this.expirationTimes=ng(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ng(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Zv(e,n,t,r,o,s,i,a,l){return e=new v4(e,n,t,a,l),n===1?(n=1,s===!0&&(n|=8)):n=0,s=er(3,null,null,n),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dv(s),e}function w4(e,n,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:aa,key:r==null?null:""+r,children:e,containerInfo:n,implementation:t}}function vC(e){if(!e)return _s;e=e._reactInternals;e:{if(Mi(e)!==e||e.tag!==1)throw Error(X(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(gn(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(X(171))}if(e.tag===1){var t=e.type;if(gn(t))return y_(e,t,n)}return n}function wC(e,n,t,r,o,s,i,a,l){return e=Zv(t,r,!0,e,o,s,i,a,l),e.context=vC(null),t=e.current,r=nn(),o=vs(t),s=wo(r,o),s.callback=n??null,ms(t,s,o),e.current.lanes=o,lu(e,o,r),mn(e,r),e}function Zf(e,n,t,r){var o=n.current,s=nn(),i=vs(o);return t=vC(t),n.context===null?n.context=t:n.pendingContext=t,n=wo(s,i),n.payload={element:e},r=r===void 0?null:r,r!==null&&(n.callback=r),e=ms(o,n,i),e!==null&&(Cr(e,o,i,s),Xd(e,o,i)),i}function Qh(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function xS(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var t=e.retryLane;e.retryLane=t!==0&&t<n?t:n}}function Jv(e,n){xS(e,n),(e=e.alternate)&&xS(e,n)}function x4(){return null}var xC=typeof reportError=="function"?reportError:function(e){console.error(e)};function e1(e){this._internalRoot=e}Jf.prototype.render=e1.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(X(409));Zf(e,n,null,null)};Jf.prototype.unmount=e1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;Pi(function(){Zf(null,e,null,null)}),n[ko]=null}};function Jf(e){this._internalRoot=e}Jf.prototype.unstable_scheduleHydration=function(e){if(e){var n=qE();e={blockedOn:null,target:e,priority:n};for(var t=0;t<rs.length&&n!==0&&n<rs[t].priority;t++);rs.splice(t,0,e),t===0&&ZE(e)}};function t1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ep(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function SS(){}function S4(e,n,t,r,o){if(o){if(typeof r=="function"){var s=r;r=function(){var c=Qh(i);s.call(c)}}var i=wC(n,r,e,0,null,!1,!1,"",SS);return e._reactRootContainer=i,e[ko]=i.current,Ec(e.nodeType===8?e.parentNode:e),Pi(),i}for(;o=e.lastChild;)e.removeChild(o);if(typeof r=="function"){var a=r;r=function(){var c=Qh(l);a.call(c)}}var l=Zv(e,0,!1,null,null,!1,!1,"",SS);return e._reactRootContainer=l,e[ko]=l.current,Ec(e.nodeType===8?e.parentNode:e),Pi(function(){Zf(n,l,t,r)}),l}function tp(e,n,t,r,o){var s=t._reactRootContainer;if(s){var i=s;if(typeof o=="function"){var a=o;o=function(){var l=Qh(i);a.call(l)}}Zf(n,i,e,o)}else i=S4(t,n,e,o,r);return Qh(i)}XE=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var t=Yl(n.pendingLanes);t!==0&&(xv(n,t|1),mn(n,ht()),!(xe&6)&&(Ka=ht()+500,js()))}break;case 13:Pi(function(){var r=$o(e,1);if(r!==null){var o=nn();Cr(r,e,1,o)}}),Jv(e,1)}};Sv=function(e){if(e.tag===13){var n=$o(e,134217728);if(n!==null){var t=nn();Cr(n,e,134217728,t)}Jv(e,134217728)}};GE=function(e){if(e.tag===13){var n=vs(e),t=$o(e,n);if(t!==null){var r=nn();Cr(t,e,n,r)}Jv(e,n)}};qE=function(){return Ie};QE=function(e,n){var t=Ie;try{return Ie=e,n()}finally{Ie=t}};Py=function(e,n,t){switch(n){case"input":if(my(e,t),n=t.name,t.type==="radio"&&n!=null){for(t=e;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<t.length;n++){var r=t[n];if(r!==e&&r.form===e.form){var o=Vf(r);if(!o)throw Error(X(90));kE(r),my(r,o)}}}break;case"textarea":TE(e,t);break;case"select":n=t.value,n!=null&&_a(e,!!t.multiple,n,!1)}};jE=Xv;NE=Pi;var b4={usingClientEntryPoint:!1,Events:[uu,ha,Vf,DE,LE,Xv]},Cl={findFiberByHostInstance:si,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},P4={bundleType:Cl.bundleType,version:Cl.version,rendererPackageName:Cl.rendererPackageName,rendererConfig:Cl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ro.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=FE(e),e===null?null:e.stateNode},findFiberByHostInstance:Cl.findFiberByHostInstance||x4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var id=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!id.isDisabled&&id.supportsFiber)try{Ff=id.inject(P4),Ur=id}catch{}}jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=b4;jn.createPortal=function(e,n){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!t1(n))throw Error(X(200));return w4(e,n,null,t)};jn.createRoot=function(e,n){if(!t1(e))throw Error(X(299));var t=!1,r="",o=xC;return n!=null&&(n.unstable_strictMode===!0&&(t=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),n=Zv(e,1,!1,null,null,t,!1,r,o),e[ko]=n.current,Ec(e.nodeType===8?e.parentNode:e),new e1(n)};jn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(X(188)):(e=Object.keys(e).join(","),Error(X(268,e)));return e=FE(n),e=e===null?null:e.stateNode,e};jn.flushSync=function(e){return Pi(e)};jn.hydrate=function(e,n,t){if(!ep(n))throw Error(X(200));return tp(null,e,n,!0,t)};jn.hydrateRoot=function(e,n,t){if(!t1(e))throw Error(X(405));var r=t!=null&&t.hydratedSources||null,o=!1,s="",i=xC;if(t!=null&&(t.unstable_strictMode===!0&&(o=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),n=wC(n,null,e,1,t??null,o,!1,s,i),e[ko]=n.current,Ec(e),r)for(e=0;e<r.length;e++)t=r[e],o=t._getVersion,o=o(t._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[t,o]:n.mutableSourceEagerHydrationData.push(t,o);return new Jf(n)};jn.render=function(e,n,t){if(!ep(n))throw Error(X(200));return tp(null,e,n,!1,t)};jn.unmountComponentAtNode=function(e){if(!ep(e))throw Error(X(40));return e._reactRootContainer?(Pi(function(){tp(null,null,e,!1,function(){e._reactRootContainer=null,e[ko]=null})}),!0):!1};jn.unstable_batchedUpdates=Xv;jn.unstable_renderSubtreeIntoContainer=function(e,n,t,r){if(!ep(t))throw Error(X(200));if(e==null||e._reactInternals===void 0)throw Error(X(38));return tp(e,n,t,!1,r)};jn.version="18.2.0-next-9e3b772b8-20220608";function SC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(SC)}catch(e){console.error(e)}}SC(),wE.exports=jn;var Do=wE.exports;const bC=Qa(Do);var bS=Do;cy.createRoot=bS.createRoot,cy.hydrateRoot=bS.hydrateRoot;var ad=function(e){return e&&e.Math===Math&&e},bn=ad(typeof globalThis=="object"&&globalThis)||ad(typeof window=="object"&&window)||ad(typeof self=="object"&&self)||ad(typeof tn=="object"&&tn)||function(){return this}()||tn||Function("return this")(),n1={},an=function(e){try{return!!e()}catch{return!0}},E4=an,Ns=!E4(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),_4=an,np=!_4(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),C4=np,ld=Function.prototype.call,zs=C4?ld.bind(ld):function(){return ld.apply(ld,arguments)},PC={},EC={}.propertyIsEnumerable,_C=Object.getOwnPropertyDescriptor,I4=_C&&!EC.call({1:2},1);PC.f=I4?function(n){var t=_C(this,n);return!!t&&t.enumerable}:EC;var CC=function(e,n){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:n}},IC=np,kC=Function.prototype,n0=kC.call,k4=IC&&kC.bind.bind(n0,n0),Pt=IC?k4:function(e){return function(){return n0.apply(e,arguments)}},$C=Pt,$4=$C({}.toString),T4=$C("".slice),tl=function(e){return T4($4(e),8,-1)},M4=Pt,A4=an,O4=tl,Pg=Object,R4=M4("".split),D4=A4(function(){return!Pg("z").propertyIsEnumerable(0)})?function(e){return O4(e)==="String"?R4(e,""):Pg(e)}:Pg,rp=function(e){return e==null},L4=rp,j4=TypeError,nl=function(e){if(L4(e))throw j4("Can't call method on "+e);return e},N4=D4,z4=nl,op=function(e){return N4(z4(e))},r0=typeof document=="object"&&document.all,B4=typeof r0>"u"&&r0!==void 0,TC={all:r0,IS_HTMLDDA:B4},MC=TC,F4=MC.all,ln=MC.IS_HTMLDDA?function(e){return typeof e=="function"||e===F4}:function(e){return typeof e=="function"},PS=ln,AC=TC,U4=AC.all,Ai=AC.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:PS(e)||e===U4}:function(e){return typeof e=="object"?e!==null:PS(e)},Eg=bn,K4=ln,H4=function(e){return K4(e)?e:void 0},sp=function(e,n){return arguments.length<2?H4(Eg[e]):Eg[e]&&Eg[e][n]},V4=Pt,OC=V4({}.isPrototypeOf),W4=typeof navigator<"u"&&String(navigator.userAgent)||"",RC=bn,_g=W4,ES=RC.process,_S=RC.Deno,CS=ES&&ES.versions||_S&&_S.version,IS=CS&&CS.v8,wr,Zh;IS&&(wr=IS.split("."),Zh=wr[0]>0&&wr[0]<4?1:+(wr[0]+wr[1]));!Zh&&_g&&(wr=_g.match(/Edge\/(\d+)/),(!wr||wr[1]>=74)&&(wr=_g.match(/Chrome\/(\d+)/),wr&&(Zh=+wr[1])));var Y4=Zh,kS=Y4,X4=an,G4=bn,q4=G4.String,DC=!!Object.getOwnPropertySymbols&&!X4(function(){var e=Symbol("symbol detection");return!q4(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&kS&&kS<41}),Q4=DC,LC=Q4&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Z4=sp,J4=ln,eO=OC,tO=LC,nO=Object,jC=tO?function(e){return typeof e=="symbol"}:function(e){var n=Z4("Symbol");return J4(n)&&eO(n.prototype,nO(e))},rO=String,oO=function(e){try{return rO(e)}catch{return"Object"}},sO=ln,iO=oO,aO=TypeError,r1=function(e){if(sO(e))return e;throw aO(iO(e)+" is not a function")},lO=r1,cO=rp,o1=function(e,n){var t=e[n];return cO(t)?void 0:lO(t)},Cg=zs,Ig=ln,kg=Ai,uO=TypeError,dO=function(e,n){var t,r;if(n==="string"&&Ig(t=e.toString)&&!kg(r=Cg(t,e))||Ig(t=e.valueOf)&&!kg(r=Cg(t,e))||n!=="string"&&Ig(t=e.toString)&&!kg(r=Cg(t,e)))return r;throw uO("Can't convert object to primitive value")},NC={exports:{}},$S=bn,hO=Object.defineProperty,s1=function(e,n){try{hO($S,e,{value:n,configurable:!0,writable:!0})}catch{$S[e]=n}return n},fO=bn,pO=s1,TS="__core-js_shared__",gO=fO[TS]||pO(TS,{}),i1=gO,MS=i1;(NC.exports=function(e,n){return MS[e]||(MS[e]=n!==void 0?n:{})})("versions",[]).push({version:"3.32.1",mode:"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.1/LICENSE",source:"https://github.com/zloirock/core-js"});var a1=NC.exports,mO=nl,yO=Object,hu=function(e){return yO(mO(e))},vO=Pt,wO=hu,xO=vO({}.hasOwnProperty),Bs=Object.hasOwn||function(n,t){return xO(wO(n),t)},SO=Pt,bO=0,PO=Math.random(),EO=SO(1 .toString),zC=function(e){return"Symbol("+(e===void 0?"":e)+")_"+EO(++bO+PO,36)},_O=bn,CO=a1,AS=Bs,IO=zC,kO=DC,$O=LC,wa=_O.Symbol,$g=CO("wks"),TO=$O?wa.for||wa:wa&&wa.withoutSetter||IO,Lo=function(e){return AS($g,e)||($g[e]=kO&&AS(wa,e)?wa[e]:TO("Symbol."+e)),$g[e]},MO=zs,OS=Ai,RS=jC,AO=o1,OO=dO,RO=Lo,DO=TypeError,LO=RO("toPrimitive"),jO=function(e,n){if(!OS(e)||RS(e))return e;var t=AO(e,LO),r;if(t){if(n===void 0&&(n="default"),r=MO(t,e,n),!OS(r)||RS(r))return r;throw DO("Can't convert object to primitive value")}return n===void 0&&(n="number"),OO(e,n)},NO=jO,zO=jC,BC=function(e){var n=NO(e,"string");return zO(n)?n:n+""},BO=bn,DS=Ai,o0=BO.document,FO=DS(o0)&&DS(o0.createElement),FC=function(e){return FO?o0.createElement(e):{}},UO=Ns,KO=an,HO=FC,UC=!UO&&!KO(function(){return Object.defineProperty(HO("div"),"a",{get:function(){return 7}}).a!==7}),VO=Ns,WO=zs,YO=PC,XO=CC,GO=op,qO=BC,QO=Bs,ZO=UC,LS=Object.getOwnPropertyDescriptor;n1.f=VO?LS:function(n,t){if(n=GO(n),t=qO(t),ZO)try{return LS(n,t)}catch{}if(QO(n,t))return XO(!WO(YO.f,n,t),n[t])};var rl={},JO=Ns,eR=an,KC=JO&&eR(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),tR=Ai,nR=String,rR=TypeError,Oi=function(e){if(tR(e))return e;throw rR(nR(e)+" is not an object")},oR=Ns,sR=UC,iR=KC,cd=Oi,jS=BC,aR=TypeError,Tg=Object.defineProperty,lR=Object.getOwnPropertyDescriptor,Mg="enumerable",Ag="configurable",Og="writable";rl.f=oR?iR?function(n,t,r){if(cd(n),t=jS(t),cd(r),typeof n=="function"&&t==="prototype"&&"value"in r&&Og in r&&!r[Og]){var o=lR(n,t);o&&o[Og]&&(n[t]=r.value,r={configurable:Ag in r?r[Ag]:o[Ag],enumerable:Mg in r?r[Mg]:o[Mg],writable:!1})}return Tg(n,t,r)}:Tg:function(n,t,r){if(cd(n),t=jS(t),cd(r),sR)try{return Tg(n,t,r)}catch{}if("get"in r||"set"in r)throw aR("Accessors not supported");return"value"in r&&(n[t]=r.value),n};var cR=Ns,uR=rl,dR=CC,l1=cR?function(e,n,t){return uR.f(e,n,dR(1,t))}:function(e,n,t){return e[n]=t,e},HC={exports:{}},s0=Ns,hR=Bs,VC=Function.prototype,fR=s0&&Object.getOwnPropertyDescriptor,c1=hR(VC,"name"),pR=c1&&(function(){}).name==="something",gR=c1&&(!s0||s0&&fR(VC,"name").configurable),mR={EXISTS:c1,PROPER:pR,CONFIGURABLE:gR},yR=Pt,vR=ln,i0=i1,wR=yR(Function.toString);vR(i0.inspectSource)||(i0.inspectSource=function(e){return wR(e)});var WC=i0.inspectSource,xR=bn,SR=ln,NS=xR.WeakMap,bR=SR(NS)&&/native code/.test(String(NS)),PR=a1,ER=zC,zS=PR("keys"),YC=function(e){return zS[e]||(zS[e]=ER(e))},u1={},_R=bR,XC=bn,CR=Ai,IR=l1,Rg=Bs,Dg=i1,kR=YC,$R=u1,BS="Object already initialized",a0=XC.TypeError,TR=XC.WeakMap,Jh,Oc,ef,MR=function(e){return ef(e)?Oc(e):Jh(e,{})},AR=function(e){return function(n){var t;if(!CR(n)||(t=Oc(n)).type!==e)throw a0("Incompatible receiver, "+e+" required");return t}};if(_R||Dg.state){var Dr=Dg.state||(Dg.state=new TR);Dr.get=Dr.get,Dr.has=Dr.has,Dr.set=Dr.set,Jh=function(e,n){if(Dr.has(e))throw a0(BS);return n.facade=e,Dr.set(e,n),n},Oc=function(e){return Dr.get(e)||{}},ef=function(e){return Dr.has(e)}}else{var Vi=kR("state");$R[Vi]=!0,Jh=function(e,n){if(Rg(e,Vi))throw a0(BS);return n.facade=e,IR(e,Vi,n),n},Oc=function(e){return Rg(e,Vi)?e[Vi]:{}},ef=function(e){return Rg(e,Vi)}}var GC={set:Jh,get:Oc,has:ef,enforce:MR,getterFor:AR},d1=Pt,OR=an,RR=ln,ud=Bs,l0=Ns,DR=mR.CONFIGURABLE,LR=WC,qC=GC,jR=qC.enforce,NR=qC.get,FS=String,th=Object.defineProperty,zR=d1("".slice),BR=d1("".replace),FR=d1([].join),UR=l0&&!OR(function(){return th(function(){},"length",{value:8}).length!==8}),KR=String(String).split("String"),HR=HC.exports=function(e,n,t){zR(FS(n),0,7)==="Symbol("&&(n="["+BR(FS(n),/^Symbol\(([^)]*)\)/,"$1")+"]"),t&&t.getter&&(n="get "+n),t&&t.setter&&(n="set "+n),(!ud(e,"name")||DR&&e.name!==n)&&(l0?th(e,"name",{value:n,configurable:!0}):e.name=n),UR&&t&&ud(t,"arity")&&e.length!==t.arity&&th(e,"length",{value:t.arity});try{t&&ud(t,"constructor")&&t.constructor?l0&&th(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var r=jR(e);return ud(r,"source")||(r.source=FR(KR,typeof n=="string"?n:"")),e};Function.prototype.toString=HR(function(){return RR(this)&&NR(this).source||LR(this)},"toString");var VR=HC.exports,WR=ln,YR=rl,XR=VR,GR=s1,QC=function(e,n,t,r){r||(r={});var o=r.enumerable,s=r.name!==void 0?r.name:n;if(WR(t)&&XR(t,s,r),r.global)o?e[n]=t:GR(n,t);else{try{r.unsafe?e[n]&&(o=!0):delete e[n]}catch{}o?e[n]=t:YR.f(e,n,{value:t,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return e},ZC={},qR=Math.ceil,QR=Math.floor,ZR=Math.trunc||function(n){var t=+n;return(t>0?QR:qR)(t)},JR=ZR,Ri=function(e){var n=+e;return n!==n||n===0?0:JR(n)},e8=Ri,t8=Math.max,n8=Math.min,r8=function(e,n){var t=e8(e);return t<0?t8(t+n,0):n8(t,n)},o8=Ri,s8=Math.min,JC=function(e){return e>0?s8(o8(e),9007199254740991):0},i8=JC,fu=function(e){return i8(e.length)},a8=op,l8=r8,c8=fu,US=function(e){return function(n,t,r){var o=a8(n),s=c8(o),i=l8(r,s),a;if(e&&t!==t){for(;s>i;)if(a=o[i++],a!==a)return!0}else for(;s>i;i++)if((e||i in o)&&o[i]===t)return e||i||0;return!e&&-1}},u8={includes:US(!0),indexOf:US(!1)},d8=Pt,Lg=Bs,h8=op,f8=u8.indexOf,p8=u1,KS=d8([].push),eI=function(e,n){var t=h8(e),r=0,o=[],s;for(s in t)!Lg(p8,s)&&Lg(t,s)&&KS(o,s);for(;n.length>r;)Lg(t,s=n[r++])&&(~f8(o,s)||KS(o,s));return o},h1=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],g8=eI,m8=h1,y8=m8.concat("length","prototype");ZC.f=Object.getOwnPropertyNames||function(n){return g8(n,y8)};var tI={};tI.f=Object.getOwnPropertySymbols;var v8=sp,w8=Pt,x8=ZC,S8=tI,b8=Oi,P8=w8([].concat),E8=v8("Reflect","ownKeys")||function(n){var t=x8.f(b8(n)),r=S8.f;return r?P8(t,r(n)):t},HS=Bs,_8=E8,C8=n1,I8=rl,k8=function(e,n,t){for(var r=_8(n),o=I8.f,s=C8.f,i=0;i<r.length;i++){var a=r[i];!HS(e,a)&&!(t&&HS(t,a))&&o(e,a,s(n,a))}},$8=an,T8=ln,M8=/#|\.prototype\./,pu=function(e,n){var t=O8[A8(e)];return t===D8?!0:t===R8?!1:T8(n)?$8(n):!!n},A8=pu.normalize=function(e){return String(e).replace(M8,".").toLowerCase()},O8=pu.data={},R8=pu.NATIVE="N",D8=pu.POLYFILL="P",L8=pu,jg=bn,j8=n1.f,N8=l1,z8=QC,B8=s1,F8=k8,U8=L8,ol=function(e,n){var t=e.target,r=e.global,o=e.stat,s,i,a,l,c,u;if(r?i=jg:o?i=jg[t]||B8(t,{}):i=(jg[t]||{}).prototype,i)for(a in n){if(c=n[a],e.dontCallGetSet?(u=j8(i,a),l=u&&u.value):l=i[a],s=U8(r?a:t+(o?".":"#")+a,e.forced),!s&&l!==void 0){if(typeof c==typeof l)continue;F8(c,l)}(e.sham||l&&l.sham)&&N8(c,"sham",!0),z8(i,a,c,e)}},nI={},K8=eI,H8=h1,V8=Object.keys||function(n){return K8(n,H8)},W8=Ns,Y8=KC,X8=rl,G8=Oi,q8=op,Q8=V8;nI.f=W8&&!Y8?Object.defineProperties:function(n,t){G8(n);for(var r=q8(t),o=Q8(t),s=o.length,i=0,a;s>i;)X8.f(n,a=o[i++],r[a]);return n};var Z8=sp,J8=Z8("document","documentElement"),eD=Oi,tD=nI,VS=h1,nD=u1,rD=J8,oD=FC,sD=YC,WS=">",YS="<",c0="prototype",u0="script",rI=sD("IE_PROTO"),Ng=function(){},oI=function(e){return YS+u0+WS+e+YS+"/"+u0+WS},XS=function(e){e.write(oI("")),e.close();var n=e.parentWindow.Object;return e=null,n},iD=function(){var e=oD("iframe"),n="java"+u0+":",t;return e.style.display="none",rD.appendChild(e),e.src=String(n),t=e.contentWindow.document,t.open(),t.write(oI("document.F=Object")),t.close(),t.F},dd,nh=function(){try{dd=new ActiveXObject("htmlfile")}catch{}nh=typeof document<"u"?document.domain&&dd?XS(dd):iD():XS(dd);for(var e=VS.length;e--;)delete nh[c0][VS[e]];return nh()};nD[rI]=!0;var sI=Object.create||function(n,t){var r;return n!==null?(Ng[c0]=eD(n),r=new Ng,Ng[c0]=null,r[rI]=n):r=nh(),t===void 0?r:tD.f(r,t)},aD=Lo,lD=sI,cD=rl.f,d0=aD("unscopables"),h0=Array.prototype;h0[d0]===void 0&&cD(h0,d0,{configurable:!0,value:lD(null)});var f1=function(e){h0[d0][e]=!0},uD=ol,dD=hu,hD=fu,fD=Ri,pD=f1;uD({target:"Array",proto:!0},{at:function(n){var t=dD(this),r=hD(t),o=fD(n),s=o>=0?o:r+o;return s<0||s>=r?void 0:t[s]}});pD("at");var gD=bn,mD=Pt,gu=function(e,n){return mD(gD[e].prototype[n])},yD=gu;yD("Array","at");var vD=tl,iI=Array.isArray||function(n){return vD(n)==="Array"},wD=TypeError,xD=9007199254740991,SD=function(e){if(e>xD)throw wD("Maximum allowed index exceeded");return e},bD=tl,PD=Pt,aI=function(e){if(bD(e)==="Function")return PD(e)},GS=aI,ED=r1,_D=np,CD=GS(GS.bind),ID=function(e,n){return ED(e),n===void 0?e:_D?CD(e,n):function(){return e.apply(n,arguments)}},kD=iI,$D=fu,TD=SD,MD=ID,lI=function(e,n,t,r,o,s,i,a){for(var l=o,c=0,u=i?MD(i,a):!1,d,h;c<r;)c in t&&(d=u?u(t[c],c,n):t[c],s>0&&kD(d)?(h=$D(d),l=lI(e,n,d,h,l,s-1)-1):(TD(l+1),e[l]=d),l++),c++;return l},cI=lI,AD=Lo,OD=AD("toStringTag"),uI={};uI[OD]="z";var RD=String(uI)==="[object z]",DD=RD,LD=ln,rh=tl,jD=Lo,ND=jD("toStringTag"),zD=Object,BD=rh(function(){return arguments}())==="Arguments",FD=function(e,n){try{return e[n]}catch{}},dI=DD?rh:function(e){var n,t,r;return e===void 0?"Undefined":e===null?"Null":typeof(t=FD(n=zD(e),ND))=="string"?t:BD?rh(n):(r=rh(n))==="Object"&&LD(n.callee)?"Arguments":r},UD=Pt,KD=an,hI=ln,HD=dI,VD=sp,WD=WC,fI=function(){},YD=[],pI=VD("Reflect","construct"),p1=/^\s*(?:class|function)\b/,XD=UD(p1.exec),GD=!p1.exec(fI),Il=function(n){if(!hI(n))return!1;try{return pI(fI,YD,n),!0}catch{return!1}},gI=function(n){if(!hI(n))return!1;switch(HD(n)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return GD||!!XD(p1,WD(n))}catch{return!0}};gI.sham=!0;var qD=!pI||KD(function(){var e;return Il(Il.call)||!Il(Object)||!Il(function(){e=!0})||e})?gI:Il,qS=iI,QD=qD,ZD=Ai,JD=Lo,e7=JD("species"),QS=Array,t7=function(e){var n;return qS(e)&&(n=e.constructor,QD(n)&&(n===QS||qS(n.prototype))?n=void 0:ZD(n)&&(n=n[e7],n===null&&(n=void 0))),n===void 0?QS:n},n7=t7,mI=function(e,n){return new(n7(e))(n===0?0:n)},r7=ol,o7=cI,s7=hu,i7=fu,a7=Ri,l7=mI;r7({target:"Array",proto:!0},{flat:function(){var n=arguments.length?arguments[0]:void 0,t=s7(this),r=i7(t),o=l7(t,0);return o.length=o7(o,t,t,r,0,n===void 0?1:a7(n)),o}});var c7=f1;c7("flat");var u7=gu;u7("Array","flat");var d7=ol,h7=cI,f7=r1,p7=hu,g7=fu,m7=mI;d7({target:"Array",proto:!0},{flatMap:function(n){var t=p7(this),r=g7(t),o;return f7(n),o=m7(t,0),o.length=h7(o,t,t,r,0,1,n,arguments.length>1?arguments[1]:void 0),o}});var y7=f1;y7("flatMap");var v7=gu;v7("Array","flatMap");var w7=dI,x7=String,mu=function(e){if(w7(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return x7(e)},S7=ol,b7=Pt,P7=nl,E7=Ri,_7=mu,C7=an,I7=b7("".charAt),k7=C7(function(){return"".at(-2)!=="\uD842"});S7({target:"String",proto:!0,forced:k7},{at:function(n){var t=_7(P7(this)),r=t.length,o=E7(n),s=o>=0?o:r+o;return s<0||s>=r?void 0:I7(t,s)}});var $7=gu;$7("String","at");var T7=Oi,yI=function(){var e=T7(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},g1=an,M7=bn,m1=M7.RegExp,y1=g1(function(){var e=m1("a","y");return e.lastIndex=2,e.exec("abcd")!==null}),A7=y1||g1(function(){return!m1("a","y").sticky}),O7=y1||g1(function(){var e=m1("^r","gy");return e.lastIndex=2,e.exec("str")!==null}),R7={BROKEN_CARET:O7,MISSED_STICKY:A7,UNSUPPORTED_Y:y1},D7=an,L7=bn,j7=L7.RegExp,N7=D7(function(){var e=j7(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),z7=an,B7=bn,F7=B7.RegExp,U7=z7(function(){var e=F7("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),xa=zs,ip=Pt,K7=mu,H7=yI,V7=R7,W7=a1,Y7=sI,X7=GC.get,G7=N7,q7=U7,Q7=W7("native-string-replace",String.prototype.replace),tf=RegExp.prototype.exec,f0=tf,Z7=ip("".charAt),J7=ip("".indexOf),eL=ip("".replace),zg=ip("".slice),p0=function(){var e=/a/,n=/b*/g;return xa(tf,e,"a"),xa(tf,n,"a"),e.lastIndex!==0||n.lastIndex!==0}(),vI=V7.BROKEN_CARET,g0=/()??/.exec("")[1]!==void 0,tL=p0||g0||vI||G7||q7;tL&&(f0=function(n){var t=this,r=X7(t),o=K7(n),s=r.raw,i,a,l,c,u,d,h;if(s)return s.lastIndex=t.lastIndex,i=xa(f0,s,o),t.lastIndex=s.lastIndex,i;var f=r.groups,p=vI&&t.sticky,m=xa(H7,t),y=t.source,x=0,S=o;if(p&&(m=eL(m,"y",""),J7(m,"g")===-1&&(m+="g"),S=zg(o,t.lastIndex),t.lastIndex>0&&(!t.multiline||t.multiline&&Z7(o,t.lastIndex-1)!==`
`)&&(y="(?: "+y+")",S=" "+S,x++),a=new RegExp("^(?:"+y+")",m)),g0&&(a=new RegExp("^"+y+"$(?!\\s)",m)),p0&&(l=t.lastIndex),c=xa(tf,p?a:t,S),p?c?(c.input=zg(c.input,x),c[0]=zg(c[0],x),c.index=t.lastIndex,t.lastIndex+=c[0].length):t.lastIndex=0:p0&&c&&(t.lastIndex=t.global?c.index+c[0].length:l),g0&&c&&c.length>1&&xa(Q7,c[0],a,function(){for(u=1;u<arguments.length-2;u++)arguments[u]===void 0&&(c[u]=void 0)}),c&&f)for(c.groups=d=Y7(null),u=0;u<f.length;u++)h=f[u],d[h[0]]=c[h[1]];return c});var v1=f0,nL=ol,ZS=v1;nL({target:"RegExp",proto:!0,forced:/./.exec!==ZS},{exec:ZS});var rL=np,wI=Function.prototype,JS=wI.apply,eb=wI.call,oL=typeof Reflect=="object"&&Reflect.apply||(rL?eb.bind(JS):function(){return eb.apply(JS,arguments)}),tb=aI,nb=QC,sL=v1,rb=an,xI=Lo,iL=l1,aL=xI("species"),Bg=RegExp.prototype,lL=function(e,n,t,r){var o=xI(e),s=!rb(function(){var c={};return c[o]=function(){return 7},""[e](c)!==7}),i=s&&!rb(function(){var c=!1,u=/a/;return e==="split"&&(u={},u.constructor={},u.constructor[aL]=function(){return u},u.flags="",u[o]=/./[o]),u.exec=function(){return c=!0,null},u[o](""),!c});if(!s||!i||t){var a=tb(/./[o]),l=n(o,""[e],function(c,u,d,h,f){var p=tb(c),m=u.exec;return m===sL||m===Bg.exec?s&&!f?{done:!0,value:a(u,d,h)}:{done:!0,value:p(d,u,h)}:{done:!1}});nb(String.prototype,e,l[0]),nb(Bg,o,l[1])}r&&iL(Bg[o],"sham",!0)},w1=Pt,cL=Ri,uL=mu,dL=nl,hL=w1("".charAt),ob=w1("".charCodeAt),fL=w1("".slice),sb=function(e){return function(n,t){var r=uL(dL(n)),o=cL(t),s=r.length,i,a;return o<0||o>=s?e?"":void 0:(i=ob(r,o),i<55296||i>56319||o+1===s||(a=ob(r,o+1))<56320||a>57343?e?hL(r,o):i:e?fL(r,o,o+2):(i-55296<<10)+(a-56320)+65536)}},pL={codeAt:sb(!1),charAt:sb(!0)},gL=pL.charAt,mL=function(e,n,t){return n+(t?gL(e,n).length:1)},x1=Pt,yL=hu,vL=Math.floor,Fg=x1("".charAt),wL=x1("".replace),Ug=x1("".slice),xL=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,SL=/\$([$&'`]|\d{1,2})/g,SI=function(e,n,t,r,o,s){var i=t+e.length,a=r.length,l=SL;return o!==void 0&&(o=yL(o),l=xL),wL(s,l,function(c,u){var d;switch(Fg(u,0)){case"$":return"$";case"&":return e;case"`":return Ug(n,0,t);case"'":return Ug(n,i);case"<":d=o[Ug(u,1,-1)];break;default:var h=+u;if(h===0)return c;if(h>a){var f=vL(h/10);return f===0?c:f<=a?r[f-1]===void 0?Fg(u,1):r[f-1]+Fg(u,1):c}d=r[h-1]}return d===void 0?"":d})},ib=zs,bL=Oi,PL=ln,EL=tl,_L=v1,CL=TypeError,IL=function(e,n){var t=e.exec;if(PL(t)){var r=ib(t,e,n);return r!==null&&bL(r),r}if(EL(e)==="RegExp")return ib(_L,e,n);throw CL("RegExp#exec called on incompatible receiver")},kL=oL,ab=zs,ap=Pt,$L=lL,TL=an,ML=Oi,AL=ln,OL=rp,RL=Ri,DL=JC,Wi=mu,LL=nl,jL=mL,NL=o1,zL=SI,BL=IL,FL=Lo,m0=FL("replace"),UL=Math.max,KL=Math.min,HL=ap([].concat),Kg=ap([].push),lb=ap("".indexOf),cb=ap("".slice),VL=function(e){return e===void 0?e:String(e)},WL=function(){return"a".replace(/./,"$0")==="$0"}(),ub=function(){return/./[m0]?/./[m0]("a","$0")==="":!1}(),YL=!TL(function(){var e=/./;return e.exec=function(){var n=[];return n.groups={a:"7"},n},"".replace(e,"$<a>")!=="7"});$L("replace",function(e,n,t){var r=ub?"$":"$0";return[function(s,i){var a=LL(this),l=OL(s)?void 0:NL(s,m0);return l?ab(l,s,a,i):ab(n,Wi(a),s,i)},function(o,s){var i=ML(this),a=Wi(o);if(typeof s=="string"&&lb(s,r)===-1&&lb(s,"$<")===-1){var l=t(n,i,a,s);if(l.done)return l.value}var c=AL(s);c||(s=Wi(s));var u=i.global,d;u&&(d=i.unicode,i.lastIndex=0);for(var h=[],f;f=BL(i,a),!(f===null||(Kg(h,f),!u));){var p=Wi(f[0]);p===""&&(i.lastIndex=jL(a,DL(i.lastIndex),d))}for(var m="",y=0,x=0;x<h.length;x++){f=h[x];for(var S=Wi(f[0]),b=UL(KL(RL(f.index),a.length),0),P=[],C,_=1;_<f.length;_++)Kg(P,VL(f[_]));var I=f.groups;if(c){var k=HL([S],P,b,a);I!==void 0&&Kg(k,I),C=Wi(kL(s,void 0,k))}else C=zL(S,a,b,P,I,s);b>=y&&(m+=cb(a,y,b)+C,y=b+S.length)}return m+cb(a,y)}]},!YL||!WL||ub);var XL=Ai,GL=tl,qL=Lo,QL=qL("match"),ZL=function(e){var n;return XL(e)&&((n=e[QL])!==void 0?!!n:GL(e)==="RegExp")},JL=zs,ej=Bs,tj=OC,nj=yI,db=RegExp.prototype,rj=function(e){var n=e.flags;return n===void 0&&!("flags"in db)&&!ej(e,"flags")&&tj(db,e)?JL(nj,e):n},oj=ol,sj=zs,S1=Pt,hb=nl,ij=ln,aj=rp,lj=ZL,kl=mu,cj=o1,uj=rj,dj=SI,hj=Lo,fj=hj("replace"),pj=TypeError,bI=S1("".indexOf);S1("".replace);var fb=S1("".slice),gj=Math.max,pb=function(e,n,t){return t>e.length?-1:n===""?t:bI(e,n,t)};oj({target:"String",proto:!0},{replaceAll:function(n,t){var r=hb(this),o,s,i,a,l,c,u,d,h,f=0,p=0,m="";if(!aj(n)){if(o=lj(n),o&&(s=kl(hb(uj(n))),!~bI(s,"g")))throw pj("`.replaceAll` does not allow non-global regexes");if(i=cj(n,fj),i)return sj(i,n,r,t)}for(a=kl(r),l=kl(n),c=ij(t),c||(t=kl(t)),u=l.length,d=gj(1,u),f=pb(a,l,0);f!==-1;)h=c?kl(t(l,f,a)):dj(l,a,f,[],void 0,t),m+=fb(a,p,f)+h,p=f+u,f=pb(a,l,f+d);return p<a.length&&(m+=fb(a,p)),m}});var mj=gu;mj("String","replaceAll");const Mn="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",yj="a0",PI="A00000000000000000000000000";function EI(e){if(e>="a"&&e<="z")return e.charCodeAt(0)-"a".charCodeAt(0)+2;if(e>="A"&&e<="Z")return"Z".charCodeAt(0)-e.charCodeAt(0)+2;throw new Error("Invalid index key head: "+e)}function _I(e){if(e.length!==EI(e.charAt(0)))throw new Error("invalid integer part of index key: "+e)}function gb(e){if(e===void 0)throw Error("n is undefined")}function mb(e){_I(e);const[n,...t]=e.split("");let r=!0;for(let o=t.length-1;r&&o>=0;o--){const s=Mn.indexOf(t[o])+1;s===Mn.length?t[o]="0":(t[o]=Mn.charAt(s),r=!1)}if(r){if(n==="Z")return"a0";if(n==="z")return;const o=String.fromCharCode(n.charCodeAt(0)+1);return o>"a"?t.push("0"):t.pop(),o+t.join("")}else return n+t.join("")}function vj(e){_I(e);const[n,...t]=e.split("");let r=!0;for(let o=t.length-1;r&&o>=0;o--){const s=Mn.indexOf(t[o])-1;s===-1?t[o]=Mn.slice(-1):(t[o]=Mn.charAt(s),r=!1)}if(r){if(n==="a")return"Z"+Mn.slice(-1);if(n==="A")return;const o=String.fromCharCode(n.charCodeAt(0)-1);return o<"Z"?t.push(Mn.slice(-1)):t.pop(),o+t.join("")}else return n+t.join("")}function Sa(e,n){if(n!==void 0&&e>=n)throw new Error(e+" >= "+n);if(e.slice(-1)==="0"||n&&n.slice(-1)==="0")throw new Error("trailing zero");if(n){let o=0;for(;(e.charAt(o)||"0")===n.charAt(o);)o++;if(o>0)return n.slice(0,o)+Sa(e.slice(o),n.slice(o))}const t=e?Mn.indexOf(e.charAt(0)):0,r=n!==void 0?Mn.indexOf(n.charAt(0)):Mn.length;if(r-t>1){const o=Math.round(.5*(t+r));return Mn.charAt(o)}else return n&&n.length>1?n.slice(0,1):Mn.charAt(t)+Sa(e.slice(1),void 0)}function Gl(e){const n=EI(e.charAt(0));if(n>e.length)throw new Error("invalid index: "+e);return e.slice(0,n)}function yb(e){if(e===PI)throw new Error("invalid index: "+e);const n=Gl(e);if(e.slice(n.length).slice(-1)==="0")throw new Error("invalid index: "+e)}function Yi(e,n){if(e!==void 0&&yb(e),n!==void 0&&yb(n),e!==void 0&&n!==void 0&&e>=n)throw new Error(e+" >= "+n);if(e===void 0&&n===void 0)return yj;if(e===void 0){if(n===void 0)throw Error("b is undefined");const a=Gl(n),l=n.slice(a.length);if(a===PI)return a+Sa("",l);if(a<n)return a;const c=vj(a);return gb(c),c}if(n===void 0){const a=Gl(e),l=e.slice(a.length),c=mb(a);return c===void 0?a+Sa(l,void 0):c}const t=Gl(e),r=e.slice(t.length),o=Gl(n),s=n.slice(o.length);if(t===o)return t+Sa(r,s);const i=mb(t);return gb(i),i<n?i:t+Sa(r,void 0)}function Cs(e,n,t){if(t===0)return[];if(t===1)return[Yi(e,n)];if(n===void 0){let s=Yi(e,n);const i=[s];for(let a=0;a<t-1;a++)s=Yi(s,n),i.push(s);return i}if(e===void 0){let s=Yi(e,n);const i=[s];for(let a=0;a<t-1;a++)s=Yi(e,s),i.push(s);return i.reverse(),i}const r=Math.floor(t/2),o=Yi(e,n);return[...Cs(e,o,r),o,...Cs(o,n,t-r-1)]}function Xi(e,n,t){return Cs(e,n,t)}function Hg(e,n){return Cs(e,void 0,n)}function cc(e,n){return Cs(e,n,1)[0]}function po(e){return Cs(e,void 0,1)[0]}function wj(e){return Cs(void 0,e,1)[0]}function CI(e,n="a1"){return[n,...Cs(n,void 0,e)]}function un(e,n){return e.index<n.index?-1:e.index>n.index?1:0}const vb=8;class II{constructor(){v(this,"arraySize",0);v(this,"array",Array(vb));v(this,"set",null)}get isEmpty(){if(this.array)return this.arraySize===0;if(this.set)return this.set.size===0;throw new Error("no set or array")}add(n){if(this.array)return this.array.indexOf(n)!==-1?!1:this.arraySize<vb?(this.array[this.arraySize]=n,this.arraySize++,!0):(this.set=new Set(this.array),this.array=null,this.set.add(n),!0);if(this.set)return this.set.has(n)?!1:(this.set.add(n),!0);throw new Error("no set or array")}remove(n){if(this.array){const t=this.array.indexOf(n);return t===-1?!1:(this.array[t]=void 0,this.arraySize--,t!==this.arraySize&&(this.array[t]=this.array[this.arraySize],this.array[this.arraySize]=void 0),!0)}if(this.set)return this.set.has(n)?(this.set.delete(n),!0):!1;throw new Error("no set or array")}visit(n){if(this.array){for(let t=0;t<this.arraySize;t++){const r=this.array[t];typeof r<"u"&&n(r)}return}if(this.set){this.set.forEach(n);return}throw new Error("no set or array")}}function kI(e){return e&&typeof e=="object"&&"parents"in e}function $I(e){for(let n=0,t=e.parents.length;n<t;n++)if(e.parents[n].__unsafe__getWithoutCapture(),e.parents[n].lastChangedEpoch!==e.parentEpochs[n])return!0;return!1}const nf=(e,n)=>{if(e.children.remove(n)&&e.children.isEmpty&&kI(e))for(let t=0,r=e.parents.length;t<r;t++)nf(e.parents[t],e)},b1=(e,n)=>{if(e.children.add(n)&&kI(e))for(let t=0,r=e.parents.length;t<r;t++)b1(e.parents[t],e)};function TI(e,n){return e===n||Object.is(e,n)||!!(e&&n&&typeof e.equals=="function"&&e.equals(n))}const br=Object.freeze([]),wb=Symbol.for("__@tldraw/state__"),xb=globalThis;xb[wb]?console.error('Multiple versions of @tldraw/state detected. This will cause unexpected behavior. Please add "resolutions" (yarn/pnpm) or "overrides" (npm) in your package.json to ensure only one version of @tldraw/state is loaded.'):xb[wb]=!0;class xj{constructor(n,t){v(this,"offset",0);v(this,"numNewParents",0);v(this,"maybeRemoved");this.below=n,this.child=t}}let Te=null;function MI(e){Te=new xj(Te,e)}function AI(){const e=Te;if(Te=e.below,e.numNewParents>0||e.offset!==e.child.parents.length){for(let t=e.offset;t<e.child.parents.length;t++){const r=e.child.parents[t];e.child.parents.indexOf(r)>=e.offset&&nf(r,e.child)}if(e.child.parents.length=e.offset,e.child.parentEpochs.length=e.offset,Te!=null&&Te.maybeRemoved)for(let t=0;t<Te.maybeRemoved.length;t++){const r=Te.maybeRemoved[t];e.child.parents.indexOf(r)===-1&&nf(r,e.child)}}}function y0(e){if(Te){const n=Te.child.parents.indexOf(e);if(n<0&&(Te.numNewParents++,Te.child.isActivelyListening&&b1(e,Te.child)),n<0||n>=Te.offset){if(n!==Te.offset&&n>0){const t=Te.child.parents[Te.offset];Te.maybeRemoved?Te.maybeRemoved.indexOf(t)===-1&&Te.maybeRemoved.push(t):Te.maybeRemoved=[t]}Te.child.parents[Te.offset]=e,Te.child.parentEpochs[Te.offset]=e.lastChangedEpoch,Te.offset++}}}const Rn=Symbol("RESET_VALUE");class OI{constructor(n){v(this,"index",0);v(this,"buffer");this.capacity=n,this.buffer=new Array(n)}pushEntry(n,t,r){if(r!==void 0){if(r===Rn){this.clear();return}this.buffer[this.index]=[n,t,r],this.index=(this.index+1)%this.capacity}}clear(){this.index=0,this.buffer.fill(void 0)}getChangesSince(n){const{index:t,capacity:r,buffer:o}=this;for(let s=0;s<r;s++){const i=(t-1+r-s)%r,a=o[i];if(!a)return Rn;const[l,c]=a;if(s===0&&n>=c)return[];if(l<=n&&n<c){const u=s+1,d=new Array(u);for(let h=0;h<u;h++)d[h]=o[(i+h)%r][2];return d}}return Rn}}const li=-1;let $t=li+1,Vg=!1;function Sj(){$t++}class bj{constructor(n){v(this,"initialAtomValues",new Map);this.parent=n}get isRoot(){return this.parent===null}commit(){if(this.isRoot){const n=this.initialAtomValues;this.initialAtomValues=new Map,RI(n.keys())}else this.initialAtomValues.forEach((n,t)=>{this.parent.initialAtomValues.has(t)||this.parent.initialAtomValues.set(t,n)})}abort(){$t++,this.initialAtomValues.forEach((n,t)=>{var r;t.set(n),(r=t.historyBuffer)==null||r.clear()}),this.commit()}}function RI(e){if(Vg)throw new Error("cannot change atoms during reaction cycle");try{Vg=!0;const n=new Set,t=r=>{r.lastTraversedEpoch!==$t&&(r.lastTraversedEpoch=$t,"maybeScheduleEffect"in r?n.add(r):r.children.visit(t))};for(const r of e)r.children.visit(t);for(const r of n)r.maybeScheduleEffect()}finally{Vg=!1}}function Pj(e,n){ls?ls.initialAtomValues.has(e)||ls.initialAtomValues.set(e,n):RI([e])}let ls=null;function Ej(e){const n=new bj(ls);ls=n;try{let t=!1;const r=e(()=>t=!0);return t?n.abort():n.commit(),r}catch(t){throw n.abort(),t}finally{ls=ls.parent}}function Gn(e){return ls?e():Ej(e)}class _j{constructor(n,t,r){v(this,"isEqual");v(this,"computeDiff");v(this,"lastChangedEpoch",$t);v(this,"children",new II);v(this,"historyBuffer");this.name=n,this.current=t,this.isEqual=(r==null?void 0:r.isEqual)??null,r&&(r.historyLength&&(this.historyBuffer=new OI(r.historyLength)),this.computeDiff=r.computeDiff)}__unsafe__getWithoutCapture(){return this.current}get value(){return y0(this),this.current}set(n,t){var o,s;if(((o=this.isEqual)==null?void 0:o.call(this,this.current,n))??TI(this.current,n))return this.current;Sj(),this.historyBuffer&&this.historyBuffer.pushEntry(this.lastChangedEpoch,$t,t??((s=this.computeDiff)==null?void 0:s.call(this,this.current,n,this.lastChangedEpoch,$t))??Rn),this.lastChangedEpoch=$t;const r=this.current;return this.current=n,Pj(this,r),n}update(n){return this.set(n(this.current))}getDiffSince(n){var t;return y0(this),n>=this.lastChangedEpoch?br:((t=this.historyBuffer)==null?void 0:t.getChangesSince(n))??Rn}}function dt(e,n,t){return new _j(e,n,t)}const v0=Symbol("UNINITIALIZED"),Ma=e=>e===v0;class w0{constructor(n,t){this.value=n,this.diff=t}}function ql(e,n){return new w0(e,n)}class DI{constructor(n,t,r){v(this,"lastChangedEpoch",li);v(this,"lastTraversedEpoch",li);v(this,"lastCheckedEpoch",li);v(this,"parents",[]);v(this,"parentEpochs",[]);v(this,"children",new II);v(this,"historyBuffer");v(this,"state",v0);v(this,"computeDiff");v(this,"isEqual");this.name=n,this.derive=t,r!=null&&r.historyLength&&(this.historyBuffer=new OI(r.historyLength)),this.computeDiff=r==null?void 0:r.computeDiff,this.isEqual=(r==null?void 0:r.isEqual)??TI}get isActivelyListening(){return!this.children.isEmpty}__unsafe__getWithoutCapture(){var t;const n=this.lastChangedEpoch===li;if(!n&&(this.lastCheckedEpoch===$t||!$I(this)))return this.lastCheckedEpoch=$t,this.state;try{MI(this);const r=this.derive(this.state,this.lastCheckedEpoch),o=r instanceof w0?r.value:r;if(this.state===v0||!this.isEqual(o,this.state)){if(this.historyBuffer&&!n){const s=r instanceof w0?r.diff:void 0;this.historyBuffer.pushEntry(this.lastChangedEpoch,$t,s??((t=this.computeDiff)==null?void 0:t.call(this,this.state,o,this.lastCheckedEpoch,$t))??Rn)}this.lastChangedEpoch=$t,this.state=o}return this.lastCheckedEpoch=$t,this.state}finally{AI()}}get value(){const n=this.__unsafe__getWithoutCapture();return y0(this),n}getDiffSince(n){var t;return this.value,n>=this.lastChangedEpoch?br:((t=this.historyBuffer)==null?void 0:t.getChangesSince(n))??Rn}}function Sb(e={},n,t,r){const o=r.get,s=Symbol.for("__@tldraw/state__computed__"+t);return r.get=function(){let i=this[s];return i||(i=new DI(t,o.bind(this),e),Object.defineProperty(this,s,{enumerable:!1,configurable:!1,writable:!1,value:i})),i.value},r}function G(){if(arguments.length===1){const e=arguments[0];return(n,t,r)=>Sb(e,n,t,r)}else return typeof arguments[0]=="string"?new DI(arguments[0],arguments[1],arguments[2]):Sb(void 0,arguments[0],arguments[1],arguments[2])}class yu{constructor(n,t,r){v(this,"_isActivelyListening",!1);v(this,"lastTraversedEpoch",li);v(this,"lastReactedEpoch",li);v(this,"_scheduleCount",0);v(this,"parentEpochs",[]);v(this,"parents",[]);v(this,"_scheduleEffect");v(this,"maybeExecute",()=>{this._isActivelyListening&&this.execute()});this.name=n,this.runEffect=t,this._scheduleEffect=r==null?void 0:r.scheduleEffect}get isActivelyListening(){return this._isActivelyListening}get scheduleCount(){return this._scheduleCount}maybeScheduleEffect(){if(this._isActivelyListening&&this.lastReactedEpoch!==$t){if(this.parents.length&&!$I(this)){this.lastReactedEpoch=$t;return}this.scheduleEffect()}}scheduleEffect(){this._scheduleCount++,this._scheduleEffect?this._scheduleEffect(this.maybeExecute):this.execute()}attach(){this._isActivelyListening=!0;for(let n=0,t=this.parents.length;n<t;n++)b1(this.parents[n],this)}detach(){this._isActivelyListening=!1;for(let n=0,t=this.parents.length;n<t;n++)nf(this.parents[n],this)}execute(){try{MI(this);const n=this.runEffect(this.lastReactedEpoch);return this.lastReactedEpoch=$t,n}finally{AI()}}}function lp(e,n,t){const r=new yu(e,n,t);return r.attach(),r.scheduleEffect(),()=>{r.detach()}}function Cj(e,n,t){const r=new yu(e,n,t);return{scheduler:r,start:o=>{const s=(o==null?void 0:o.force)??!1;r.attach(),s?r.scheduleEffect():r.maybeScheduleEffect()},stop:()=>{r.detach()}}}function cp(e,n){const t=oe.useRef(n);t.current=n;const[r,o,s]=oe.useMemo(()=>{let i=null;const a=u=>(i=u,()=>{i=null}),l=new yu(`useStateTracking(${e})`,()=>{var u;return(u=t.current)==null?void 0:u.call(t)},{scheduleEffect(){i==null||i()}});return[l,a,()=>l.scheduleCount]},[e]);return oe.useSyncExternalStore(o,s,s),oe.useEffect(()=>(r.attach(),r.maybeScheduleEffect(),()=>{r.detach()}),[r]),r.execute()}const bb={apply(e,n,t){return cp(e.displayName??e.name??"tracked(???)",()=>e.apply(n,t))}},Ij=Symbol.for("react.memo"),kj=Symbol.for("react.forward_ref");function me(e){let n=null;const t=e.$$typeof;return t===Ij&&(e=e.type,n=e.compare),t===kj?w.memo(w.forwardRef(new Proxy(e.render,bb))):w.memo(new Proxy(e,bb),n)}function $j(){const e=arguments[0],n=arguments[1],t=arguments.length===3?void 0:arguments[2],r=arguments.length===3?arguments[2]:arguments[3];return w.useMemo(()=>G(`useComputed(${e})`,n,t),r)}function pi(e,n,t=br){w.useEffect(()=>{const r=new yu(e,n);return r.attach(),r.execute(),()=>{r.detach()}},t)}function J(){const e=arguments,n=e.length===3?e[2]:[e[0]],t=e.length===3?e[0]:`useValue(${e[0].name})`,r=w.useRef(!0);r.current=!0;const o=w.useMemo(()=>e.length===1?e[0]:G(t,()=>{if(r.current)return e[1]();try{return e[1]()}catch{return{}}}),n);try{const{subscribe:s,getSnapshot:i}=w.useMemo(()=>({subscribe:a=>lp(`useValue(${t})`,()=>{o.value,a()}),getSnapshot:()=>o.value}),[o]);return w.useSyncExternalStore(s,i,i)}finally{r.current=!1}}class oh{constructor(n){v(this,"nextValue");v(this,"diff");this.previousValue=n}get(){var r,o,s,i;const n=((o=(r=this.diff)==null?void 0:r.removed)==null?void 0:o.size)??0,t=((i=(s=this.diff)==null?void 0:s.added)==null?void 0:i.size)??0;if(!(n===0&&t===0))return{value:this.nextValue,diff:this.diff}}_add(n,t){var r,o;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.add(n),this.diff??(this.diff={}),t?(r=this.diff.removed)==null||r.delete(n):((o=this.diff).added??(o.added=new Set),this.diff.added.add(n))}add(n){var o,s,i;const t=this.previousValue.has(n);if(t)return((s=(o=this.diff)==null?void 0:o.removed)==null?void 0:s.has(n))?this._add(n,t):void 0;(i=this.nextValue)!=null&&i.has(n)||this._add(n,t)}_remove(n,t){var r,o;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.delete(n),this.diff??(this.diff={}),t?((r=this.diff).removed??(r.removed=new Set),this.diff.removed.add(n)):(o=this.diff.added)==null||o.delete(n)}remove(n){var o,s,i,a;const t=this.previousValue.has(n);if(!t)return((s=(o=this.diff)==null?void 0:o.added)==null?void 0:s.has(n))?this._remove(n,t):void 0;(a=(i=this.diff)==null?void 0:i.removed)!=null&&a.has(n)||this._remove(n,t)}}function rf(e,n){const t=[];e:for(const r of e){for(const o of t)if(n?n(r,o):r===o)continue e;t.push(r)}return t}function he(e){return e.filter(n=>n!=null)}function en(e){return e[e.length-1]}function LI(e,n){let t,r=1/0;for(const o of e){const s=n(o);s<r&&(t=o,r=s)}return t}function Tj(e,n){const t=[],r=[];for(const o of e)n(o)?t.push(o):r.push(o);return[t,r]}function jI(e){const n=(...t)=>{try{return e(...t)}catch(r){throw r instanceof Error&&Error.captureStackTrace&&Error.captureStackTrace(r,n),r}};return n}function P1(e,n){const t=n&&e&&typeof e=="object"&&n in e?e[n]:e;throw new Error(`Unknown switch case ${t}`)}const Rc=jI((e,n)=>{if(!e)throw new Error(n||"Assertion Error")}),Mj=jI((e,n)=>{if(e==null)throw new Error(n??"value must be defined");return e});function NI(e,n){let t;const r=(...o)=>(t||(t={},t.promise=new Promise((s,i)=>{t.resolve=s,t.reject=i})),clearTimeout(t.timeout),t.latestArgs=o,t.timeout=setTimeout(()=>{const s=t;t=void 0;try{s.resolve(e(...s.latestArgs))}catch(i){s.reject(i)}},n),t.promise);return r.cancel=()=>{t&&clearTimeout(t.timeout)},r}const Pb=new WeakMap;function E1(e,n){if(typeof e!="object"||e===null)return;let t=Pb.get(e);t||(t={tags:{},extras:{}},Pb.set(e,t)),n.tags&&(t.tags={...t.tags,...n.tags}),n.extras&&(t.extras={...t.extras,...n.extras})}function sh(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n+""}function Aa(e=""){let n=0,t=0,r=0,o=0;function s(){const i=n^n<<11;return n=t,t=r,r=o,o^=(o>>>19^i^i>>>8)>>>0,o/4294967296*2}for(let i=0;i<e.length+64;i++)n^=e.charCodeAt(i)|0,s();return s}function x0(e,n,t,r=!1){const[o,s]=n,[i,a]=t,l=i+(e-o)/(s-o)*(a-i);return r?i<a?Math.max(Math.min(l,a),i):Math.max(Math.min(l,i),a):l}function Dc(e,n){return Object.prototype.hasOwnProperty.call(e,n)}function gi(e,n){if(Dc(e,n))return e[n]}function yn(e){if(!e)return e;if(Array.isArray(e)){const n=[],t=e.length;for(let r=0;r<t;r++)n.push(yn(e[r]));return n}else if(typeof e=="object"){const n=Object.keys(e),t=n.length,r={};for(let o=0;o<t;o++){const s=n[o];r[s]=yn(e[s])}return r}return e}function Eb(e){return Object.keys(e)}function lt(e){return Object.values(e)}function xo(e){return Object.entries(e)}function zI(e){return Object.fromEntries(e)}function Wg(e,n){const t={};let r=!1;for(const[o,s]of xo(e))n(o,s)?t[o]=s:r=!0;return r?t:e}function _b(e,n){const t={};for(const[r,o]of xo(e)){const s=n(r,o);t[r]=s}return t}const Aj=()=>typeof process<"u"&&!1,of=[],Oj=()=>{const e=of.splice(0,of.length);for(const n of e)n()};let Yg;function Rj(){Yg||(Yg=requestAnimationFrame(()=>{Yg=void 0,Oj()}))}function Dj(e){if(Aj())return e();of.includes(e)||(of.push(e),Rj())}function Lj(e,n){return e.id>n.id?1:-1}function jj(e){return e!==null}const So=typeof window<"u"&&window.structuredClone?window.structuredClone:e=>e&&JSON.parse(JSON.stringify(e));let BI=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((n,t)=>(t&=63,t<36?n+=t.toString(36):t<62?n+=(t-26).toString(36).toUpperCase():t>62?n+="-":n+="_",n),"");class _1{constructor(n,t){v(this,"createDefaultProperties");v(this,"migrations");v(this,"validator");v(this,"scope");v(this,"isInstance",n=>(n==null?void 0:n.typeName)===this.typeName);this.typeName=n,this.createDefaultProperties=t.createDefaultProperties,this.migrations=t.migrations,this.validator=t.validator??{validate:r=>r},this.scope=t.scope??"document"}create(n){const t={...this.createDefaultProperties(),id:this.createId()};for(const[r,o]of Object.entries(n))o!==void 0&&(t[r]=o);return t.typeName=this.typeName,t}clone(n){return{...So(n),id:this.createId()}}createId(n){return this.typeName+":"+(n??BI())}createCustomId(n){return this.typeName+":"+n}parseId(n){if(!this.isId(n))throw new Error(`ID "${n}" is not a valid ID for type "${this.typeName}"`);return n.slice(this.typeName.length+1)}isId(n){if(!n)return!1;for(let t=0;t<this.typeName.length;t++)if(n[t]!==this.typeName[t])return!1;return n[this.typeName.length]===":"}withDefaultProperties(n){return new _1(this.typeName,{createDefaultProperties:n,migrations:this.migrations,validator:this.validator,scope:this.scope})}validate(n){return this.validator.validate(n)}}function jo(e,n){return new _1(e,{createDefaultProperties:()=>({}),migrations:n.migrations??{currentVersion:0,firstVersion:0,migrators:{}},validator:n.validator,scope:n.scope})}class Cb{constructor(){v(this,"items",new WeakMap)}get(n,t){return this.items.has(n)||this.items.set(n,t(n)),this.items.get(n)}}var sf={exports:{}};sf.exports;(function(e,n){var t=200,r="__lodash_hash_undefined__",o=1,s=2,i=9007199254740991,a="[object Arguments]",l="[object Array]",c="[object AsyncFunction]",u="[object Boolean]",d="[object Date]",h="[object Error]",f="[object Function]",p="[object GeneratorFunction]",m="[object Map]",y="[object Number]",x="[object Null]",S="[object Object]",b="[object Promise]",P="[object Proxy]",C="[object RegExp]",_="[object Set]",I="[object String]",k="[object Symbol]",T="[object Undefined]",M="[object WeakMap]",O="[object ArrayBuffer]",z="[object DataView]",B="[object Float32Array]",D="[object Float64Array]",F="[object Int8Array]",V="[object Int16Array]",q="[object Int32Array]",L="[object Uint8Array]",N="[object Uint8ClampedArray]",H="[object Uint16Array]",Q="[object Uint32Array]",Z=/[\\^$.*+?()[\]{}|]/g,Ee=/^\[object .+?Constructor\]$/,ke=/^(?:0|[1-9]\d*)$/,ue={};ue[B]=ue[D]=ue[F]=ue[V]=ue[q]=ue[L]=ue[N]=ue[H]=ue[Q]=!0,ue[a]=ue[l]=ue[O]=ue[u]=ue[z]=ue[d]=ue[h]=ue[f]=ue[m]=ue[y]=ue[S]=ue[C]=ue[_]=ue[I]=ue[M]=!1;var He=typeof tn=="object"&&tn&&tn.Object===Object&&tn,Ve=typeof self=="object"&&self&&self.Object===Object&&self,We=He||Ve||Function("return this")(),Re=n&&!n.nodeType&&n,Gt=Re&&!0&&e&&!e.nodeType&&e,Ho=Gt&&Gt.exports===Re,Pn=Ho&&He.process,so=function(){try{return Pn&&Pn.binding&&Pn.binding("util")}catch{}}(),cr=so&&so.isTypedArray;function Vo($,A){for(var K=-1,ee=$==null?0:$.length,ze=0,ge=[];++K<ee;){var it=$[K];A(it,K,$)&&(ge[ze++]=it)}return ge}function io($,A){for(var K=-1,ee=A.length,ze=$.length;++K<ee;)$[ze+K]=A[K];return $}function Bn($,A){for(var K=-1,ee=$==null?0:$.length;++K<ee;)if(A($[K],K,$))return!0;return!1}function ur($,A){for(var K=-1,ee=Array($);++K<$;)ee[K]=A(K);return ee}function Fn($){return function(A){return $(A)}}function qt($,A){return $.has(A)}function Lu($,A){return $==null?void 0:$[A]}function Hs($){var A=-1,K=Array($.size);return $.forEach(function(ee,ze){K[++A]=[ze,ee]}),K}function Fp($,A){return function(K){return $(A(K))}}function Up($){var A=-1,K=Array($.size);return $.forEach(function(ee){K[++A]=ee}),K}var Kp=Array.prototype,Hp=Function.prototype,Ui=Object.prototype,Wo=We["__core-js_shared__"],qw=Hp.toString,Or=Ui.hasOwnProperty,Qw=function(){var $=/[^.]+$/.exec(Wo&&Wo.keys&&Wo.keys.IE_PROTO||"");return $?"Symbol(src)_1."+$:""}(),Zw=Ui.toString,JM=RegExp("^"+qw.call(Or).replace(Z,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Jw=Ho?We.Buffer:void 0,ju=We.Symbol,ex=We.Uint8Array,tx=Ui.propertyIsEnumerable,eA=Kp.splice,Vs=ju?ju.toStringTag:void 0,nx=Object.getOwnPropertySymbols,tA=Jw?Jw.isBuffer:void 0,nA=Fp(Object.keys,Object),Vp=Ki(We,"DataView"),gl=Ki(We,"Map"),Wp=Ki(We,"Promise"),Yp=Ki(We,"Set"),Xp=Ki(We,"WeakMap"),ml=Ki(Object,"create"),rA=Xs(Vp),oA=Xs(gl),sA=Xs(Wp),iA=Xs(Yp),aA=Xs(Xp),rx=ju?ju.prototype:void 0,Gp=rx?rx.valueOf:void 0;function Ws($){var A=-1,K=$==null?0:$.length;for(this.clear();++A<K;){var ee=$[A];this.set(ee[0],ee[1])}}function lA(){this.__data__=ml?ml(null):{},this.size=0}function cA($){var A=this.has($)&&delete this.__data__[$];return this.size-=A?1:0,A}function uA($){var A=this.__data__;if(ml){var K=A[$];return K===r?void 0:K}return Or.call(A,$)?A[$]:void 0}function dA($){var A=this.__data__;return ml?A[$]!==void 0:Or.call(A,$)}function hA($,A){var K=this.__data__;return this.size+=this.has($)?0:1,K[$]=ml&&A===void 0?r:A,this}Ws.prototype.clear=lA,Ws.prototype.delete=cA,Ws.prototype.get=uA,Ws.prototype.has=dA,Ws.prototype.set=hA;function ao($){var A=-1,K=$==null?0:$.length;for(this.clear();++A<K;){var ee=$[A];this.set(ee[0],ee[1])}}function fA(){this.__data__=[],this.size=0}function pA($){var A=this.__data__,K=zu(A,$);if(K<0)return!1;var ee=A.length-1;return K==ee?A.pop():eA.call(A,K,1),--this.size,!0}function gA($){var A=this.__data__,K=zu(A,$);return K<0?void 0:A[K][1]}function mA($){return zu(this.__data__,$)>-1}function yA($,A){var K=this.__data__,ee=zu(K,$);return ee<0?(++this.size,K.push([$,A])):K[ee][1]=A,this}ao.prototype.clear=fA,ao.prototype.delete=pA,ao.prototype.get=gA,ao.prototype.has=mA,ao.prototype.set=yA;function Ys($){var A=-1,K=$==null?0:$.length;for(this.clear();++A<K;){var ee=$[A];this.set(ee[0],ee[1])}}function vA(){this.size=0,this.__data__={hash:new Ws,map:new(gl||ao),string:new Ws}}function wA($){var A=Bu(this,$).delete($);return this.size-=A?1:0,A}function xA($){return Bu(this,$).get($)}function SA($){return Bu(this,$).has($)}function bA($,A){var K=Bu(this,$),ee=K.size;return K.set($,A),this.size+=K.size==ee?0:1,this}Ys.prototype.clear=vA,Ys.prototype.delete=wA,Ys.prototype.get=xA,Ys.prototype.has=SA,Ys.prototype.set=bA;function Nu($){var A=-1,K=$==null?0:$.length;for(this.__data__=new Ys;++A<K;)this.add($[A])}function PA($){return this.__data__.set($,r),this}function EA($){return this.__data__.has($)}Nu.prototype.add=Nu.prototype.push=PA,Nu.prototype.has=EA;function Yo($){var A=this.__data__=new ao($);this.size=A.size}function _A(){this.__data__=new ao,this.size=0}function CA($){var A=this.__data__,K=A.delete($);return this.size=A.size,K}function IA($){return this.__data__.get($)}function kA($){return this.__data__.has($)}function $A($,A){var K=this.__data__;if(K instanceof ao){var ee=K.__data__;if(!gl||ee.length<t-1)return ee.push([$,A]),this.size=++K.size,this;K=this.__data__=new Ys(ee)}return K.set($,A),this.size=K.size,this}Yo.prototype.clear=_A,Yo.prototype.delete=CA,Yo.prototype.get=IA,Yo.prototype.has=kA,Yo.prototype.set=$A;function TA($,A){var K=Fu($),ee=!K&&VA($),ze=!K&&!ee&&qp($),ge=!K&&!ee&&!ze&&hx($),it=K||ee||ze||ge,vt=it?ur($.length,String):[],Et=vt.length;for(var Je in $)(A||Or.call($,Je))&&!(it&&(Je=="length"||ze&&(Je=="offset"||Je=="parent")||ge&&(Je=="buffer"||Je=="byteLength"||Je=="byteOffset")||BA(Je,Et)))&&vt.push(Je);return vt}function zu($,A){for(var K=$.length;K--;)if(lx($[K][0],A))return K;return-1}function MA($,A,K){var ee=A($);return Fu($)?ee:io(ee,K($))}function yl($){return $==null?$===void 0?T:x:Vs&&Vs in Object($)?NA($):HA($)}function ox($){return vl($)&&yl($)==a}function sx($,A,K,ee,ze){return $===A?!0:$==null||A==null||!vl($)&&!vl(A)?$!==$&&A!==A:AA($,A,K,ee,sx,ze)}function AA($,A,K,ee,ze,ge){var it=Fu($),vt=Fu(A),Et=it?l:Xo($),Je=vt?l:Xo(A);Et=Et==a?S:Et,Je=Je==a?S:Je;var En=Et==S,dr=Je==S,Lt=Et==Je;if(Lt&&qp($)){if(!qp(A))return!1;it=!0,En=!1}if(Lt&&!En)return ge||(ge=new Yo),it||hx($)?ix($,A,K,ee,ze,ge):LA($,A,Et,K,ee,ze,ge);if(!(K&o)){var Un=En&&Or.call($,"__wrapped__"),Kn=dr&&Or.call(A,"__wrapped__");if(Un||Kn){var Go=Un?$.value():$,lo=Kn?A.value():A;return ge||(ge=new Yo),ze(Go,lo,K,ee,ge)}}return Lt?(ge||(ge=new Yo),jA($,A,K,ee,ze,ge)):!1}function OA($){if(!dx($)||UA($))return!1;var A=cx($)?JM:Ee;return A.test(Xs($))}function RA($){return vl($)&&ux($.length)&&!!ue[yl($)]}function DA($){if(!KA($))return nA($);var A=[];for(var K in Object($))Or.call($,K)&&K!="constructor"&&A.push(K);return A}function ix($,A,K,ee,ze,ge){var it=K&o,vt=$.length,Et=A.length;if(vt!=Et&&!(it&&Et>vt))return!1;var Je=ge.get($);if(Je&&ge.get(A))return Je==A;var En=-1,dr=!0,Lt=K&s?new Nu:void 0;for(ge.set($,A),ge.set(A,$);++En<vt;){var Un=$[En],Kn=A[En];if(ee)var Go=it?ee(Kn,Un,En,A,$,ge):ee(Un,Kn,En,$,A,ge);if(Go!==void 0){if(Go)continue;dr=!1;break}if(Lt){if(!Bn(A,function(lo,Gs){if(!qt(Lt,Gs)&&(Un===lo||ze(Un,lo,K,ee,ge)))return Lt.push(Gs)})){dr=!1;break}}else if(!(Un===Kn||ze(Un,Kn,K,ee,ge))){dr=!1;break}}return ge.delete($),ge.delete(A),dr}function LA($,A,K,ee,ze,ge,it){switch(K){case z:if($.byteLength!=A.byteLength||$.byteOffset!=A.byteOffset)return!1;$=$.buffer,A=A.buffer;case O:return!($.byteLength!=A.byteLength||!ge(new ex($),new ex(A)));case u:case d:case y:return lx(+$,+A);case h:return $.name==A.name&&$.message==A.message;case C:case I:return $==A+"";case m:var vt=Hs;case _:var Et=ee&o;if(vt||(vt=Up),$.size!=A.size&&!Et)return!1;var Je=it.get($);if(Je)return Je==A;ee|=s,it.set($,A);var En=ix(vt($),vt(A),ee,ze,ge,it);return it.delete($),En;case k:if(Gp)return Gp.call($)==Gp.call(A)}return!1}function jA($,A,K,ee,ze,ge){var it=K&o,vt=ax($),Et=vt.length,Je=ax(A),En=Je.length;if(Et!=En&&!it)return!1;for(var dr=Et;dr--;){var Lt=vt[dr];if(!(it?Lt in A:Or.call(A,Lt)))return!1}var Un=ge.get($);if(Un&&ge.get(A))return Un==A;var Kn=!0;ge.set($,A),ge.set(A,$);for(var Go=it;++dr<Et;){Lt=vt[dr];var lo=$[Lt],Gs=A[Lt];if(ee)var fx=it?ee(Gs,lo,Lt,A,$,ge):ee(lo,Gs,Lt,$,A,ge);if(!(fx===void 0?lo===Gs||ze(lo,Gs,K,ee,ge):fx)){Kn=!1;break}Go||(Go=Lt=="constructor")}if(Kn&&!Go){var Uu=$.constructor,Ku=A.constructor;Uu!=Ku&&"constructor"in $&&"constructor"in A&&!(typeof Uu=="function"&&Uu instanceof Uu&&typeof Ku=="function"&&Ku instanceof Ku)&&(Kn=!1)}return ge.delete($),ge.delete(A),Kn}function ax($){return MA($,XA,zA)}function Bu($,A){var K=$.__data__;return FA(A)?K[typeof A=="string"?"string":"hash"]:K.map}function Ki($,A){var K=Lu($,A);return OA(K)?K:void 0}function NA($){var A=Or.call($,Vs),K=$[Vs];try{$[Vs]=void 0;var ee=!0}catch{}var ze=Zw.call($);return ee&&(A?$[Vs]=K:delete $[Vs]),ze}var zA=nx?function($){return $==null?[]:($=Object($),Vo(nx($),function(A){return tx.call($,A)}))}:GA,Xo=yl;(Vp&&Xo(new Vp(new ArrayBuffer(1)))!=z||gl&&Xo(new gl)!=m||Wp&&Xo(Wp.resolve())!=b||Yp&&Xo(new Yp)!=_||Xp&&Xo(new Xp)!=M)&&(Xo=function($){var A=yl($),K=A==S?$.constructor:void 0,ee=K?Xs(K):"";if(ee)switch(ee){case rA:return z;case oA:return m;case sA:return b;case iA:return _;case aA:return M}return A});function BA($,A){return A=A??i,!!A&&(typeof $=="number"||ke.test($))&&$>-1&&$%1==0&&$<A}function FA($){var A=typeof $;return A=="string"||A=="number"||A=="symbol"||A=="boolean"?$!=="__proto__":$===null}function UA($){return!!Qw&&Qw in $}function KA($){var A=$&&$.constructor,K=typeof A=="function"&&A.prototype||Ui;return $===K}function HA($){return Zw.call($)}function Xs($){if($!=null){try{return qw.call($)}catch{}try{return $+""}catch{}}return""}function lx($,A){return $===A||$!==$&&A!==A}var VA=ox(function(){return arguments}())?ox:function($){return vl($)&&Or.call($,"callee")&&!tx.call($,"callee")},Fu=Array.isArray;function WA($){return $!=null&&ux($.length)&&!cx($)}var qp=tA||qA;function YA($,A){return sx($,A)}function cx($){if(!dx($))return!1;var A=yl($);return A==f||A==p||A==c||A==P}function ux($){return typeof $=="number"&&$>-1&&$%1==0&&$<=i}function dx($){var A=typeof $;return $!=null&&(A=="object"||A=="function")}function vl($){return $!=null&&typeof $=="object"}var hx=cr?Fn(cr):RA;function XA($){return WA($)?TA($):DA($)}function GA(){return[]}function qA(){return!1}e.exports=YA})(sf,sf.exports);var Nj=sf.exports;const zj=Qa(Nj);function Bj(e){if(e.length===0)return new Set;const n=e[0],t=e.slice(1),r=new Set;for(const o of n)t.every(s=>s.has(o))&&r.add(o);return r}function Fj(e,n){const t={};for(const r of n)e.has(r)||(t.added??(t.added=new Set),t.added.add(r));for(const r of e)n.has(r)||(t.removed??(t.removed=new Set),t.removed.add(r));return t.added||t.removed?t:void 0}function Ib(e,n){for(const[t,r]of Object.entries(e)){const o=r,s=n[t];if("eq"in o&&s!==o.eq||"neq"in o&&s===o.neq||"gt"in o&&(typeof s!="number"||s<=o.gt))return!1}return!0}function kb(e,n,t){const r=Object.fromEntries(Object.keys(t).map(o=>[o,new Set]));for(const[o,s]of Object.entries(t))if("eq"in s){const a=e.index(n,o).value.get(s.eq);if(a)for(const l of a)r[o].add(l)}else if("neq"in s){const i=e.index(n,o);for(const[a,l]of i.value)if(a!==s.neq)for(const c of l)r[o].add(c)}else if("gt"in s){const i=e.index(n,o);for(const[a,l]of i.value)if(a>s.gt)for(const c of l)r[o].add(c)}return Bj(Object.values(r))}class Uj{constructor(n,t){v(this,"indexCache",new Map);v(this,"historyCache",new Map);this.atoms=n,this.history=t}filterHistory(n){if(this.historyCache.has(n))return this.historyCache.get(n);const t=G("filterHistory:"+n,(r,o)=>{if(Ma(r))return this.history.value;const s=this.history.getDiffSince(o);if(s===Rn)return this.history.value;const i={added:{},removed:{},updated:{}};let a=0,l=0,c=0;for(const u of s){for(const d of lt(u.added))if(d.typeName===n)if(i.removed[d.id]){const h=i.removed[d.id];delete i.removed[d.id],l--,h!==d&&(i.updated[d.id]=[h,d],c++)}else i.added[d.id]=d,a++;for(const[d,h]of lt(u.updated))h.typeName===n&&(i.added[h.id]?i.added[h.id]=h:i.updated[h.id]?i.updated[h.id]=[i.updated[h.id][0],h]:(i.updated[h.id]=[d,h],c++));for(const d of lt(u.removed))d.typeName===n&&(i.added[d.id]?(delete i.added[d.id],a--):i.updated[d.id]?(i.removed[d.id]=i.updated[d.id][0],delete i.updated[d.id],c--,l++):(i.removed[d.id]=d,l++))}return a||l||c?ql(this.history.value,i):r},{historyLength:100});return this.historyCache.set(n,t),t}index(n,t){const r=n+":"+t;if(this.indexCache.has(r))return this.indexCache.get(r);const o=this.__uncached_createIndex(n,t);return this.indexCache.set(r,o),o}__uncached_createIndex(n,t){const r=this.filterHistory(n),o=()=>{r.value;const s=new Map;for(const i of lt(this.atoms.value)){const a=i.value;if(a.typeName===n){const l=a[t];s.has(l)||s.set(l,new Set),s.get(l).add(a.id)}}return s};return G("index:"+n+":"+t,(s,i)=>{if(Ma(s))return o();const a=r.getDiffSince(i);if(a===Rn)return o();const l=new Map,c=(f,p)=>{let m=l.get(f);m||(m=new oh(s.get(f)??new Set)),m.add(p),l.set(f,m)},u=(f,p)=>{let m=l.get(f);m||(m=new oh(s.get(f)??new Set)),m.remove(p),l.set(f,m)};for(const f of a){for(const p of lt(f.added))if(p.typeName===n){const m=p[t];c(m,p.id)}for(const[p,m]of lt(f.updated))if(m.typeName===n){const y=p[t],x=m[t];y!==x&&(u(y,m.id),c(x,m.id))}for(const p of lt(f.removed))if(p.typeName===n){const m=p[t];u(m,p.id)}}let d,h;for(const[f,p]of l){const m=p.get();m&&(d||(d=new Map(s)),h||(h=new Map),m.value.size===0?d.delete(f):d.set(f,m.value),h.set(f,m.diff))}return d&&h?ql(d,h):s},{historyLength:100})}record(n,t=()=>({}),r="record:"+n+(t?":"+t.toString():"")){const o=this.ids(n,t,r);return G(r,()=>{var s;for(const i of o.value)return(s=this.atoms.value[i])==null?void 0:s.value})}records(n,t=()=>({}),r="records:"+n+(t?":"+t.toString():"")){const o=this.ids(n,t,"ids:"+r);return G(r,()=>[...o.value].map(s=>{const i=this.atoms.value[s];if(!i)throw new Error("no atom found for record id: "+s);return i.value}))}ids(n,t=()=>({}),r="ids:"+n+(t?":"+t.toString():"")){const o=this.filterHistory(n),s=()=>{o.value;const l=t();return Object.keys(l).length===0?new Set(lt(this.atoms.value).flatMap(c=>{const u=c.value;return u.typeName===n?u.id:[]})):kb(this,n,l)},i=l=>{const c=s(),u=Fj(l,c);return u?ql(c,u):l},a=G("ids_query:"+r,t,{isEqual:zj});return G("query:"+r,(l,c)=>{const u=a.value;if(Ma(l))return s();if(c<a.lastChangedEpoch)return i(l);const d=o.getDiffSince(c);if(d===Rn)return i(l);const h=new oh(l);for(const p of d){for(const m of lt(p.added))m.typeName===n&&Ib(u,m)&&h.add(m.id);for(const[m,y]of lt(p.updated))y.typeName===n&&(Ib(u,y)?h.add(y.id):h.remove(y.id));for(const m of lt(p.removed))m.typeName===n&&h.remove(m.id)}const f=h.get();return f?ql(f.value,f.diff):l},{historyLength:50})}exec(n,t){const r=kb(this,n,t);if(r.size===0)return br;const o=this.atoms.value;return[...r].map(s=>o[s].value)}}class FI{constructor(n){v(this,"id",BI());v(this,"atoms",dt("store_atoms",{}));v(this,"history",dt("history",0,{historyLength:1e3}));v(this,"query",new Uj(this.atoms,this.history));v(this,"listeners",new Set);v(this,"historyAccumulator",new Hj);v(this,"historyReactor");v(this,"schema");v(this,"props");v(this,"scopedTypes");v(this,"onAfterCreate");v(this,"onAfterChange");v(this,"onBeforeDelete");v(this,"onAfterDelete");v(this,"_runCallbacks",!0);v(this,"put",(n,t)=>{Gn(()=>{const r={},o={},s=this.atoms.__unsafe__getWithoutCapture();let i=null,a,l=!1;for(let d=0,h=n.length;d<h;d++){a=n[d];const f=(i??s)[a.id];if(f){const p=f.__unsafe__getWithoutCapture();a=this.schema.validateRecord(this,a,t??"updateRecord",p),f.set(a);const m=f.__unsafe__getWithoutCapture();p!==m&&(l=!0,r[a.id]=[p,m])}else l=!0,a=this.schema.validateRecord(this,a,t??"createRecord",null),o[a.id]=a,i||(i={...s}),i[a.id]=dt("atom:"+a.id,a)}if(i&&this.atoms.set(i),!l)return;this.updateHistory({added:o,updated:r,removed:{}});const{onAfterCreate:c,onAfterChange:u}=this;c&&this._runCallbacks&&Object.values(o).forEach(d=>{c(d)}),u&&this._runCallbacks&&Object.values(r).forEach(([d,h])=>{u(d,h)})})});v(this,"remove",n=>{Gn(()=>{if(this.onBeforeDelete&&this._runCallbacks)for(const r of n){const o=this.atoms.__unsafe__getWithoutCapture()[r];o&&this.onBeforeDelete(o.value)}let t;if(this.atoms.update(r=>{let o;for(const s of n)s in r&&(o||(o={...r}),t||(t={}),delete o[s],t[s]=r[s].value);return o??r}),!!t&&(this.updateHistory({added:{},updated:{},removed:t}),this.onAfterDelete&&this._runCallbacks))for(let r=0,o=n.length;r<o;r++)this.onAfterDelete(t[n[r]])})});v(this,"get",n=>{var t;return(t=this.atoms.value[n])==null?void 0:t.value});v(this,"unsafeGetWithoutCapture",n=>{var t;return(t=this.atoms.value[n])==null?void 0:t.__unsafe__getWithoutCapture()});v(this,"serialize",(n="document")=>{const t={};for(const[r,o]of xo(this.atoms.value)){const s=o.value;(n==="all"||this.scopedTypes[n].has(s.typeName))&&(t[r]=s)}return t});v(this,"allRecords",()=>lt(this.atoms.value).map(n=>n.value));v(this,"clear",()=>{this.remove(Eb(this.atoms.value))});v(this,"update",(n,t)=>{const r=this.atoms.value[n];if(!r){console.error(`Record ${n} not found. This is probably an error`);return}this.put([t(r.__unsafe__getWithoutCapture())])});v(this,"has",n=>!!this.atoms.value[n]);v(this,"listen",(n,t)=>{this._flushHistory();const r={onHistory:n,filters:{source:(t==null?void 0:t.source)??"all",scope:(t==null?void 0:t.scope)??"all"}};return this.listeners.add(r),this.historyReactor.scheduler.isActivelyListening||this.historyReactor.start(),()=>{this.listeners.delete(r),this.listeners.size===0&&this.historyReactor.stop()}});v(this,"isMergingRemoteChanges",!1);v(this,"mergeRemoteChanges",n=>{if(this.isMergingRemoteChanges)return n();try{this.isMergingRemoteChanges=!0,Gn(n)}finally{this.isMergingRemoteChanges=!1}});v(this,"createComputedCache",(n,t)=>{const r=new Cb;return{get:o=>{const s=this.atoms.value[o];if(s)return r.get(s,()=>G(n+":"+o,()=>t(s.value))).value}}});v(this,"createSelectedComputedCache",(n,t,r)=>{const o=new Cb;return{get:s=>{const i=this.atoms.value[s];if(!i)return;const a=G(n+":"+s+":selector",()=>t(i.value));return o.get(i,()=>G(n+":"+s,()=>r(a.value))).value}}});v(this,"_integrityChecker");v(this,"_isPossiblyCorrupted",!1);const{initialData:t,schema:r}=n;this.schema=r,this.props=n.props,t&&this.atoms.set(zI(xo(t).map(([o,s])=>[o,dt("atom:"+o,this.schema.validateRecord(this,s,"initialize",null))]))),this.historyReactor=Cj("Store.historyReactor",()=>{this.history.value,this._flushHistory()},{scheduleEffect:o=>Dj(o)}),this.scopedTypes={document:new Set(lt(this.schema.types).filter(o=>o.scope==="document").map(o=>o.typeName)),session:new Set(lt(this.schema.types).filter(o=>o.scope==="session").map(o=>o.typeName)),presence:new Set(lt(this.schema.types).filter(o=>o.scope==="presence").map(o=>o.typeName))}}_flushHistory(){if(this.historyAccumulator.hasChanges()){const n=this.historyAccumulator.flush();for(const{changes:t,source:r}of n){let o=null,s=null,i=null;for(const{onHistory:a,filters:l}of this.listeners)if(!(l.source!=="all"&&l.source!==r))if(l.scope!=="all")if(l.scope==="document"){if(s??(s=this.filterChangesByScope(t,"document")),!s)continue;a({changes:s,source:r})}else if(l.scope==="session"){if(o??(o=this.filterChangesByScope(t,"session")),!o)continue;a({changes:o,source:r})}else{if(i??(i=this.filterChangesByScope(t,"presence")),!i)continue;a({changes:i,source:r})}else a({changes:t,source:r})}}}filterChangesByScope(n,t){const r={added:Wg(n.added,(o,s)=>this.scopedTypes[t].has(s.typeName)),updated:Wg(n.updated,(o,s)=>this.scopedTypes[t].has(s[1].typeName)),removed:Wg(n.removed,(o,s)=>this.scopedTypes[t].has(s.typeName))};return Object.keys(r.added).length===0&&Object.keys(r.updated).length===0&&Object.keys(r.removed).length===0?null:r}updateHistory(n){this.historyAccumulator.add({changes:n,source:this.isMergingRemoteChanges?"remote":"user"}),this.listeners.size===0&&this.historyAccumulator.clear(),this.history.set(this.history.value+1,n)}validate(n){this.allRecords().forEach(t=>this.schema.validateRecord(this,t,n,null))}getSnapshot(n="document"){return{store:this.serialize(n),schema:this.schema.serialize()}}loadSnapshot(n){const t=this.schema.migrateStoreSnapshot(n);if(t.type==="error")throw new Error(`Failed to migrate snapshot: ${t.reason}`);Gn(()=>{this.clear(),this.put(Object.values(t.value)),this.ensureStoreIsUsable()})}extractingChanges(n){const t=[],r=this.historyAccumulator.intercepting(o=>t.push(o.changes));try{return Gn(n),up(t)}finally{r()}}applyDiff(n,t=!0){const r=this._runCallbacks;try{this._runCallbacks=t,Gn(()=>{const o=lt(n.added).concat(lt(n.updated).map(([i,a])=>a)),s=Eb(n.removed);o.length&&this.put(o),s.length&&this.remove(s)})}finally{this._runCallbacks=r}}ensureStoreIsUsable(){var n;this._integrityChecker??(this._integrityChecker=this.schema.createIntegrityChecker(this)),(n=this._integrityChecker)==null||n.call(this)}markAsPossiblyCorrupted(){this._isPossiblyCorrupted=!0}isPossiblyCorrupted(){return this._isPossiblyCorrupted}}function up(e){const n={added:{},removed:{},updated:{}};for(const t of e){for(const[r,o]of xo(t.added))if(n.removed[r]){const s=n.removed[r];delete n.removed[r],s!==o&&(n.updated[r]=[s,o])}else n.added[r]=o;for(const[r,[o,s]]of xo(t.updated)){if(n.added[r]){n.added[r]=s,delete n.updated[r],delete n.removed[r];continue}if(n.updated[r]){n.updated[r][1]=s,delete n.removed[r];continue}n.updated[r]=t.updated[r],delete n.removed[r]}for(const[r,o]of xo(t.removed))n.added[r]?delete n.added[r]:n.updated[r]?(n.removed[r]=n.updated[r][0],delete n.updated[r]):n.removed[r]=o}return n}function Kj(e){const n=[];let t=e[0],r;for(let o=1,s=e.length;o<s;o++)r=e[o],t.source!==r.source?(n.push(t),t=r):t={source:t.source,changes:up([t.changes,r.changes])};return n.push(t),n}class Hj{constructor(){v(this,"_history",[]);v(this,"_interceptors",new Set)}intercepting(n){return this._interceptors.add(n),()=>{this._interceptors.delete(n)}}add(n){this._history.push(n);for(const t of this._interceptors)t(n)}flush(){const n=Kj(this._history);return this._history=[],n}clear(){this._history=[]}hasChanges(){return this._history.length>0}}function Vj(e){return typeof e=="object"&&e!==null&&"id"in e&&"typeName"in e}function Pe(e){const{currentVersion:n,firstVersion:t,migrators:r={},subTypeKey:o,subTypeMigrations:s}=e;if(typeof n=="number"&&typeof t=="number"){if(n===t)throw Error("Current version is equal to initial version.");if(n<t)throw Error("Current version is lower than initial version.")}return{firstVersion:t??0,currentVersion:n??0,migrators:r,subTypeKey:o,subTypeMigrations:s}}var Ql=(e=>(e.IncompatibleSubtype="incompatible-subtype",e.UnknownType="unknown-type",e.TargetVersionTooNew="target-version-too-new",e.TargetVersionTooOld="target-version-too-old",e.MigrationError="migration-error",e.UnrecognizedSubtype="unrecognized-subtype",e))(Ql||{});function hd({record:e,migrations:n,fromVersion:t,toVersion:r}){let o=t;if(!Vj(e))throw new Error("[migrateRecord] object is not a record");const{typeName:s,id:i,...a}=e;let l=a;for(;o<r;){const c=o+1,u=n.migrators[c];if(!u)return{type:"error",reason:"target-version-too-new"};l=u.up(l),o=c}for(;o>r;){const c=o-1,u=n.migrators[o];if(!u)return{type:"error",reason:"target-version-too-old"};l=u.down(l),o=c}return{type:"success",value:{...l,id:i,typeName:s}}}function C1({value:e,migrations:n,fromVersion:t,toVersion:r}){let o=t;for(;o<r;){const s=o+1,i=n.migrators[s];if(!i)return{type:"error",reason:"target-version-too-new"};e=i.up(e),o=s}for(;o>r;){const s=o-1,i=n.migrators[o];if(!i)return{type:"error",reason:"target-version-too-old"};e=i.down(e),o=s}return{type:"success",value:e}}class I1{constructor(n,t){this.types=n,this.options=t}static create(n,t){return new I1(n,t??{})}get currentStoreVersion(){var n;return((n=this.options.snapshotMigrations)==null?void 0:n.currentVersion)??0}validateRecord(n,t,r,o){try{const s=gi(this.types,t.typeName);if(!s)throw new Error(`Missing definition for record type ${t.typeName}`);return s.validate(t)}catch(s){if(this.options.onValidationFailure)return this.options.onValidationFailure({store:n,record:t,phase:r,recordBefore:o,error:s});throw s}}migratePersistedRecord(n,t,r="up"){var d;const o=gi(this.types,n.typeName),s=t.recordVersions[n.typeName];if(!s||!o)return{type:"error",reason:Ql.UnknownType};const i=o.migrations.currentVersion,a=s.version;if(i!==a){const h=hd(r==="up"?{record:n,migrations:o.migrations,fromVersion:a,toVersion:i}:{record:n,migrations:o.migrations,fromVersion:i,toVersion:a});if(h.type==="error")return h;n=h.value}if(!o.migrations.subTypeKey)return{type:"success",value:n};const l=(d=o.migrations.subTypeMigrations)==null?void 0:d[n[o.migrations.subTypeKey]],c="subTypeVersions"in s?s.subTypeVersions[n[o.migrations.subTypeKey]]:void 0;if(l===void 0)return{type:"error",reason:Ql.UnrecognizedSubtype};if(c===void 0)return{type:"error",reason:Ql.IncompatibleSubtype};const u=hd(r==="up"?{record:n,migrations:l,fromVersion:c,toVersion:l.currentVersion}:{record:n,migrations:l,fromVersion:l.currentVersion,toVersion:c});return u.type==="error"?u:{type:"success",value:u.value}}migrateStoreSnapshot(n){let{store:t}=n;const r=this.options.snapshotMigrations;if(!r)return{type:"success",value:t};const o=r.currentVersion,s=n.schema.storeVersion??0;if(o<s)return{type:"error",reason:Ql.TargetVersionTooOld};if(o>s){const a=C1({value:t,migrations:r,fromVersion:s,toVersion:o});if(a.type==="error")return a;t=a.value}const i=[];for(const a of lt(t)){const l=this.migratePersistedRecord(a,n.schema);if(l.type==="error")return l;l.value&&l.value!==a&&i.push(l.value)}if(i.length){t={...t};for(const a of i)t[a.id]=a}return{type:"success",value:t}}createIntegrityChecker(n){var t,r;return((r=(t=this.options).createIntegrityChecker)==null?void 0:r.call(t,n))??void 0}serialize(){var n;return{schemaVersion:1,storeVersion:((n=this.options.snapshotMigrations)==null?void 0:n.currentVersion)??0,recordVersions:Object.fromEntries(lt(this.types).map(t=>[t.typeName,t.migrations.subTypeKey&&t.migrations.subTypeMigrations?{version:t.migrations.currentVersion,subTypeKey:t.migrations.subTypeKey,subTypeVersions:t.migrations.subTypeMigrations?Object.fromEntries(Object.entries(t.migrations.subTypeMigrations).map(([r,o])=>[r,o.currentVersion])):void 0}:{version:t.migrations.currentVersion}]))}}serializeEarliestVersion(){var n;return{schemaVersion:1,storeVersion:((n=this.options.snapshotMigrations)==null?void 0:n.firstVersion)??0,recordVersions:Object.fromEntries(lt(this.types).map(t=>[t.typeName,t.migrations.subTypeKey&&t.migrations.subTypeMigrations?{version:t.migrations.firstVersion,subTypeKey:t.migrations.subTypeKey,subTypeVersions:t.migrations.subTypeMigrations?Object.fromEntries(Object.entries(t.migrations.subTypeMigrations).map(([r,o])=>[r,o.firstVersion])):void 0}:{version:t.migrations.firstVersion}]))}}}const Wj=(e,n)=>{if(e.schemaVersion>n.schemaVersion)return 1;if(e.schemaVersion<n.schemaVersion)return-1;if(e.storeVersion>n.storeVersion)return 1;if(e.storeVersion<n.storeVersion)return-1;for(const t of Object.keys(e.recordVersions)){const r=e.recordVersions[t],o=n.recordVersions[t];if(r.version>o.version)return 1;if(r.version<o.version)return-1;if("subTypeVersions"in r&&!("subTypeVersions"in o))return 1;if(!("subTypeVersions"in r)&&"subTypeVersions"in o)return-1;if(!(!("subTypeVersions"in r)||!("subTypeVersions"in o)))for(const s of Object.keys(r.subTypeVersions)){const i=r.subTypeVersions[s],a=o.subTypeVersions[s];if(i>a)return 1;if(i<a)return-1}}return 0};function Yj(e){if(!e.length)return null;let n="";for(const t of e)typeof t=="number"?n+=`.${t}`:t.startsWith("(")?n.endsWith(")")?n=`${n.slice(0,-1)}, ${t.slice(1)}`:n+=t:n+=`.${t}`;return n.startsWith(".")?n.slice(1):n}class Qe extends Error{constructor(t,r=[]){const o=Yj(r),s=t.split(`
`).map((i,a)=>a===0?i:`  ${i}`).join(`
`);super(r?`At ${o}: ${s}`:s);v(this,"name","ValidationError");this.rawMessage=t,this.path=r}}function sl(e,n){try{return n()}catch(t){throw t instanceof Qe?new Qe(t.rawMessage,[e,...t.path]):new Qe(t.toString(),[e])}}function Ha(e){if(e===null)return"null";if(Array.isArray(e))return"an array";const n=typeof e;switch(n){case"bigint":case"boolean":case"function":case"number":case"string":case"symbol":return`a ${n}`;case"object":return`an ${n}`;case"undefined":return"undefined";default:P1(n)}}class cn{constructor(n){this.validationFn=n}validate(n){return this.validationFn(n)}nullable(){return Jj(this)}optional(){return KI(this)}refine(n){return new cn(t=>n(this.validate(t)))}check(n,t){return typeof n=="string"?this.refine(r=>(sl(`(check ${n})`,()=>t(r)),r)):this.refine(r=>(n(r),r))}}class Xj extends cn{constructor(n){super(t=>{const r=Qj.validate(t);for(let o=0;o<r.length;o++)sl(o,()=>n.validate(r[o]));return r}),this.itemValidator=n}nonEmpty(){return this.check(n=>{if(n.length===0)throw new Qe("Expected a non-empty array")})}lengthGreaterThan1(){return this.check(n=>{if(n.length<=1)throw new Qe("Expected an array with length greater than 1")})}}class af extends cn{constructor(n,t=!1){super(r=>{if(typeof r!="object"||r===null)throw new Qe(`Expected object, got ${Ha(r)}`);for(const[o,s]of Object.entries(n))sl(o,()=>{s.validate(gi(r,o))});if(!t){for(const o of Object.keys(r))if(!Dc(n,o))throw new Qe("Unexpected property",[o])}return r}),this.config=n,this.shouldAllowUnknownProperties=t}allowUnknownProperties(){return new af(this.config,!0)}extend(n){return new af({...this.config,...n})}}class k1 extends cn{constructor(n,t,r){super(o=>{if(typeof o!="object"||o===null)throw new Qe(`Expected an object, got ${Ha(o)}`,[]);const s=gi(o,n);if(typeof s!="string")throw new Qe(`Expected a string for key "${n}", got ${Ha(s)}`);const i=Dc(t,s)?t[s]:void 0;return i===void 0?this.unknownValueValidation(o,s):sl(`(${n} = ${s})`,()=>i.validate(o))}),this.key=n,this.config=t,this.unknownValueValidation=r}validateUnknownVariants(n){return new k1(this.key,this.config,n)}}class Gj extends cn{constructor(n,t){super(r=>{if(typeof r!="object"||r===null)throw new Qe(`Expected object, got ${Ha(r)}`);for(const[o,s]of Object.entries(r))sl(o,()=>{n.validate(o),t.validate(s)});return r}),this.keyValidator=n,this.valueValidator=t}}function $1(e){return new cn(n=>{if(typeof n!==e)throw new Qe(`Expected ${e}, got ${Ha(n)}`);return n})}const qj=new cn(e=>e),pe=$1("string"),fe=$1("number").check(e=>{if(Number.isNaN(e))throw new Qe("Expected a number, got NaN");if(!Number.isFinite(e))throw new Qe(`Expected a finite number, got ${e}`)}),T1=fe.check(e=>{if(e<0)throw new Qe(`Expected a positive number, got ${e}`)}),wn=fe.check(e=>{if(e<=0)throw new Qe(`Expected a non-zero positive number, got ${e}`)}),UI=fe.check(e=>{if(!Number.isInteger(e))throw new Qe(`Expected an integer, got ${e}`)});UI.check(e=>{if(e<0)throw new Qe(`Expected a positive integer, got ${e}`)});UI.check(e=>{if(e<=0)throw new Qe(`Expected a non-zero positive integer, got ${e}`)});const Me=$1("boolean");function xn(e){return new cn(n=>{if(n!==e)throw new Qe(`Expected ${e}, got ${JSON.stringify(n)}`);return e})}const Qj=new cn(e=>{if(!Array.isArray(e))throw new Qe(`Expected an array, got ${Ha(e)}`);return e});function Ir(e){return new Xj(e)}function be(e){return new af(e)}function S0(e){return e===null||typeof e=="number"||typeof e=="string"||typeof e=="boolean"?!0:Array.isArray(e)?e.every(S0):typeof e=="object"?Object.values(e).every(S0):!1}const Wr=new cn(e=>{if(S0(e))return e;throw new Qe(`Expected json serializable value, got ${typeof e}`)});function Zj(e,n){return new Gj(e,n)}function M1(e,n){return new k1(e,n,(t,r)=>{throw new Qe(`Expected one of ${Object.keys(n).map(o=>JSON.stringify(o)).join(" or ")}, got ${JSON.stringify(r)}`,[e])})}function No(e,n){return new cn(t=>{const r=t&&typeof t=="object"&&"id"in t&&typeof t.id=="string"?`${e}(id = ${t.id})`:e;return sl(r,()=>n.validate(t))})}function vu(e){return new cn(n=>{if(!e.has(n)){const t=Array.from(e,r=>JSON.stringify(r)).join(" or ");throw new Qe(`Expected ${t}, got ${n}`)}return n})}function KI(e){return new cn(n=>{if(n!==void 0)return e.validate(n)})}function Jj(e){return new cn(n=>n===null?null:e.validate(n))}function HI(...e){return vu(new Set(e))}function kr(e){return pe.refine(n=>{if(!n.startsWith(`${e}:`))throw new Error(`${e} ID must start with "${e}:"`);return n})}const dp=kr("asset");function A1(e,n){return be({id:dp,typeName:xn("asset"),type:xn(e),props:n,meta:Wr})}const e9=No("camera",be({typeName:xn("camera"),id:kr("camera"),x:fe,y:fe,z:fe,meta:Wr})),$b={AddMeta:1},t9=Pe({currentVersion:$b.AddMeta,migrators:{[$b.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...n})=>({...n})}}}),Bt=jo("camera",{validator:e9,migrations:t9,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,z:1,meta:{}})),Lc=be({x:fe,y:fe,z:fe.optional()}),uc=be({x:fe,y:fe,w:fe,h:fe}),n9=new Set(["accent","white","black","selection-stroke","selection-fill","laser","muted-1"]),VI=vu(n9),r9=new Set(["none","default","pointer","cross","grab","rotate","grabbing","resize-edge","resize-corner","text","move","ew-resize","ns-resize","nesw-resize","nwse-resize","nesw-rotate","nwse-rotate","swne-rotate","senw-rotate","zoom-in","zoom-out"]),WI=vu(r9),o9=be({color:VI,type:WI,rotation:fe}),YI=fe.check(e=>{if(e<0||e>1)throw new Qe("Opacity must be between 0 and 1")}),s9=new Set(["starting","paused","active","stopping"]),XI=be({points:Ir(Lc),size:T1,color:VI,opacity:fe,state:vu(s9),delay:fe}),jc=kr("page"),i9=No("page",be({typeName:xn("page"),id:jc,name:pe,index:pe,meta:Wr})),Tb={AddMeta:1},a9=Pe({currentVersion:Tb.AddMeta,migrators:{[Tb.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...n})=>({...n})}}}),Jn=jo("page",{validator:i9,migrations:a9,scope:"document"}).withDefaultProperties(()=>({meta:{}}));function Qt(e){return Jn.isId(e)}kr("instance");function l9(e){const n={};for(const[r,o]of e)n[r]=KI(o);const t=No("instance",be({typeName:xn("instance"),id:kr("instance"),currentPageId:jc,followingUserId:pe.nullable(),brush:uc.nullable(),opacityForNextShape:YI,stylesForNextShape:be(n),cursor:o9,scribble:XI.nullable(),isFocusMode:Me,isDebugMode:Me,isToolLocked:Me,exportBackground:Me,screenBounds:uc,zoomBrush:uc.nullable(),isPenMode:Me,isGridMode:Me,chatMessage:pe,isChatting:Me,highlightedUserIds:Ir(pe),meta:Wr}));return jo("instance",{migrations:c9,validator:t,scope:"session"}).withDefaultProperties(()=>({followingUserId:null,opacityForNextShape:1,stylesForNextShape:{},brush:null,scribble:null,cursor:{type:"default",color:"black",rotation:0},isFocusMode:!1,exportBackground:!1,isDebugMode:!1,isToolLocked:!1,screenBounds:{x:0,y:0,w:1080,h:720},zoomBrush:null,isGridMode:!1,isPenMode:!1,chatMessage:"",isChatting:!1,highlightedUserIds:[],meta:{}}))}const wt={AddTransparentExportBgs:1,RemoveDialog:2,AddToolLockMode:3,RemoveExtraPropsForNextShape:4,AddLabelColor:5,AddFollowingUserId:6,RemoveAlignJustify:7,AddZoom:8,AddVerticalAlign:9,AddScribbleDelay:10,RemoveUserId:11,AddIsPenModeAndIsGridMode:12,HoistOpacity:13,AddChat:14,AddHighlightedUserIds:15,ReplacePropsForNextShapeWithStylesForNextShape:16,AddMeta:17},c9=Pe({currentVersion:wt.AddMeta,migrators:{[wt.AddTransparentExportBgs]:{up:e=>({...e,exportBackground:!0}),down:({exportBackground:e,...n})=>n},[wt.RemoveDialog]:{up:({dialog:e,...n})=>n,down:e=>({...e,dialog:null})},[wt.AddToolLockMode]:{up:e=>({...e,isToolLocked:!1}),down:({isToolLocked:e,...n})=>n},[wt.RemoveExtraPropsForNextShape]:{up:({propsForNextShape:e,...n})=>({...n,propsForNextShape:Object.fromEntries(Object.entries(e).filter(([t])=>["color","labelColor","dash","fill","size","font","align","verticalAlign","icon","geo","arrowheadStart","arrowheadEnd","spline"].includes(t)))}),down:e=>e},[wt.AddLabelColor]:{up:({propsForNextShape:e,...n})=>({...n,propsForNextShape:{...e,labelColor:"black"}}),down:e=>{const{labelColor:n,...t}=e.propsForNextShape;return{...e,propsForNextShape:{...t}}}},[wt.AddFollowingUserId]:{up:e=>({...e,followingUserId:null}),down:({followingUserId:e,...n})=>n},[wt.RemoveAlignJustify]:{up:e=>{let n=e.propsForNextShape.align;return n==="justify"&&(n="start"),{...e,propsForNextShape:{...e.propsForNextShape,align:n}}},down:e=>({...e})},[wt.AddZoom]:{up:e=>({...e,zoomBrush:null}),down:({zoomBrush:e,...n})=>n},[wt.AddVerticalAlign]:{up:e=>({...e,propsForNextShape:{...e.propsForNextShape,verticalAlign:"middle"}}),down:e=>{const{verticalAlign:n,...t}=e.propsForNextShape;return{...e,propsForNextShape:t}}},[wt.AddScribbleDelay]:{up:e=>e.scribble!==null?{...e,scribble:{...e.scribble,delay:0}}:{...e},down:e=>{if(e.scribble!==null){const{delay:n,...t}=e.scribble;return{...e,scribble:t}}return{...e}}},[wt.RemoveUserId]:{up:({userId:e,...n})=>n,down:e=>({...e,userId:"user:none"})},[wt.AddIsPenModeAndIsGridMode]:{up:e=>({...e,isPenMode:!1,isGridMode:!1}),down:({isPenMode:e,isGridMode:n,...t})=>t},[wt.HoistOpacity]:{up:({propsForNextShape:{opacity:e,...n},...t})=>({...t,opacityForNextShape:Number(e??"1"),propsForNextShape:n}),down:({opacityForNextShape:e,...n})=>({...n,propsForNextShape:{...n.propsForNextShape,opacity:e<.175?"0.1":e<.375?"0.25":e<.625?"0.5":e<.875?"0.75":"1"}})},[wt.AddChat]:{up:e=>({...e,chatMessage:"",isChatting:!1}),down:({chatMessage:e,isChatting:n,...t})=>t},[wt.AddHighlightedUserIds]:{up:e=>({...e,highlightedUserIds:[]}),down:({highlightedUserIds:e,...n})=>n},[wt.ReplacePropsForNextShapeWithStylesForNextShape]:{up:({propsForNextShape:e,...n})=>({...n,stylesForNextShape:{}}),down:({stylesForNextShape:e,...n})=>({...n,propsForNextShape:{color:"black",labelColor:"black",dash:"draw",fill:"none",size:"m",icon:"file",font:"draw",align:"middle",verticalAlign:"middle",geo:"rectangle",arrowheadStart:"none",arrowheadEnd:"arrow",spline:"line"}})},[wt.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...n})=>({...n})}}}),hn="instance:instance",u9=pe.refine(e=>{if(!e.startsWith("page:")&&!e.startsWith("shape:"))throw new Error('Parent ID must start with "page:" or "shape:"');return e}),mr=kr("shape");function d9(e,n,t){return be({id:mr,typeName:xn("shape"),x:fe,y:fe,rotation:fe,index:pe,parentId:u9,type:xn(e),isLocked:Me,opacity:YI,props:n?be(n):Wr,meta:t?be(t):Wr})}const h9=No("instance_page_state",be({typeName:xn("instance_page_state"),id:kr("instance_page_state"),pageId:jc,selectedIds:Ir(mr),hintingIds:Ir(mr),erasingIds:Ir(mr),hoveredId:mr.nullable(),editingId:mr.nullable(),croppingId:mr.nullable(),focusLayerId:mr.nullable(),meta:Wr})),fd={AddCroppingId:1,RemoveInstanceIdAndCameraId:2,AddMeta:3},f9=Pe({currentVersion:fd.AddMeta,migrators:{[fd.AddCroppingId]:{up(e){return{...e,croppingId:null}},down({croppingId:e,...n}){return n}},[fd.RemoveInstanceIdAndCameraId]:{up({instanceId:e,cameraId:n,...t}){return t},down(e){return{...e,instanceId:hn,cameraId:Bt.createId("void")}}},[fd.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...n})=>({...n})}}}),Ft=jo("instance_page_state",{migrations:f9,validator:h9,scope:"session"}).withDefaultProperties(()=>({editingId:null,croppingId:null,selectedIds:[],hoveredId:null,erasingIds:[],hintingIds:[],focusLayerId:null,meta:{}})),p9=No("pointer",be({typeName:xn("pointer"),id:kr("pointer"),x:fe,y:fe,lastActivityTimestamp:fe,meta:Wr})),Mb={AddMeta:1},g9=Pe({currentVersion:Mb.AddMeta,migrators:{[Mb.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...n})=>({...n})}}}),O1=jo("pointer",{validator:p9,migrations:g9,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,lastActivityTimestamp:0,meta:{}})),lf=O1.createId("pointer"),m9=No("instance_presence",be({typeName:xn("instance_presence"),id:kr("instance_presence"),userId:pe,userName:pe,lastActivityTimestamp:fe,followingUserId:pe.nullable(),cursor:be({x:fe,y:fe,type:WI,rotation:fe}),color:pe,camera:be({x:fe,y:fe,z:fe}),screenBounds:uc,selectedIds:Ir(kr("shape")),currentPageId:kr("page"),brush:uc.nullable(),scribble:XI.nullable(),chatMessage:pe,meta:Wr})),$l={AddScribbleDelay:1,RemoveInstanceId:2,AddChatMessage:3,AddMeta:4},y9=Pe({currentVersion:$l.AddMeta,migrators:{[$l.AddScribbleDelay]:{up:e=>e.scribble!==null?{...e,scribble:{...e.scribble,delay:0}}:{...e},down:e=>{if(e.scribble!==null){const{delay:n,...t}=e.scribble;return{...e,scribble:t}}return{...e}}},[$l.RemoveInstanceId]:{up:({instanceId:e,...n})=>n,down:e=>({...e,instanceId:hn})},[$l.AddChatMessage]:{up:e=>({...e,chatMessage:""}),down:({chatMessage:e,...n})=>n},[$l.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...n})=>({...n})}}}),v9=jo("instance_presence",{migrations:y9,validator:m9,scope:"presence"}).withDefaultProperties(()=>({lastActivityTimestamp:0,followingUserId:null,color:"#FF0000",camera:{x:0,y:0,z:1},cursor:{x:0,y:0,type:"default",rotation:0},screenBounds:{x:0,y:0,w:1,h:1},selectedIds:[],brush:null,scribble:null,chatMessage:"",meta:{}})),w9=No("document",be({typeName:xn("document"),id:xn("document:document"),gridSize:fe,name:pe,meta:Wr})),Xg={AddName:1,AddMeta:2},x9=Pe({currentVersion:Xg.AddMeta,migrators:{[Xg.AddName]:{up:e=>({...e,name:""}),down:({name:e,...n})=>n},[Xg.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...n})=>({...n})}}}),R1=jo("document",{migrations:x9,validator:w9,scope:"document"}).withDefaultProperties(()=>({gridSize:10,name:"",meta:{}})),b0=R1.createId("document");function S9(e,n){return e.index<n.index?-1:e.index>n.index?1:0}function Ab(e){e.typeName==="asset"&&("src"in e&&(e.src="<redacted>"),"src"in e.props&&(e.props.src="<redacted>"))}const b9=({error:e,phase:n,record:t,recordBefore:r})=>{throw E1(e,{tags:{origin:"store.validateRecord",storePhase:n,isExistingValidationIssue:n==="initialize"},extras:{recordBefore:r?Ab(So(r)):void 0,recordAfter:Ab(So(t))}}),e};function P9(){return[Jn.create({name:"Page 1",index:"a1",meta:{}})]}function E9(e){const n=e.query.ids("page"),t=()=>{if(!e.has(b0))return e.put([R1.create({id:b0,name:e.props.defaultName})]),t();if(!e.has(lf))return e.put([O1.create({id:lf})]),t();const r=n.value;if(r.size===0)return e.put(P9()),t();const o=()=>[...r].map(l=>e.get(l)).sort(S9)[0].id,s=e.get(hn);if(s){if(!r.has(s.currentPageId))return e.put([{...s,currentPageId:o()}]),t()}else return e.put([e.schema.types.instance.create({id:hn,currentPageId:o(),exportBackground:!0})]),t();const i=new Set,a=new Set;for(const l of r){const c=Ft.createId(l);e.has(c)||i.add(c);const u=Bt.createId(l);e.has(u)||a.add(u)}i.size>0&&e.put([...i].map(l=>Ft.create({id:l,pageId:Ft.parseId(l)}))),a.size>0&&e.put([...a].map(l=>Bt.create({id:l})))};return t}const _9=A1("bookmark",be({title:pe,description:pe,image:pe,src:pe.nullable()})),C9=Pe({}),I9=A1("image",be({w:fe,h:fe,name:pe,isAnimated:Me,mimeType:pe.nullable(),src:pe.nullable()})),Gg={AddIsAnimated:1,RenameWidthHeight:2},k9=Pe({currentVersion:Gg.RenameWidthHeight,migrators:{[Gg.AddIsAnimated]:{up:e=>({...e,props:{...e.props,isAnimated:!1}}),down:e=>{const{isAnimated:n,...t}=e.props;return{...e,props:t}}},[Gg.RenameWidthHeight]:{up:e=>{const{width:n,height:t,...r}=e.props;return{...e,props:{w:n,h:t,...r}}},down:e=>{const{w:n,h:t,...r}=e.props;return{...e,props:{width:n,height:t,...r}}}}}}),$9=A1("video",be({w:fe,h:fe,name:pe,isAnimated:Me,mimeType:pe.nullable(),src:pe.nullable()})),qg={AddIsAnimated:1,RenameWidthHeight:2},T9=Pe({currentVersion:qg.RenameWidthHeight,migrators:{[qg.AddIsAnimated]:{up:e=>({...e,props:{...e.props,isAnimated:!1}}),down:e=>{const{isAnimated:n,...t}=e.props;return{...e,props:t}}},[qg.RenameWidthHeight]:{up:e=>{const{width:n,height:t,...r}=e.props;return{...e,props:{w:n,h:t,...r}}},down:e=>{const{w:n,h:t,...r}=e.props;return{...e,props:{width:n,height:t,...r}}}}}}),M9=No("asset",M1("type",{image:I9,video:$9,bookmark:_9})),Ob={AddMeta:1},A9=Pe({subTypeKey:"type",subTypeMigrations:{image:k9,video:T9,bookmark:C9},currentVersion:Ob.AddMeta,migrators:{[Ob.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...n})=>({...n})}}}),Oa=jo("asset",{migrations:A9,validator:M9,scope:"document"}).withDefaultProperties(()=>({meta:{}}));let O9=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((n,t)=>(t&=63,t<36?n+=t.toString(36):t<62?n+=(t-26).toString(36).toUpperCase():t>62?n+="-":n+="_",n),"");class Wt{constructor(n,t,r){this.id=n,this.defaultValue=t,this.type=r}static define(n,t){const{defaultValue:r,type:o=qj}=t;return new Wt(n,r,o)}static defineEnum(n,t){const{defaultValue:r,values:o}=t;return new R9(n,r,o)}validate(n){return this.type.validate(n)}}class R9 extends Wt{constructor(n,t,r){super(n,t,HI(...r)),this.values=r}}const pd={AddIsLocked:1,HoistOpacity:2,AddMeta:3},Qg=Pe({currentVersion:pd.AddMeta,migrators:{[pd.AddIsLocked]:{up:e=>({...e,isLocked:!1}),down:e=>{const{isLocked:n,...t}=e;return{...t}}},[pd.HoistOpacity]:{up:({props:{opacity:e,...n},...t})=>({...t,opacity:Number(e??"1"),props:n}),down:({opacity:e,...n})=>({...n,props:{...n.props,opacity:e<.175?"0.1":e<.375?"0.25":e<.625?"0.5":e<.875?"0.75":"1"}})},[pd.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...n})=>({...n})}}});function ci(e){return e?e.typeName==="shape":!1}function Wn(e){return e?e.startsWith("shape:"):!1}function Ue(e){return`shape:${e??O9()}`}function GI(e){const n=new Map;for(const[t,r]of Object.entries(e))if(r instanceof Wt){if(n.has(r))throw new Error(`Duplicate style prop ${r.id}. Each style prop can only be used once within a shape.`);n.set(r,t)}return n}function D9(e){return jo("shape",{migrations:Pe({currentVersion:Qg.currentVersion,firstVersion:Qg.firstVersion,migrators:Qg.migrators,subTypeKey:"type",subTypeMigrations:_b(e,(n,t)=>t.migrations??Pe({}))}),scope:"document",validator:No("shape",M1("type",_b(e,(n,{props:t,meta:r})=>d9(n,t,r))))}).withDefaultProperties(()=>({x:0,y:0,rotation:0,isLocked:!1,opacity:1,meta:{}}))}const Tl={RemoveCodeAndIconShapeTypes:1,AddInstancePresenceType:2,RemoveTLUserAndPresenceAndAddPointer:3,RemoveUserDocument:4},L9=Pe({currentVersion:Tl.RemoveUserDocument,migrators:{[Tl.RemoveCodeAndIconShapeTypes]:{up:e=>Object.fromEntries(Object.entries(e).filter(([n,t])=>t.typeName!=="shape"||t.type!=="icon"&&t.type!=="code")),down:e=>e},[Tl.AddInstancePresenceType]:{up:e=>e,down:e=>Object.fromEntries(Object.entries(e).filter(([n,t])=>t.typeName!=="instance_presence"))},[Tl.RemoveTLUserAndPresenceAndAddPointer]:{up:e=>Object.fromEntries(Object.entries(e).filter(([n,t])=>!t.typeName.match(/^(user|user_presence)$/))),down:e=>Object.fromEntries(Object.entries(e).filter(([n,t])=>t.typeName!=="pointer"))},[Tl.RemoveUserDocument]:{up:e=>Object.fromEntries(Object.entries(e).filter(([n,t])=>!t.typeName.match("user_document"))),down:e=>e}}});function j9({shapes:e}){const n=new Map;for(const o of lt(e))for(const s of GI(o.props??{}).keys()){if(n.has(s.id)&&n.get(s.id)!==s)throw new Error(`Multiple StyleProp instances with the same id: ${s.id}`);n.set(s.id,s)}const t=D9(e),r=l9(n);return I1.create({asset:Oa,camera:Bt,document:R1,instance:r,instance_page_state:Ft,page:Jn,shape:t,instance_presence:v9,pointer:O1},{snapshotMigrations:L9,onValidationFailure:b9,createIntegrityChecker:E9})}const qI=["black","grey","light-violet","violet","blue","light-blue","yellow","orange","green","light-green","light-red","red"],cf={lightMode:{text:"#000000",background:"rgb(249, 250, 251)",solid:"#fcfffe",black:{solid:"#1d1d1d",semi:"#e8e8e8",pattern:"#494949",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}},blue:{solid:"#4263eb",semi:"#dce1f8",pattern:"#6681ee",highlight:{srgb:"#10acff",p3:"color(display-p3 0.308 0.6632 0.9996)"}},green:{solid:"#099268",semi:"#d3e9e3",pattern:"#39a785",highlight:{srgb:"#00ffc8",p3:"color(display-p3 0.2536 0.984 0.7981)"}},grey:{solid:"#adb5bd",semi:"#eceef0",pattern:"#bcc3c9",highlight:{srgb:"#cbe7f1",p3:"color(display-p3 0.8163 0.9023 0.9416)"}},"light-blue":{solid:"#4dabf7",semi:"#ddedfa",pattern:"#6fbbf8",highlight:{srgb:"#00f4ff",p3:"color(display-p3 0.1512 0.9414 0.9996)"}},"light-green":{solid:"#40c057",semi:"#dbf0e0",pattern:"#65cb78",highlight:{srgb:"#65f641",p3:"color(display-p3 0.563 0.9495 0.3857)"}},"light-red":{solid:"#ff8787",semi:"#f4dadb",pattern:"#fe9e9e",highlight:{srgb:"#ff7fa3",p3:"color(display-p3 0.9988 0.5301 0.6397)"}},"light-violet":{solid:"#e599f7",semi:"#f5eafa",pattern:"#e9acf8",highlight:{srgb:"#ff88ff",p3:"color(display-p3 0.9676 0.5652 0.9999)"}},orange:{solid:"#f76707",semi:"#f8e2d4",pattern:"#f78438",highlight:{srgb:"#ffa500",p3:"color(display-p3 0.9988 0.6905 0.266)"}},red:{solid:"#e03131",semi:"#f4dadb",pattern:"#e55959",highlight:{srgb:"#ff636e",p3:"color(display-p3 0.9992 0.4376 0.45)"}},violet:{solid:"#ae3ec9",semi:"#ecdcf2",pattern:"#bd63d3",highlight:{srgb:"#c77cff",p3:"color(display-p3 0.7469 0.5089 0.9995)"}},yellow:{solid:"#ffc078",semi:"#f9f0e6",pattern:"#fecb92",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}}},darkMode:{text:"#f8f9fa",background:"#212529",solid:"#28292e",black:{solid:"#e1e1e1",semi:"#2c3036",pattern:"#989898",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}},blue:{solid:"#4156be",semi:"#262d40",pattern:"#3a4b9e",highlight:{srgb:"#0079d2",p3:"color(display-p3 0.0032 0.4655 0.7991)"}},green:{solid:"#3b7b5e",semi:"#253231",pattern:"#366a53",highlight:{srgb:"#009774",p3:"color(display-p3 0.0085 0.582 0.4604)"}},grey:{solid:"#93989f",semi:"#33373c",pattern:"#7c8187",highlight:{srgb:"#9cb4cb",p3:"color(display-p3 0.6299 0.7012 0.7856)"}},"light-blue":{solid:"#588fc9",semi:"#2a3642",pattern:"#4d7aa9",highlight:{srgb:"#00bdc8",p3:"color(display-p3 0.0023 0.7259 0.7735)"}},"light-green":{solid:"#599f57",semi:"#2a3830",pattern:"#4e874e",highlight:{srgb:"#00a000",p3:"color(display-p3 0.2711 0.6172 0.0195)"}},"light-red":{solid:"#c67877",semi:"#3b3235",pattern:"#a56767",highlight:{srgb:"#db005b",p3:"color(display-p3 0.7849 0.0585 0.3589)"}},"light-violet":{solid:"#b583c9",semi:"#383442",pattern:"#9770a9",highlight:{srgb:"#c400c7",p3:"color(display-p3 0.7024 0.0403 0.753)"}},orange:{solid:"#bf612e",semi:"#3a2e2a",pattern:"#9f552d",highlight:{srgb:"#d07a00",p3:"color(display-p3 0.7699 0.4937 0.0085)"}},red:{solid:"#aa3c37",semi:"#36292b",pattern:"#8f3734",highlight:{srgb:"#de002c",p3:"color(display-p3 0.7978 0.0509 0.2035)"}},violet:{solid:"#873fa3",semi:"#31293c",pattern:"#763a8b",highlight:{srgb:"#9e00ee",p3:"color(display-p3 0.5651 0.0079 0.8986)"}},yellow:{solid:"#cba371",semi:"#3c3934",pattern:"#fecb92",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}}}};function Sn(e){return e.isDarkMode?cf.darkMode:cf.lightMode}const or=Wt.defineEnum("tldraw:color",{defaultValue:"black",values:qI}),QI=Wt.defineEnum("tldraw:labelColor",{defaultValue:"black",values:qI}),Ei=Wt.defineEnum("tldraw:dash",{defaultValue:"draw",values:["draw","solid","dashed","dotted"]}),Va=Wt.defineEnum("tldraw:fill",{defaultValue:"none",values:["none","semi","solid","pattern"]}),Yr=Wt.defineEnum("tldraw:font",{defaultValue:"draw",values:["draw","sans","serif","mono"]}),wu={draw:"'tldraw_draw', sans-serif",sans:"'tldraw_sans', sans-serif",serif:"'tldraw_serif', serif",mono:"'tldraw_mono', monospace"},Xr=Wt.defineEnum("tldraw:size",{defaultValue:"m",values:["s","m","l","xl"]}),ZI=["arrow","triangle","square","dot","pipe","diamond","inverted","bar","none"],uf=Wt.defineEnum("tldraw:arrowheadStart",{defaultValue:"none",values:ZI}),df=Wt.defineEnum("tldraw:arrowheadEnd",{defaultValue:"arrow",values:ZI}),Rb=M1("type",{binding:be({type:xn("binding"),boundShapeId:mr,normalizedAnchor:Lc,isExact:Me}),point:be({type:xn("point"),x:fe,y:fe})}),N9={labelColor:QI,color:or,fill:Va,dash:Ei,size:Xr,arrowheadStart:uf,arrowheadEnd:df,font:Yr,start:Rb,end:Rb,bend:fe,text:pe},Db={AddLabelColor:1},z9=Pe({currentVersion:Db.AddLabelColor,migrators:{[Db.AddLabelColor]:{up:e=>({...e,props:{...e.props,labelColor:"black"}}),down:e=>{const{labelColor:n,...t}=e.props;return{...e,props:t}}}}}),B9={w:wn,h:wn,assetId:dp.nullable(),url:pe},Lb={NullAssetId:1},F9=Pe({currentVersion:Lb.NullAssetId,migrators:{[Lb.NullAssetId]:{up:e=>e.props.assetId===void 0?{...e,props:{...e.props,assetId:null}}:e,down:e=>{if(e.props.assetId===null){const{assetId:n,...t}=e.props;return{...e,props:t}}return e}}}}),JI=be({type:HI("free","straight"),points:Ir(Lc)}),U9={color:or,fill:Va,dash:Ei,size:Xr,segments:Ir(JI),isComplete:Me,isClosed:Me,isPen:Me},jb={AddInPen:1},K9=Pe({currentVersion:jb.AddInPen,migrators:{[jb.AddInPen]:{up:e=>{const{points:n}=e.props.segments[0];if(n.length===0)return{...e,props:{...e.props,isPen:!1}};let t=!(n[0].z===0||n[0].z===.5);return n[1]&&(t=t&&!(n[1].z===0||n[1].z===.5)),{...e,props:{...e.props,isPen:t}}},down:e=>{const{isPen:n,...t}=e.props;return{...e,props:{...t}}}}}}),Nb=/(^\/r\/[^/]+\/?$)/,De=e=>{try{return new URL(e)}catch{return}},Wa=[{type:"tldraw",title:"tldraw",hostnames:["beta.tldraw.com","lite.tldraw.com","www.tldraw.com"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:e=>{const n=De(e);if(n&&n.pathname.match(Nb))return e},fromEmbedUrl:e=>{const n=De(e);if(n&&n.pathname.match(Nb))return e}},{type:"codesandbox",title:"CodeSandbox",hostnames:["codesandbox.io"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const n=De(e),t=n&&n.pathname.match(/\/s\/([^/]+)\/?/);if(t)return`https://codesandbox.io/embed/${t[1]}`},fromEmbedUrl:e=>{const n=De(e),t=n&&n.pathname.match(/\/embed\/([^/]+)\/?/);if(t)return`https://codesandbox.io/s/${t[1]}`}},{type:"codepen",title:"Codepen",hostnames:["codepen.io"],minWidth:300,minHeight:300,width:520,height:400,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const n=/https:\/\/codepen.io\/([^/]+)\/pen\/([^/]+)/,t=e.match(n);if(t){const[r,o,s]=t;return`https://codepen.io/${o}/embed/${s}`}},fromEmbedUrl:e=>{const n=/https:\/\/codepen.io\/([^/]+)\/embed\/([^/]+)/,t=e.match(n);if(t){const[r,o,s]=t;return`https://codepen.io/${o}/pen/${s}`}}},{type:"scratch",title:"Scratch",hostnames:["scratch.mit.edu"],width:520,height:400,doesResize:!1,canUnmount:!1,toEmbedUrl:e=>{const n=/https?:\/\/scratch.mit.edu\/projects\/([^/]+)/,t=e.match(n);if(t){const[r,o]=t;return`https://scratch.mit.edu/projects/embed/${o}`}},fromEmbedUrl:e=>{const n=/https:\/\/scratch.mit.edu\/projects\/embed\/([^/]+)/,t=e.match(n);if(t){const[r,o]=t;return`https://scratch.mit.edu/projects/${o}`}}},{type:"youtube",title:"YouTube",hostnames:["*.youtube.com","youtube.com","youtu.be"],width:800,height:450,doesResize:!0,canUnmount:!1,overridePermissions:{"allow-presentation":!0},isAspectRatioLocked:!0,toEmbedUrl:e=>{const n=De(e);if(!n)return;const t=n.hostname.replace(/^www./,"");if(t==="youtu.be")return`https://www.youtube.com/embed/${n.pathname.split("/").filter(Boolean)[0]}`;if((t==="youtube.com"||t==="m.youtube.com")&&n.pathname.match(/^\/watch/))return`https://www.youtube.com/embed/${n.searchParams.get("v")}`},fromEmbedUrl:e=>{const n=De(e);if(!n)return;if(n.hostname.replace(/^www./,"")==="youtube.com"){const r=n.pathname.match(/^\/embed\/([^/]+)\/?/);if(r)return`https://www.youtube.com/watch?v=${r[1]}`}}},{type:"figma",title:"Figma",hostnames:["figma.com"],width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:e=>{if(e.match(/https:\/\/([\w\.-]+\.)?figma.com\/(file|proto)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/)&&!e.includes("figma.com/embed"))return`https://www.figma.com/embed?embed_host=share&url=${e}`},fromEmbedUrl:e=>{const n=De(e);if(n&&n.pathname.match(/^\/embed\/?$/)){const t=n.searchParams.get("url");if(t)return t}}},{type:"google_maps",title:"Google Maps",hostnames:["google.*"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{if(e.includes("/maps/")){const n=e.match(/@(.*),(.*),(.*)z/);let t;if(n){const[,r,o,s]=n;t=`https://${new URL(e).host.replace("www.","")}/maps/embed/v1/view?key=${{}.NEXT_PUBLIC_GC_API_KEY}&center=${r},${o}&zoom=${s}`}else t="";return t}},fromEmbedUrl:e=>{const n=De(e);if(!n)return;if(n.pathname.match(/^\/maps\/embed\/v1\/view\/?$/)&&n.searchParams.has("center")&&n.searchParams.get("zoom")){const r=n.searchParams.get("zoom"),[o,s]=n.searchParams.get("center").split(",");return`https://www.google.com/maps/@${o},${s},${r}z`}}},{type:"google_calendar",title:"Google Calendar",hostnames:["calendar.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,canUnmount:!1,instructionLink:"https://support.google.com/calendar/answer/41207?hl=en",toEmbedUrl:e=>{const n=De(e),t=n==null?void 0:n.searchParams.get("cid");if(n!=null&&n.pathname.match(/\/calendar\/u\/0/)&&t){n.pathname="/calendar/embed";const r=Array.from(n.searchParams.keys());for(const o of r)n.searchParams.delete(o);return n.searchParams.set("src",t),n.href}},fromEmbedUrl:e=>{const n=De(e),t=n==null?void 0:n.searchParams.get("src");if(n!=null&&n.pathname.match(/\/calendar\/embed/)&&t){n.pathname="/calendar/u/0";const r=Array.from(n.searchParams.keys());for(const o of r)n.searchParams.delete(o);return n.searchParams.set("cid",t),n.href}}},{type:"google_slides",title:"Google Slides",hostnames:["docs.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const n=De(e);if(n!=null&&n.pathname.match(/^\/presentation/)&&(n!=null&&n.pathname.match(/\/pub\/?$/))){n.pathname=n.pathname.replace(/\/pub$/,"/embed");const t=Array.from(n.searchParams.keys());for(const r of t)n.searchParams.delete(r);return n.href}},fromEmbedUrl:e=>{const n=De(e);if(n!=null&&n.pathname.match(/^\/presentation/)&&(n!=null&&n.pathname.match(/\/embed\/?$/))){n.pathname=n.pathname.replace(/\/embed$/,"/pub");const t=Array.from(n.searchParams.keys());for(const r of t)n.searchParams.delete(r);return n.href}}},{type:"github_gist",title:"GitHub Gist",hostnames:["gist.github.com"],width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:e=>{const n=De(e);if(n&&n.pathname.match(/\/([^/]+)\/([^/]+)/))return e.split("/").pop()?e:void 0},fromEmbedUrl:e=>{const n=De(e);if(n&&n.pathname.match(/\/([^/]+)\/([^/]+)/))return e.split("/").pop()?e:void 0}},{type:"replit",title:"Replit",hostnames:["replit.com"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const n=De(e);if(n&&n.pathname.match(/\/@([^/]+)\/([^/]+)/))return`${e}?embed=true`},fromEmbedUrl:e=>{const n=De(e);if(n&&n.pathname.match(/\/@([^/]+)\/([^/]+)/)&&n.searchParams.has("embed"))return n.searchParams.delete("embed"),n.href}},{type:"felt",title:"Felt",hostnames:["felt.com"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const n=De(e);if(n&&n.pathname.match(/^\/map\//))return n.origin+"/embed"+n.pathname},fromEmbedUrl:e=>{const n=De(e);if(n&&n.pathname.match(/^\/embed\/map\//))return n.pathname=n.pathname.replace(/^\/embed/,""),n.href}},{type:"spotify",title:"Spotify",hostnames:["open.spotify.com"],width:720,height:500,minHeight:500,overrideOutlineRadius:12,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const n=De(e);if(n&&n.pathname.match(/^\/(artist|album)\//))return n.origin+"/embed"+n.pathname},fromEmbedUrl:e=>{const n=De(e);if(n&&n.pathname.match(/^\/embed\/(artist|album)\//))return n.origin+n.pathname.replace(/^\/embed/,"")}},{type:"vimeo",title:"Vimeo",hostnames:["vimeo.com","player.vimeo.com"],width:640,height:360,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!0,toEmbedUrl:e=>{const n=De(e);if(n&&n.hostname==="vimeo.com"&&n.pathname.match(/^\/[0-9]+/))return"https://player.vimeo.com/video/"+n.pathname.split("/")[1]+"?title=0&byline=0"},fromEmbedUrl:e=>{const n=De(e);if(n&&n.hostname==="player.vimeo.com"){const t=n.pathname.match(/^\/video\/([^/]+)\/?$/);if(t)return"https://vimeo.com/"+t[1]}}},{type:"excalidraw",title:"Excalidraw",hostnames:["excalidraw.com"],width:720,height:500,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!0,toEmbedUrl:e=>{const n=De(e);if(n&&n.hash.match(/#room=/))return e},fromEmbedUrl:e=>{const n=De(e);if(n&&n.hash.match(/#room=/))return e}},{type:"observable",title:"Observable",hostnames:["observablehq.com"],width:720,height:500,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!1,backgroundColor:"#fff",toEmbedUrl:e=>{const n=De(e);if(n&&n.pathname.match(/^\/@([^/]+)\/([^/]+)\/?$/))return`${n.origin}/embed${n.pathname}?cell=*`;if(n&&n.pathname.match(/^\/d\/([^/]+)\/?$/)){const t=n.pathname.replace(/^\/d/,"");return`${n.origin}/embed${t}?cell=*`}},fromEmbedUrl:e=>{const n=De(e);if(n&&n.pathname.match(/^\/embed\/@([^/]+)\/([^/]+)\/?$/))return`${n.origin}${n.pathname.replace("/embed","")}#cell-*`;if(n&&n.pathname.match(/^\/embed\/([^/]+)\/?$/))return`${n.origin}${n.pathname.replace("/embed","/d")}#cell-*`}}],H9={"allow-downloads-without-user-activation":!1,"allow-downloads":!1,"allow-modals":!1,"allow-orientation-lock":!1,"allow-pointer-lock":!1,"allow-popups":!0,"allow-popups-to-escape-sandbox":!1,"allow-presentation":!1,"allow-storage-access-by-user-activation":!1,"allow-top-navigation":!1,"allow-top-navigation-by-user-activation":!1,"allow-scripts":!0,"allow-same-origin":!0,"allow-forms":!0},V9={w:wn,h:wn,url:pe},Ml={GenOriginalUrlInEmbed:1,RemoveDoesResize:2,RemoveTmpOldUrl:3,RemovePermissionOverrides:4},W9=Pe({currentVersion:Ml.RemovePermissionOverrides,migrators:{[Ml.GenOriginalUrlInEmbed]:{up:e=>{const n=e.props.url,t=new URL(n).host.replace("www.","");let r;for(const o of Wa)if(o.hostnames.includes(t))try{r=o.fromEmbedUrl(n)}catch(s){console.warn(s)}return{...e,props:{...e.props,tmpOldUrl:e.props.url,url:r??""}}},down:e=>{let n=e.props.tmpOldUrl;if(!n||n===""){const o=e.props.url,s=new URL(o).host.replace("www.","");for(const i of Wa)if(i.hostnames.includes(s))try{n=i.toEmbedUrl(o)}catch(a){console.warn(a)}}const{tmpOldUrl:t,...r}=e.props;return{...e,props:{...r,url:n??""}}}},[Ml.RemoveDoesResize]:{up:e=>{const{doesResize:n,...t}=e.props;return{...e,props:{...t}}},down:e=>({...e,props:{...e.props,doesResize:!0}})},[Ml.RemoveTmpOldUrl]:{up:e=>{const{tmpOldUrl:n,...t}=e.props;return{...e,props:{...t}}},down:e=>({...e,props:{...e.props}})},[Ml.RemovePermissionOverrides]:{up:e=>{const{overridePermissions:n,...t}=e.props;return{...e,props:{...t}}},down:e=>({...e,props:{...e.props}})}}}),Y9={w:wn,h:wn,name:pe},X9=Pe({}),Nc=Wt.defineEnum("tldraw:horizontalAlign",{defaultValue:"middle",values:["start","middle","end","start-legacy","end-legacy","middle-legacy"]}),hf=Wt.defineEnum("tldraw:verticalAlign",{defaultValue:"middle",values:["start","middle","end"]}),Hr=Wt.defineEnum("tldraw:geo",{defaultValue:"rectangle",values:["rectangle","ellipse","triangle","diamond","pentagon","hexagon","octagon","star","rhombus","rhombus-2","oval","trapezoid","arrow-right","arrow-left","arrow-up","arrow-down","x-box","check-box"]}),G9={geo:Hr,labelColor:QI,color:or,fill:Va,dash:Ei,size:Xr,font:Yr,align:Nc,verticalAlign:hf,url:pe,w:wn,h:wn,growY:T1,text:pe},qs={AddUrlProp:1,AddLabelColor:2,RemoveJustify:3,AddCheckBox:4,AddVerticalAlign:5,MigrateLegacyAlign:6},q9=Pe({currentVersion:qs.MigrateLegacyAlign,migrators:{[qs.AddUrlProp]:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{const{url:n,...t}=e.props;return{...e,props:t}}},[qs.AddLabelColor]:{up:e=>({...e,props:{...e.props,labelColor:"black"}}),down:e=>{const{labelColor:n,...t}=e.props;return{...e,props:t}}},[qs.RemoveJustify]:{up:e=>{let n=e.props.align;return n==="justify"&&(n="start"),{...e,props:{...e.props,align:n}}},down:e=>({...e})},[qs.AddCheckBox]:{up:e=>({...e}),down:e=>({...e,props:{...e.props,geo:e.props.geo==="check-box"?"rectangle":e.props.geo}})},[qs.AddVerticalAlign]:{up:e=>({...e,props:{...e.props,verticalAlign:"middle"}}),down:e=>{const{verticalAlign:n,...t}=e.props;return{...e,props:t}}},[qs.MigrateLegacyAlign]:{up:e=>{let n;switch(e.props.align){case"start":n="start-legacy";break;case"end":n="end-legacy";break;default:n="middle-legacy";break}return{...e,props:{...e.props,align:n}}},down:e=>{let n;switch(e.props.align){case"start-legacy":n="start";break;case"end-legacy":n="end";break;case"middle-legacy":n="middle";break;default:n=e.props.align}return{...e,props:{...e.props,align:n}}}}}}),Q9={},Z9=Pe({}),J9={color:or,size:Xr,segments:Ir(JI),isComplete:Me,isPen:Me},eN=Pe({}),tN=be({topLeft:Lc,bottomRight:Lc}),nN={w:wn,h:wn,playing:Me,url:pe,assetId:dp.nullable(),crop:tN.nullable()},Zg={AddUrlProp:1,AddCropProp:2},rN=Pe({currentVersion:Zg.AddCropProp,migrators:{[Zg.AddUrlProp]:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{const{url:n,...t}=e.props;return{...e,props:t}}},[Zg.AddCropProp]:{up:e=>({...e,props:{...e.props,crop:null}}),down:e=>{const{crop:n,...t}=e.props;return{...e,props:t}}}}}),oN=new Set(["vertex","virtual","create"]),sN=be({id:pe,type:vu(oN),canBind:Me.optional(),index:pe,x:fe,y:fe}),ff=Wt.defineEnum("tldraw:spline",{defaultValue:"line",values:["cubic","line"]}),iN={color:or,dash:Ei,size:Xr,spline:ff,handles:Zj(pe,sN)},aN=Pe({}),lN={color:or,size:Xr,font:Yr,align:Nc,verticalAlign:hf,growY:T1,url:pe,text:pe},Al={AddUrlProp:1,RemoveJustify:2,MigrateLegacyAlign:3,AddVerticalAlign:4},cN=Pe({currentVersion:Al.AddVerticalAlign,migrators:{[Al.AddUrlProp]:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{const{url:n,...t}=e.props;return{...e,props:t}}},[Al.RemoveJustify]:{up:e=>{let n=e.props.align;return n==="justify"&&(n="start"),{...e,props:{...e.props,align:n}}},down:e=>({...e})},[Al.MigrateLegacyAlign]:{up:e=>{let n;switch(e.props.align){case"start":n="start-legacy";break;case"end":n="end-legacy";break;default:n="middle-legacy";break}return{...e,props:{...e.props,align:n}}},down:e=>{let n;switch(e.props.align){case"start-legacy":n="start";break;case"end-legacy":n="end";break;case"middle-legacy":n="middle";break;default:n=e.props.align}return{...e,props:{...e.props,align:n}}}},[Al.AddVerticalAlign]:{up:e=>({...e,props:{...e.props,verticalAlign:"middle"}}),down:e=>{const{verticalAlign:n,...t}=e.props;return{...e,props:t}}}}}),uN={color:or,size:Xr,font:Yr,align:Nc,w:wn,text:pe,scale:wn,autoSize:Me},zb={RemoveJustify:1},dN=Pe({currentVersion:zb.RemoveJustify,migrators:{[zb.RemoveJustify]:{up:e=>{let n=e.props.align;return n==="justify"&&(n="start"),{...e,props:{...e.props,align:n}}},down:e=>({...e})}}}),hN={w:wn,h:wn,time:fe,playing:Me,url:pe,assetId:dp.nullable()},Bb={AddUrlProp:1},fN=Pe({currentVersion:Bb.AddUrlProp,migrators:{[Bb.AddUrlProp]:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{const{url:n,...t}=e.props;return{...e,props:t}}}}}),zc=[{locale:"ar",label:""},{locale:"ca",label:"Catal"},{locale:"da",label:"Danish"},{locale:"de",label:"Deutsch"},{locale:"en",label:"English"},{locale:"es",label:"Espaol"},{locale:"fa",label:""},{locale:"fi",label:"Suomi"},{locale:"fr",label:"Franais"},{locale:"gl",label:"Galego"},{locale:"he",label:""},{locale:"it",label:"Italiano"},{locale:"ja",label:""},{locale:"ko-kr",label:""},{locale:"ku",label:""},{locale:"hi-in",label:""},{locale:"hu",label:"Magyar"},{locale:"my",label:""},{locale:"ne",label:""},{locale:"no",label:"Norwegian"},{locale:"pl",label:"Polski"},{locale:"pt-br",label:"Portugus - Brasil"},{locale:"pt-pt",label:"Portugus - Europeu"},{locale:"ro",label:"Romn"},{locale:"ru",label:"Russian"},{locale:"sv",label:"Svenska"},{locale:"te",label:""},{locale:"th",label:""},{locale:"tr",label:"Trke"},{locale:"uk",label:"Ukrainian"},{locale:"vi",label:"Ting Vit"},{locale:"zh-cn",label:"Chinese - Simplified"},{locale:"zh-tw",label:" ()"}];function pN(){const e=typeof window<"u"?window.navigator.languages??["en"]:["en"];return gN(e)}function gN(e){for(const n of e){const t=mN(n);if(t)return t}return"en"}const Fb={zh:"zh-cn",pt:"pt-br",ko:"ko-kr",hi:"hi-in"};function mN(e){const n=zc.find(o=>o.locale===e.toLowerCase());if(n)return n.locale;const[t,r]=e.split(/[-_]/).map(o=>o.toLowerCase());if(r){const o=zc.find(s=>s.locale===t);if(o)return o.locale}return t in Fb?Fb[t]:null}const gd="2.0.0-alpha.14";let P0={fonts:{draw:`https://unpkg.com/@tldraw/assets@${gd}/fonts/Shantell_Sans-Normal-SemiBold.woff2`,serif:`https://unpkg.com/@tldraw/assets@${gd}/fonts/IBMPlexSerif-Medium.woff2`,sansSerif:`https://unpkg.com/@tldraw/assets@${gd}/fonts/IBMPlexSans-Medium.woff2`,monospace:`https://unpkg.com/@tldraw/assets@${gd}/fonts/IBMPlexMono-Medium.woff2`}};function yN(e){return w.useMemo(()=>e?{fonts:Object.assign({...P0.fonts},{...e==null?void 0:e.fonts})}:P0,[e])}var ek={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var n={}.hasOwnProperty;function t(){for(var r=[],o=0;o<arguments.length;o++){var s=arguments[o];if(s){var i=typeof s;if(i==="string"||i==="number")r.push(s);else if(Array.isArray(s)){if(s.length){var a=t.apply(null,s);a&&r.push(a)}}else if(i==="object"){if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]")){r.push(s.toString());continue}for(var l in s)n.call(s,l)&&s[l]&&r.push(l)}}}return r.join(" ")}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(ek);var vN=ek.exports;const de=Qa(vN),D1=oe.createContext({}),U=()=>oe.useContext(D1),L1={openWindow:(e,n)=>window.open(e,n,"noopener noreferrer"),refreshPage:()=>window.location.reload(),hardReset:async()=>{var e;return await((e=window.__tldraw__hardReset)==null?void 0:e.call(window))}};function tk(){L1.hardReset()}function wN(){L1.refreshPage()}const Kt={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>e*(2-e),easeInOutQuad:e=>e<.5?2*e*e:-1+(4-2*e)*e,easeInCubic:e=>e*e*e,easeOutCubic:e=>--e*e*e+1,easeInOutCubic:e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1- --e*e*e*e,easeInOutQuart:e=>e<.5?8*e*e*e*e:1-8*--e*e*e*e,easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1+--e*e*e*e*e,easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e,easeInSine:e=>1-Math.cos(e*Math.PI/2),easeOutSine:e=>Math.sin(e*Math.PI/2),easeInOutSine:e=>-(Math.cos(Math.PI*e)-1)/2,easeInExpo:e=>e<=0?0:Math.pow(2,10*e-10),easeOutExpo:e=>e>=1?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>e<=0?0:e>=1?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2};class E{constructor(n=0,t=0,r=1){this.x=n,this.y=t,this.z=r}get pressure(){return this.z}set(n=this.x,t=this.y,r=this.z){return this.x=n,this.y=t,this.z=r,this}setTo({x:n=0,y:t=0,z:r=1}){return this.x=n,this.y=t,this.z=r,this}rot(n){if(n===0)return this;const{x:t,y:r}=this,o=Math.sin(n),s=Math.cos(n);return this.x=t*s-r*o,this.y=t*o+r*s,this}rotWith(n,t){if(t===0)return this;const r=this.x-n.x,o=this.y-n.y,s=Math.sin(t),i=Math.cos(t);return this.x=n.x+(r*i-o*s),this.y=n.y+(r*s+o*i),this}clone(){const{x:n,y:t,z:r}=this;return new E(n,t,r)}sub(n){return this.x-=n.x,this.y-=n.y,this}subXY(n,t){return this.x-=n,this.y-=t,this}subScalar(n){return this.x-=n,this.y-=n,this}add(n){return this.x+=n.x,this.y+=n.y,this}addXY(n,t){return this.x+=n,this.y+=t,this}addScalar(n){return this.x+=n,this.y+=n,this}clamp(n,t){return this.x=Math.max(this.x,n),this.y=Math.max(this.y,n),t!==void 0&&(this.x=Math.min(this.x,t),this.y=Math.min(this.y,t)),this}div(n){return this.x/=n,this.y/=n,this}divV(n){return this.x/=n.x,this.y/=n.y,this}mul(n){return this.x*=n,this.y*=n,this}mulV(n){return this.x*=n.x,this.y*=n.y,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}nudge(n,t){const r=E.Tan(n,this);return this.add(r.mul(t))}neg(){return this.x*=-1,this.y*=-1,this}cross(n){return this.x=this.y*n.z-this.z*n.y,this.y=this.z*n.x-this.x*n.z,this}dpr(n){return E.Dpr(this,n)}cpr(n){return E.Cpr(this,n)}len2(){return E.Len2(this)}len(){return E.Len(this)}pry(n){return E.Pry(this,n)}per(){const{x:n,y:t}=this;return this.x=t,this.y=-n,this}uni(){return E.Uni(this)}tan(n){return E.Tan(this,n)}dist(n){return E.Dist(this,n)}distanceToLineSegment(n,t){return E.DistanceToLineSegment(n,t,this)}slope(n){return E.Slope(this,n)}snapToGrid(n){return this.x=Math.round(this.x/n)*n,this.y=Math.round(this.y/n)*n,this}angle(n){return E.Angle(this,n)}toAngle(){return E.ToAngle(this)}lrp(n,t){return this.x=this.x+(n.x-this.x)*t,this.y=this.y+(n.y-this.y)*t,this}equals(n){return E.Equals(this,n)}equalsXY(n,t){return E.EqualsXY(this,n,t)}norm(){const n=this.len();return this.x=n===0?0:this.x/n,this.y=n===0?0:this.y/n,this}toFixed(){return E.ToFixed(this)}toString(){return E.ToString(E.ToFixed(this))}toJson(){return E.ToJson(this)}toArray(){return E.ToArray(this)}static Add(n,t){return new E(n.x+t.x,n.y+t.y)}static AddXY(n,t,r){return new E(n.x+t,n.y+r)}static Sub(n,t){return new E(n.x-t.x,n.y-t.y)}static SubXY(n,t,r){return new E(n.x-t,n.y-r)}static AddScalar(n,t){return new E(n.x+t,n.y+t)}static SubScalar(n,t){return new E(n.x-t,n.y-t)}static Div(n,t){return new E(n.x/t,n.y/t)}static Mul(n,t){return new E(n.x*t,n.y*t)}static DivV(n,t){return new E(n.x/t.x,n.y/t.y)}static MulV(n,t){return new E(n.x*t.x,n.y*t.y)}static Neg(n){return new E(-n.x,-n.y)}static Per(n){return new E(n.y,-n.x)}static Dist2(n,t){return E.Sub(n,t).len2()}static Abs(n){return new E(Math.abs(n.x),Math.abs(n.y))}static Dist(n,t){return Math.hypot(n.y-t.y,n.x-t.x)}static Dpr(n,t){return n.x*t.x+n.y*t.y}static Cross(n,t){return new E(n.y*t.z-n.z*t.y,n.z*t.x-n.x*t.z)}static Cpr(n,t){return n.x*t.y-t.x*n.y}static Len2(n){return n.x*n.x+n.y*n.y}static Len(n){return Math.sqrt(E.Len2(n))}static Pry(n,t){return E.Dpr(n,t)/E.Len(t)}static Uni(n){return E.Div(n,E.Len(n))}static Tan(n,t){return E.Uni(E.Sub(n,t))}static Min(n,t){return new E(Math.min(n.x,t.x),Math.min(n.y,t.y))}static Max(n,t){return new E(Math.max(n.x,t.x),Math.max(n.y,t.y))}static From({x:n,y:t,z:r=1}){return new E(n,t,r)}static FromArray(n){return new E(n[0],n[1])}static Rot(n,t=0){const r=Math.sin(t),o=Math.cos(t);return new E(n.x*o-n.y*r,n.x*r+n.y*o)}static RotWith(n,t,r){const o=n.x-t.x,s=n.y-t.y,i=Math.sin(r),a=Math.cos(r);return new E(t.x+(o*a-s*i),t.y+(o*i+s*a))}static NearestPointOnLineThroughPoint(n,t,r){return E.Mul(t,E.Sub(r,n).pry(t)).add(n)}static NearestPointOnLineSegment(n,t,r,o=!0){const s=E.Tan(t,n),i=E.Add(n,E.Mul(s,E.Sub(r,n).pry(s)));if(o){if(i.x<Math.min(n.x,t.x))return E.Cast(n.x<t.x?n:t);if(i.x>Math.max(n.x,t.x))return E.Cast(n.x>t.x?n:t);if(i.y<Math.min(n.y,t.y))return E.Cast(n.y<t.y?n:t);if(i.y>Math.max(n.y,t.y))return E.Cast(n.y>t.y?n:t)}return i}static DistanceToLineThroughPoint(n,t,r){return E.Dist(r,E.NearestPointOnLineThroughPoint(n,t,r))}static DistanceToLineSegment(n,t,r,o=!0){return E.Dist(r,E.NearestPointOnLineSegment(n,t,r,o))}static Snap(n,t=1){return new E(Math.round(n.x/t)*t,Math.round(n.y/t)*t)}static Cast(n){return n instanceof E?n:E.From(n)}static Slope(n,t){return n.x===t.y?NaN:(n.y-t.y)/(n.x-t.x)}static Angle(n,t){return Math.atan2(t.y-n.y,t.x-n.x)}static Lrp(n,t,r){return E.Sub(t,n).mul(r).add(n)}static Med(n,t){return new E((n.x+t.x)/2,(n.y+t.y)/2)}static Equals(n,t){return Math.abs(n.x-t.x)<1e-4&&Math.abs(n.y-t.y)<1e-4}static EqualsXY(n,t,r){return n.x===t&&n.y===r}static Clockwise(n,t,r){return(r.x-n.x)*(t.y-n.y)-(t.x-n.x)*(r.y-n.y)<0}static Rescale(n,t){const r=E.Len(n);return new E(t*n.x/r,t*n.y/r)}static ScaleWithOrigin(n,t,r){return E.Sub(n,r).mul(t).add(r)}static ToFixed(n,t=2){return new E(+n.x.toFixed(t),+n.y.toFixed(t),+n.z.toFixed(t))}static Nudge(n,t,r){return E.Add(n,E.Tan(t,n).mul(r))}static ToString(n){return`${n.x}, ${n.y}`}static ToAngle(n){let t=Math.atan2(n.y,n.x);return t<0&&(t+=Math.PI*2),t}static ToArray(n){return[n.x,n.y,n.z]}static ToJson(n){const{x:t,y:r,z:o}=n;return{x:t,y:r,z:o}}static Average(n){const t=n.length,r=new E(0,0);for(let o=0;o<t;o++)r.add(n[o]);return r.div(t)}static Clamp(n,t,r){return r===void 0?new E(Math.min(Math.max(n.x,t)),Math.min(Math.max(n.y,t))):new E(Math.min(Math.max(n.x,t),r),Math.min(Math.max(n.y,t),r))}static PointsBetween(n,t,r=6){const o=[];for(let s=0;s<r;s++){const i=Kt.easeInQuad(s/(r-1)),a=E.Lrp(n,t,i);a.z=Math.min(1,.5+Math.abs(.5-xN(i))*.65),o.push(a)}return o}static SnapToGrid(n,t=8){return new E(Math.round(n.x/t)*t,Math.round(n.y/t)*t)}}const xN=e=>e<.5?2*e*e:-1+(4-2*e)*e,Ge=Math.PI,_e=Ge/2,qe=Ge*2,Ub=Math.PI/180,SN=Math.sin;function xr(e,n,t){return Math.max(n,typeof t<"u"?Math.min(e,t):e)}function md(e,n=1e10){return e?Math.round(e*n)/n:0}function dc(e,n,t=1e-6){return Math.abs(e-n)<=t}function Bc(e,n){const t=Math.pow(e-n,2)/Math.pow(e+n,2);return Ge*(e+n)*(1+3*t/(10+Math.sqrt(4-3*t)))}function j1(e){return e=e%qe,e<0?e=e+qe:e===0&&(e=0),e}function cs(e,n){const t=(n-e)%qe;return 2*t%qe-t}function bN(e,n){return qe-cs(e,n)}function Qs(e,n,t){return e+cs(e,n)*t}function nk(e,n){return cs(e,n)}function PN(e,n,t){return nk(E.Angle(e,n),E.Angle(e,t))}function rk(e){return(qe+e)%qe}function pf(e,n){const t=qe/n;let r=Math.floor((rk(e)+t/2)/t)*t%qe;return r<Ge&&(r+=qe),r>Ge&&(r-=qe),r}function ok(e,n){return e===n||dc(e%(Math.PI/2)-n%(Math.PI/2),0)}function EN(e){return e*Ge/180}function _N(e){return e*180/Ge}function yd(e,n,t,r){const o=PN(e,t,r);return n*qe*(o/qe)}function ni(e,n,t,r){return new E(e+t*Math.cos(r),n+t*Math.sin(r))}function Jg(e,n,t){const r=e/2,o=n/2,s=[];for(let i=0;i<t;i++){const a=qe/t,l=-_e+i*a;s.push(new E(r+r*Math.cos(l),o+o*Math.sin(l)))}return s}function Ol(e,n,t,r){return e<r&&t<n}function yr(e,n,t,r){const o=Math.max(e,t),s=Math.min(n,r);return o<=s?[o,s]:null}const CN=(e,n,t)=>{const r=qe/e/2,o=Math.floor(e/4)*2,s=e*2-o,i=0,a=Math.floor(e/2)*2,l=Math.cos(-_e+o*r)*n/2,c=Math.cos(-_e+s*r)*n/2,u=Math.sin(-_e+i*r)*t/2,d=Math.sin(-_e+a*r)*t/2;return new ne(0,0,l-c,d-u)};function Kb(e,n,t){return(n.x-e.x)*(t.y-e.y)-(t.x-e.x)*(n.y-e.y)}function sr(e,n){let t=0,r,o;for(let s=0;s<n.length;s++)r=n[s],o=n[(s+1)%n.length],r.y<=e.y?o.y>e.y&&Kb(r,o,e)>0&&(t+=1):o.y<=e.y&&Kb(r,o,e)<0&&(t-=1);return t!==0}function IN(e,n,t=8){const r=n.length;for(let o=1;o<r;o++){const s=n[o-1],i=n[o];if(E.DistanceToLineSegment(s,i,e)<t)return!0}return!1}function R(e){return+e.toFixed(4)}function gf(e){return+e.toFixed(2)}const Hb=e=>Math.abs(e)<Number.MAX_SAFE_INTEGER,et=class et{constructor(n=0,t=0,r=0,o=0){v(this,"x",0);v(this,"y",0);v(this,"w",0);v(this,"h",0);this.x=n,this.y=t,this.w=r,this.h=o}get point(){return new E(this.x,this.y)}set point(n){this.x=n.x,this.y=n.y}get minX(){return this.x}set minX(n){this.x=n}get midX(){return this.x+this.w/2}get maxX(){return this.x+this.w}get minY(){return this.y}set minY(n){this.y=n}get midY(){return this.y+this.h/2}get maxY(){return this.y+this.h}get width(){return this.w}set width(n){this.w=n}get height(){return this.h}set height(n){this.h=n}get aspectRatio(){return this.width/this.height}get center(){return new E(this.midX,this.midY)}set center(n){this.minX=n.x-this.width/2,this.minY=n.y-this.height/2}get corners(){return[new E(this.minX,this.minY),new E(this.maxX,this.minY),new E(this.maxX,this.maxY),new E(this.minX,this.maxY)]}get snapPoints(){return[new E(this.minX,this.minY),new E(this.maxX,this.minY),new E(this.maxX,this.maxY),new E(this.minX,this.maxY),this.center]}get sides(){const{corners:n}=this;return[[n[0],n[1]],[n[1],n[2]],[n[2],n[3]],[n[3],n[0]]]}get size(){return new E(this.w,this.h)}toFixed(){return this.x=md(this.x),this.y=md(this.y),this.w=md(this.w),this.h=md(this.h),this}setTo(n){return this.x=n.x,this.y=n.y,this.w=n.w,this.h=n.h,this}set(n=0,t=0,r=0,o=0){return this.x=n,this.y=t,this.w=r,this.h=o,this}expand(n){const t=Math.min(this.minX,n.minX),r=Math.min(this.minY,n.minY),o=Math.max(this.maxX,n.maxX),s=Math.max(this.maxY,n.maxY);return this.x=t,this.y=r,this.w=o-t,this.h=s-r,this}expandBy(n){return this.x-=n,this.y-=n,this.w+=n*2,this.h+=n*2,this}scale(n){return this.x/=n,this.y/=n,this.w/=n,this.h/=n,this}clone(){const{x:n,y:t,w:r,h:o}=this;return new et(n,t,r,o)}translate(n){return this.x+=n.x,this.y+=n.y,this}snapToGrid(n){const t=Math.round(this.minX/n)*n,r=Math.round(this.minY/n)*n,o=Math.round(this.maxX/n)*n,s=Math.round(this.maxY/n)*n;this.minX=t,this.minY=r,this.width=Math.max(1,o-t),this.height=Math.max(1,s-r)}collides(n){return et.Collides(this,n)}contains(n){return et.Contains(this,n)}includes(n){return et.Includes(this,n)}containsPoint(n,t){return et.ContainsPoint(this,n,t)}getHandlePoint(n){switch(n){case"top_left":return new E(this.minX,this.minY);case"top_right":return new E(this.maxX,this.minY);case"bottom_left":return new E(this.minX,this.maxY);case"bottom_right":return new E(this.maxX,this.maxY);case"top":return new E(this.midX,this.minY);case"right":return new E(this.maxX,this.midY);case"bottom":return new E(this.midX,this.maxY);case"left":return new E(this.minX,this.midY)}}toJson(){return{x:this.minX,y:this.minY,w:this.w,h:this.h}}resize(n,t,r){const{minX:o,minY:s,maxX:i,maxY:a}=this;let{minX:l,minY:c,maxX:u,maxY:d}=this;switch(n){case"left":case"top_left":case"bottom_left":{l+=t;break}case"right":case"top_right":case"bottom_right":{u+=t;break}}switch(n){case"top":case"top_left":case"top_right":{c+=r;break}case"bottom":case"bottom_left":case"bottom_right":{d+=r;break}}const h=(u-l)/(i-o),f=(d-c)/(a-s),p=h<0,m=f<0;if(p){const y=u;u=l,l=y}if(m){const y=d;d=c,c=y}this.minX=l,this.minY=c,this.width=Math.abs(u-l),this.height=Math.abs(d-c)}union(n){const t=Math.min(this.minX,n.x),r=Math.min(this.minY,n.y),o=Math.max(this.maxX,n.w+n.x),s=Math.max(this.maxY,n.h+n.y);return this.x=t,this.y=r,this.width=o-t,this.height=s-r,this}static From(n){return new et(n.x,n.y,n.w,n.h)}static FromPoints(n){if(n.length===0)return new et;let t=1/0,r=1/0,o=-1/0,s=-1/0,i;for(let a=0,l=n.length;a<l;a++)i=n[a],t=Math.min(i.x,t),r=Math.min(i.y,r),o=Math.max(i.x,o),s=Math.max(i.y,s);return new et(t,r,o-t,s-r)}static Expand(n,t){const r=Math.min(t.minX,n.minX),o=Math.min(t.minY,n.minY),s=Math.max(t.maxX,n.maxX),i=Math.max(t.maxY,n.maxY);return new et(r,o,s-r,i-o)}static ExpandBy(n,t){return new et(n.minX-t,n.minY-t,n.width+t*2,n.height+t*2)}static Resize(n,t,r,o,s=!1){const{minX:i,minY:a,maxX:l,maxY:c}=n;let{minX:u,minY:d,maxX:h,maxY:f}=n;switch(t){case"left":case"top_left":case"bottom_left":{u+=r;break}case"right":case"top_right":case"bottom_right":{h+=r;break}}switch(t){case"top":case"top_left":case"top_right":{d+=o;break}case"bottom":case"bottom_left":case"bottom_right":{f+=o;break}}const p=(h-u)/(l-i),m=(f-d)/(c-a),y=p<0,x=m<0;if(s){const b=(l-i)/(c-a),P=Math.abs(h-u),C=Math.abs(f-d),_=P*(m<0?1:-1)*(1/b),I=C*(p<0?1:-1)*b,k=b<P/C;switch(t){case"top_left":{k?d=f+_:u=h+I;break}case"top_right":{k?d=f+_:h=u-I;break}case"bottom_right":{k?f=d-_:h=u-I;break}case"bottom_left":{k?f=d-_:u=h+I;break}case"bottom":case"top":{const T=(u+h)/2,M=C*b;u=T-M/2,h=T+M/2;break}case"left":case"right":{const T=(d+f)/2,M=P/b;d=T-M/2,f=T+M/2;break}}}if(y){const b=h;h=u,u=b}if(x){const b=f;f=d,d=b}const S=new et(u,d,Math.abs(h-u),Math.abs(f-d));return{box:S,scaleX:+(S.width/n.width*(p>0?1:-1)).toFixed(5),scaleY:+(S.height/n.height*(m>0?1:-1)).toFixed(5)}}equals(n){return et.Equals(this,n)}static Equals(n,t){return t.x===n.x&&t.y===n.y&&t.w===n.w&&t.h===n.h}};v(et,"Collides",(n,t)=>!(n.maxX<t.minX||n.minX>t.maxX||n.maxY<t.minY||n.minY>t.maxY)),v(et,"Contains",(n,t)=>n.minX<t.minX&&n.minY<t.minY&&n.maxY>t.maxY&&n.maxX>t.maxX),v(et,"Includes",(n,t)=>et.Collides(n,t)||et.Contains(n,t)),v(et,"ContainsPoint",(n,t,r)=>typeof t=="number"?!(t<n.minX||r<n.minY||t>n.maxX||r>n.maxY):!(t.x<n.minX||t.y<n.minY||t.x>n.maxX||t.y>n.maxY)),v(et,"Common",n=>{let t=1/0,r=1/0,o=-1/0,s=-1/0;for(let i=0;i<n.length;i++){const a=n[i];t=Math.min(t,a.minX),r=Math.min(r,a.minY),o=Math.max(o,a.maxX),s=Math.max(s,a.maxY)}return new et(t,r,o-t,s-r)}),v(et,"Sides",(n,t=0)=>{const{corners:r}=n;return[[r[0],r[1]],[r[1],r[2]],[r[2],r[3]],[r[3],r[0]]]});let ne=et;function kN(e){switch(e){case"top":return"bottom";case"bottom":return"top";case"top_left":return"bottom_left";case"top_right":return"bottom_right";case"bottom_left":return"top_left";case"bottom_right":return"top_right";default:return e}}function $N(e){switch(e){case"left":return"right";case"right":return"left";case"top_left":return"top_right";case"top_right":return"top_left";case"bottom_left":return"bottom_right";case"bottom_right":return"bottom_left";default:return e}}function TN(e){return e==="top_left"||e==="top_right"||e==="bottom_right"||e==="bottom_left"}class sk{constructor(n){v(this,"_values");v(this,"_computed",{});this._values=n}get values(){return this._values}set values(n){this._values=n,this._computed={}}get length(){if(this._computed.length!==void 0)return this._computed.length;const{lut:n}=this;let t=n[0],r=0;for(let o=1;o<n.length;o++){const s=n[o];r+=t.dist(s),t=s}return this._computed.length=r,r}get bounds(){if(this._computed.bounds!==void 0)return this._computed.bounds;let n=1/0,t=1/0,r=-1/0,o=-1/0;const{lut:s}=this;for(const a of s)n=Math.min(a.x,n),t=Math.min(a.y,t),r=Math.max(a.x,r),o=Math.max(a.y,o);const i=new ne(n,t,r-n,o-t);return this._computed.bounds=i,i}get lut(){if(this._computed.lut)return this._computed.lut;const{p:n}=this.values,t=[];for(let r=0;r<n+1;r++)t.push(this.getPoint(r/n));return this._computed.lut=t,t}get midPoint(){if(this._computed.midPoint)return this._computed.midPoint;const n=this.getPoint(.5);return this._computed.midPoint=n,n}get path(){if(this._computed.path)return this._computed.path;const n=this.getPath();return this._computed.path=n,n}getPointAtLength(n){const t=Math.max(0,Math.min(1,n/this.length));return this.getPoint(t)}getNormal(n){return this.getPoint(n-.0025).tan(this.getPoint(n+.0025)).per().uni().toFixed()}getNormalAtLength(n){return this.getNormal(n/this.length)}getClosestPointTo(n){const{lut:t}=this;let r=0,o=t[0],s=t[0].dist(n);for(let a=1;a<t.length;a++){const l=E.Dist(t[a],n);l<s&&(s=l,o=t[a],r=a/t.length)}const i=1/this.values.p;for(let a=Math.max(0,r-i/2);a<Math.min(1,r+i/2);a+=i/10){const l=this.getPoint(a),c=E.Dist(l,n);c<s&&(s=c,o=l)}return{point:o,distance:s}}update(n){this._computed={},this.values={...this.values,...n}}}var Rte;class MN extends sk{constructor(t,r,o,s,i=25){super({a:t,b:r,c:o,d:s,p:i});v(this,Rte,function*(){const{a:t,b:r,c:o,d:s}=this.values;yield*[t,r,o,s]})}getPath(t=!0){const{a:r,b:o,c:s,d:i}=this.values;return E.Equals(r,i)?"":`${t?`M${r.x.toFixed(2)},${r.y.toFixed(2)}C`:""}${o.x.toFixed(2)},${o.y.toFixed(2)} ${s.x.toFixed(2)},${s.y.toFixed(2)} ${i.x.toFixed(2)},${i.y.toFixed(2)}`}getPoint(t){const{a:r,b:o,c:s,d:i}=this.values;return t<=0?E.From(r):t>=1?E.From(i):new E((1-t)*(1-t)*(1-t)*r.x+3*((1-t)*(1-t))*t*o.x+3*(1-t)*(t*t)*s.x+t*t*t*i.x,(1-t)*(1-t)*(1-t)*r.y+3*((1-t)*(1-t))*t*o.y+3*(1-t)*(t*t)*s.y+t*t*t*i.y)}getX(t){const{a:r,b:o,c:s,d:i}=this.values;return(1-t)*(1-t)*(1-t)*r.x+3*((1-t)*(1-t))*t*o.x+3*(1-t)*(t*t)*s.x+t*t*t*i.x}getY(t){const{a:r,b:o,c:s,d:i}=this.values;return(1-t)*(1-t)*(1-t)*r.y+3*((1-t)*(1-t))*t*o.y+3*(1-t)*(t*t)*s.y+t*t*t*i.y}}Rte=Symbol.iterator;class ik{constructor(n,t=50,r=1){v(this,"computed",{});this.points=n,this.p=t,this.k=r}get length(){if(this.computed.length!==void 0)return this.computed.length;const{segments:n}=this,t=n.reduce((r,o)=>r+o.length,0);return this.computed.length=t,t}get bounds(){if(this.computed.bounds!==void 0)return this.computed.bounds;const{segments:n}=this,t=ne.Common(n.map(r=>r.bounds));return this.computed.bounds=t,t}get head(){const{points:n}=this;return n[0]}get tail(){const{points:n}=this;return n[n.length-1]}get path(){if(this.computed.path!==void 0)return this.computed.path;const n=this.segments.map(t=>t.path).filter(t=>t!=null&&t!=="").join(" ");return this.computed.path=n,n}addPoint(n){const{points:t,k:r,p:o}=this;return t.push(n),this.computed={},this.getSegmentsFromPoints(this.points,o,r),this}removePoint(n){const{points:t,k:r,p:o}=this,s=typeof n=="number"?Math.floor(n):t.indexOf(n);return s===-1?this:(t.splice(s,1),this.computed={},this.getSegmentsFromPoints(this.points,o,r),this)}getPointAtLength(n){const{segments:t}=this;let r=n;if(n<=0)return t[0].getPoint(0);if(n>=this.length)return t[t.length-1].getPoint(1);for(let o=0;o<t.length;o++){const s=t[o],{length:i}=s;if(r<i)return s.getPoint(r/i);r-=s.length}return t[t.length-1].getPoint(1)}getPoint(n){return n<=0?this.segments[0].getPoint(0):n>=1?this.segments[this.segments.length-1].getPoint(1):this.getPointAtLength(n*this.length)}getNormal(n){const{length:t}=this;return this.getNormalAtLength(n*t)}getNormalAtLength(n){const{segments:t}=this;if(n<0)return new E(0,0);let r=n;for(const o of t){const s=o.length;if(r<=s)return o.getNormal(r/s);r-=s}return new E(0,0)}getClosestPointTo(n){const{head:t,segments:r}=this;let o=t,s=E.Dist(n,t);for(const i of r){const a=i.getClosestPointTo(n);a.distance<s&&(s=a.distance,o=a.point)}return{point:o,distance:s}}}class N1 extends ik{constructor(t,r=1.2,o=20){super(t,r,o);v(this,"segments");this.segments=this.getSegmentsFromPoints(t,r,o)}getSegmentsFromPoints(t,r=1.25,o=20){const s=t.length,i=s-2,a=[];for(let l=0;l<s-1;l++){const c=l===0?t[0]:t[l-1],u=t[l],d=t[l+1],h=l===i?d:t[l+2];a.push(new MN(u,l===0?c:new E(u.x+(d.x-c.x)/6*r,u.y+(d.y-c.y)/6*r),l===i?d:new E(d.x-(h.x-u.x)/6*r,d.y-(h.y-u.y)/6*r),d,o))}return a}static FromPoints(t){return new N1(t)}}class AN extends sk{constructor(n,t,r=2){super({a:n,b:t,p:r}),this.a=n,this.b=t,this.values.p=Math.max(10,Math.ceil(this.length/20))}get length(){return E.Dist(this.a,this.b)}get tangent(){return E.Tan(this.a,this.b)}get angle(){return E.Angle(this.a,this.b)}get bounds(){return ne.FromPoints([this.a,this.b])}getX(n){const{a:t,b:r}=this.values;return t.x+(r.x-t.x)*n}getY(n){const{a:t,b:r}=this.values;return t.y+(r.y-t.y)*n}getPoint(n){const{a:t,b:r}=this.values;return n<=0?E.From(t):n>=1?E.From(r):E.Lrp(t,r,n)}getPath(n=!0){const{a:t,b:r}=this.values;return E.Equals(t,r)?"":n?`M${t.x},${t.y}L${r.x},${r.y}`:`${r.x},${r.y}`}getNormal(){const{a:n,b:t}=this.values;return E.Sub(n,t).per().uni().toFixed()}getClosestPointTo(n){const{a:t,b:r}=this.values,o=E.NearestPointOnLineSegment(t,r,n),s=o.dist(n);return{point:o,distance:s}}static Length(n){return E.Dist(n.a,n.b)}static Tangent(n){return E.Tan(n.a,n.b)}static Angle(n){return E.Angle(n.a,n.b)}}const Le=class Le{constructor(n,t,r,o,s,i){v(this,"a",1);v(this,"b",0);v(this,"c",0);v(this,"d",1);v(this,"e",0);v(this,"f",0);this.a=n,this.b=t,this.c=r,this.d=o,this.e=s,this.f=i}equals(n){return this.a===n.a&&this.b===n.b&&this.c===n.c&&this.d===n.d&&this.e===n.e&&this.f===n.f}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}multiply(n){const t=n,{a:r,b:o,c:s,d:i,e:a,f:l}=this;return this.a=r*t.a+s*t.b,this.c=r*t.c+s*t.d,this.e=r*t.e+s*t.f+a,this.b=o*t.a+i*t.b,this.d=o*t.c+i*t.d,this.f=o*t.e+i*t.f+l,this}rotate(n,t,r){return n===0?this:t===void 0?this.multiply(Le.Rotate(n)):this.translate(t,r).multiply(Le.Rotate(n)).translate(-t,-r)}translate(n,t){return this.multiply(Le.Translate(n,t))}scale(n,t){return this.multiply(Le.Scale(n,t))}invert(){const{a:n,b:t,c:r,d:o,e:s,f:i}=this,a=n*o-t*r;return this.a=o/a,this.b=t/-a,this.c=r/-a,this.d=n/a,this.e=(o*s-r*i)/-a,this.f=(t*s-n*i)/a,this}applyToPoint(n){return Le.applyToPoint(this,n)}applyToPoints(n){return Le.applyToPoints(this,n)}decomposed(){return Le.Decompose(this)}toCssString(){return Le.toCssString(this)}setTo(n){return Object.assign(this,n),this}decompose(){return Le.Decompose(this)}clone(){return new Le(this.a,this.b,this.c,this.d,this.e,this.f)}static Identity(){return new Le(1,0,0,1,0,0)}static Translate(n,t){return new Le(1,0,0,1,n,t)}static Rotate(n,t,r){if(n===0)return Le.Identity();const o=Math.cos(n),s=Math.sin(n),i=new Le(o,s,-s,o,0,0);return t===void 0?i:Le.Compose(Le.Translate(t,r),i,Le.Translate(-t,-r))}static Multiply(n,t){return{a:n.a*t.a+n.c*t.b,c:n.a*t.c+n.c*t.d,e:n.a*t.e+n.c*t.f+n.e,b:n.b*t.a+n.d*t.b,d:n.b*t.c+n.d*t.d,f:n.b*t.e+n.d*t.f+n.f}}static Inverse(n){const t=n.a*n.d-n.b*n.c;return{a:n.d/t,b:n.b/-t,c:n.c/-t,d:n.a/t,e:(n.d*n.e-n.c*n.f)/-t,f:(n.b*n.e-n.a*n.f)/t}}static Absolute(n){const t=n.a*n.d-n.b*n.c;return{a:n.d/t,b:n.b/-t,c:n.c/-t,d:n.a/t,e:(n.d*n.e-n.c*n.f)/t,f:(n.b*n.e-n.a*n.f)/-t}}static Compose(...n){const t=Le.Identity();for(let r=0,o=n.length;r<o;r++)t.multiply(n[r]);return t}static Decompose(n){let t,r,o;if(n.a!==0||n.c!==0){const s=Math.hypot(n.a,n.c);t=s,r=(n.a*n.d-n.b*n.c)/s,o=Math.acos(n.a/s)*(n.c>0?-1:1)}else if(n.b!==0||n.d!==0){const s=Math.hypot(n.b,n.d);t=(n.a*n.d-n.b*n.c)/s,r=s,o=_e+Math.acos(n.b/s)*(n.d>0?-1:1)}else t=0,r=0,o=0;return{x:n.e,y:n.f,scaleX:t,scaleY:r,rotation:rk(o)}}static Smooth(n,t=1e10){return n.a=Math.round(n.a*t)/t,n.b=Math.round(n.b*t)/t,n.c=Math.round(n.c*t)/t,n.d=Math.round(n.d*t)/t,n.e=Math.round(n.e*t)/t,n.f=Math.round(n.f*t)/t,n}static toCssString(n){return`matrix(${R(n.a)}, ${R(n.b)}, ${R(n.c)}, ${R(n.d)}, ${R(n.e)}, ${R(n.f)})`}static applyToPoint(n,t){return new E(n.a*t.x+n.c*t.y+n.e,n.b*t.x+n.d*t.y+n.f,t.z)}static applyToXY(n,t,r){return[n.a*t+n.c*r+n.e,n.b*t+n.d*r+n.f]}static applyToPoints(n,t){return t.map(r=>new E(n.a*r.x+n.c*r.y+n.e,n.b*r.x+n.d*r.y+n.f,r.z))}static applyToBounds(n,t){return new ne(n.e+t.minX,n.f+t.minY,t.width,t.height)}static From(n){return new Le(n.a,n.b,n.c,n.d,n.e,n.f)}};v(Le,"Scale",(n,t,r,o)=>{const s=new Le(n,0,0,0,t,0);return r===void 0?s:Le.Compose(Le.Translate(r,o),s,Le.Translate(-r,-o))});let Y=Le;class z1 extends ik{constructor(t,r=1.2,o=20){super(t,r,o);v(this,"segments");this.segments=this.getSegmentsFromPoints(t,o)}getSegmentsFromPoints(t,r=50){const o=[];for(let s=0;s<t.length-1;s++)o.push(new AN(t[s],t[s+1],r));return o}static FromPoints(t){return new z1(t)}}const{PI:ON}=Math,Gi=ON+1e-4;function Fc(e,n={}){const{size:t=16,smoothing:r=.5,start:o={},end:s={},last:i=!1}=n,{cap:a=!0}=o,{cap:l=!0}=s;if(e.length===0||t<=0)return[];const c=e[0],u=e[e.length-1],d=u.runningLength,h=o.taper===!1?0:o.taper===!0?Math.max(t,d):o.taper,f=s.taper===!1?0:s.taper===!0?Math.max(t,d):s.taper,p=Math.pow(t*r,2),m=[],y=[];let x=e[0].vector,S=e[0].point,b=S,P=S,C=b,_=!1,I;for(let B=0;B<e.length;B++){I=e[B];const{point:D,vector:F}=e[B],V=I.vector.dpr(x),q=(B<e.length-1?e[B+1]:e[B]).vector,L=B<e.length-1?q.dpr(I.vector):1,N=V<0&&!_,H=L!==null&&L<.2;if(N||H){if(L>-.62&&d-I.runningLength>I.radius){const Z=x.clone().mul(I.radius);x.clone().cpr(q)<0?(P=E.Add(D,Z),C=E.Sub(D,Z)):(P=E.Sub(D,Z),C=E.Add(D,Z)),m.push(P),y.push(C)}else{const Z=x.clone().mul(I.radius).per(),Ee=E.Sub(I.input,Z);for(let ke=1/13,ue=0;ue<1;ue+=ke)P=E.RotWith(Ee,I.input,Gi*ue),m.push(P),C=E.RotWith(Ee,I.input,Gi+Gi*-ue),y.push(C)}S=P,b=C,H&&(_=!0);continue}if(_=!1,I===c||I===u){const Z=E.Per(F).mul(I.radius);m.push(E.Sub(D,Z)),y.push(E.Add(D,Z));continue}const Q=E.Lrp(q,F,L).per().mul(I.radius);P=E.Sub(D,Q),(B<=1||E.Dist2(S,P)>p)&&(m.push(P),S=P),C=E.Add(D,Q),(B<=1||E.Dist2(b,C)>p)&&(y.push(C),b=C),x=F}const k=c.point,T=e.length>1?e[e.length-1].point:E.AddXY(c.point,1,1);if(e.length===1&&(!(h||f)||i)){const B=E.Add(k,E.Sub(k,T).uni().per().mul(-c.radius)),D=[];for(let F=1/13,V=F;V<=1;V+=F)D.push(E.RotWith(B,k,Gi*2*V));return D}const M=[];if(!(h||f&&e.length===1))if(a)for(let B=1/8,D=B;D<=1;D+=B){const F=E.RotWith(y[0],k,Gi*D);M.push(F)}else{const B=E.Sub(m[0],y[0]),D=E.Mul(B,.5),F=E.Mul(B,.51);M.push(E.Sub(k,D),E.Sub(k,F),E.Add(k,F),E.Add(k,D))}const O=[],z=u.vector.clone().per().neg();if(f||h&&e.length===1)O.push(T);else if(l){const B=E.Add(T,E.Mul(z,u.radius));for(let D=1/29,F=D;F<1;F+=D)O.push(E.RotWith(B,T,Gi*3*F))}else O.push(E.Add(T,E.Mul(z,u.radius)),E.Add(T,E.Mul(z,u.radius*.99)),E.Sub(T,E.Mul(z,u.radius*.99)),E.Sub(T,E.Mul(z,u.radius)));return m.concat(O,y.reverse(),M)}const RN=.025,DN=.01;function xs(e,n={}){var y;const{streamline:t=.5,size:r=16,simulatePressure:o=!1}=n;if(e.length===0)return[];const s=.15+(1-t)*.85;let i=e.map(E.From),a=0;if(!o){let x=i[0];for(;x&&!(x.z>=RN);)i.shift(),x=i[0]}if(!o){let x=i[i.length-1];for(;x&&!(x.z>=DN);)i.pop(),x=i[i.length-1]}if(i.length===0)return[{point:E.From(e[0]),input:E.From(e[0]),pressure:o?.5:.15,vector:new E(1,1),distance:0,runningLength:0,radius:1}];let l=i[1];for(;l&&!(E.Dist(l,i[0])>r/3);)i[0].z=Math.max(i[0].z,l.z),i.splice(1,1),l=i[1];const c=i.pop();for(l=i[i.length-1];l&&!(E.Dist(l,c)>r/3);)i.pop(),l=i[i.length-1],a++;i.push(c);const u=n.last||!n.simulatePressure||i.length>1&&E.Dist(i[i.length-1],i[i.length-2])<r||a>0;if(i.length===2&&n.simulatePressure){const x=i[1];i=i.slice(0,-1);for(let S=1;S<5;S++){const b=E.Lrp(i[0],x,S/4);b.z=(i[0].z+(x.z-i[0].z))*S/4,i.push(b)}}const d=[{point:i[0],input:i[0],pressure:o?.5:i[0].z,vector:new E(1,1),distance:0,runningLength:0,radius:1}];let h=0,f=d[0],p,m;u&&t>0&&i.push(i[i.length-1].clone());for(let x=1,S=i.length;x<S;x++)p=!s||n.last&&x===S-1?i[x].clone():i[x].clone().lrp(f.point,1-s),!f.point.equals(p)&&(m=E.Dist(p,f.point),h+=m,!(x<4&&h<r)&&(f={input:i[x],point:p,pressure:o?.5:i[x].z,vector:E.Sub(f.point,p).uni(),distance:m,runningLength:h,radius:1},d.push(f)));if((y=d[1])!=null&&y.vector&&(d[0].vector=d[1].vector.clone()),h<1){const x=Math.max(.5,...d.map(S=>S.pressure));d.forEach(S=>S.pressure=x)}return d}const{min:Qo}=Math,em=.275;function Uc(e,n){const{size:t=16,thinning:r=.5,simulatePressure:o=!0,easing:s=y=>y,start:i={},end:a={}}=n,{easing:l=Kt.easeOutQuad}=i,{easing:c=Kt.easeOutCubic}=a,u=e[e.length-1].runningLength;let d,h=e[0].pressure,f;if(!o&&u<t){const y=e.reduce((x,S)=>Math.max(x,S.pressure),.5);return e.forEach(x=>{x.pressure=y,x.radius=t*s(.5-r*(.5-x.pressure))}),e}else{let y;for(let x=0,S=e.length;x<S&&(f=e[x],!(f.runningLength>t*5));x++){const b=Qo(1,f.distance/t);if(o){const P=Qo(1,1-b);y=Qo(1,h+(P-h)*(b*em))}else y=Qo(1,h+(f.pressure-h)*.5);h=h+(y-h)*.5}for(let x=0;x<e.length;x++){if(f=e[x],r){let{pressure:S}=f;const b=Qo(1,f.distance/t);if(o){const P=Qo(1,1-b);S=Qo(1,h+(P-h)*(b*em))}else S=Qo(1,h+(S-h)*(b*em));f.radius=t*s(.5-r*(.5-S)),h=S}else f.radius=t/2;d===void 0&&(d=f.radius)}}const p=i.taper===!1?0:i.taper===!0?Math.max(t,u):i.taper,m=a.taper===!1?0:a.taper===!0?Math.max(t,u):a.taper;if(p||m)for(let y=0;y<e.length;y++){f=e[y];const{runningLength:x}=f,S=x<p?l(x/p):1,b=u-x<m?c((u-x)/m):1;f.radius=Math.max(.01,f.radius*Math.min(S,b))}return e}function LN(e,n={}){return Fc(Uc(xs(e,n),n),n)}function B1(e,n,t,r){const o=e.x-t.x,s=e.y-t.y,i=r.x-t.x,a=r.y-t.y,l=n.x-e.x,c=n.y-e.y,u=i*s-a*o,d=l*s-c*o,h=a*l-i*c;if(u===0||d===0||h===0)return null;if(h!==0){const f=u/h,p=d/h;if(0<=f&&f<=1&&0<=p&&p<=1)return E.AddXY(e,f*l,f*c)}return null}function ak(e,n,t,r){const o=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),s=2*((n.x-e.x)*(e.x-t.x)+(n.y-e.y)*(e.y-t.y)),i=t.x*t.x+t.y*t.y+e.x*e.x+e.y*e.y-2*(t.x*e.x+t.y*e.y)-r*r,a=s*s-4*o*i;if(a<0||a===0)return null;const l=Math.sqrt(a),c=(-s+l)/(2*o),u=(-s-l)/(2*o);if((c<0||c>1)&&(u<0||u>1))return null;const d=[];return 0<=c&&c<=1&&d.push(E.Lrp(e,n,c)),0<=u&&u<=1&&d.push(E.Lrp(e,n,u)),d.length===0?null:d}function F1(e,n,t){const r=[];let o;for(let s=0,i=t.length-1;s<i;s++)o=B1(e,n,t[s],t[s+1]),o&&r.push(o);return r.length===0?null:r}function jN(e,n,t){const r=[];let o;for(let s=1,i=t.length;s<i+1;s++)o=B1(e,n,t[s-1],t[s%t.length]),o&&r.push(o);return r.length===0?null:r}function NN(e,n,t,r){let o=t.x-e.x,s=t.y-e.y;const i=Math.sqrt(o*o+s*s),a=(i*i-r*r+n*n)/(2*i),l=Math.sqrt(n*n-a*a);return o/=i,s/=i,[new E(e.x+o*a-s*l,e.y+s*a+o*l),new E(e.x+o*a+s*l,e.y+s*a-o*l)]}function Vb(e,n,t){const r=[];let o,s,i;for(let a=0,l=t.length;a<l;a++)o=t[a],s=t[(a+1)%t.length],i=ak(o,s,e,n),i&&r.push(...i);return r.length===0?null:r}function Wb(e,n,t){const r=[];let o,s,i;for(let a=1,l=t.length;a<l;a++)o=t[a-1],s=t[a],i=ak(o,s,e,n),i&&r.push(...i);return r.length===0?null:r}function vd(e,n,t){return(t.y-e.y)*(n.x-e.x)>(n.y-e.y)*(t.x-e.x)}function Gr(e,n,t,r){return vd(e,t,r)!==vd(n,t,r)&&vd(e,n,t)!==vd(e,n,r)}function E0(e,n){const t=[];let r,o,s,i;for(let a=0,l=e.length;a<l;a++)r=e[a],sr(r,n)&&t.push(r);for(let a=0,l=n.length;a<l;a++)r=n[a],sr(r,e)&&t.push(r);for(let a=0,l=e.length;a<l;a++){r=e[a],o=e[(a+1)%e.length];for(let c=0,u=n.length;c<u;c++){s=n[c],i=n[(c+1)%n.length];const d=B1(r,o,s,i);d!==null&&t.push(d)}}return t.length===0?null:zN(t)}function zN(e){const n=E.Average(e);return e.sort((t,r)=>E.Angle(n,t)-E.Angle(n,r))}function BN(e,n){let t,r,o,s;for(let i=0,a=e.length;i<a;i++){t=e[i],r=e[(i+1)%a];for(let l=0,c=n.length;l<c;l++)if(o=n[l],s=n[(l+1)%c],Gr(t,r,o,s))return!0}return!1}function at(e){return`${R(e.x)},${R(e.y)} `}function lk(e=""){let n=0,t=0,r=0,o=0;function s(){const i=n^n<<11;return n=t,t=r,r=o,o^=(o>>>19^i^i>>>8)>>>0,o/4294967296*2}for(let i=0;i<e.length+64;i++)n^=e.charCodeAt(i)|0,s();return s}function Kc(e){let n="M";const t=e.length;let r,o,s;for(let i=0,a=t;i<a;i+=3)r=e[i],o=e[i+1],s=e[i+2],n+=`${at(r)}L${at(o)}Q${at(s)}`;return n+=`${at(e[0])}`,n}function Hc(e,n,t,r,o){const s=[],i=lk(e);let a=n[0],l;const c=n.length;for(let u=0,d=c*o;u<d;u++){l=E.AddXY(n[(u+1)%c],i()*t,i()*t);const h=E.Sub(l,a),f=E.Len(h),p=E.Div(h,f).mul(Math.min(f/4,r));s.push(E.Add(a,p),E.Add(l,p.neg()),l),a=l}return s}function Yb(e,n,t){let r=`M${at(n[0])}L`,o=`M${at(n[0])}L`,s=`M${at(n[0])}L`;const i=t/3,a=t*2,l=lk(e);let c=n[0],u,d=n[0],h;const f=n.length;for(let p=0,m=f-1;p<m;p++){u=E.AddXY(n[p+1],l()*i,l()*i),h=E.AddXY(n[p+1],l(),l()*i);const y=E.Sub(u,c),x=E.Len(y),S=E.Div(y,x).mul(Math.min(x/4,a)),b=E.Add(c,S),P=E.Add(u,S.neg()),C=E.Sub(h,d),_=E.Len(C),I=E.Div(C,_).mul(Math.min(_/4,a)),k=E.Add(d,I),T=E.Add(h,I.neg());p===m-1?(r+=`${at(b)} L ${at(u)}`,o+=`${at(b)} L ${at(u)}`,s+=`${at(k)} L ${at(h)}`):(r+=`${at(b)}L ${at(P)}Q ${at(u)}`,o+=`${at(b)}L ${at(P)}Q ${at(u)}`,s+=`${at(k)}L ${at(T)}Q ${at(h)}`,c=u,d=h)}return[r,o+s]}const U1={peopleMenu:Xb("peopleMenu"),highlighterTool:Xb("highlighterTool",{all:!0})},pt={preventDefaultLogging:fr("preventDefaultLogging",{defaults:{all:!1}}),pointerCaptureLogging:fr("pointerCaptureLogging",{defaults:{all:!1}}),pointerCaptureTracking:fr("pointerCaptureTracking",{defaults:{all:!1}}),pointerCaptureTrackingObject:fr("pointerCaptureTrackingObject",{defaults:{all:new Map},shouldStoreForSession:!1}),elementRemovalLogging:fr("elementRemovalLogging",{defaults:{all:!1}}),debugSvg:fr("debugSvg",{defaults:{all:!1}}),throwToBlob:fr("throwToBlob",{defaults:{all:!1}}),logMessages:fr("uiLog",{defaults:{all:[]}}),resetConnectionEveryPing:fr("resetConnectionEveryPing",{defaults:{all:!1}}),debugCursors:fr("debugCursors",{defaults:{all:!1}}),forceSrgb:fr("forceSrgbColors",{defaults:{all:!1}})};typeof window<"u"&&(window.tldrawLog=e=>{pt.logMessages.set(pt.logMessages.value.concat(e))});if(typeof Element<"u"){const e=Element.prototype.removeChild;lp("element removal logging",()=>{pt.elementRemovalLogging.value?Element.prototype.removeChild=function(n){return console.warn("[tldraw] removing child:",n),e.call(this,n)}:Element.prototype.removeChild=e})}function fr(e,{defaults:n,shouldStoreForSession:t=!0}){return ck({name:e,defaults:n,shouldStoreForSession:t})}function Xb(e,n={all:!0,production:!1}){return ck({name:e,defaults:n,shouldStoreForSession:!0})}function ck(e){const n=UN(e),t=e.shouldStoreForSession?FN(e.name):null,r=dt(`debug:${e.name}`,t??n);return typeof window<"u"&&(e.shouldStoreForSession&&lp(`debug:${e.name}`,()=>{const o=r.value;try{o===n?window.sessionStorage.removeItem(`tldraw_debug:${e.name}`):window.sessionStorage.setItem(`tldraw_debug:${e.name}`,JSON.stringify(o))}catch{}}),Object.defineProperty(window,`tldraw${e.name.replace(/^[a-z]/,o=>o.toUpperCase())}`,{get(){return r.value},set(o){r.set(o)},configurable:!0})),Object.assign(r,e)}function FN(e){try{return JSON.parse((window==null?void 0:window.sessionStorage.getItem(`tldraw_debug:${e}`))??"null")}catch{return null}}function tm(e){try{return e()}catch{return null}}function UN(e){switch(tm(()=>({}).TLDRAW_ENV)??tm(()=>({}).VERCEL_PUBLIC_TLDRAW_ENV)??tm(()=>({}).NEXT_PUBLIC_TLDRAW_ENV)??"production"){case"production":return e.defaults.production??e.defaults.all;case"preview":case"staging":return e.defaults.staging??e.defaults.all;default:return e.defaults.development??e.defaults.all}}function mf(e){if(e instanceof HTMLElement)return e;if(e.parentElement)return mf(e.parentElement);throw Error("Could not find a parent element of an HTML type!")}function Se(e){e.preventDefault(),pt.preventDefaultLogging.value&&console.warn("preventDefault called on event:",e)}function xu(e,n){if(e.setPointerCapture(n.pointerId),pt.pointerCaptureTracking.value){const t=pt.pointerCaptureTrackingObject.value;t.set(e,(t.get(e)??0)+1)}pt.pointerCaptureLogging.value&&console.warn("setPointerCapture called on element:",e,n)}function Su(e,n){if(e.hasPointerCapture(n.pointerId)){if(e.releasePointerCapture(n.pointerId),pt.pointerCaptureTracking.value){const t=pt.pointerCaptureTrackingObject.value;t.get(e)===1?t.delete(e):t.has(e)?t.set(e,t.get(e)-1):console.warn("Release without capture")}pt.pointerCaptureLogging.value&&console.warn("releasePointerCapture called on element:",e,n)}}const KN=[{offsetX:0,offsetY:2,blur:4,spread:0,color:"#00000029"},{offsetX:0,offsetY:3,blur:6,spread:0,color:"#0000001f"}];function K1(e){return KN.map(t=>{const{offsetX:r,offsetY:o,blur:s,spread:i,color:a}=t,l=new E(r,o),{x:c,y:u}=l.rot(-e);return`${c}px ${u}px ${s}px ${i}px ${a}`}).join(", ")}function uk(){const[e,n]=w.useState(!1);return w.useEffect(()=>{const t=window.matchMedia("(prefers-reduced-motion: reduce)"),r=()=>{n(t.matches)};return r(),t.addEventListener("change",r),()=>t.removeEventListener("change",r)},[]),e}const hc=(e,n)=>e.length<=n?e:e.substring(0,n-3)+"...",Vr=e=>e.stopPropagation();function mt(e,n){e.isKilled=!0;const{top:t,left:r}=n.getBoundingClientRect();return{point:{x:e.clientX-r,y:e.clientY-t,z:e.pressure},shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey,pointerId:e.pointerId,button:e.button,isPen:e.pointerType==="pen"}}function qn(e){return`${R(e.x)},${R(e.y)} `}function Qn(e,n){return`${R((e.x+n.x)/2)},${R((e.y+n.y)/2)} `}function Vc(e,n=!0){const t=e.length;if(t<2)return"";let r=e[0],o=e[1];if(t===2)return`M${qn(r)}L${qn(o)}`;let s="";for(let i=2,a=t-1;i<a;i++)r=e[i],o=e[i+1],s+=Qn(r,o);return n?`M${Qn(e[0],e[1])}Q${qn(e[1])}${Qn(e[1],e[2])}T${s}${Qn(e[t-1],e[0])}${Qn(e[0],e[1])}Z`:`M${qn(e[0])}Q${qn(e[1])}${Qn(e[1],e[2])}${e.length>3?"T":""}${s}L${qn(e[t-1])}`}function mi(e,n=!1){const t=e.length;if(t<2)return"";let r=e[0].point,o=e[1].point;if(t===2)return`M${qn(r)}L${qn(o)}`;let s="";for(let i=2,a=t-1;i<a;i++)r=e[i].point,o=e[i+1].point,s+=Qn(r,o);return n?`M${Qn(e[0].point,e[1].point)}Q${qn(e[1].point)}${Qn(e[1].point,e[2].point)}T${s}${Qn(e[t-1].point,e[0].point)}${Qn(e[0].point,e[1].point)}Z`:`M${qn(e[0].point)}Q${qn(e[1].point)}${Qn(e[1].point,e[2].point)}${e.length>3?"T":""}${s}L${qn(e[t-1].point)}`}function HN(){const e=U();return w.useMemo(function(){let r,o;function s(p){p.isKilled||p.button!==0&&p.button!==1&&p.button!==5||(xu(p.currentTarget,p),e.dispatch({type:"pointer",target:"canvas",name:"pointer_down",...mt(p,e.getContainer())}))}function i(p){p.isKilled||p.clientX===r&&p.clientY===o||(r=p.clientX,o=p.clientY,e.dispatch({type:"pointer",target:"canvas",name:"pointer_move",...mt(p,e.getContainer())}))}function a(p){p.isKilled||p.button!==0&&p.button!==1&&p.button!==2&&p.button!==5||(r=p.clientX,o=p.clientY,Su(p.currentTarget,p),e.dispatch({type:"pointer",target:"canvas",name:"pointer_up",...mt(p,e.getContainer())}))}function l(p){p.isKilled||e.dispatch({type:"pointer",target:"canvas",name:"pointer_enter",...mt(p,e.getContainer())})}function c(p){p.isKilled||e.dispatch({type:"pointer",target:"canvas",name:"pointer_leave",...mt(p,e.getContainer())})}function u(p){p.isKilled=!0,document.body.click(),Se(p)}function d(p){p.isKilled=!0,p.target.tagName!=="A"&&p.target.tagName!=="TEXTAREA"&&Se(p)}function h(p){Se(p)}async function f(p){var x,S;if(Se(p),!((S=(x=p.dataTransfer)==null?void 0:x.files)!=null&&S.length))return;const m=Array.from(p.dataTransfer.files),y=e.getContainer().getBoundingClientRect();await e.putExternalContent({type:"files",files:m,point:e.screenToPage(p.clientX-y.x,p.clientY-y.y),ignoreParent:!1})}return{onPointerDown:s,onPointerMove:i,onPointerUp:a,onPointerEnter:l,onPointerLeave:c,onDragOver:h,onDrop:f,onTouchStart:u,onTouchEnd:d}},[e])}function VN(){const e=U();w.useEffect(()=>{if(window.matchMedia){const n=window.matchMedia("(pointer: coarse)"),t=()=>{e.isCoarsePointer=n.matches};return t(),n.addEventListener("change",t),()=>n.removeEventListener("change",t)}},[e])}const dk=w.createContext(null);function WN({container:e,children:n}){return g.jsx(dk.Provider,{value:e,children:n})}function Yt(){return Mj(w.useContext(dk),"useContainer used outside of <Tldraw />")}function YN(){const e=U(),n=Yt(),t=J("isFocused",()=>e.isFocused,[e]);w.useEffect(()=>{if(typeof matchMedia!==void 0)return;function r(){e.setDevicePixelRatio(window.devicePixelRatio)}const o=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);return o.addEventListener("change",r),()=>{o.removeEventListener("change",r)}},[e]),w.useEffect(()=>{if(!t)return;const r=c=>{if(c.altKey&&(e.isIn("zoom")||!e.root.path.value.endsWith(".idle"))&&!Rl()&&Se(c),c.isKilled)return;switch(c.isKilled=!0,c.key){case"=":{if(c.metaKey||c.ctrlKey){Se(c);return}break}case"-":{if(c.metaKey||c.ctrlKey){Se(c);return}break}case"0":{if(c.metaKey||c.ctrlKey){Se(c);return}break}case"Tab":{if(Rl()||e.isMenuOpen)return;break}case",":{if(!Rl()&&(Se(c),!e.inputs.keys.has("Comma"))){const{x:d,y:h,z:f}=e.inputs.currentScreenPoint,{pageState:{hoveredId:p}}=e;e.inputs.keys.add("Comma");const m={type:"pointer",name:"pointer_down",point:{x:d,y:h,z:f},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey,pointerId:0,button:0,isPen:e.isPenMode,...p?{target:"shape",shape:e.getShapeById(p)}:{target:"canvas"}};e.dispatch(m);return}break}case"Escape":{e.inputs.keys.has("Escape")||(e.inputs.keys.add("Escape"),e.cancel(),n.focus());return}default:if(Rl()||e.isMenuOpen)return}const u={type:"keyboard",name:e.inputs.keys.has(c.code)?"key_repeat":"key_down",key:c.key,code:c.code,shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey};e.dispatch(u)},o=c=>{var d;if(c.isKilled||(c.isKilled=!0,Rl()||e.isMenuOpen))return;if(c.key===","&&((d=document.activeElement)!=null&&d.ELEMENT_NODE&&Se(c),e.inputs.keys.has(c.code))){const{x:h,y:f,z:p}=e.inputs.currentScreenPoint,{pageState:{hoveredId:m}}=e;e.inputs.keys.delete(c.code);const y={type:"pointer",name:"pointer_up",point:{x:h,y:f,z:p},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey,pointerId:0,button:0,isPen:e.isPenMode,...m?{target:"shape",shape:e.getShapeById(m)}:{target:"canvas"}};e.dispatch(y);return}const u={type:"keyboard",name:"key_up",key:c.key,code:c.code,shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey};e.dispatch(u)};function s(c){var u,d;if(n.contains(c.target)){const h=c.touches[0].pageX,f=c.touches[0].radiusX||0;(h-f<10||h+f>e.viewportScreenBounds.width-10)&&(((u=c.target)==null?void 0:u.tagName)==="BUTTON"&&((d=c.target)==null||d.click()),Se(c))}}const i=c=>{n.contains(c.target)&&(c.ctrlKey||c.metaKey)&&Se(c)};function a(){e.complete()}function l(){e.updateViewportScreenBounds()}return n.addEventListener("touchstart",s,{passive:!1}),n.addEventListener("wheel",i,{passive:!1}),document.addEventListener("gesturestart",Se),document.addEventListener("gesturechange",Se),document.addEventListener("gestureend",Se),n.addEventListener("keydown",r),n.addEventListener("keyup",o),window.addEventListener("blur",a),window.addEventListener("focus",l),()=>{n.removeEventListener("touchstart",s),n.removeEventListener("wheel",i),document.removeEventListener("gesturestart",Se),document.removeEventListener("gesturechange",Se),document.removeEventListener("gestureend",Se),n.removeEventListener("keydown",r),n.removeEventListener("keyup",o),window.removeEventListener("blur",a),window.removeEventListener("focus",l)}},[e,n,t])}const XN=["input","select","button","textarea"];function Rl(){const{activeElement:e}=document;return!!(e&&(e.getAttribute("contenteditable")||XN.indexOf(e.tagName.toLowerCase())>-1))}function GN(){return g.jsx("div",{className:"tl-background"})}function hp(e,n,t,r,o,s){w.useLayoutEffect(()=>{const i=e.current;if(!i||n===void 0)return;let a=`translate(${n}px, ${t}px)`;r!==void 0&&(a+=` scale(${r})`),o!==void 0&&(a+=` rotate(${o}rad)`),s&&(a+=` translate(${s.x}px, ${s.y}px)`),i.style.transform=a})}const nm=({brush:e,color:n,opacity:t})=>{const r=w.useRef(null);return hp(r,e.x,e.y),g.jsx("svg",{className:"tl-overlays__item",ref:r,children:n?g.jsxs("g",{className:"tl-brush",opacity:t,children:[g.jsx("rect",{width:R(Math.max(1,e.w)),height:R(Math.max(1,e.h)),fill:n,opacity:.75}),g.jsx("rect",{width:R(Math.max(1,e.w)),height:R(Math.max(1,e.h)),fill:"none",stroke:n,opacity:.1})]}):g.jsx("rect",{className:"tl-brush tl-brush__default",width:R(Math.max(1,e.w)),height:R(Math.max(1,e.h))})})},qN=({className:e,zoom:n,point:t,color:r,viewport:o,opacity:s=1})=>{const i=w.useRef(null);return hp(i,xr(t.x,o.minX+5/n,o.maxX-5/n),xr(t.y,o.minY+5/n,o.maxY-5/n),1/n,E.Angle(o.center,t)),g.jsxs("svg",{ref:i,className:de("tl-overlays__item",e),children:[g.jsx("use",{href:"#cursor_hint",color:r,strokeWidth:3,stroke:"var(--color-background)"}),g.jsx("use",{href:"#cursor_hint",color:r,opacity:s})]})},QN=({className:e,zoom:n,point:t,color:r,name:o,chatMessage:s})=>{const i=w.useRef(null);return hp(i,t==null?void 0:t.x,t==null?void 0:t.y,1/n),t?g.jsxs("div",{ref:i,className:de("tl-overlays__item",e),children:[g.jsx("svg",{className:"tl-cursor",children:g.jsx("use",{href:"#cursor",color:r})}),s?g.jsxs(g.Fragment,{children:[o&&g.jsx("div",{className:"tl-nametag-title",style:{color:r},children:o}),g.jsx("div",{className:"tl-nametag-chat",style:{backgroundColor:r},children:s})]}):o&&g.jsx("div",{className:"tl-nametag",style:{backgroundColor:r},children:o})]}):null},Gb=w.memo(QN),co=2e3,yf=40,go=320,qi=[.1,.25,.5,1,2,4,8],Dl=.1,ss=8,ZN=.5,JN=.1,ez=.2,tz=.005,nz=.05,rz=10,oz=1,sz=1e3,iz=1e3,az=5,Hn=8,lz=450,cz=200,_0=6,Wc=4,uz=32,vf={};for(let e=1;e<=Math.ceil(ss);e++)vf[e+"_dark"]=`hash_pattern_zoom_${e}_dark`,vf[e+"_light"]=`hash_pattern_zoom_${e}_light`;const qb={duration:0,easing:Kt.easeInOutCubic},ih=.09,Qb=[{min:-1,mid:.15,step:100},{min:.05,mid:.375,step:25},{min:.15,mid:1,step:5},{min:.7,mid:2.5,step:1}],dz=6e4,hk=3e3,hz=1200,Zb={CAMERA_MOVE:-10},fz=64,pz=620,gz=({x:e,y:n,z:t,size:r})=>g.jsxs("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[g.jsx("defs",{children:Qb.map(({min:o,mid:s,step:i},a)=>{const l=i*r*t,c=.5+e*t,u=.5+n*t,d=c>0?c%l:l+c%l,h=u>0?u%l:l+u%l,f=t<s?x0(t,[o,s],[0,1]):1;return g.jsx("pattern",{id:`grid-${i}`,width:l,height:l,patternUnits:"userSpaceOnUse",children:g.jsx("circle",{className:"tl-grid-dot",cx:d,cy:h,r:1,opacity:f})},`grid-pattern-${a}`)})}),Qb.map(({step:o},s)=>g.jsx("rect",{width:"100%",height:"100%",fill:`url(#grid-${o})`},`grid-rect-${s}`))]}),mz=({handle:e,className:n})=>g.jsxs("g",{className:de("tl-handle",{"tl-handle__hint":e.type!=="vertex"},n),children:[g.jsx("circle",{className:"tl-handle__bg"}),g.jsx("circle",{className:"tl-handle__fg"})]}),Jb=({scribble:e,zoom:n,color:t,opacity:r,className:o})=>{if(!e.points.length)return;const s=Vc(LN(e.points,{size:e.size/n,start:{taper:!0,easing:Kt.linear},last:e.state==="stopping",simulatePressure:!1,streamline:.32}));return g.jsx("svg",{className:o&&de("tl-overlays__item",o),children:g.jsx("path",{className:"tl-scribble",d:s,fill:t??`var(--color-${e.color})`,opacity:r??e.opacity})})},yz=({error:e})=>g.jsx("div",{className:"tl-shape-error-boundary",children:e}),vz=()=>g.jsx("circle",{cx:4,cy:4,r:8,strokeWidth:"1",stroke:"red"});function wz({points:e,zoom:n}){const t=2.5/n,r=e.reduce((h,f)=>Math.min(h,f.x),1/0),o=e.reduce((h,f)=>Math.max(h,f.x),-1/0),s=e.reduce((h,f)=>Math.min(h,f.y),1/0),i=e.reduce((h,f)=>Math.max(h,f.y),-1/0),a=e.some(h=>h.x===r&&h.y===s);let l,c,u,d;return a?(l=r,c=s,u=o,d=i):(l=r,c=i,u=o,d=s),g.jsxs("g",{className:"tl-snap-line",children:[g.jsx("line",{x1:l,y1:c,x2:u,y2:d}),e.map((h,f)=>g.jsx("g",{transform:`translate(${h.x},${h.y})`,children:g.jsx("path",{className:"tl-snap-point",d:`M ${-t},${-t} L ${t},${t} M ${-t},${t} L ${t},${-t}`})},f))]})}function xz({gaps:e,direction:n,zoom:t}){const r=3.5/t;let o=[-1/0,1/0],s=null;const i=n==="horizontal";for(const l of e){if(s=yr(o[0],o[1],i?l.startEdge[0].y:l.startEdge[0].x,i?l.startEdge[1].y:l.startEdge[1].x),s)o=s;else continue;if(s=yr(o[0],o[1],i?l.endEdge[0].y:l.endEdge[0].x,i?l.endEdge[1].y:l.endEdge[1].x),s)o=s;else continue}if(o===null)return null;const a=(o[0]+o[1])/2;return g.jsx("g",{className:"tl-snap-line",children:e.map(({startEdge:l,endEdge:c},u)=>g.jsx(w.Fragment,{children:i?g.jsxs(g.Fragment,{children:[g.jsx("line",{x1:l[0].x,y1:a-2*r,x2:l[1].x,y2:a+2*r}),g.jsx("line",{x1:c[0].x,y1:a-2*r,x2:c[1].x,y2:a+2*r}),g.jsx("line",{x1:l[0].x,y1:a,x2:c[0].x,y2:a}),g.jsx("line",{x1:(l[0].x+c[0].x)/2,y1:a-r,x2:(l[0].x+c[0].x)/2,y2:a+r})]}):g.jsxs(g.Fragment,{children:[g.jsx("line",{x1:a-2*r,y1:l[0].y,x2:a+2*r,y2:l[1].y}),g.jsx("line",{x1:a-2*r,y1:c[0].y,x2:a+2*r,y2:c[1].y}),g.jsx("line",{x1:a,y1:l[0].y,x2:a,y2:c[0].y}),g.jsx("line",{x1:a-r,y1:(l[0].y+c[0].y)/2,x2:a+r,y2:(l[0].y+c[0].y)/2})]})},u))})}const Sz=({className:e,line:n,zoom:t})=>g.jsx("svg",{className:de("tl-overlays__item",e),children:n.type==="points"?g.jsx(wz,{...n,zoom:t}):n.type==="gaps"?g.jsx(xz,{...n,zoom:t}):null}),fp=()=>g.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",children:g.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[g.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"var(--color-text-1)"}),g.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"var(--color-text-1)",children:g.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})}),bz=()=>null,Pz={error:null};class fk extends w.Component{constructor(){super(...arguments);v(this,"state",Pz)}static getDerivedStateFromError(t){return{error:t}}componentDidCatch(t){var r,o;(o=(r=this.props).onError)==null||o.call(r,t)}render(){const{error:t}=this.state;if(t!==null){const{fallback:r}=this.props;return g.jsx(r,{error:t})}return this.props.children}}function Yc({children:e,fallback:n,...t}){return n===null?g.jsx(g.Fragment,{children:e}):g.jsx(fk,{fallback:n,...t,children:e})}class Ez{constructor(n){this.shape=n}equals(n){var t,r,o,s;return((t=this.shape)==null?void 0:t.props)===((r=n==null?void 0:n.shape)==null?void 0:r.props)&&((o=this.shape)==null?void 0:o.meta)===((s=n==null?void 0:n.shape)==null?void 0:s.meta)}}const _z=({shape:e,util:n})=>cp("Indicator:"+e.type,()=>n.indicator(e)),Cz=({editor:e,id:n})=>{const t=J("shape",()=>new Ez(e.store.get(n)),[e,n]),{ShapeIndicatorErrorFallback:r}=ar();return t.shape?g.jsx(Yc,{fallback:r,onError:o=>e.annotateError(o,{origin:"react.shapeIndicator",willCrashApp:!1}),children:g.jsx(_z,{shape:t.shape,util:e.getShapeUtil(t.shape)},t.shape.id)}):null},Iz=({id:e,className:n,color:t,opacity:r})=>{const o=U(),s=J("transform",()=>{const i=o.getPageTransformById(e);return i?i.toCssString():""},[o,e]);return g.jsx("svg",{className:de("tl-overlays__item",n),children:g.jsx("g",{className:"tl-shape-indicator",transform:s,stroke:t??"var(--color-selected)",opacity:r,children:g.jsx(Cz,{editor:o,id:e})})})},pp=w.memo(Iz),pk=w.createContext({});function kz({overrides:e,children:n}){return g.jsx(pk.Provider,{value:{Background:GN,SvgDefs:bz,Brush:nm,ZoomBrush:nm,CollaboratorBrush:nm,Cursor:Gb,CollaboratorCursor:Gb,CollaboratorHint:qN,CollaboratorShapeIndicator:pp,Grid:gz,Scribble:Jb,SnapLine:Sz,Handle:mz,CollaboratorScribble:Jb,ErrorFallback:jk,ShapeErrorFallback:yz,ShapeIndicatorErrorFallback:vz,Spinner:fp,...e},children:n})}function ar(){return w.useContext(pk)}const $z=["textarea","input"];function Tz(e){const n=U();w.useEffect(()=>{const t=e.current;if(!t)return;const r=o=>{var s;if(o instanceof PointerEvent&&o.pointerType==="pen"){o.isKilled=!0;const{target:i}=o;if($z.includes((s=i.tagName)==null?void 0:s.toLocaleLowerCase())||n.isIn("select.editing_shape"))return;Se(o)}};return t.addEventListener("touchstart",r),t.addEventListener("touchend",r),()=>{t.removeEventListener("touchstart",r),t.addEventListener("touchend",r)}},[n,e])}function Mz(e,n,t){return Math.max(n,Math.min(e,t))}const Mt={toVector(e,n){return e===void 0&&(e=n),Array.isArray(e)?e:[e,e]},add(e,n){return[e[0]+n[0],e[1]+n[1]]},sub(e,n){return[e[0]-n[0],e[1]-n[1]]},addTo(e,n){e[0]+=n[0],e[1]+=n[1]},subTo(e,n){e[0]-=n[0],e[1]-=n[1]}};function e2(e,n,t){return n===0||Math.abs(n)===1/0?Math.pow(e,t*5):e*n*t/(n+t*e)}function t2(e,n,t,r=.15){return r===0?Mz(e,n,t):e<n?-e2(n-e,t-n,r)+n:e>t?+e2(e-t,t-n,r)+t:e}function Az(e,[n,t],[r,o]){const[[s,i],[a,l]]=e;return[t2(n,s,i,r),t2(t,a,l,o)]}function Oz(e,n){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Rz(e){var n=Oz(e,"string");return typeof n=="symbol"?n:String(n)}function zt(e,n,t){return n=Rz(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function n2(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),t.push.apply(t,r)}return t}function rt(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?n2(Object(t),!0).forEach(function(r){zt(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):n2(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}const gk={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function r2(e){return e?e[0].toUpperCase()+e.slice(1):""}const Dz=["enter","leave"];function Lz(e=!1,n){return e&&!Dz.includes(n)}function jz(e,n="",t=!1){const r=gk[e],o=r&&r[n]||n;return"on"+r2(e)+r2(o)+(Lz(t,o)?"Capture":"")}const Nz=["gotpointercapture","lostpointercapture"];function zz(e){let n=e.substring(2).toLowerCase();const t=!!~n.indexOf("passive");t&&(n=n.replace("passive",""));const r=Nz.includes(n)?"capturecapture":"capture",o=!!~n.indexOf(r);return o&&(n=n.replace("capture","")),{device:n,capture:o,passive:t}}function Bz(e,n=""){const t=gk[e],r=t&&t[n]||n;return e+r}function mk(e){return"touches"in e}function Fz(e){return mk(e)?"touch":"pointerType"in e?e.pointerType:"mouse"}function Uz(e){return Array.from(e.touches).filter(n=>{var t,r;return n.target===e.currentTarget||((t=e.currentTarget)===null||t===void 0||(r=t.contains)===null||r===void 0?void 0:r.call(t,n.target))})}function C0(e,n){try{const t=n.clientX-e.clientX,r=n.clientY-e.clientY,o=(n.clientX+e.clientX)/2,s=(n.clientY+e.clientY)/2,i=Math.hypot(t,r);return{angle:-(Math.atan2(t,r)*180)/Math.PI,distance:i,origin:[o,s]}}catch{}return null}function Kz(e){return Uz(e).map(n=>n.identifier)}function o2(e,n){const[t,r]=Array.from(e.touches).filter(o=>n.includes(o.identifier));return C0(t,r)}const s2=40,i2=800;function yk(e){let{deltaX:n,deltaY:t,deltaMode:r}=e;return r===1?(n*=s2,t*=s2):r===2&&(n*=i2,t*=i2),[n,t]}function Hz(e){const n={};if("buttons"in e&&(n.buttons=e.buttons),"shiftKey"in e){const{shiftKey:t,altKey:r,metaKey:o,ctrlKey:s}=e;Object.assign(n,{shiftKey:t,altKey:r,metaKey:o,ctrlKey:s})}return n}function wf(e,...n){return typeof e=="function"?e(...n):e}function Vz(){}function Wz(...e){return e.length===0?Vz:e.length===1?e[0]:function(){let n;for(const t of e)n=t.apply(this,arguments)||n;return n}}function a2(e,n){return Object.assign({},n,e||{})}const Yz=32;class vk{constructor(n,t,r){this.ctrl=n,this.args=t,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(n){this.ctrl.state[this.key]=n}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:n,shared:t,ingKey:r,args:o}=this;t[r]=n._active=n.active=n._blocked=n._force=!1,n._step=[!1,!1],n.intentional=!1,n._movement=[0,0],n._distance=[0,0],n._direction=[0,0],n._delta=[0,0],n._bounds=[[-1/0,1/0],[-1/0,1/0]],n.args=o,n.axis=void 0,n.memo=void 0,n.elapsedTime=n.timeDelta=0,n.direction=[0,0],n.distance=[0,0],n.overflow=[0,0],n._movementBound=[!1,!1],n.velocity=[0,0],n.movement=[0,0],n.delta=[0,0],n.timeStamp=0}start(n){const t=this.state,r=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=n.target,t.currentTarget=n.currentTarget,t.lastOffset=r.from?wf(r.from,t):t.offset,t.offset=t.lastOffset,t.startTime=t.timeStamp=n.timeStamp)}computeValues(n){const t=this.state;t._values=n,t.values=this.config.transform(n)}computeInitial(){const n=this.state;n._initial=n._values,n.initial=n.values}compute(n){const{state:t,config:r,shared:o}=this;t.args=this.args;let s=0;if(n&&(t.event=n,r.preventDefault&&n.cancelable&&t.event.preventDefault(),t.type=n.type,o.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,o.locked=!!document.pointerLockElement,Object.assign(o,Hz(n)),o.down=o.pressed=o.buttons%2===1||o.touches>0,s=n.timeStamp-t.timeStamp,t.timeStamp=n.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){const _=t._delta.map(Math.abs);Mt.addTo(t._distance,_)}this.axisIntent&&this.axisIntent(n);const[i,a]=t._movement,[l,c]=r.threshold,{_step:u,values:d}=t;if(r.hasCustomTransform?(u[0]===!1&&(u[0]=Math.abs(i)>=l&&d[0]),u[1]===!1&&(u[1]=Math.abs(a)>=c&&d[1])):(u[0]===!1&&(u[0]=Math.abs(i)>=l&&Math.sign(i)*l),u[1]===!1&&(u[1]=Math.abs(a)>=c&&Math.sign(a)*c)),t.intentional=u[0]!==!1||u[1]!==!1,!t.intentional)return;const h=[0,0];if(r.hasCustomTransform){const[_,I]=d;h[0]=u[0]!==!1?_-u[0]:0,h[1]=u[1]!==!1?I-u[1]:0}else h[0]=u[0]!==!1?i-u[0]:0,h[1]=u[1]!==!1?a-u[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(h);const f=t.offset,p=t._active&&!t._blocked||t.active;p&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=o[this.ingKey]=t._active,n&&(t.first&&("bounds"in r&&(t._bounds=wf(r.bounds,t)),this.setup&&this.setup()),t.movement=h,this.computeOffset()));const[m,y]=t.offset,[[x,S],[b,P]]=t._bounds;t.overflow=[m<x?-1:m>S?1:0,y<b?-1:y>P?1:0],t._movementBound[0]=t.overflow[0]?t._movementBound[0]===!1?t._movement[0]:t._movementBound[0]:!1,t._movementBound[1]=t.overflow[1]?t._movementBound[1]===!1?t._movement[1]:t._movementBound[1]:!1;const C=t._active?r.rubberband||[0,0]:[0,0];if(t.offset=Az(t._bounds,t.offset,C),t.delta=Mt.sub(t.offset,f),this.computeMovement(),p&&(!t.last||s>Yz)){t.delta=Mt.sub(t.offset,f);const _=t.delta.map(Math.abs);Mt.addTo(t.distance,_),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&s>0&&(t.velocity=[_[0]/s,_[1]/s],t.timeDelta=s)}}emit(){const n=this.state,t=this.shared,r=this.config;if(n._active||this.clean(),(n._blocked||!n.intentional)&&!n._force&&!r.triggerAllEvents)return;const o=this.handler(rt(rt(rt({},t),n),{},{[this.aliasKey]:n.values}));o!==void 0&&(n.memo=o)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function Xz([e,n],t){const r=Math.abs(e),o=Math.abs(n);if(r>o&&r>t)return"x";if(o>r&&o>t)return"y"}class Gz extends vk{constructor(...n){super(...n),zt(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=Mt.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=Mt.sub(this.state.offset,this.state.lastOffset)}axisIntent(n){const t=this.state,r=this.config;if(!t.axis&&n){const o=typeof r.axisThreshold=="object"?r.axisThreshold[Fz(n)]:r.axisThreshold;t.axis=Xz(t._movement,o)}t._blocked=(r.lockDirection||!!r.axis)&&!t.axis||!!r.axis&&r.axis!==t.axis}restrictToAxis(n){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":n[1]=0;break;case"y":n[0]=0;break}}}const qz=e=>e,l2=.15,wk={enabled(e=!0){return e},eventOptions(e,n,t){return rt(rt({},t.shared.eventOptions),e)},preventDefault(e=!1){return e},triggerAllEvents(e=!1){return e},rubberband(e=0){switch(e){case!0:return[l2,l2];case!1:return[0,0];default:return Mt.toVector(e)}},from(e){if(typeof e=="function")return e;if(e!=null)return Mt.toVector(e)},transform(e,n,t){const r=e||t.shared.transform;return this.hasCustomTransform=!!r,r||qz},threshold(e){return Mt.toVector(e,0)}},Qz=0,bu=rt(rt({},wk),{},{axis(e,n,{axis:t}){if(this.lockDirection=t==="lock",!this.lockDirection)return t},axisThreshold(e=Qz){return e},bounds(e={}){if(typeof e=="function")return s=>bu.bounds(e(s));if("current"in e)return()=>e.current;if(typeof HTMLElement=="function"&&e instanceof HTMLElement)return e;const{left:n=-1/0,right:t=1/0,top:r=-1/0,bottom:o=1/0}=e;return[[n,t],[r,o]]}}),Pu=typeof window<"u"&&window.document&&window.document.createElement;function Zz(){return Pu&&"ontouchstart"in window}function c2(){return Zz()||Pu&&window.navigator.maxTouchPoints>1}function Jz(){return Pu&&"onpointerdown"in window}function eB(){return Pu&&"exitPointerLock"in window.document}function tB(){try{return"constructor"in GestureEvent}catch{return!1}}const Zn={isBrowser:Pu,gesture:tB(),touch:c2(),touchscreen:c2(),pointer:Jz(),pointerLock:eB()},nB=250,rB=180,oB=.5,sB=50,iB=250,aB=10,u2={mouse:0,touch:0,pen:8};rt(rt({},bu),{},{device(e,n,{pointer:{touch:t=!1,lock:r=!1,mouse:o=!1}={}}){return this.pointerLock=r&&Zn.pointerLock,Zn.touch&&t?"touch":this.pointerLock?"mouse":Zn.pointer&&!o?"pointer":Zn.touch?"touch":"mouse"},preventScrollAxis(e,n,{preventScroll:t}){if(this.preventScrollDelay=typeof t=="number"?t:t||t===void 0&&e?nB:void 0,!(!Zn.touchscreen||t===!1))return e||(t!==void 0?"y":void 0)},pointerCapture(e,n,{pointer:{capture:t=!0,buttons:r=1,keys:o=!0}={}}){return this.pointerButtons=r,this.keys=o,!this.pointerLock&&this.device==="pointer"&&t},threshold(e,n,{filterTaps:t=!1,tapsThreshold:r=3,axis:o=void 0}){const s=Mt.toVector(e,t?r:o?1:0);return this.filterTaps=t,this.tapsThreshold=r,s},swipe({velocity:e=oB,distance:n=sB,duration:t=iB}={}){return{velocity:this.transform(Mt.toVector(e)),distance:this.transform(Mt.toVector(n)),duration:t}},delay(e=0){switch(e){case!0:return rB;case!1:return 0;default:return e}},axisThreshold(e){return e?rt(rt({},u2),e):u2},keyboardDisplacement(e=aB){return e}});function xk(e){const[n,t]=e.overflow,[r,o]=e._delta,[s,i]=e._direction;(n<0&&r>0&&s<0||n>0&&r<0&&s>0)&&(e._movement[0]=e._movementBound[0]),(t<0&&o>0&&i<0||t>0&&o<0&&i>0)&&(e._movement[1]=e._movementBound[1])}const lB=30,cB=100;class uB extends vk{constructor(...n){super(...n),zt(this,"ingKey","pinching"),zt(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();const n=this.state;n._touchIds=[],n.canceled=!1,n.cancel=this.cancel.bind(this),n.turns=0}computeOffset(){const{type:n,movement:t,lastOffset:r}=this.state;n==="wheel"?this.state.offset=Mt.add(t,r):this.state.offset=[(1+t[0])*r[0],t[1]+r[1]]}computeMovement(){const{offset:n,lastOffset:t}=this.state;this.state.movement=[n[0]/t[0],n[1]-t[1]]}axisIntent(){const n=this.state,[t,r]=n._movement;if(!n.axis){const o=Math.abs(t)*lB-Math.abs(r);o<0?n.axis="angle":o>0&&(n.axis="scale")}}restrictToAxis(n){this.config.lockDirection&&(this.state.axis==="scale"?n[1]=0:this.state.axis==="angle"&&(n[0]=0))}cancel(){const n=this.state;n.canceled||setTimeout(()=>{n.canceled=!0,n._active=!1,this.compute(),this.emit()},0)}touchStart(n){this.ctrl.setEventIds(n);const t=this.state,r=this.ctrl.touchIds;if(t._active&&t._touchIds.every(s=>r.has(s))||r.size<2)return;this.start(n),t._touchIds=Array.from(r).slice(0,2);const o=o2(n,t._touchIds);o&&this.pinchStart(n,o)}pointerStart(n){if(n.buttons!=null&&n.buttons%2!==1)return;this.ctrl.setEventIds(n),n.target.setPointerCapture(n.pointerId);const t=this.state,r=t._pointerEvents,o=this.ctrl.pointerIds;if(t._active&&Array.from(r.keys()).every(i=>o.has(i))||(r.size<2&&r.set(n.pointerId,n),t._pointerEvents.size<2))return;this.start(n);const s=C0(...Array.from(r.values()));s&&this.pinchStart(n,s)}pinchStart(n,t){const r=this.state;r.origin=t.origin,this.computeValues([t.distance,t.angle]),this.computeInitial(),this.compute(n),this.emit()}touchMove(n){if(!this.state._active)return;const t=o2(n,this.state._touchIds);t&&this.pinchMove(n,t)}pointerMove(n){const t=this.state._pointerEvents;if(t.has(n.pointerId)&&t.set(n.pointerId,n),!this.state._active)return;const r=C0(...Array.from(t.values()));r&&this.pinchMove(n,r)}pinchMove(n,t){const r=this.state,o=r._values[1],s=t.angle-o;let i=0;Math.abs(s)>270&&(i+=Math.sign(s)),this.computeValues([t.distance,t.angle-360*i]),r.origin=t.origin,r.turns=i,r._movement=[r._values[0]/r._initial[0]-1,r._values[1]-r._initial[1]],this.compute(n),this.emit()}touchEnd(n){this.ctrl.setEventIds(n),this.state._active&&this.state._touchIds.some(t=>!this.ctrl.touchIds.has(t))&&(this.state._active=!1,this.compute(n),this.emit())}pointerEnd(n){const t=this.state;this.ctrl.setEventIds(n);try{n.target.releasePointerCapture(n.pointerId)}catch{}t._pointerEvents.has(n.pointerId)&&t._pointerEvents.delete(n.pointerId),t._active&&t._pointerEvents.size<2&&(t._active=!1,this.compute(n),this.emit())}gestureStart(n){n.cancelable&&n.preventDefault();const t=this.state;t._active||(this.start(n),this.computeValues([n.scale,n.rotation]),t.origin=[n.clientX,n.clientY],this.compute(n),this.emit())}gestureMove(n){if(n.cancelable&&n.preventDefault(),!this.state._active)return;const t=this.state;this.computeValues([n.scale,n.rotation]),t.origin=[n.clientX,n.clientY];const r=t._movement;t._movement=[n.scale-1,n.rotation],t._delta=Mt.sub(t._movement,r),this.compute(n),this.emit()}gestureEnd(n){this.state._active&&(this.state._active=!1,this.compute(n),this.emit())}wheel(n){const t=this.config.modifierKey;t&&!n[t]||(this.state._active?this.wheelChange(n):this.wheelStart(n),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(n){this.start(n),this.wheelChange(n)}wheelChange(n){"uv"in n||n.cancelable&&n.preventDefault();const r=this.state;r._delta=[-yk(n)[1]/cB*r.offset[0],0],Mt.addTo(r._movement,r._delta),xk(r),this.state.origin=[n.clientX,n.clientY],this.compute(n),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(n){const t=this.config.device;t&&(n(t,"start",this[t+"Start"].bind(this)),n(t,"change",this[t+"Move"].bind(this)),n(t,"end",this[t+"End"].bind(this)),n(t,"cancel",this[t+"End"].bind(this)),n("lostPointerCapture","",this[t+"End"].bind(this))),this.config.pinchOnWheel&&n("wheel","",this.wheel.bind(this),{passive:!1})}}const dB=rt(rt({},wk),{},{device(e,n,{shared:t,pointer:{touch:r=!1}={}}){if(t.target&&!Zn.touch&&Zn.gesture)return"gesture";if(Zn.touch&&r)return"touch";if(Zn.touchscreen){if(Zn.pointer)return"pointer";if(Zn.touch)return"touch"}},bounds(e,n,{scaleBounds:t={},angleBounds:r={}}){const o=i=>{const a=a2(wf(t,i),{min:-1/0,max:1/0});return[a.min,a.max]},s=i=>{const a=a2(wf(r,i),{min:-1/0,max:1/0});return[a.min,a.max]};return typeof t!="function"&&typeof r!="function"?[o(),s()]:i=>[o(i),s(i)]},threshold(e,n,t){return this.lockDirection=t.axis==="lock",Mt.toVector(e,this.lockDirection?[.1,3]:0)},modifierKey(e){return e===void 0?"ctrlKey":e},pinchOnWheel(e=!0){return e}});rt(rt({},bu),{},{mouseOnly:(e=!0)=>e});class hB extends Gz{constructor(...n){super(...n),zt(this,"ingKey","wheeling")}wheel(n){this.state._active||this.start(n),this.wheelChange(n),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(n){const t=this.state;t._delta=yk(n),Mt.addTo(t._movement,t._delta),xk(t),this.compute(n),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(n){n("wheel","",this.wheel.bind(this))}}const fB=bu;rt(rt({},bu),{},{mouseOnly:(e=!0)=>e});const H1=new Map,I0=new Map;function pB(e){H1.set(e.key,e.engine),I0.set(e.key,e.resolver)}const gB={key:"pinch",engine:uB,resolver:dB},mB={key:"wheel",engine:hB,resolver:fB};function yB(e,n){if(e==null)return{};var t={},r=Object.keys(e),o,s;for(s=0;s<r.length;s++)o=r[s],!(n.indexOf(o)>=0)&&(t[o]=e[o]);return t}function vB(e,n){if(e==null)return{};var t=yB(e,n),r,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)r=s[o],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}const wB={target(e){if(e)return()=>"current"in e?e.current:e},enabled(e=!0){return e},window(e=Zn.isBrowser?window:void 0){return e},eventOptions({passive:e=!0,capture:n=!1}={}){return{passive:e,capture:n}},transform(e){return e}},xB=["target","eventOptions","window","enabled","transform"];function ah(e={},n){const t={};for(const[r,o]of Object.entries(n))switch(typeof o){case"function":t[r]=o.call(t,e[r],r,e);break;case"object":t[r]=ah(e[r],o);break;case"boolean":o&&(t[r]=e[r]);break}return t}function SB(e,n,t={}){const r=e,{target:o,eventOptions:s,window:i,enabled:a,transform:l}=r,c=vB(r,xB);if(t.shared=ah({target:o,eventOptions:s,window:i,enabled:a,transform:l},wB),n){const u=I0.get(n);t[n]=ah(rt({shared:t.shared},c),u)}else for(const u in c){const d=I0.get(u);d&&(t[u]=ah(rt({shared:t.shared},c[u]),d))}return t}class Sk{constructor(n,t){zt(this,"_listeners",new Set),this._ctrl=n,this._gestureKey=t}add(n,t,r,o,s){const i=this._listeners,a=Bz(t,r),l=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},c=rt(rt({},l),s);n.addEventListener(a,o,c);const u=()=>{n.removeEventListener(a,o,c),i.delete(u)};return i.add(u),u}clean(){this._listeners.forEach(n=>n()),this._listeners.clear()}}class bB{constructor(){zt(this,"_timeouts",new Map)}add(n,t,r=140,...o){this.remove(n),this._timeouts.set(n,window.setTimeout(t,r,...o))}remove(n){const t=this._timeouts.get(n);t&&window.clearTimeout(t)}clean(){this._timeouts.forEach(n=>void window.clearTimeout(n)),this._timeouts.clear()}}class PB{constructor(n){zt(this,"gestures",new Set),zt(this,"_targetEventStore",new Sk(this)),zt(this,"gestureEventStores",{}),zt(this,"gestureTimeoutStores",{}),zt(this,"handlers",{}),zt(this,"config",{}),zt(this,"pointerIds",new Set),zt(this,"touchIds",new Set),zt(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),EB(this,n)}setEventIds(n){if(mk(n))return this.touchIds=new Set(Kz(n)),this.touchIds;if("pointerId"in n)return n.type==="pointerup"||n.type==="pointercancel"?this.pointerIds.delete(n.pointerId):n.type==="pointerdown"&&this.pointerIds.add(n.pointerId),this.pointerIds}applyHandlers(n,t){this.handlers=n,this.nativeHandlers=t}applyConfig(n,t){this.config=SB(n,t,this.config)}clean(){this._targetEventStore.clean();for(const n of this.gestures)this.gestureEventStores[n].clean(),this.gestureTimeoutStores[n].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...n){const t=this.config.shared,r={};let o;if(!(t.target&&(o=t.target(),!o))){if(t.enabled){for(const i of this.gestures){const a=this.config[i],l=d2(r,a.eventOptions,!!o);if(a.enabled){const c=H1.get(i);new c(this,n,i).bind(l)}}const s=d2(r,t.eventOptions,!!o);for(const i in this.nativeHandlers)s(i,"",a=>this.nativeHandlers[i](rt(rt({},this.state.shared),{},{event:a,args:n})),void 0,!0)}for(const s in r)r[s]=Wz(...r[s]);if(!o)return r;for(const s in r){const{device:i,capture:a,passive:l}=zz(s);this._targetEventStore.add(o,i,"",r[s],{capture:a,passive:l})}}}}function Qi(e,n){e.gestures.add(n),e.gestureEventStores[n]=new Sk(e,n),e.gestureTimeoutStores[n]=new bB}function EB(e,n){n.drag&&Qi(e,"drag"),n.wheel&&Qi(e,"wheel"),n.scroll&&Qi(e,"scroll"),n.move&&Qi(e,"move"),n.pinch&&Qi(e,"pinch"),n.hover&&Qi(e,"hover")}const d2=(e,n,t)=>(r,o,s,i={},a=!1)=>{var l,c;const u=(l=i.capture)!==null&&l!==void 0?l:n.capture,d=(c=i.passive)!==null&&c!==void 0?c:n.passive;let h=a?r:jz(r,o,u);t&&d&&(h+="Passive"),e[h]=e[h]||[],e[h].push(s)},_B=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function CB(e){const n={},t={},r=new Set;for(let o in e)_B.test(o)?(r.add(RegExp.lastMatch),t[o]=e[o]):n[o]=e[o];return[t,n,r]}function Zi(e,n,t,r,o,s){if(!e.has(t)||!H1.has(r))return;const i=t+"Start",a=t+"End",l=c=>{let u;return c.first&&i in n&&n[i](c),t in n&&(u=n[t](c)),c.last&&a in n&&n[a](c),u};o[r]=l,s[r]=s[r]||{}}function IB(e,n){const[t,r,o]=CB(e),s={};return Zi(o,t,"onDrag","drag",s,n),Zi(o,t,"onWheel","wheel",s,n),Zi(o,t,"onScroll","scroll",s,n),Zi(o,t,"onPinch","pinch",s,n),Zi(o,t,"onMove","move",s,n),Zi(o,t,"onHover","hover",s,n),{handlers:s,config:n,nativeHandlers:r}}function kB(e,n={},t,r){const o=oe.useMemo(()=>new PB(e),[]);if(o.applyHandlers(e,r),o.applyConfig(n,t),oe.useEffect(o.effect.bind(o)),oe.useEffect(()=>o.clean.bind(o),[]),n.target===void 0)return o.bind.bind(o)}function $B(e){return e.forEach(pB),function(t,r){const{handlers:o,nativeHandlers:s,config:i}=IB(t,r||{});return kB(o,i,void 0,s)}}var bk="Expected a function",h2=0/0,TB="[object Symbol]",MB=/^\s+|\s+$/g,AB=/^[-+]0x[0-9a-f]+$/i,OB=/^0b[01]+$/i,RB=/^0o[0-7]+$/i,DB=parseInt,LB=typeof tn=="object"&&tn&&tn.Object===Object&&tn,jB=typeof self=="object"&&self&&self.Object===Object&&self,NB=LB||jB||Function("return this")(),zB=Object.prototype,BB=zB.toString,FB=Math.max,UB=Math.min,rm=function(){return NB.Date.now()};function KB(e,n,t){var r,o,s,i,a,l,c=0,u=!1,d=!1,h=!0;if(typeof e!="function")throw new TypeError(bk);n=f2(n)||0,xf(t)&&(u=!!t.leading,d="maxWait"in t,s=d?FB(f2(t.maxWait)||0,n):s,h="trailing"in t?!!t.trailing:h);function f(_){var I=r,k=o;return r=o=void 0,c=_,i=e.apply(k,I),i}function p(_){return c=_,a=setTimeout(x,n),u?f(_):i}function m(_){var I=_-l,k=_-c,T=n-I;return d?UB(T,s-k):T}function y(_){var I=_-l,k=_-c;return l===void 0||I>=n||I<0||d&&k>=s}function x(){var _=rm();if(y(_))return S(_);a=setTimeout(x,m(_))}function S(_){return a=void 0,h&&r?f(_):(r=o=void 0,i)}function b(){a!==void 0&&clearTimeout(a),c=0,r=l=o=a=void 0}function P(){return a===void 0?i:S(rm())}function C(){var _=rm(),I=y(_);if(r=arguments,o=this,l=_,I){if(a===void 0)return p(l);if(d)return a=setTimeout(x,n),f(l)}return a===void 0&&(a=setTimeout(x,n)),i}return C.cancel=b,C.flush=P,C}function HB(e,n,t){var r=!0,o=!0;if(typeof e!="function")throw new TypeError(bk);return xf(t)&&(r="leading"in t?!!t.leading:r,o="trailing"in t?!!t.trailing:o),KB(e,n,{leading:r,maxWait:n,trailing:o})}function xf(e){var n=typeof e;return!!e&&(n=="object"||n=="function")}function VB(e){return!!e&&typeof e=="object"}function WB(e){return typeof e=="symbol"||VB(e)&&BB.call(e)==TB}function f2(e){if(typeof e=="number")return e;if(WB(e))return h2;if(xf(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=xf(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=e.replace(MB,"");var t=OB.test(e);return t||RB.test(e)?DB(e.slice(2),t?2:8):AB.test(e)?h2:+e}var YB=HB;const Pk=Qa(YB),p2=10,XB=/Mac|iPod|iPhone|iPad/.test(typeof window>"u"?"node":window.navigator.platform);function Ek(e){let{deltaY:n,deltaX:t}=e,r=0;if(e.ctrlKey||e.altKey||e.metaKey){const o=Math.sign(e.deltaY),s=Math.abs(e.deltaY);let i=n;s>p2&&(i=p2*o),r=i/100}else e.shiftKey&&!XB&&(t=n,n=0);return{x:-t,y:-n,z:-r}}const GB=$B([mB,gB]);let Ji;const qB=e=>Ji===void 0?(Ji=e,!1):e-Ji>120&&e-Ji<160?(Ji=e,!0):(Ji=e,!1);function QB(e){const n=U(),t=w.useMemo(()=>{let r=null;const o=({event:m})=>{if(!n.isFocused||(r=null,qB(Date.now())))return;if(n.editingId){const S=n.getShapeById(n.editingId);if(S&&n.getShapeUtil(S).canScroll(S)){const P=n.getPageBoundsById(n.editingId);if(P!=null&&P.containsPoint(n.inputs.currentPagePoint))return}}Se(m);const y=Ek(m);if(y.x===0&&y.y===0)return;const x={type:"wheel",name:"wheel",delta:y,shiftKey:m.shiftKey,altKey:m.altKey,ctrlKey:m.metaKey||m.ctrlKey};n.dispatch(x)};let s=1,i=1,a=1,l=0;const c=new E,u=new E,d=m=>{const y=e.current;r=null;const{event:x,origin:S,da:b}=m;x instanceof WheelEvent||(x.target===y||y!=null&&y.contains(x.target))&&(u.x=S[0],u.y=S[1],c.x=S[0],c.y=S[1],s=b[0],i=n.zoomLevel,n.dispatch({type:"pinch",name:"pinch_start",point:{x:S[0],y:S[1],z:n.zoomLevel},delta:{x:0,y:0},shiftKey:x.shiftKey,altKey:x.altKey,ctrlKey:x.metaKey||x.ctrlKey}))},h=Pk(m=>{if(r===null){const y=Math.abs(l-s),x=E.Dist(c,u);m==="gesture"&&y||m==="touch"&&y>16?r="zooming":x>16&&(r="panning")}},32);return{onWheel:o,onPinchStart:d,onPinchEnd:m=>{const y=e.current,{event:x,origin:S,offset:b}=m;if(x instanceof WheelEvent||!(x.target===y||y!=null&&y.contains(x.target)))return;const P=b[0];r=null,requestAnimationFrame(()=>{n.dispatch({type:"pinch",name:"pinch_end",point:{x:S[0],y:S[1],z:P},delta:{x:S[0],y:S[1]},shiftKey:x.shiftKey,altKey:x.altKey,ctrlKey:x.metaKey||x.ctrlKey})})},onPinch:m=>{const y=e.current,{event:x,origin:S,offset:b,da:P}=m;if(x instanceof WheelEvent||!(x.target===y||y!=null&&y.contains(x.target)))return;const C=!("touches"in x);l=P[0],(C||l>64)&&(a=b[0]);const _=S[0]-u.x,I=S[1]-u.y;switch(u.x=S[0],u.y=S[1],h(C?"gesture":"touch"),r){case"zooming":{n.dispatch({type:"pinch",name:"pinch",point:{x:S[0],y:S[1],z:a},delta:{x:_,y:I},shiftKey:x.shiftKey,altKey:x.altKey,ctrlKey:x.metaKey||x.ctrlKey});break}case"panning":{n.dispatch({type:"pinch",name:"pinch",point:{x:S[0],y:S[1],z:i},delta:{x:_,y:I},shiftKey:x.shiftKey,altKey:x.altKey,ctrlKey:x.metaKey||x.ctrlKey});break}}}}},[n,e]);GB(t,{target:e,eventOptions:{passive:!1},pinch:{from:()=>[n.zoomLevel,0],scaleBounds:()=>({from:n.zoomLevel,max:8,min:.05})}})}function Ll(e,n,t){const r=e.getShapeById(n),o=e.getHandles(r);return{shape:r,handle:o.find(s=>s.id===t)}}function ZB(e,n){const t=U();return w.useMemo(()=>{const r=u=>{if(u.isKilled)return;const d=mf(u.currentTarget);xu(d,u);const{shape:h,handle:f}=Ll(t,e,n);f&&t.dispatch({type:"pointer",target:"handle",handle:f,shape:h,name:"pointer_down",...mt(u,t.getContainer())})};let o,s;return{onPointerDown:r,onPointerMove:u=>{if(u.isKilled||u.clientX===o&&u.clientY===s)return;o=u.clientX,s=u.clientY;const{shape:d,handle:h}=Ll(t,e,n);h&&t.dispatch({type:"pointer",target:"handle",handle:h,shape:d,name:"pointer_move",...mt(u,t.getContainer())})},onPointerUp:u=>{if(u.isKilled)return;const d=mf(u.currentTarget);Su(d,u);const{shape:h,handle:f}=Ll(t,e,n);f&&t.dispatch({type:"pointer",target:"handle",handle:f,shape:h,name:"pointer_up",...mt(u,t.getContainer())})},onPointerEnter:u=>{if(u.isKilled)return;const{shape:d,handle:h}=Ll(t,e,n);h&&t.dispatch({type:"pointer",target:"handle",handle:h,shape:d,name:"pointer_enter",...mt(u,t.getContainer())})},onPointerLeave:u=>{if(u.isKilled)return;const{shape:d,handle:h}=Ll(t,e,n);h&&t.dispatch({type:"pointer",target:"handle",handle:h,shape:d,name:"pointer_leave",...mt(u,t.getContainer())})}}},[t,e,n])}function JB(){const e=U(),n=Yt();w.useLayoutEffect(()=>{const t=Pk(()=>{e.updateViewportScreenBounds()},200,{trailing:!0}),r=new ResizeObserver(o=>{o[0].contentRect&&t()});return n&&r.observe(n),t(),()=>{r.disconnect()}},[e,n])}var eF=200,V1="__lodash_hash_undefined__",tF=1/0,nF="[object Function]",rF="[object GeneratorFunction]",oF=/[\\^$.*+?()[\]{}|]/g,sF=/^\[object .+?Constructor\]$/,iF=typeof tn=="object"&&tn&&tn.Object===Object&&tn,aF=typeof self=="object"&&self&&self.Object===Object&&self,W1=iF||aF||Function("return this")();function lF(e,n){var t=e?e.length:0;return!!t&&dF(e,n,0)>-1}function cF(e,n,t){for(var r=-1,o=e?e.length:0;++r<o;)if(t(n,e[r]))return!0;return!1}function uF(e,n,t,r){for(var o=e.length,s=t+(r?1:-1);r?s--:++s<o;)if(n(e[s],s,e))return s;return-1}function dF(e,n,t){if(n!==n)return uF(e,hF,t);for(var r=t-1,o=e.length;++r<o;)if(e[r]===n)return r;return-1}function hF(e){return e!==e}function fF(e,n){return e.has(n)}function pF(e,n){return e==null?void 0:e[n]}function gF(e){var n=!1;if(e!=null&&typeof e.toString!="function")try{n=!!(e+"")}catch{}return n}function _k(e){var n=-1,t=Array(e.size);return e.forEach(function(r){t[++n]=r}),t}var mF=Array.prototype,yF=Function.prototype,Ck=Object.prototype,om=W1["__core-js_shared__"],g2=function(){var e=/[^.]+$/.exec(om&&om.keys&&om.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ik=yF.toString,Y1=Ck.hasOwnProperty,vF=Ck.toString,wF=RegExp("^"+Ik.call(Y1).replace(oF,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xF=mF.splice,SF=X1(W1,"Map"),sm=X1(W1,"Set"),Xc=X1(Object,"create");function _i(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var r=e[n];this.set(r[0],r[1])}}function bF(){this.__data__=Xc?Xc(null):{}}function PF(e){return this.has(e)&&delete this.__data__[e]}function EF(e){var n=this.__data__;if(Xc){var t=n[e];return t===V1?void 0:t}return Y1.call(n,e)?n[e]:void 0}function _F(e){var n=this.__data__;return Xc?n[e]!==void 0:Y1.call(n,e)}function CF(e,n){var t=this.__data__;return t[e]=Xc&&n===void 0?V1:n,this}_i.prototype.clear=bF;_i.prototype.delete=PF;_i.prototype.get=EF;_i.prototype.has=_F;_i.prototype.set=CF;function il(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var r=e[n];this.set(r[0],r[1])}}function IF(){this.__data__=[]}function kF(e){var n=this.__data__,t=gp(n,e);if(t<0)return!1;var r=n.length-1;return t==r?n.pop():xF.call(n,t,1),!0}function $F(e){var n=this.__data__,t=gp(n,e);return t<0?void 0:n[t][1]}function TF(e){return gp(this.__data__,e)>-1}function MF(e,n){var t=this.__data__,r=gp(t,e);return r<0?t.push([e,n]):t[r][1]=n,this}il.prototype.clear=IF;il.prototype.delete=kF;il.prototype.get=$F;il.prototype.has=TF;il.prototype.set=MF;function al(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var r=e[n];this.set(r[0],r[1])}}function AF(){this.__data__={hash:new _i,map:new(SF||il),string:new _i}}function OF(e){return mp(this,e).delete(e)}function RF(e){return mp(this,e).get(e)}function DF(e){return mp(this,e).has(e)}function LF(e,n){return mp(this,e).set(e,n),this}al.prototype.clear=AF;al.prototype.delete=OF;al.prototype.get=RF;al.prototype.has=DF;al.prototype.set=LF;function Sf(e){var n=-1,t=e?e.length:0;for(this.__data__=new al;++n<t;)this.add(e[n])}function jF(e){return this.__data__.set(e,V1),this}function NF(e){return this.__data__.has(e)}Sf.prototype.add=Sf.prototype.push=jF;Sf.prototype.has=NF;function gp(e,n){for(var t=e.length;t--;)if(WF(e[t][0],n))return t;return-1}function zF(e){if(!kk(e)||KF(e))return!1;var n=YF(e)||gF(e)?wF:sF;return n.test(HF(e))}function BF(e,n,t){var r=-1,o=lF,s=e.length,i=!0,a=[],l=a;if(t)i=!1,o=cF;else if(s>=eF){var c=n?null:FF(e);if(c)return _k(c);i=!1,o=fF,l=new Sf}else l=n?[]:a;e:for(;++r<s;){var u=e[r],d=n?n(u):u;if(u=t||u!==0?u:0,i&&d===d){for(var h=l.length;h--;)if(l[h]===d)continue e;n&&l.push(d),a.push(u)}else o(l,d,t)||(l!==a&&l.push(d),a.push(u))}return a}var FF=sm&&1/_k(new sm([,-0]))[1]==tF?function(e){return new sm(e)}:XF;function mp(e,n){var t=e.__data__;return UF(n)?t[typeof n=="string"?"string":"hash"]:t.map}function X1(e,n){var t=pF(e,n);return zF(t)?t:void 0}function UF(e){var n=typeof e;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?e!=="__proto__":e===null}function KF(e){return!!g2&&g2 in e}function HF(e){if(e!=null){try{return Ik.call(e)}catch{}try{return e+""}catch{}}return""}function VF(e){return e&&e.length?BF(e):[]}function WF(e,n){return e===n||e!==e&&n!==n}function YF(e){var n=kk(e)?vF.call(e):"";return n==nF||n==rF}function kk(e){var n=typeof e;return!!e&&(n=="object"||n=="function")}function XF(){}var GF=VF;const $k=Qa(GF);function qF(){const e=U(),n=w.useMemo(()=>e.store.query.records("instance_presence",()=>({userId:{neq:e.user.id}})),[e]),t=$j("userIds",()=>$k(n.value.map(r=>r.userId)).sort(),{isEqual:(r,o)=>{var s;return r.join(",")===((s=o.join)==null?void 0:s.call(o,","))}},[n]);return J(t)}function Tk(e){const n=U(),t=w.useMemo(()=>n.store.query.records("instance_presence",()=>({userId:{eq:e}})),[n,e]);return J(`latestPresence:${e}`,()=>t.value.slice().sort((o,s)=>s.lastActivityTimestamp-o.lastActivityTimestamp)[0],[])??null}const QF=me(function(){const n=qF();return g.jsx(g.Fragment,{children:n.map(t=>g.jsx(ZF,{collaboratorId:t},t))})}),ZF=me(function({collaboratorId:n}){const t=U(),r=Tk(n),o=eU(r);if(!(r&&r.currentPageId===t.currentPageId))return null;switch(o){case"inactive":{const{followingUserId:s,highlightedUserIds:i}=t.instanceState;if(!(s===r.userId||i.includes(r.userId)))return null;break}case"idle":{const{highlightedUserIds:s}=t.instanceState;if(r.followingUserId===t.user.id&&!(r.chatMessage||s.includes(r.userId)))return null;break}}return g.jsx(JF,{latestPresence:r})}),JF=me(function({latestPresence:n}){const t=U(),{CollaboratorBrush:r,CollaboratorScribble:o,CollaboratorCursor:s,CollaboratorHint:i,CollaboratorShapeIndicator:a}=ar(),{viewportPageBounds:l,zoomLevel:c}=t,{userId:u,chatMessage:d,brush:h,scribble:f,selectedIds:p,userName:m,cursor:y,color:x}=n,S=!(y.x<l.minX-12/c||y.y<l.minY-16/c||y.x>l.maxX-12/c||y.y>l.maxY-16/c);return g.jsxs(g.Fragment,{children:[h&&r?g.jsx(r,{className:"tl-collaborator__brush",brush:h,color:x,opacity:.1},u+"_brush"):null,S&&s?g.jsx(s,{className:"tl-collaborator__cursor",point:y,color:x,zoom:c,name:m!=="New User"?m:null,chatMessage:d},u+"_cursor"):i?g.jsx(i,{className:"tl-collaborator__cursor-hint",point:y,color:x,zoom:c,viewport:l},u+"_cursor_hint"):null,f&&o?g.jsx(o,{className:"tl-collaborator__scribble",scribble:f,color:x,zoom:c,opacity:f.color==="laser"?.5:.1},u+"_scribble"):null,a&&p.map(b=>g.jsx(a,{className:"tl-collaborator__shape-indicator",id:b,color:x,opacity:.5},u+"_"+b))]})});function m2(e){return e>dz?"inactive":e>hk?"idle":"active"}function eU(e){const n=w.useRef((e==null?void 0:e.lastActivityTimestamp)??-1),[t,r]=w.useState(()=>m2(Date.now()-n.current));return w.useEffect(()=>{const o=setInterval(()=>{r(m2(Date.now()-n.current))},hz);return()=>clearInterval(o)},[]),e&&(n.current=e.lastActivityTimestamp),t}const tU=me(function(){const n=U(),t=w.useMemo(()=>({onPointerDown:h=>{if(h.isKilled)return;xu(h.currentTarget,h);const f={type:"pointer",target:"selection",name:"pointer_down",...mt(h,n.getContainer())};n.dispatch(f)},onPointerMove:h=>{if(h.isKilled)return;const f={type:"pointer",target:"selection",name:"pointer_move",...mt(h,n.getContainer())};n.dispatch(f)},onPointerUp:h=>{if(h.isKilled)return;Su(h.currentTarget,h);const f={type:"pointer",target:"selection",name:"pointer_up",...mt(h,n.getContainer())};n.dispatch(f)},onPointerEnter:h=>{if(h.isKilled)return;const f={type:"pointer",target:"selection",name:"pointer_enter",...mt(h,n.getContainer())};n.dispatch(f)},onPointerLeave:h=>{if(h.isKilled)return;const f={type:"pointer",target:"selection",name:"pointer_leave",...mt(h,n.getContainer())};n.dispatch(f)}}),[n]),{selectionBounds:r,selectedIds:o}=n;if(!r)return null;const s=n.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","text.resizing");if(o.length===1){const a=n.getShapeById(o[0]);if(!a||n.getShapeUtil(a).hideSelectionBoundsBg(a))return null}const i=Y.toCssString(Y.Compose(Y.Translate(r.minX,r.minY),Y.Rotate(n.selectionRotation)));return g.jsx("div",{className:"tl-selection__bg",draggable:!1,style:{transform:i,width:R(Math.max(1,r.width)),height:R(Math.max(1,r.height)),pointerEvents:s?"all":"none",opacity:s?1:0},...t})});function Ya({children:e,className:n="",...t}){return g.jsx("div",{...t,className:`tl-html-container ${n}`,children:e})}function G1(e){const n=U();return J("isEditing",()=>n.editingId===e,[n,e])}function nU(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function rU(e){const n=new URL(e).host.replace("www.","");for(const t of Wa)if(Mk(t.hostnames,n)){const r=t.fromEmbedUrl(e);if(r)return{definition:t,url:r,embedUrl:e}}}const oU=e=>e.split("*").map(n=>nU(n)).join(".+"),Mk=(e,n)=>!!e.find(t=>{const r=new RegExp(oU(t));return n.match(r)});function sU(e){const n=new URL(e).host.replace("www.","");for(const t of Wa)if(Mk(t.hostnames,n)){const r=t.toEmbedUrl(e);if(r)return{definition:t,embedUrl:r,url:e}}}function Ak(e){return sU(e)??rU(e)}function mo(e){try{return Ak(e)}catch(n){console.error(n)}}class eo{constructor(n,t,r){v(this,"canSnap",()=>!0);v(this,"canScroll",()=>!1);v(this,"canUnmount",()=>!0);v(this,"canBind",(n,t)=>!0);v(this,"canEdit",()=>!1);v(this,"canResize",()=>!0);v(this,"canCrop",()=>!1);v(this,"isClosed",()=>!0);v(this,"hideResizeHandles",()=>!1);v(this,"hideRotateHandle",()=>!1);v(this,"hideSelectionBoundsBg",()=>!1);v(this,"hideSelectionBoundsFg",()=>!1);v(this,"isAspectRatioLocked",()=>!1);v(this,"onBeforeCreate");v(this,"onBeforeUpdate");v(this,"onDragShapesOver");v(this,"onDragShapesOut");v(this,"onDropShapesOver");v(this,"onResizeStart");v(this,"onResize");v(this,"onResizeEnd");v(this,"onTranslateStart");v(this,"onTranslate");v(this,"onTranslateEnd");v(this,"onRotateStart");v(this,"onRotate");v(this,"onRotateEnd");v(this,"onHandleChange");v(this,"onBindingChange");v(this,"onChildrenChange");v(this,"onDoubleClickHandle");v(this,"onDoubleClickEdge");v(this,"onDoubleClick");v(this,"onClick");v(this,"onEditEnd");this.editor=n,this.type=t,this.styleProps=r}setStyleInPartial(n,t,r){const o=this.styleProps.get(n);return o?{...t,props:{...t.props,[o]:r}}:t}providesBackgroundForChildren(n){return!1}getOutlineSegments(n){return[this.editor.getOutline(n)]}getOutline(n){return this.editor.getBounds(n).corners}snapPoints(n){return this.editor.getBounds(n).snapPoints}center(n){return this.getCenter(n)}getCenter(n){return this.editor.getBounds(n).center}canReceiveNewChildrenOfType(n,t){return!1}canDropShapes(n,t){return!1}expandSelectionOutlinePx(n){return 0}hitTestPoint(n,t){return this.editor.getBounds(n).containsPoint(t)}hitTestLineSegment(n,t,r){const o=this.editor.getOutline(n);for(let s=0;s<o.length;s++){const i=o[s],a=o[(s+1)%o.length];if(Gr(t,r,i,a))return!0}return!1}getCanvasSvgDefs(){return[]}}v(eo,"type");function Ok(e,n,t={}){const{newPoint:r,handle:o,scaleX:s,scaleY:i}=n,{minWidth:a=1,maxWidth:l=1/0,minHeight:c=1,maxHeight:u=1/0}=t;let d=e.props.w*s,h=e.props.h*i;const f=new E(0,0);if(d>0){if(d<a){switch(o){case"top_left":case"left":case"bottom_left":{f.x=d-a;break}case"top":case"bottom":{f.x=(d-a)/2;break}default:f.x=0}d=a}}else if(f.x=d,d=-d,d<a){switch(o){case"top_left":case"left":case"bottom_left":{f.x=-d;break}default:f.x=-a}d=a}if(h>0){if(h<c){switch(o){case"top_left":case"top":case"top_right":{f.y=h-c;break}case"right":case"left":{f.y=(h-c)/2;break}default:f.y=0}h=c}}else if(f.y=h,h=-h,h<c){switch(o){case"top_left":case"top":case"top_right":{f.y=-h;break}default:f.y=-c}h=c}const{x:p,y:m}=f.rot(e.rotation).add(r);return{x:p,y:m,props:{w:Math.min(l,d),h:Math.min(u,h)}}}class ll extends eo{constructor(){super(...arguments);v(this,"onResize",(t,r)=>Ok(t,r))}getBounds(t){return new ne(0,0,t.props.w,t.props.h)}getCenter(t){return new E(t.props.w/2,t.props.h/2)}getOutline(t){return this.editor.getBounds(t).corners}hitTestPoint(t,r){return sr(r,this.editor.getOutline(t))}hitTestLineSegment(t,r,o){const s=this.editor.getOutline(t);for(let i=0;i<s.length;i++){const a=s[i],l=s[(i+1)%s.length];if(Gr(r,o,a,l))return!0}return!1}}const iU=e=>Object.entries(e).filter(([n,t])=>t).map(([n])=>n).join(" "),Nf=class Nf extends ll{constructor(){super(...arguments);v(this,"hideSelectionBoundsBg",t=>!this.canResize(t));v(this,"hideSelectionBoundsFg",t=>!this.canResize(t));v(this,"canEdit",()=>!0);v(this,"canUnmount",t=>{var r,o;return!!((o=(r=mo(t.props.url))==null?void 0:r.definition)!=null&&o.canUnmount)});v(this,"canResize",t=>{var r,o;return!!((o=(r=mo(t.props.url))==null?void 0:r.definition)!=null&&o.doesResize)});v(this,"isAspectRatioLocked",t=>{const r=mo(t.props.url);return(r==null?void 0:r.definition.isAspectRatioLocked)??!1});v(this,"onResize",(t,r)=>{const o=this.isAspectRatioLocked(t),s=mo(t.props.url);let i=(s==null?void 0:s.definition.minWidth)??200,a=(s==null?void 0:s.definition.minHeight)??200;if(o){const l=t.props.w/t.props.h;l>1?i*=l:a/=l}return Ok(t,r,{minWidth:i,minHeight:a})})}getDefaultProps(){return{w:300,h:300,url:""}}component(t){const{w:r,h:o,url:s}=t.props,i=G1(t.id),a=w.useMemo(()=>Ak(s),[s]),l=J("is hovering",()=>{const{editingId:h,hoveredId:f}=this.editor.pageState;if(h&&f!==h){const p=this.editor.getShapeById(h);if(p&&this.editor.isShapeOfType(p,Nf))return!0}return!1},[]),c=this.editor.getPageRotation(t),u=i||l;if((a==null?void 0:a.definition.type)==="github_gist"){const h=a.url.split("/").pop();if(!h)throw Error("No gist id!");return g.jsx(Ya,{className:"tl-embed-container",id:t.id,children:g.jsx(aU,{id:h,width:R(r),height:R(o),isInteractive:u,pageRotation:c})})}const d=iU({...H9,...(a==null?void 0:a.definition.overridePermissions)??{}});return g.jsx(Ya,{className:"tl-embed-container",id:t.id,children:a!=null&&a.definition?g.jsx("iframe",{className:`tl-embed tl-embed-${t.id}`,sandbox:d,src:a.embedUrl,width:R(r),height:R(o),draggable:!1,frameBorder:"0",referrerPolicy:"no-referrer-when-downgrade",style:{border:0,pointerEvents:u?"auto":"none",zIndex:u?"":"-1",boxShadow:K1(c),borderRadius:(a==null?void 0:a.definition.overrideOutlineRadius)??8,background:a==null?void 0:a.definition.backgroundColor}}):g.jsx("g",{transform:`translate(${(r-38)/2}, ${(o-38)/2})`,children:g.jsx(fp,{})})})}indicator(t){const r=w.useMemo(()=>mo(t.props.url),[t.props.url]);return g.jsx("rect",{width:R(t.props.w),height:R(t.props.h),rx:(r==null?void 0:r.definition.overrideOutlineRadius)??8,ry:(r==null?void 0:r.definition.overrideOutlineRadius)??8})}};v(Nf,"type","embed");let Is=Nf;function aU({id:e,file:n,isInteractive:t,width:r,height:o,style:s,pageRotation:i}){return g.jsx("iframe",{className:"tl-embed",draggable:!1,width:R(r),height:R(o),frameBorder:"0",scrolling:"no",seamless:!0,referrerPolicy:"no-referrer-when-downgrade",style:{...s,pointerEvents:t?"all":"none",zIndex:t?"":"-1",boxShadow:K1(i)},srcDoc:`
			<html>
				<head>
					<base target="_blank">
				</head>
				<body>
					<script src=${`https://gist.github.com/${e}.js${n?`?file=${n}`:""}`}><\/script>
					<style type="text/css">
						* { margin: 0px; }
						table { height: 100%; background-color: red; }
						.gist { background-color: none; height: 100%;  }
						.gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
					</style>
				</body>
			</html>`})}class yp{constructor(){v(this,"items",new WeakMap)}get(n,t){return this.items.has(n)||this.items.set(n,t(n)),this.items.get(n)}access(n){return this.items.get(n)}set(n,t){this.items.set(n,t)}has(n){return this.items.has(n)}invalidate(n){this.items.delete(n)}bust(){this.items=new WeakMap}}function Rk(e,n){return e.match(/^\s*$/)?n:e}function lU(e){return e.replace(/\s/g,"")}function vp(e,n,t){const{padding:r=0}=t,o=document.createElementNS("http://www.w3.org/2000/svg","text");if(o.setAttribute("font-size",t.fontSize+"px"),o.setAttribute("font-family",t.fontFamily),o.setAttribute("font-style",t.fontStyle),o.setAttribute("font-weight",t.fontWeight),o.setAttribute("line-height",t.lineHeight*t.fontSize+"px"),o.setAttribute("dominant-baseline","mathematical"),o.setAttribute("alignment-baseline","mathematical"),n.length===0)return o;const s=ne.From(n[0].box);for(const{box:c}of n)s.union(c);const i=r+(t.offsetX??0),a=(t.offsetY??0)+t.fontSize/2+(t.verticalTextAlign==="start"?r:t.verticalTextAlign==="end"?t.height-r-s.height:(Math.ceil(t.height)-s.height)/2);let l=null;for(const{text:c,box:u}of n){if(l!==null&&u.y>l){const p=document.createElementNS("http://www.w3.org/2000/svg","tspan");p.setAttribute("alignment-baseline","mathematical"),p.setAttribute("x",i+"px"),p.setAttribute("y",u.y+a+"px"),p.textContent=`
`,o.appendChild(p)}const h=document.createElementNS("http://www.w3.org/2000/svg","tspan");h.setAttribute("alignment-baseline","mathematical"),h.setAttribute("x",u.x+i+"px"),h.setAttribute("y",u.y+a+"px");const f=lU(c);h.textContent=f,o.appendChild(h),l=u.y}return t.stroke&&t.strokeWidth&&(o.setAttribute("stroke",t.stroke),o.setAttribute("stroke-width",t.strokeWidth+"px")),t.fill&&o.setAttribute("fill",t.fill),o}const At={lineHeight:1.35,fontWeight:"normal",fontVariant:"normal",fontStyle:"normal",padding:"0px",maxWidth:"auto"},Ae={s:2,m:3.5,l:5,xl:10},us={s:18,m:24,l:36,xl:44},yi={s:18,m:22,l:26,xl:32},ns={s:18,m:20,l:24,xl:28},bo={draw:"var(--tl-font-draw)",sans:"var(--tl-font-sans)",serif:"var(--tl-font-serif)",mono:"var(--tl-font-mono)"};function wp(e){return{key:`${Yr.id}:${e}`,getElement:async()=>{const n=cU(e);if(!n)return null;const t=n.$$_url,r=n.$$_fontface;if(!t||!r)return null;const o=await(await fetch(t)).blob(),s=await new Promise((l,c)=>{const u=new FileReader;u.onload=()=>l(u.result),u.onerror=c,u.readAsDataURL(o)}),i=r.replace(t,s),a=document.createElementNS("http://www.w3.org/2000/svg","style");return a.textContent=i,a}}}function cU(e){const n=wu[e];for(const t of document.fonts)if(n.includes(t.family))return t;return null}function q1(e,n){return{key:`${Yr.id}:${e}`,getElement:async()=>{if(e!=="pattern")return null;const t=8/12,r=document.createElement("div");return r.innerHTML=`
				<svg>
					<defs>
						<mask id="hash_pattern_mask">
							<rect x="0" y="0" width="8" height="8" fill="white" />
							<g
								strokeLinecap="round"
								stroke="black"
							>
								<line x1="${t*1}" y1="${t*3}" x2="${t*3}" y2="${t*1}" />
								<line x1="${t*5}" y1="${t*7}" x2="${t*7}" y2="${t*5}" />
								<line x1="${t*9}" y1="${t*11}" x2="${t*11}" y2="${t*9}" />
							</g>
						</mask>
						<pattern
							id="hash_pattern"
							width="8"
							height="8"
							patternUnits="userSpaceOnUse"
						>
							<rect x="0" y="0" width="8" height="8" fill="${n.solid}" mask="url(#hash_pattern_mask)" />
						</pattern>
					</defs>
				</svg>
			`,Array.from(r.querySelectorAll("defs > *"))}}}function Q1(){return{key:`${Yr.id}:pattern`,component:hU}}const Zl=8,y2=(e,n,t)=>new Promise((r,o)=>{const s=Zl*n*e,i=document.createElement("canvas");i.width=s,i.height=s;const a=i.getContext("2d");if(!a)return;a.fillStyle=t?"#212529":"#f8f9fa",a.fillRect(0,0,s,s),a.globalCompositeOperation="destination-out",a.lineCap="round",a.lineWidth=1.25*n*e;const l=8/12,c=u=>u*n*e;a.beginPath(),a.moveTo(c(l*1),c(l*3)),a.lineTo(c(l*3),c(l*1)),a.moveTo(c(l*5),c(l*7)),a.lineTo(c(l*7),c(l*5)),a.moveTo(c(l*9),c(l*11)),a.lineTo(c(l*11),c(l*9)),a.stroke(),i.toBlob(u=>{!u||pt.throwToBlob.value?o():r(u)})}),v2=(e,n)=>{const t=document.createElement("canvas");t.width=e[0],t.height=e[1];const r=t.getContext("2d");return r?(n(r),t.toDataURL()):""},uU=()=>{const e=[];for(let n=1;n<=Math.ceil(ss);n++){const t=v2([1,1],o=>{o.fillStyle=cf.lightMode.black.semi,o.fillRect(0,0,1,1)}),r=v2([1,1],o=>{o.fillStyle=cf.darkMode.black.semi,o.fillRect(0,0,1,1)});e.push({zoom:n,url:t,darkMode:!1}),e.push({zoom:n,url:r,darkMode:!0})}return e};function dU(){const n=U().devicePixelRatio,[t,r]=w.useState(!1),o=w.useMemo(()=>uU(),[]),[s,i]=w.useState(o);return w.useEffect(()=>{const l=[];for(let u=1;u<=Math.ceil(ss);u++)l.push(y2(n,u,!1).then(d=>({zoom:u,url:URL.createObjectURL(d),darkMode:!1}))),l.push(y2(n,u,!0).then(d=>({zoom:u,url:URL.createObjectURL(d),darkMode:!0})));let c=!1;return Promise.all(l).then(u=>{c||(i(u),r(!0))}),()=>{c=!0,r(!1)}},[n]),{defs:g.jsx(g.Fragment,{children:s.map(l=>{const c=l.zoom+(l.darkMode?"_dark":"_light");return g.jsx("pattern",{id:vf[c],width:Zl,height:Zl,patternUnits:"userSpaceOnUse",children:g.jsx("image",{href:l.url,width:Zl,height:Zl})},c)})}),isReady:t}}function hU(){const e=U(),n=w.useRef(null),{defs:t,isReady:r}=dU();return w.useEffect(()=>{if(r&&e.isSafari){const o=Dk(n.current);o&&requestAnimationFrame(()=>{o.style.display="none",requestAnimationFrame(()=>{o.style.display=""})})}},[e,r]),g.jsx("g",{ref:n,children:t})}function Dk(e){return e.classList.contains("tl-html-layer")?e:e.parentElement?Dk(e.parentElement):null}function fU(e,{initialBounds:n,scaleX:t,scaleY:r,newPoint:o}){const s=Math.max(.01,Math.min(Math.abs(t),Math.abs(r))),i=new E(0,0);t<0&&(i.x=-(n.width*s)),r<0&&(i.y=-(n.height*s));const{x:a,y:l}=E.Add(o,i.rot(e.rotation));return{x:a,y:l,props:{scale:s*e.props.scale}}}const ba="  ",Zt=class Zt{static insertTextFirefox(n,t){n.setRangeText(t,n.selectionStart||0,n.selectionEnd||0,"end"),n.dispatchEvent(new InputEvent("input",{data:t,inputType:"insertText",isComposing:!1}))}static insert(n,t){const r=n.ownerDocument,o=r.activeElement;o!==n&&n.focus(),r.execCommand("insertText",!1,t)||Zt.insertTextFirefox(n,t),o===r.body?n.blur():o instanceof HTMLElement&&o!==n&&o.focus()}static set(n,t){n.select(),Zt.insert(n,t)}static getSelection(n){const{selectionStart:t,selectionEnd:r}=n;return n.value.slice(t||void 0,r||void 0)}static wrapSelection(n,t,r){const{selectionStart:o,selectionEnd:s}=n,i=Zt.getSelection(n);Zt.insert(n,t+i+(r??t)),n.selectionStart=(o||0)+t.length,n.selectionEnd=(s||0)+t.length}static replace(n,t,r){let o=0;n.value.replace(t,(...s)=>{const i=o+s[s.length-2],a=s[0].length;n.selectionStart=i,n.selectionEnd=i+a;const l=typeof r=="string"?r:r(...s);return Zt.insert(n,l),n.selectionStart=i,o+=l.length-a,l})}static findLineEnd(n,t){const r=n.lastIndexOf(`
`,t-1)+1;return n.charAt(r)!=="	"?t:r+1}static indent(n){var a;const{selectionStart:t,selectionEnd:r,value:o}=n,s=o.slice(t,r),i=(a=/\n/g.exec(s))==null?void 0:a.length;if(i&&i>0){const l=o.lastIndexOf(`
`,t-1)+1,c=n.value.slice(l,r-1),u=c.replace(/^|\n/g,`$&${ba}`),d=u.length-c.length;n.setSelectionRange(l,r-1),Zt.insert(n,u),n.setSelectionRange(t+1,r+d)}else Zt.insert(n,ba)}static unindent(n){const{selectionStart:t,selectionEnd:r,value:o}=n,s=o.lastIndexOf(`
`,t-1)+1,i=Zt.findLineEnd(o,r),a=n.value.slice(s,i),l=a.replace(/(^|\n)(\t| {1,2})/g,"$1"),c=a.length-l.length;n.setSelectionRange(s,i),Zt.insert(n,l);const u=/\t| {1,2}/.exec(o.slice(s,t)),d=u?u[0].length:0,h=t-d;n.setSelectionRange(t-d,Math.max(h,r-c))}static indentCE(n){var l;const t=window.getSelection(),r=n.innerText,o=wd(n)??0,s=wd(n)??0,i=r.slice(o,s),a=(l=/\n/g.exec(i))==null?void 0:l.length;if(a&&a>0){const c=r.lastIndexOf(`
`,o-1)+1,u=r.slice(c,s-1),h=u.replace(/^|\n/g,`$&${ba}`).length-u.length;t&&t.setBaseAndExtent(n,o+1,n,s+h)}else{const c=window.getSelection();n.innerText=r.slice(0,o)+ba+r.slice(o),c==null||c.setBaseAndExtent(n,o+1,n,o+2)}}static unindentCE(n){const t=window.getSelection(),r=n.innerText,o=wd(n)??0,s=wd(n)??0,i=r.lastIndexOf(`
`,o-1)+1,a=Zt.findLineEnd(r,s),l=r.slice(i,a),c=l.replace(/(^|\n)(\t| {1,2})/g,"$1"),u=l.length-c.length;if(t){t.setBaseAndExtent(n,i,n,a);const d=/\t| {1,2}/.exec(r.slice(i,o)),h=d?d[0].length:0,f=o-h;t.setBaseAndExtent(n,o-h,n,Math.max(f,s-u))}}static normalizeText(n){return n.replace(Zt.fixNewLines,`
`)}static normalizeTextForDom(n){return n.replace(Zt.fixNewLines,`
`).split(`
`).map(t=>t||" ").join(`
`)}};v(Zt,"fixNewLines",/\r?\n|\r/g);let Ss=Zt;function wd(e){if(typeof window.getSelection>"u")return;const n=window.getSelection();if(!n)return;let t=0;if(n.rangeCount!==0){const r=n.getRangeAt(0),o=r.cloneRange();o.selectNodeContents(e),o.setEnd(r.endContainer,r.endOffset),t=o.toString().length}return t}function Z1(e,n,t){const r=U(),o=w.useRef(null),s=J("isEditing",()=>r.pageState.editingId===e,[r,e]),i=w.useRef(!1),a=w.useRef(),l=J("is editable hovering",()=>{if(n==="text"&&r.isIn("text")&&r.hoveredId===e)return!0;if(r.isIn("select.editing_shape")){const{editingShape:p}=r;return p?r.hoveredId===e&&p.type===n&&r.getShapeUtil(p).canEdit(p):!1}return!1},[n,e]),c=w.useCallback(()=>{l||requestAnimationFrame(()=>{const p=o.current;if(!p)return;const m=r.getShapeById(e);m&&(p.value=m.props.text,p.value.length&&!i.current&&p.select(),i.current=!1)})},[r,e,l]),u=w.useCallback(()=>{const p=a.current;requestAnimationFrame(()=>{var y;const m=o.current;if(r.isIn("select.editing_shape")&&m)if(p)if(!p.length)m.focus();else{i.current=!0,m.focus();const x=window.getSelection();x&&p.forEach(S=>x.addRange(S))}else m.focus();else(y=window.getSelection())==null||y.removeAllRanges(),r.complete()})},[r]),d=w.useCallback(p=>{switch((p.ctrlKey||p.metaKey)&&Vr(p),p.key){case"Enter":{(p.ctrlKey||p.metaKey)&&r.complete();break}case"Tab":{Se(p),p.shiftKey?Ss.unindent(p.currentTarget):Ss.indent(p.currentTarget);break}}},[r]),h=w.useCallback(p=>{let m=Ss.normalizeText(p.currentTarget.value);const y=m.replace(/\t/g,ba);if(y!==m){const x=p.currentTarget.selectionStart;p.currentTarget.value=y,p.currentTarget.selectionStart=x+(y.length-m.length),p.currentTarget.selectionEnd=x+(y.length-m.length),m=y}r.updateShapes([{id:e,type:n,props:{text:m}}])},[r,e,n]),f=t.trim().length===0;return w.useEffect(()=>{if(o.current){let m=function(){var x,S;const y=(x=window.getSelection)==null?void 0:x.call(window);if(y&&y.type!=="None"){const b=[];if(y)for(let P=0;P<y.rangeCount;P++)b.push((S=y.getRangeAt)==null?void 0:S.call(y,P));a.current=b}};return document.addEventListener("selectionchange",m),()=>{document.removeEventListener("selectionchange",m)}}}),{rInput:o,isEditing:s,isEditableFromHover:l,handleFocus:c,handleBlur:u,handleKeyDown:d,handleChange:h,isEmpty:f}}const pU=new yp;class Mr extends eo{constructor(){super(...arguments);v(this,"canEdit",()=>!0);v(this,"isAspectRatioLocked",()=>!0);v(this,"onResize",(t,r)=>{const{initialBounds:o,initialShape:s,scaleX:i,handle:a}=r;if(r.mode==="scale_shape"||a!=="right"&&a!=="left")return{id:t.id,type:t.type,...fU(t,r)};{const l=o.width;let c=l*i;const u=new E(0,0);c=Math.max(1,Math.abs(c)),a==="left"?(u.x=l-c,i<0&&(u.x+=c)):i<0&&(u.x-=c);const{x:d,y:h}=u.rot(t.rotation).add(s);return{id:t.id,type:t.type,x:d,y:h,props:{w:c/s.props.scale,autoSize:!1}}}});v(this,"onBeforeCreate",t=>{if(!t.props.autoSize||t.props.text.trim())return;const r=this.getMinDimensions(t);return{...t,x:t.x-r.width/2,y:t.y-r.height/2}});v(this,"onEditEnd",t=>{const{id:r,type:o,props:{text:s}}=t,i=t.props.text.trimEnd();i.length===0?this.editor.deleteShapes([t.id]):i!==t.props.text&&this.editor.updateShapes([{id:r,type:o,props:{text:s.trimEnd()}}])});v(this,"onBeforeUpdate",(t,r)=>{if(!r.props.autoSize)return;const o=t.props.size!==r.props.size||t.props.align!==r.props.align||t.props.font!==r.props.font||t.props.scale!==1&&r.props.scale===1,s=t.props.text!==r.props.text;if(!o&&!s)return;const i=this.getMinDimensions(t),a=w2(this.editor,r.props),l=i.width*t.props.scale,c=i.height*t.props.scale,u=a.width*r.props.scale,d=a.height*r.props.scale;let h;switch(r.props.align){case"middle":{h=new E((u-l)/2,s?0:(d-c)/2);break}case"end":{h=new E(u-l,s?0:(d-c)/2);break}default:{if(s)break;h=new E(0,(d-c)/2);break}}if(h){h.rot(r.rotation);const{x:f,y:p}=r;return{...r,x:f-h.x,y:p-h.y,props:{...r.props,w:u}}}else return{...r,props:{...r.props,w:u}}});v(this,"onDoubleClickEdge",t=>{if(!t.props.autoSize)return{id:t.id,type:t.type,props:{autoSize:!0}};if(t.props.scale!==1)return{id:t.id,type:t.type,props:{scale:1}}})}getDefaultProps(){return{color:"black",size:"m",w:8,text:"",font:"draw",align:"middle",autoSize:!0,scale:1}}getMinDimensions(t){return pU.get(t.props,r=>w2(this.editor,r))}getBounds(t){const{scale:r}=t.props,{width:o,height:s}=this.getMinDimensions(t);return new ne(0,0,o*r,s*r)}getOutline(t){const r=this.editor.getBounds(t);return[new E(0,0),new E(r.width,0),new E(r.width,r.height),new E(0,r.height)]}component(t){const{id:r,type:o,props:{text:s,color:i}}=t,a=Sn(this.editor),{width:l,height:c}=this.getMinDimensions(t),{rInput:u,isEmpty:d,isEditing:h,isEditableFromHover:f,handleFocus:p,handleChange:m,handleKeyDown:y,handleBlur:x}=Z1(r,o,s);return g.jsx(Ya,{id:t.id,children:g.jsxs("div",{className:"tl-text-shape__wrapper tl-text-shadow","data-font":t.props.font,"data-align":t.props.align,"data-hastext":!d,"data-isediting":h||f,"data-textwrap":!0,style:{fontSize:us[t.props.size],lineHeight:us[t.props.size]*At.lineHeight+"px",transform:`scale(${t.props.scale})`,transformOrigin:"top left",width:Math.max(1,l),height:Math.max(us[t.props.size]*At.lineHeight,c),color:a[i].solid},children:[g.jsx("div",{className:"tl-text tl-text-content",dir:"ltr",children:s}),h||f?g.jsx("textarea",{ref:u,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:h,placeholder:"",spellCheck:"true",wrap:"off",dir:"ltr",datatype:"wysiwyg",defaultValue:s,onFocus:p,onChange:m,onKeyDown:y,onBlur:x,onTouchEnd:Vr,onContextMenu:Vr}):null]})})}indicator(t){const r=this.getBounds(t);return g.jsx("rect",{width:R(r.width),height:R(r.height)})}toSvg(t,r){r.addExportDef(wp(t.props.font));const o=Sn(this.editor),s=this.getBounds(t),i=t.props.text,a=s.width/(t.props.scale??1),l=s.height/(t.props.scale??1),c={fontSize:us[t.props.size],fontFamily:wu[t.props.font],textAlign:t.props.align,verticalTextAlign:"middle",width:a,height:l,padding:0,lineHeight:At.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},u=o[t.props.color].solid,d=document.createElementNS("http://www.w3.org/2000/svg","g"),h=vp(this.editor,this.editor.textMeasure.measureTextSpans(i,c),{...c,stroke:o.background,strokeWidth:2,fill:o.background,padding:0}),f=h.cloneNode(!0);return f.setAttribute("fill",u),f.setAttribute("stroke","none"),d.append(h),d.append(f),d}}v(Mr,"type","text");function w2(e,n){const{font:t,text:r,autoSize:o,size:s,w:i}=n,a=16,l=us[s],c=o?"fit-content":Math.floor(Math.max(a,i))+"px",u=e.textMeasure.measureText(r,{...At,fontFamily:bo[t],fontSize:l,width:c});return o&&(u.w+=1),{width:Math.max(a,u.w),height:Math.max(l,u.h)}}const gU='<path d="m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z" fill="white"/><path d="m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z" fill="white"/><path d="m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z" fill="black"/><path d="m13 10.814v11.188l2.969-2.866.428-.139h4.768z" fill="black"/>',mU='<path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" stroke-linejoin="round"/><path d="m21.5664 21.7344v-3.459"/><path d="m19.5508 21.7461-.016-3.473"/><path d="m17.5547 18.3047.021 3.426"/></g>',yU='<path d="m25 16h-6.01v-6h-2.98v6h-6.01v3h6.01v6h2.98v-6h6.01z" fill="white"/><path d="m23.9902 17.0103h-6v-6.01h-.98v6.01h-6v.98h6v6.01h.98v-6.01h6z" fill="%23231f1f"/>',vU='<path d="m19 14h1v1h-1zm1 6h-1v-1h1zm-5-5h-1v-1h1zm0 5h-1v-1h1zm2-10.987-7.985 7.988 5.222 5.221 2.763 2.763 7.984-7.985z" fill="white"/><g fill="black"><path d="m23.5664 16.9971-2.557-2.809v1.829h-4.009-4.001v-1.829l-2.571 2.809 2.572 2.808-.001-1.808h4.001 4.009l-.001 1.808z"/><path d="m17.9873 17h.013v-4.001l1.807.001-2.807-2.571-2.809 2.57h1.809v4.001h.008v4.002l-1.828-.001 2.807 2.577 2.805-2.576h-1.805z"/></g>',x2="<path d='m19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill='%23fff'/><path d='m18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill='%23000'/>",S2="<path d='m9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill='%23fff'/><path d='m17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill='%23000'/>",xd='<path d="M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill="white"/>',wU='<path fill="white" d="M7.94 0a5.25 5.25 0 0 0-3.47 1.17A5.27 5.27 0 0 0 1 0H0v3h1c1.41 0 1.85.7 2 1v3.94H2v3h1v3c-.13.3-.57 1-2 1H0v3h1a5.27 5.27 0 0 0 3.47-1.17c.98.8 2.21 1.21 3.47 1.17h1v-3h-1c-1.41 0-1.85-.7-2-1v-3H7v-3H6V4c.13-.3.57-1 2-1h1V0H7.94z"/><path fill="black" d="M7.94 2V1a4 4 0 0 0-3.47 1.64A4 4 0 0 0 1 1v1c1.3-.17 2.56.6 3 1.84v5.1H3v1h1v4.16c-.45 1.24-1.7 2-3 1.84v1a4.05 4.05 0 0 0 3.47-1.63 4.05 4.05 0 0 0 3.47 1.63v-1A2.82 2.82 0 0 1 5 14.1V9.93h1v-1H5V3.85A2.81 2.81 0 0 1 7.94 2z"/>',xU="<path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042' fill='white'/><g stroke='black' stroke-width='.75'><path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042z' stroke-linejoin='round'/><path d='m20.5664 19.7344v-3.459' stroke-linecap='round'/><path d='m18.5508 19.7461-.016-3.473' stroke-linecap='round'/><path d='m16.5547 16.3047.021 3.426' stroke-linecap='round'/></g>",SU='<path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" stroke-linejoin="round"/><path d="m20.5664 21.7344v-3.459"/><path d="m18.5508 21.7461-.016-3.473"/><path d="m16.5547 18.3047.021 3.426"/></g>',bU='<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 14h-2v-2h-2v2h-2v1.98h2v2.02h2v-2.02h2z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>',PU='<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 16h-5.98v-1.98h5.98z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>';function _t(e,n,t,r,o,s=16,i=16){const a=(-t-n)*(Ge/180),l=Math.sin(a),c=Math.cos(a),u=1*c-1*l,d=1*l+1*c;return`url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: ${o};'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='${u}' dy='${d}' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(${n+t} 16 16)${r?" scale(-1,-1) translate(0, -32)":""}' filter='url(%23shadow)'>`+e.replaceAll('"',"'")+`</g></svg>") ${s} ${i}, pointer`}const EU={none:()=>"none",default:(e,n,t)=>_t(gU,e,0,n,t,12,8),pointer:(e,n,t)=>_t(mU,e,0,n,t,14,10),cross:(e,n,t)=>_t(yU,e,0,n,t),move:(e,n,t)=>_t(vU,e,0,n,t),grab:(e,n,t)=>_t(SU,e,0,n,t),grabbing:(e,n,t)=>_t(xU,e,0,n,t),text:(e,n,t)=>_t(wU,e,0,n,t,4,10),"ew-resize":(e,n,t)=>_t(S2,e,0,n,t),"ns-resize":(e,n,t)=>_t(S2,e,90,n,t),"nesw-resize":(e,n,t)=>_t(x2,e,0,n,t),"nwse-resize":(e,n,t)=>_t(x2,e,90,n,t),"nwse-rotate":(e,n,t)=>_t(xd,e,0,n,t),"nesw-rotate":(e,n,t)=>_t(xd,e,90,n,t),"senw-rotate":(e,n,t)=>_t(xd,e,180,n,t),"swne-rotate":(e,n,t)=>_t(xd,e,270,n,t),"zoom-in":(e,n,t)=>_t(bU,e,0,n,t),"zoom-out":(e,n,t)=>_t(PU,e,0,n,t)};function _n(e,n=0,t="black"){return EU[e](_N(n),!1,t)}const _U=["default","pointer","cross","move","grab","grabbing","text"];function CU(){const e=U(),n=Yt();pi("useCursor",()=>{const{type:t,rotation:r,color:o}=e.cursor;if(_U.includes(t)){n.style.setProperty("--tl-cursor",`var(--tl-cursor-${t})`);return}n.style.setProperty("--tl-cursor",_n(t,r,o))},[e,n])}function jr(e){const n=U();return w.useMemo(function(){const o=c=>{if(c.isKilled||c.button!==0)return;const u=mf(c.currentTarget);function d(){u.removeEventListener("pointerup",d),Su(u,c)}xu(u,c),u.addEventListener("pointerup",d),n.dispatch({name:"pointer_down",type:"pointer",target:"selection",handle:e,...mt(c,n.getContainer())}),c.stopPropagation()};let s,i;function a(c){c.isKilled||c.button===0&&(c.clientX===s&&c.clientY===i||(s=c.clientX,i=c.clientY,n.dispatch({name:"pointer_move",type:"pointer",target:"selection",handle:e,...mt(c,n.getContainer())})))}return{onPointerDown:o,onPointerMove:a,onPointerUp:c=>{c.isKilled||c.button===0&&n.dispatch({name:"pointer_up",type:"pointer",target:"selection",handle:e,...mt(c,n.getContainer())})}}},[n,e])}function IU({size:e,width:n,height:t,hideAlternateHandles:r}){const o=R(e/3),s=o/2;return g.jsxs("svg",{className:"tl-overlays__item",children:[g.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${R(0-s)},${R(e)} 
						${R(0-s)},${R(0-s)} 
						${R(e)},${R(0-s)}`,strokeWidth:o,"data-testid":"selection.crop.top_left","aria-label":"top_left handle"}),g.jsx("line",{className:de("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:R(n/2-e),y1:R(0-s),x2:R(n/2+e),y2:R(0-s),strokeWidth:o,"data-testid":"selection.crop.top","aria-label":"top handle"}),g.jsx("polyline",{className:de("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${R(n-e)},${R(0-s)} 
						${R(n+s)},${R(0-s)} 
						${R(n+s)},${R(e)}`,strokeWidth:o,"data-testid":"selection.crop.top_right","aria-label":"top_right handle"}),g.jsx("line",{className:de("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:R(n+s),y1:R(t/2-e),x2:R(n+s),y2:R(t/2+e),strokeWidth:o,"data-testid":"selection.crop.right","aria-label":"right handle"}),g.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${R(n+s)},${R(t-e)} 
						${R(n+s)},${R(t+s)}
						${R(n-e)},${R(t+s)}`,strokeWidth:o,"data-testid":"selection.crop.bottom_right","aria-label":"bottom_right handle"}),g.jsx("line",{className:de("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:R(n/2-e),y1:R(t+s),x2:R(n/2+e),y2:R(t+s),strokeWidth:o,"data-testid":"selection.crop.bottom","aria-label":"bottom handle"}),g.jsx("polyline",{className:de("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${R(0+e)},${R(t+s)} 
						${R(0-s)},${R(t+s)}
						${R(0-s)},${R(t-e)}`,strokeWidth:o,"data-testid":"selection.crop.bottom_left","aria-label":"bottom_left handle"}),g.jsx("line",{className:de("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:R(0-s),y1:R(t/2-e),x2:R(0-s),y2:R(t/2+e),strokeWidth:o,"data-testid":"selection.crop.left","aria-label":"left handle"})]})}const kU=typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1,$U=me(function(){const n=U(),t=w.useRef(null),r=n.isReadOnly,o=jr("top"),s=jr("right"),i=jr("bottom"),a=jr("left"),l=jr("top_left"),c=jr("top_right"),u=jr("bottom_right"),d=jr("bottom_left"),h=!n.isMenuOpen&&n.cursor.type==="default",f=n.isCoarsePointer;let p=n.selectionBounds;const m=n.selectedShapes,y=n.onlySelectedShape,x=y&&n.isShapeOrAncestorLocked(y),S=y?n.getShapeUtil(y).expandSelectionOutlinePx(y):0;if(hp(t,p==null?void 0:p.x,p==null?void 0:p.y,1,n.selectionRotation,{x:-S,y:-S}),!p)return null;p=p.clone().expandBy(S);const b=n.zoomLevel,P=n.selectionRotation,C=n.isChangingStyle,_=Math.max(1,p.width),I=Math.max(1,p.height),k=8/b,T=_<k*2,M=I<k*2,O=_<k*4,z=I<k*4,B=_<k*5,D=I<k*5,F=f?1.75:1,V=6/b*F,q=(O?V/2:V)*(F*.75),L=(z?V/2:V)*(F*.75),N=(y?!n.getShapeUtil(y).hideSelectionBoundsFg(y):!0)&&!C;let H=N&&n.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_canvas","select.pointing_selection","select.pointing_shape","select.crop.idle","select.crop.pointing_crop","select.pointing_resize_handle","select.pointing_crop_handle","select.editing_shape")||N&&n.isIn("select.resizing")&&y&&n.isShapeOfType(y,Mr);y&&n.isShapeOfType(y,Is)&&H&&kU&&(H=!1);const Q=n.isInAny("select.pointing_crop_handle","select.crop.idle","select.crop.pointing_crop")&&!C&&!r,Z=n.isInAny("select.idle","select.pointing_selection","select.pointing_shape","select.crop.idle")&&!C&&!r,Ee=!f&&!(T||M)&&(Z||Q)&&(y?!n.getShapeUtil(y).hideRotateHandle(y):!0)&&!x,ke=f&&(!O||!z)&&(Z||Q)&&(y?!n.getShapeUtil(y).hideRotateHandle(y):!0)&&!x,ue=Z&&(y?n.getShapeUtil(y).canResize(y)&&!n.getShapeUtil(y).hideResizeHandles(y):!0)&&!Q&&!x,He=T||M,Ve=T&&M,We=B||D,Re=ue||Q,Gt=!Ee,Ho=!Z||!ke,Pn=!Z||!Re,so=!Z||!Re||He,cr=!Z||!Re||He,Vo=!Z||!Re||Ve&&!Q;let io=f;io&&m.every(qt=>n.getShapeUtil(qt).isAspectRatioLocked(qt))&&(io=!1);let Bn=!0;Q?Bn=We:ue&&(Bn=He||Ve||io);const ur=Math.min(24/b,I-L*3),Fn=Z&&f&&y&&n.isShapeOfType(y,Mr)&&ur*b>=4;return g.jsxs("svg",{ref:t,className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:[H&&g.jsx("rect",{className:de("tl-selection__fg__outline"),width:R(_),height:R(I)}),g.jsx(Sd,{"data-testid":"selection.rotate.top-left",cx:0,cy:0,targetSize:V,corner:"top_left_rotate",cursor:h?_n("nwse-rotate",P):void 0,isHidden:Gt}),g.jsx(Sd,{"data-testid":"selection.rotate.top-right",cx:_+V*3,cy:0,targetSize:V,corner:"top_right_rotate",cursor:h?_n("nesw-rotate",P):void 0,isHidden:Gt}),g.jsx(Sd,{"data-testid":"selection.rotate.bottom-left",cx:0,cy:I+V*3,targetSize:V,corner:"bottom_left_rotate",cursor:h?_n("swne-rotate",P):void 0,isHidden:Gt}),g.jsx(Sd,{"data-testid":"selection.rotate.bottom-right",cx:_+V*3,cy:I+V*3,targetSize:V,corner:"bottom_right_rotate",cursor:h?_n("senw-rotate",P):void 0,isHidden:Gt})," ",g.jsx(MU,{"data-testid":"selection.rotate.mobile",cx:O?-V*1.5:_/2,cy:O?I/2:-V*1.5,size:k,isHidden:Ho}),g.jsx("rect",{className:de("tl-transparent",{"tl-hidden":Bn}),"data-testid":"selection.resize.top","aria-label":"top target",pointerEvents:"all",x:0,y:R(0-(z?L*2:L)),width:R(Math.max(1,_)),height:R(Math.max(1,L*2)),style:h?{cursor:_n("ns-resize",P)}:void 0,...o}),g.jsx("rect",{className:de("tl-transparent",{"tl-hidden":Bn}),"data-testid":"selection.resize.right","aria-label":"right target",pointerEvents:"all",x:R(_-(O?0:q)),y:0,height:R(Math.max(1,I)),width:R(Math.max(1,q*2)),style:h?{cursor:_n("ew-resize",P)}:void 0,...s}),g.jsx("rect",{className:de("tl-transparent",{"tl-hidden":Bn}),"data-testid":"selection.resize.bottom","aria-label":"bottom target",pointerEvents:"all",x:0,y:R(I-(z?0:L)),width:R(Math.max(1,_)),height:R(Math.max(1,L*2)),style:h?{cursor:_n("ns-resize",P)}:void 0,...i}),g.jsx("rect",{className:de("tl-transparent",{"tl-hidden":Bn}),"data-testid":"selection.resize.left","aria-label":"left target",pointerEvents:"all",x:R(0-(O?q*2:q)),y:0,height:R(Math.max(1,I)),width:R(Math.max(1,q*2)),style:h?{cursor:_n("ew-resize",P)}:void 0,...a}),g.jsx("rect",{className:de("tl-transparent",{"tl-hidden":Pn}),"data-testid":"selection.target.top-left","aria-label":"top-left target",pointerEvents:"all",x:R(0-(O?q*2:q*1.5)),y:R(0-(z?L*2:L*1.5)),width:R(q*3),height:R(L*3),style:h?{cursor:_n("nwse-resize",P)}:void 0,...l}),g.jsx("rect",{className:de("tl-transparent",{"tl-hidden":so}),"data-testid":"selection.target.top-right","aria-label":"top-right target",pointerEvents:"all",x:R(_-(O?0:q*1.5)),y:R(0-(z?L*2:L*1.5)),width:R(q*3),height:R(L*3),style:h?{cursor:_n("nesw-resize",P)}:void 0,...c}),g.jsx("rect",{className:de("tl-transparent",{"tl-hidden":Vo}),"data-testid":"selection.target.bottom-right","aria-label":"bottom-right target",pointerEvents:"all",x:R(_-(O?q:q*1.5)),y:R(I-(z?L:L*1.5)),width:R(q*3),height:R(L*3),style:h?{cursor:_n("nwse-resize",P)}:void 0,...u}),g.jsx("rect",{className:de("tl-transparent",{"tl-hidden":cr}),"data-testid":"selection.target.bottom-left","aria-label":"bottom-left target",pointerEvents:"all",x:R(0-(O?q*3:q*1.5)),y:R(I-(z?0:L*1.5)),width:R(q*3),height:R(L*3),style:h?{cursor:_n("nesw-resize",P)}:void 0,...d}),ue&&g.jsxs(g.Fragment,{children:[g.jsx("rect",{"data-testid":"selection.resize.top-left",className:de("tl-corner-handle",{"tl-hidden":Pn}),"aria-label":"top_left handle",x:R(0-k/2),y:R(0-k/2),width:R(k),height:R(k)}),g.jsx("rect",{"data-testid":"selection.resize.top-right",className:de("tl-corner-handle",{"tl-hidden":so}),"aria-label":"top_right handle",x:R(_-k/2),y:R(0-k/2),width:R(k),height:R(k)}),g.jsx("rect",{"data-testid":"selection.resize.bottom-right",className:de("tl-corner-handle",{"tl-hidden":Vo}),"aria-label":"bottom_right handle",x:R(_-k/2),y:R(I-k/2),width:R(k),height:R(k)}),g.jsx("rect",{"data-testid":"selection.resize.bottom-left",className:de("tl-corner-handle",{"tl-hidden":cr}),"aria-label":"bottom_left handle",x:R(0-k/2),y:R(I-k/2),width:R(k),height:R(k)})]}),Fn&&g.jsxs(g.Fragment,{children:[g.jsx("rect",{"data-testid":"selection.text-resize.left.handle",className:"tl-text-handle","aria-label":"bottom_left handle",x:R(0-k/4),y:R(I/2-ur/2),rx:k/4,width:R(k/2),height:R(ur)}),g.jsx("rect",{"data-testid":"selection.text-resize.right.handle",className:"tl-text-handle","aria-label":"bottom_left handle",rx:k/4,x:R(_-k/4),y:R(I/2-ur/2),width:R(k/2),height:R(ur)})]}),Q&&g.jsx(IU,{size:k,width:_,height:I,hideAlternateHandles:We})]})}),Sd=function({cx:n,cy:t,targetSize:r,corner:o,cursor:s,isHidden:i,"data-testid":a}){const l=jr(o);return g.jsx("rect",{className:de("tl-transparent","tl-rotate-corner",{"tl-hidden":i}),"data-testid":a,"aria-label":`${o} target`,pointerEvents:"all",x:R(n-r*3),y:R(t-r*3),width:R(Math.max(1,r*3)),height:R(Math.max(1,r*3)),cursor:s,...l})},TU=Math.sqrt(Math.PI),MU=function({cx:n,cy:t,size:r,isHidden:o,"data-testid":s}){const i=jr("mobile_rotate");return g.jsxs("g",{children:[g.jsx("circle",{"data-testid":s,pointerEvents:"all",className:de("tl-transparent","tl-mobile-rotate__bg",{"tl-hidden":o}),cx:n,cy:t,...i}),g.jsx("circle",{className:de("tl-mobile-rotate__fg",{"tl-hidden":o}),cx:n,cy:t,r:r/TU})]})},jl=(e,n,t)=>r=>{if(t!=="pointer_move"&&e.pageState.editingId===n&&(r.isKilled=!0),r.isKilled)return;switch(t){case"pointer_down":{if(r.button!==0&&r.button!==1&&r.button!==2)return;xu(r.currentTarget,r);break}case"pointer_up":{Su(r.currentTarget,r);break}}const o=e.getShapeById(n);if(!o){console.error("Shape not found",n);return}e.dispatch({type:"pointer",target:"shape",shape:o,name:t,...mt(r,e.getContainer())})};function AU(e){const n=U();return oe.useMemo(()=>{function t(l){l.isKilled=!0,Se(l)}function r(l){l.isKilled=!0,Se(l)}const o=jl(n,e,"pointer_move");let s,i;function a(l){if(!l.isKilled&&!(l.clientX===s&&l.clientY===i))return s=l.clientX,i=l.clientY,o(l)}return{onPointerDown:jl(n,e,"pointer_down"),onPointerUp:jl(n,e,"pointer_up"),onPointerEnter:jl(n,e,"pointer_enter"),onPointerLeave:jl(n,e,"pointer_leave"),onPointerMove:a,onTouchStart:t,onTouchEnd:r}},[n,e])}const b2=me(function({id:n,index:t,backgroundIndex:r,opacity:o,isCulled:s}){const i=U(),{ShapeErrorFallback:a}=ar(),l=AU(n),c=w.useRef(null),u=w.useRef(null),d=w.useCallback((m,y)=>{var x,S;(x=c.current)==null||x.style.setProperty(m,y),(S=u.current)==null||S.style.setProperty(m,y)},[]);pi("set shape container transform position",()=>{const m=i.getShapeById(n),y=i.getPageTransformById(n);if(!m||!y)return null;const x=Y.toCssString(y);d("transform",x)},[i,d]),pi("set shape container clip path",()=>{if(!i.getShapeById(n))return null;const y=i.getClipPathById(n);d("clip-path",y??"none")},[i,d]),pi("set shape height and width",()=>{const m=i.getShapeById(n);if(!m)return null;const y=i.getBounds(m);d("width",Math.ceil(y.width)+"px"),d("height",Math.ceil(y.height)+"px")},[i]),w.useLayoutEffect(()=>{var m,y;d("opacity",o+""),(m=c.current)==null||m.style.setProperty("z-index",t+""),(y=u.current)==null||y.style.setProperty("z-index",r+"")},[o,t,r,d]);const h=i.getShapeById(n),f=w.useCallback(m=>{i.annotateError(m,{origin:"react.shape",willCrashApp:!1})},[i]);if(!h)return null;const p=i.getShapeUtil(h);return g.jsxs(g.Fragment,{children:[p.backgroundComponent&&g.jsx("div",{ref:u,className:"tl-shape tl-shape-background","data-shape-type":h.type,draggable:!1,children:!s&&g.jsx(Yc,{fallback:a,onError:f,children:g.jsx(RU,{shape:h,util:p})})}),g.jsx("div",{ref:c,className:"tl-shape","data-shape-type":h.type,draggable:!1,onPointerDown:l.onPointerDown,onPointerMove:l.onPointerMove,onPointerUp:l.onPointerUp,onPointerEnter:l.onPointerEnter,onPointerLeave:l.onPointerLeave,children:s&&p.canUnmount(h)?g.jsx(DU,{shape:h}):g.jsx(Yc,{fallback:a,onError:f,children:g.jsx(OU,{shape:h,util:p})})})]})}),OU=w.memo(function({shape:n,util:t}){return cp("InnerShape:"+t.type,()=>t.component(n))},(e,n)=>e.shape.props===n.shape.props&&e.shape.meta===n.shape.meta),RU=w.memo(function({shape:n,util:t}){return cp("InnerShape:"+t.type,()=>{var r;return(r=t.backgroundComponent)==null?void 0:r.call(t,n)})},(e,n)=>e.shape.props===n.shape.props&&e.shape.meta===n.shape.meta),DU=w.memo(function({shape:n}){const r=U().getBounds(n);return g.jsx("div",{className:"tl-shape__culled",style:{transform:`translate(${r.minX}px, ${r.minY}px)`,width:r.width,height:r.height}})},()=>!0),Lk=me(function(){const n=U(),{Background:t,SvgDefs:r}=ar(),o=oe.useRef(null),s=oe.useRef(null);JB(),YN(),VN(),QB(o),Tz(o),pi("position layers",()=>{const l=s.current;if(!l)return;const{x:c,y:u,z:d}=n.camera,h=d>=1?x0(d,[1,8],[.125,.5],!0):x0(d,[.1,1],[-2,.125],!0);l.style.setProperty("transform",`scale(${R(d)}) translate(${R(c+h)}px,${R(u+h)}px)`)},[n]);const i=HN(),a=J("shapeSvgDefs",()=>{const l=new Map;for(const c of lt(n.shapeUtils)){if(!c)return;const u=c.getCanvasSvgDefs();for(const{key:d,component:h}of u)l.has(d)||l.set(d,g.jsx(h,{},d))}return[...l.values()]},[n]);return oe.useEffect(()=>{var l;(l=o.current)==null||l.focus()},[]),g.jsxs("div",{ref:o,draggable:!1,className:"tl-canvas","data-testid":"canvas",...i,children:[t&&g.jsx(t,{}),g.jsx(LU,{}),g.jsx(ZU,{}),g.jsxs("div",{ref:s,className:"tl-html-layer",draggable:!1,children:[g.jsx("svg",{className:"tl-svg-context",children:g.jsxs("defs",{children:[a,P2&&g.jsx(P2,{}),g.jsx(XU,{}),g.jsx(GU,{}),g.jsx(qU,{}),r&&g.jsx(r,{})]})}),g.jsx(tU,{}),g.jsx("div",{className:"tl-shapes",children:g.jsx(HU,{})}),g.jsxs("div",{className:"tl-overlays",children:[g.jsx(UU,{}),g.jsx(NU,{}),g.jsx(jU,{}),g.jsx(zU,{}),g.jsx(VU,{}),g.jsx(WU,{}),g.jsx(YU,{}),g.jsx(BU,{}),g.jsx($U,{}),g.jsx(QF,{})]})]})]})}),LU=me(function(){const n=U(),{Grid:t}=ar(),{x:r,y:o,z:s}=n.camera,i=n.isGridMode;return t&&i?g.jsx(t,{x:r,y:o,z:s,size:n.gridSize}):null}),jU=me(function(){const n=U(),t=n.scribble,r=n.zoomLevel,{Scribble:o}=ar();return o&&t?g.jsx(o,{className:"tl-user-scribble",scribble:t,zoom:r}):null}),NU=me(function(){const n=U(),{brush:t}=n,{Brush:r}=ar();return r&&t&&n.isIn("select.brushing")?g.jsx(r,{className:"tl-user-brush",brush:t}):null}),zU=me(function(){const n=U(),{zoomBrush:t}=n,{ZoomBrush:r}=ar();return r&&t&&n.isIn("zoom")?g.jsx(r,{className:"tl-user-brush",brush:t}):null}),BU=me(function(){const n=U(),{snaps:{lines:t},zoomLevel:r}=n,{SnapLine:o}=ar();return o&&t.length>0?g.jsx(g.Fragment,{children:t.map(s=>g.jsx(o,{className:"tl-user-snapline",line:s,zoom:r},s.id))}):null}),FU=48,UU=me(function(){const n=U(),t=n.zoomLevel,r=n.isChangingStyle,o=n.onlySelectedShape,s=n.isInAny("select.idle","select.pointing_handle")&&!r&&!n.isReadOnly;if(!(o&&s))return null;const i=n.getHandles(o);if(!i)return null;const a=n.getPageTransform(o);if(!a)return null;const l=[];for(let c=0,u=i[c];c<i.length;c++,u=i[c]){if(u.type!=="vertex"){const d=i[c-1],h=i[c+1];if(d&&h&&Math.hypot(d.y-h.y,d.x-h.x)<FU/t)continue}l.push(u)}return l.sort(c=>c.type==="vertex"?1:-1),g.jsx("svg",{className:"tl-user-handles tl-overlays__item",children:g.jsx("g",{transform:Y.toCssString(a),children:l.map(c=>g.jsx(KU,{shapeId:o.id,handle:c},c.id))})})}),KU=({shapeId:e,handle:n})=>{const t=ZB(e,n.id),{Handle:r}=ar();return r?g.jsx("g",{"aria-label":"handle",transform:`translate(${n.x}, ${n.y})`,...t,children:g.jsx(r,{shapeId:e,handle:n})}):null},HU=me(function(){const n=U(),{renderingShapes:t}=n;return pt.debugSvg.value?g.jsx(g.Fragment,{children:t.map(o=>g.jsxs(oe.Fragment,{children:[g.jsx(b2,{...o}),g.jsx(QU,{id:o.id})]},o.id+"_fragment"))}):g.jsx(g.Fragment,{children:t.map(o=>g.jsx(b2,{...o},o.id+"_shape"))})}),VU=me(function(){const n=U();return n.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","select.pointing_handle")&&!n.isChangingStyle?g.jsx(g.Fragment,{children:n.selectedIds.map(r=>g.jsx(pp,{className:"tl-user-indicator__selected",id:r},r+"_indicator"))}):null}),WU=function(){const n=U(),t=J("hovered id and should display",()=>n.isInAny("select.idle","select.editing_shape")?n.pageState.hoveredId:null,[n]);return t?g.jsx(pp,{className:"tl-user-indicator__hovered",id:t}):null},YU=me(function(){const n=U(),t=rf(n.hintingIds);return t.length?g.jsx(g.Fragment,{children:t.map(r=>g.jsx(pp,{className:"tl-user-indicator__hint",id:r},r+"_hinting"))}):null});function P2(){return g.jsxs("g",{id:"cursor",children:[g.jsxs("g",{fill:"rgba(0,0,0,.2)",transform:"translate(-11,-11)",children:[g.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),g.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),g.jsxs("g",{fill:"white",transform:"translate(-12,-12)",children:[g.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),g.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),g.jsxs("g",{fill:"currentColor",transform:"translate(-12,-12)",children:[g.jsx("path",{d:"m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z"}),g.jsx("path",{d:"m13 10.814v11.188l2.969-2.866.428-.139h4.768z"})]})]})}function XU(){return g.jsx("path",{id:"cursor_hint",fill:"currentColor",d:"M -2,-5 2,0 -2,5 Z"})}function GU(){return g.jsx("marker",{id:"arrowhead-dot",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"0",children:g.jsx("circle",{cx:"3",cy:"3",r:"2",strokeDasharray:"100%"})})}function qU(){return g.jsxs("marker",{id:"arrowhead-cross",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"auto",children:[g.jsx("line",{x1:"1.5",y1:"1.5",x2:"4.5",y2:"4.5",strokeDasharray:"100%"}),g.jsx("line",{x1:"1.5",y1:"4.5",x2:"4.5",y2:"1.5",strokeDasharray:"100%"})]})}const QU=me(function({id:n}){const t=U(),r=t.getShapeById(n),[o,s]=oe.useState(""),i=(r==null?void 0:r.parentId)===t.currentPageId;return oe.useEffect(()=>{if(!i)return;let a=null;const l=lp("shape to svg",async()=>{const c=Math.random();a=c;const u=t.getPageBoundsById(n),d=await t.getSvg([n],{padding:0});d&&u&&a===c&&(d.style.setProperty("overflow","visible"),d.setAttribute("preserveAspectRatio","xMidYMin slice"),d.style.setProperty("transform",`translate(${u.x}px, ${u.y+u.h+12}px)`),d.style.setProperty("border","1px solid black"),s(d==null?void 0:d.outerHTML))});return()=>{a=null,l()}},[t,n,i]),i?g.jsx("div",{style:{paddingTop:12,position:"absolute"},children:g.jsx("div",{style:{display:"flex"},dangerouslySetInnerHTML:{__html:o}})}):null}),ZU=me(()=>{const e=pt.logMessages.value;return g.jsx("div",{className:"debug__ui-logger",children:e.map((n,t)=>{const r=typeof n=="string"?n:JSON.stringify(n);return g.jsx("div",{className:"debug__ui-logger__line",children:r},t)})})}),JU="https://github.com/tldraw/tldraw/issues/new";function eK(){}const jk=({error:e,editor:n})=>{const t=w.useRef(null),[r,o]=w.useState(!1),[s,i]=w.useState(!1),[a,l]=w.useState(!1),c=e instanceof Error?e.message:String(e),u=e instanceof Error?e.stack:null,d=J("isDarkMode",()=>{try{if(n)return n.isDarkMode}catch{}return null},[n]),[h,f]=w.useState(null);w.useLayoutEffect(()=>{var P;d!==null&&f(d);let S=(P=t.current)==null?void 0:P.parentElement,b=!1;for(;S;){if(S.classList.contains("tl-theme__dark")||S.classList.contains("tl-theme__light")){b=!0;break}S=S.parentElement}if(b){f(null);return}f(window.matchMedia("(prefers-color-scheme: dark)").matches)},[d]),w.useEffect(()=>{if(s){const S=setTimeout(()=>{i(!1)},2e3);return()=>clearTimeout(S)}},[s]);const p=()=>{const S=document.createElement("textarea");S.value=u??c,document.body.appendChild(S),S.select(),document.execCommand("copy"),S.remove(),i(!0)},m=()=>{wN()},y=async()=>{tk()},x=new URL(JU);return x.searchParams.set("title",c),x.searchParams.set("labels","bug"),x.searchParams.set("body",`Hey, I ran into an error while using tldraw:

\`\`\`js
${u??c}
\`\`\`

My browser: ${navigator.userAgent}`),g.jsxs("div",{ref:t,className:de("tl-container tl-error-boundary",h===null?"":h?"tl-theme__dark":"tl-theme__light"),children:[g.jsx("div",{className:"tl-error-boundary__overlay"}),n&&g.jsx(fk,{onError:eK,fallback:()=>null,children:g.jsx(D1.Provider,{value:n,children:g.jsx("div",{className:"tl-overlay tl-error-boundary__canvas",children:g.jsx(Lk,{})})})}),g.jsx("div",{className:de("tl-modal","tl-error-boundary__content",{"tl-error-boundary__content__expanded":r&&!a}),children:a?g.jsxs(g.Fragment,{children:[g.jsx("h2",{children:"Are you sure?"}),g.jsx("p",{children:"Resetting your data will delete your drawing and cannot be undone."}),g.jsxs("div",{className:"tl-error-boundary__content__actions",children:[g.jsx("button",{onClick:()=>l(!1),children:"Cancel"}),g.jsx("button",{className:"tl-error-boundary__reset",onClick:y,children:"Reset data"})]})]}):g.jsxs(g.Fragment,{children:[g.jsx("h2",{children:"Something's gone wrong."}),g.jsxs("p",{children:["Sorry, we encountered an error. Please refresh the page to continue. If you keep seeing this error, you can ",g.jsx("a",{href:x.toString(),children:"create a GitHub issue"})," or"," ",g.jsx("a",{href:"https://discord.gg/Cq6cPsTfNy",children:"ask for help on Discord"}),"."]}),r&&g.jsxs("div",{className:"tl-error-boundary__content__error",children:[g.jsx("pre",{children:g.jsx("code",{children:u??c})}),g.jsx("button",{onClick:p,children:s?"Copied!":"Copy"})]}),g.jsxs("div",{className:"tl-error-boundary__content__actions",children:[g.jsx("button",{onClick:()=>o(!r),children:r?"Hide details":"Show details"}),g.jsxs("div",{className:"tl-error-boundary__content__actions__group",children:[g.jsx("button",{className:"tl-error-boundary__reset",onClick:()=>l(!0),children:"Reset data"}),g.jsx("button",{className:"tl-error-boundary__refresh",onClick:m,children:"Refresh Page"})]})]})]})})]})};let Nk=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((n,t)=>(t&=63,t<36?n+=t.toString(36):t<62?n+=(t-26).toString(36).toUpperCase():t>62?n+="-":n+="_",n),"");function nt(){return Nk()}function tK(e,n){var o;let t=e;const r=new Set(n);for(;r.has(t);)t=(o=/^.*(\d+)$/.exec(t))!=null&&o[1]?t.replace(/(\d+)(?=\D?)$/,s=>(+s+1).toString()):`${t} 1`;return t}const nK=new RegExp(/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i);function k0(e){return nK.test(e)}const zk="TLDRAW_USER_DATA_v3",Bk=be({id:pe,name:pe,locale:pe,color:pe,isDarkMode:Me,animationSpeed:fe,isSnapMode:Me}),im={AddAnimationSpeed:1,AddIsSnapMode:2},bf=Pe({currentVersion:im.AddIsSnapMode,migrators:{[im.AddAnimationSpeed]:{up:e=>({...e,animationSpeed:1}),down:({animationSpeed:e,...n})=>n},[im.AddIsSnapMode]:{up:e=>({...e,isSnapMode:!1}),down:({isSnapMode:e,...n})=>n}}}),E2=["#FF802B","#EC5E41","#F2555A","#F04F88","#E34BA9","#BD54C6","#9D5BD2","#7B66DC","#02B1CC","#11B3A3","#39B178","#55B467"];function rK(){return E2[Math.floor(Math.random()*E2.length)]}function bd(){return{id:nt(),locale:typeof window<"u"?pN():"en",name:"New User",color:rK(),isDarkMode:!1,animationSpeed:1,isSnapMode:!1}}function Fk(e){if(e===null||typeof e!="object"||!("version"in e)||!("user"in e)||typeof e.version!="number")return bd();const n=C1({value:e.user,fromVersion:e.version,toVersion:bf.currentVersion??0,migrations:bf});if(n.type==="error")return bd();try{Bk.validate(n.value)}catch{return bd()}return n.value}function oK(){var n;const e=typeof window>"u"?null:JSON.parse(((n=window==null?void 0:window.localStorage)==null?void 0:n.getItem(zk))||"null")??null;return Fk(e)}const Eu=dt("globalUserData",oK());function sK(){typeof window<"u"&&window.localStorage&&window.localStorage.setItem(zk,JSON.stringify({version:bf.currentVersion,user:Eu.value}))}function iK(e){Bk.validate(e),Eu.set(e),sK(),lK()}const aK=typeof process<"u"&&!1,Ra=typeof BroadcastChannel<"u"&&!aK?new BroadcastChannel("tldraw-user-sync"):null;Ra==null||Ra.addEventListener("message",e=>{const n=e.data;(n==null?void 0:n.type)===Kk&&(n==null?void 0:n.origin)!==Uk&&Eu.set(Fk(n.data))});const Uk=nt(),Kk="tldraw-user-preferences-change";function lK(){Ra==null||Ra.postMessage({type:Kk,origin:Uk,data:{user:Eu.value,version:bf.currentVersion}})}function cK(){return Eu.value}function Hk(e={}){return{derivePresenceState:e.derivePresenceState??(()=>G("presence",()=>null)),userPreferences:e.userPreferences??G("userPreferences",()=>cK()),setUserPreferences:e.setUserPreferences??iK}}var Vk={exports:{}};(function(e){var n=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function o(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function s(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new o(u,d||l,h),p=t?t+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function i(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)n.call(u,d)&&c.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=t?t+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,p=new Array(f);h<f;h++)p[h]=d[h].fn;return p},a.prototype.listenerCount=function(c){var u=t?t+c:c,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,u,d,h,f,p){var m=t?t+c:c;if(!this._events[m])return!1;var y=this._events[m],x=arguments.length,S,b;if(y.fn){switch(y.once&&this.removeListener(c,y.fn,void 0,!0),x){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,d),!0;case 4:return y.fn.call(y.context,u,d,h),!0;case 5:return y.fn.call(y.context,u,d,h,f),!0;case 6:return y.fn.call(y.context,u,d,h,f,p),!0}for(b=1,S=new Array(x-1);b<x;b++)S[b-1]=arguments[b];y.fn.apply(y.context,S)}else{var P=y.length,C;for(b=0;b<P;b++)switch(y[b].once&&this.removeListener(c,y[b].fn,void 0,!0),x){case 1:y[b].fn.call(y[b].context);break;case 2:y[b].fn.call(y[b].context,u);break;case 3:y[b].fn.call(y[b].context,u,d);break;case 4:y[b].fn.call(y[b].context,u,d,h);break;default:if(!S)for(C=1,S=new Array(x-1);C<x;C++)S[C-1]=arguments[C];y[b].fn.apply(y[b].context,S)}}return!0},a.prototype.on=function(c,u,d){return s(this,c,u,d,!1)},a.prototype.once=function(c,u,d){return s(this,c,u,d,!0)},a.prototype.removeListener=function(c,u,d,h){var f=t?t+c:c;if(!this._events[f])return this;if(!u)return i(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!h||p.once)&&(!d||p.context===d)&&i(this,f);else{for(var m=0,y=[],x=p.length;m<x;m++)(p[m].fn!==u||h&&!p[m].once||d&&p[m].context!==d)&&y.push(p[m]);y.length?this._events[f]=y.length===1?y[0]:y:i(this,f)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=t?t+c:c,this._events[u]&&i(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,e.exports=a})(Vk);var uK=Vk.exports;function zn(e,n){return Rc(e===n.util.type,`Shape type "${e}" does not match util type "${n.util.type}"`),{type:e,...n}}const dK={wheel:"onWheel",pointer_enter:"onPointerEnter",pointer_leave:"onPointerLeave",pointer_down:"onPointerDown",pointer_move:"onPointerMove",pointer_up:"onPointerUp",right_click:"onRightClick",middle_click:"onMiddleClick",key_down:"onKeyDown",key_up:"onKeyUp",key_repeat:"onKeyRepeat",cancel:"onCancel",complete:"onComplete",interrupt:"onInterrupt",double_click:"onDoubleClick",triple_click:"onTripleClick",quadruple_click:"onQuadrupleClick"};class re{constructor(n,t){v(this,"path");v(this,"id");v(this,"current");v(this,"type");v(this,"shapeType");v(this,"initial");v(this,"children");v(this,"parent");v(this,"isActive",!1);v(this,"onWheel");v(this,"onPointerEnter");v(this,"onPointerLeave");v(this,"onPointerDown");v(this,"onPointerMove");v(this,"onPointerUp");v(this,"onDoubleClick");v(this,"onTripleClick");v(this,"onQuadrupleClick");v(this,"onRightClick");v(this,"onMiddleClick");v(this,"onKeyDown");v(this,"onKeyUp");v(this,"onKeyRepeat");v(this,"onCancel");v(this,"onComplete");v(this,"onInterrupt");v(this,"onEnter");v(this,"onExit");this.editor=n;const{id:r,children:o,initial:s}=this.constructor;this.id=r,this.current=dt("toolState"+this.id,void 0),this.path=G("toolPath"+this.id,()=>{const i=this.current.value;return this.id+(i?`.${i.path.value}`:"")}),this.parent=t??{},this.parent?o&&s?(this.type="branch",this.initial=s,this.children=Object.fromEntries(o().map(i=>[i.id,new i(this.editor,this)])),this.current.set(this.children[this.initial])):this.type="leaf":(this.type="root",o&&s&&(this.initial=s,this.children=Object.fromEntries(o().map(i=>[i.id,new i(this.editor,this)])),this.current.set(this.children[this.initial])))}transition(n,t){var s;const r=n.split(".");let o=this;for(let i=0;i<r.length;i++){const a=r[i],l=o.current.value,c=(s=o.children)==null?void 0:s[a];if(!c)throw Error(`${o.id} - no child state exists with the id ${a}.`);if((l==null?void 0:l.id)!==c.id&&(l==null||l.exit(t,a),o.current.set(c),c.enter(t,(l==null?void 0:l.id)||"initial"),!c.isActive))break;o=c}return this}handleEvent(n){var o;const t=dK[n.name],r=this.current.value;(o=this[t])==null||o.call(this,n),this.current.value===r&&this.isActive&&(r==null||r.handleEvent(n))}enter(n,t){var r;if(this.isActive=!0,(r=this.onEnter)==null||r.call(this,n,t),this.children&&this.initial&&this.isActive){const o=this.children[this.initial];this.current.set(o),o.enter(n,t)}}exit(n,t){var r,o;this.isActive=!1,(r=this.onExit)==null||r.call(this,n,t),this.isActive||(o=this.current.value)==null||o.exit(n,t)}}v(re,"id"),v(re,"initial"),v(re,"children");function kn({children:e,className:n="",...t}){return g.jsx("svg",{...t,className:`tl-svg-container ${n}`,children:e})}function rn(e,n,t={}){const{closed:r=!1,snap:o=1,start:s="outset",end:i="outset",lengthRatio:a=2,style:l="dashed"}=t;let c=0,u=0,d=1,h=0,f=0;switch(l){case"dashed":{d=1,c=Math.min(n*a,e/4);break}case"dotted":{d=100,c=n/d;break}default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return r||(s==="outset"?(e+=c/2,f+=c/2):s==="skip"&&(e-=c,f-=c),i==="outset"?e+=c/2:i==="skip"&&(e-=c)),u=Math.floor(e/c/(2*d)),u-=u%o,u<3&&l==="dashed"?e/n<5?(c=e,u=1,h=0):(c=e*.333,h=e*.333):(u=Math.max(u,3),c=e/u/(2*d),r?(f=c/2,h=(e-u*c)/u):h=(e-u*c)/Math.max(1,u-1)),{strokeDasharray:[c,h].join(" "),strokeDashoffset:f.toString()}}function Dt(){const e=U();return Sn(e)}const St=w.memo(function({d:n,color:t,fill:r}){const o=Dt();switch(r){case"none":return g.jsx("path",{className:"tl-hitarea-stroke",fill:"none",d:n});case"solid":return g.jsx("path",{className:"tl-hitarea-fill-solid",fill:o[t].semi,d:n});case"semi":return g.jsx("path",{className:"tl-hitarea-fill-solid",fill:o.solid,d:n});case"pattern":return g.jsx(hK,{color:t,fill:r,d:n})}}),hK=function({d:n,color:t}){const r=U(),o=Dt(),s=J("zoomLevel",()=>r.zoomLevel,[r]),i=J("isDarkMode",()=>r.isDarkMode,[r]),a=Math.ceil(s),l=r.zoomLevel<=.18;return g.jsxs(g.Fragment,{children:[g.jsx("path",{className:"tl-hitarea-fill-solid",fill:o[t].pattern,d:n}),g.jsx("path",{fill:l?o[t].semi:`url(#${vf[a+(i?"_dark":"_light")]})`,d:n})]})};function to({d:e,color:n,fill:t,theme:r}){if(t==="none")return;if(t==="pattern"){const s=document.createElementNS("http://www.w3.org/2000/svg","g"),i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d",e),i.setAttribute("fill",r[n].pattern);const a=document.createElementNS("http://www.w3.org/2000/svg","path");return a.setAttribute("d",e),a.setAttribute("fill","url(#hash_pattern)"),s.appendChild(i),s.appendChild(a),s}const o=document.createElementNS("http://www.w3.org/2000/svg","path");switch(o.setAttribute("d",e),t){case"semi":{o.setAttribute("fill",r.solid);break}case"solid":{o.setAttribute("fill",r[n].semi);break}}return o}function Fs(e,n){if(n){const t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.appendChild(n),t.appendChild(e),t}else return e}function fK(e,n,t){const r=n==="end"?e.end.point:e.start.point,o=n==="end"?e.start.point:e.end.point,s=e.isStraight?E.Dist(o,r):Math.abs(e.bodyArc.length),i=Math.max(Math.min(s/5,t*3),t);let a;if(e.isStraight)a=E.Nudge(r,o,i);else{const l=NN(r,i,e.handleArc.center,e.handleArc.radius);a=n==="end"?e.handleArc.sweepFlag?l[0]:l[1]:e.handleArc.sweepFlag?l[1]:l[0]}return{point:r,int:a}}function pK({point:e,int:n}){const t=E.RotWith(n,e,Ge/6),r=E.RotWith(n,e,-Ge/6);return`M ${t.x} ${t.y} L ${e.x} ${e.y} L ${r.x} ${r.y}`}function gK({point:e,int:n}){const t=E.RotWith(n,e,Ge/6),r=E.RotWith(n,e,-Ge/6);return`M ${t.x} ${t.y} L ${e.x} ${e.y} L ${r.x} ${r.y} Z`}function mK({point:e,int:n}){const t=E.Sub(n,e).div(2),r=E.Add(e,E.Rot(t,_e)),o=E.Sub(e,E.Rot(t,_e));return`M ${r.x} ${r.y} L ${n.x} ${n.y} L ${o.x} ${o.y} Z`}function yK({point:e,int:n}){const t=E.Lrp(e,n,.45),r=E.Dist(t,e);return`M ${t.x-r},${t.y}
  a ${r},${r} 0 1,0 ${r*2},0
  a ${r},${r} 0 1,0 -${r*2},0 `}function vK({point:e,int:n}){const t=E.Lrp(e,n,.75),r=E.RotWith(t,e,Ge/4),o=E.RotWith(t,e,-Ge/4),s=E.Lrp(r,o,.5);return s.add(E.Sub(s,e)),`M ${s.x} ${s.y} L ${r.x} ${r.y} ${e.x} ${e.y} L ${o.x} ${o.y} Z`}function wK({int:e,point:n}){const t=E.Lrp(n,e,.85),r=E.Sub(t,n).div(2),o=E.Add(n,E.Rot(r,_e)),s=E.Sub(n,E.Rot(r,_e)),i=E.Add(t,E.Rot(r,_e)),a=E.Sub(t,E.Rot(r,_e));return`M ${o.x} ${o.y} L ${i.x} ${i.y} L ${a.x} ${a.y} L ${s.x} ${s.y} Z`}function xK({int:e,point:n}){const t=E.Sub(e,n).div(2),r=E.Add(n,E.Rot(t,_e)),o=E.Sub(n,E.Rot(t,_e));return`M ${r.x} ${r.y} L ${o.x} ${o.y}`}function ea(e,n,t){const r=n==="end"?e.end.arrowhead:e.start.arrowhead;if(r==="none")return;const o=fK(e,n,t);if(o){switch(r){case"bar":return xK(o);case"square":return wK(o);case"diamond":return vK(o);case"dot":return yK(o);case"inverted":return mK(o);case"arrow":return pK(o);case"triangle":return gK(o)}return""}}function Jl(e){return Math.abs(e.props.bend)<8}function Pf(e,n){if(n.type==="point")return;const t=e.getShapeById(n.boundShapeId),r=e.getShapeUtil(t),o=e.getPageTransform(t);return{shape:t,transform:o,isClosed:r.isClosed(t),isExact:n.isExact,didIntersect:!1,outline:e.getOutline(t)}}function _2(e,n,t){if(t.type==="point")return E.From(t);const r=e.getShapeById(t.boundShapeId);if(r){const{point:o,size:s}=e.getBounds(r),i=E.Add(o,E.MulV(t.normalizedAnchor,s)),a=Y.applyToPoint(e.getPageTransform(r),i);return Y.applyToPoint(Y.Inverse(n),a)}else return new E(0,0)}function Sr(e,n){const t=e.getPageTransform(n),r=_2(e,t,n.props.start),o=_2(e,t,n.props.end);return{start:r,end:o}}const ui=48,Ef=10,SK=10;function Gc(e,n){const{start:t,end:r,arrowheadStart:o,arrowheadEnd:s}=n.props,i=Sr(e,n),a=i.start.clone(),l=i.end.clone(),c=E.Med(a,l),u=E.Sub(l,a).uni(),d=Pf(e,t),h=Pf(e,r),f=e.getPageTransform(n);C2(l,i.start,f,h),C2(a,i.end,f,d);let p=ui;const m=d&&h&&d.shape===h.shape;d&&h&&!m&&!d.isExact&&!h.isExact&&(h.didIntersect&&!d.didIntersect?d.isClosed&&a.setTo(E.Nudge(l,a,p)):h.didIntersect||h.isClosed&&l.setTo(E.Nudge(a,l,p)));const y=E.Sub(l,a).uni(),x=!E.Equals(y,u);if(!m){if(d&&o!=="none"&&!d.isExact){const b=Ef+Ae[n.props.size]/2+("size"in d.shape.props?Ae[d.shape.props.size]/2:0);p-=b,a.nudge(l,b*(x?-1:1))}if(h&&s!=="none"&&!h.isExact){const b=Ef+Ae[n.props.size]/2+("size"in h.shape.props?Ae[h.shape.props.size]/2:0);p-=b,l.nudge(a,b*(x?-1:1))}}d&&h&&(x?l.setTo(E.Add(a,y.mul(-p))):E.Dist(a,l)<ui/2&&l.setTo(E.Add(a,y.mul(ui/2)))),x?c.setTo(E.Med(i.start,i.end)):c.setTo(E.Med(a,l));const S=E.Dist(a,l);return{isStraight:!0,start:{handle:i.start,point:a,arrowhead:n.props.arrowheadStart},end:{handle:i.end,point:l,arrowhead:n.props.arrowheadEnd},middle:c,isValid:S>0,length:S}}function C2(e,n,t,r){if(r===void 0||r.isExact)return;const o=Y.applyToPoint(t,n),s=Y.applyToPoint(t,e),i=Y.applyToPoint(Y.Inverse(r.transform),o),a=Y.applyToPoint(Y.Inverse(r.transform),s),l=r.isClosed,u=(l?jN:F1)(i,a,r.outline);let d;if(u!==null&&(d=u.sort((p,m)=>E.Dist(p,i)-E.Dist(m,i))[0]??(l?void 0:a)),d===void 0)return;const h=Y.applyToPoint(r.transform,d),f=Y.applyToPoint(Y.Inverse(t),h);e.setTo(f),r.didIntersect=!0}function bK(e){return Wk(e.start.handle,e.end.handle)}function am(e){return Wk(e.start.point,e.end.point)}function Wk(e,n){return`M${e.x},${e.y}L${n.x},${n.y}`}function $0(e,n,t=0){const{arrowheadEnd:r,arrowheadStart:o}=n.props,s=n.props.bend+t;if(Math.abs(s)>Math.abs(n.props.bend*SK))return Gc(e,n);const i=Sr(e,n),a=E.Med(i.start,i.end),l=E.Sub(i.end,i.start).uni(),c=E.Add(a,l.per().mul(-s)),u=Pf(e,n.props.start),d=Pf(e,n.props.end),h=i.start.clone(),f=i.end.clone(),p=c.clone(),m=I2(h,f,p);if(m.length===0||m.size===0||!Hb(m.length)||!Hb(m.size))return Gc(e,n);const y=e.getPageTransform(n);if(u&&!u.isExact){const C=Y.applyToPoint(y,h),_=Y.applyToPoint(y,f),I=Y.applyToPoint(y,m.center),k=Y.Inverse(u.transform),T=Y.applyToPoint(k,C),M=Y.applyToPoint(k,_),O=Y.applyToPoint(k,I),{isClosed:z}=u,B=z?Vb:Wb;let D,F=B(O,m.radius,e.getOutline(u.shape));if(F){F=F.filter(N=>+E.Clockwise(T,N,M)===m.sweepFlag);const V=E.Angle(m.center,c),q=E.Angle(m.center,i.start),L=Qs(V,q,.5);F.sort((N,H)=>Math.abs(cs(L,O.angle(N)))-Math.abs(cs(L,O.angle(H)))),D=F[0]??(z?void 0:T)}else D=z?void 0:T;if(D&&(h.setTo(e.getPointInShapeSpace(n,Y.applyToPoint(u.transform,D))),u.didIntersect=!0,o!=="none")){const V=Ef+Ae[n.props.size]/2+("size"in u.shape.props?Ae[u.shape.props.size]/2:0);h.setTo(ni(m.center.x,m.center.y,m.radius,Qs(E.Angle(m.center,h),E.Angle(m.center,c),V/Math.abs(yd(m.center,m.radius,h,c)))))}}if(d&&!d.isExact){const C=Y.applyToPoint(y,h),_=Y.applyToPoint(y,f),I=Y.applyToPoint(y,m.center),k=Y.Inverse(d.transform),T=Y.applyToPoint(k,C),M=Y.applyToPoint(k,_),O=Y.applyToPoint(k,I),z=d.isClosed,B=z?Vb:Wb,D=E.Angle(m.center,c),F=E.Angle(m.center,i.end),V=Qs(D,F,.5);let q,L=B(O,m.radius,e.getOutline(d.shape));if(L?(L=L.filter(N=>+E.Clockwise(T,N,M)===m.sweepFlag),L.sort((N,H)=>Math.abs(cs(V,O.angle(N)))-Math.abs(cs(V,O.angle(H)))),q=L[0]??(z?void 0:M)):q=z?void 0:M,q&&(f.setTo(e.getPointInShapeSpace(n,Y.applyToPoint(d.transform,q))),d.didIntersect=!0,r!=="none")){let N=Ef+Ae[n.props.size]/2+("size"in d.shape.props?Ae[d.shape.props.size]/2:0);E.Dist(h,f)<ui&&(N*=-2),f.setTo(ni(m.center.x,m.center.y,m.radius,Qs(E.Angle(m.center,f),E.Angle(m.center,c),N/Math.abs(yd(m.center,m.radius,f,c)))))}}if(Math.abs(yd(m.center,m.radius,h,f))<ui/2&&(h.setTo(i.start),f.setTo(i.end)),u&&d&&u.shape!==d.shape&&!u.isExact&&!d.isExact){const C=E.Angle(m.center,h),_=E.Angle(m.center,f),I=m.sweepFlag?ui:-ui,k=yd(m.center,m.radius,f,h),{center:{x:T,y:M},radius:O}=m;u&&!u.didIntersect&&h.setTo(ni(T,M,O,Qs(C,_,I/k))),d&&!d.didIntersect&&f.setTo(ni(T,M,O,Qs(C,_,-I/k)))}let S=Qs(E.Angle(m.center,h),E.Angle(m.center,f),.5),b=ni(m.center.x,m.center.y,m.radius,S);+E.Clockwise(h,b,f)!==m.sweepFlag&&(S+=Ge,b=ni(m.center.x,m.center.y,m.radius,S)),p.setTo(b);const P=I2(h,f,p);return{isStraight:!1,start:{point:h,handle:i.start,arrowhead:n.props.arrowheadStart},end:{point:f,handle:i.end,arrowhead:n.props.arrowheadEnd},middle:p,handleArc:m,bodyArc:P,isValid:P.length!==0&&isFinite(P.center.x)&&isFinite(P.center.y)}}function PK(e){const{start:n,end:t,handleArc:{radius:r,largeArcFlag:o,sweepFlag:s}}=e;return`M${n.handle.x},${n.handle.y} A${r} ${r} 0 ${o} ${s} ${t.handle.x},${t.handle.y}`}function lm(e){const{start:n,end:t,bodyArc:{radius:r,largeArcFlag:o,sweepFlag:s}}=e;return`M${n.point.x},${n.point.y} A${r} ${r} 0 ${o} ${s} ${t.point.x},${t.point.y}`}function I2(e,n,t){const r=-2*(e.x*(n.y-t.y)-e.y*(n.x-t.x)+n.x*t.y-t.x*n.y),o={x:((e.x*e.x+e.y*e.y)*(t.y-n.y)+(n.x*n.x+n.y*n.y)*(e.y-t.y)+(t.x*t.x+t.y*t.y)*(n.y-e.y))/r,y:((e.x*e.x+e.y*e.y)*(n.x-t.x)+(n.x*n.x+n.y*n.y)*(t.x-e.x)+(t.x*t.x+t.y*t.y)*(e.x-n.x))/r},s=E.Dist(o,e),i=+E.Clockwise(e,t,n),a=Math.hypot(e.y-n.y,e.x-n.x),l=Math.hypot(n.y-t.y,n.x-t.x),c=Math.hypot(t.y-e.y,t.x-e.x),u=Math.acos((l*l+c*c-a*a)/(2*l*c))*2,d=+(Ge>u),h=(qe-u)*(i?1:-1),f=h*s;return{center:o,radius:s,size:h,length:f,largeArcFlag:d,sweepFlag:i}}const EK=w.memo(function({id:n,text:t,size:r,font:o,position:s,width:i,labelColor:a}){const{rInput:l,isEditing:c,handleFocus:u,handleBlur:d,handleKeyDown:h,handleChange:f,isEmpty:p}=Z1(n,"arrow",t);return!c&&p?null:g.jsx("div",{className:"tl-arrow-label","data-font":o,"data-align":"center","data-hastext":!p,"data-isediting":c,style:{textAlign:"center",fontSize:ns[r],lineHeight:ns[r]*At.lineHeight+"px",transform:`translate(${s.x}px, ${s.y}px)`,color:a},children:g.jsxs("div",{className:"tl-arrow-label__inner",children:[g.jsx("p",{style:{width:i||"9px"},children:t?Ss.normalizeTextForDom(t):" "}),c&&g.jsx("textarea",{ref:l,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:!0,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:t,onFocus:u,onChange:f,onKeyDown:h,onBlur:d,onContextMenu:Vr})]})})});var _K=Object.defineProperty,CK=Object.getOwnPropertyDescriptor,Yk=(e,n,t,r)=>{for(var o=r>1?void 0:r?CK(n,t):n,s=e.length-1,i;s>=0;s--)(i=e[s])&&(o=(r?i(n,t,o):i(o))||o);return r&&o&&_K(n,t,o),o};let IK=0;class Fe extends eo{constructor(){super(...arguments);v(this,"canEdit",()=>!0);v(this,"canBind",()=>!1);v(this,"isClosed",()=>!1);v(this,"canSnap",()=>!0);v(this,"hideResizeHandles",()=>!0);v(this,"hideRotateHandle",()=>!0);v(this,"hideSelectionBoundsFg",()=>!0);v(this,"hideSelectionBoundsBg",()=>!0);v(this,"onHandleChange",(t,{handle:r,isPrecise:o})=>{const s=yn(t);switch(r.id){case"start":case"end":{const i=this.editor.getPageTransformById(s.id),a=Y.applyToPoint(i,r);if(this.editor.inputs.ctrlKey)s.props[r.id]={type:"point",x:r.x,y:r.y};else{const l=en(this.editor.sortedShapesArray.filter(c=>{if(c.id===t.id)return;const u=this.editor.getShapeUtil(c);if(!u.canBind(c))return;const d=this.editor.getPageMaskById(c.id);if(d&&!sr(a,d))return;const h=this.editor.getPointInShapeSpace(c,a);return u.isClosed(c)?sr(h,this.editor.getOutline(c)):u.hitTestPoint(c,h)}));if(l){const c=this.editor.getBounds(l),u=this.editor.getPointInShapeSpace(l,a),d=s.props[r.id],h=t.props.start.type==="binding"&&t.props.start.boundShapeId,f=t.props.end.type==="binding"&&t.props.end.boundShapeId;let p=o||(h||f)&&h===f||!this.editor.getShapeUtil(l).isClosed(s);(d.type==="point"||d.type==="binding"&&l.id!==d.boundShapeId)&&(p=this.editor.inputs.pointerVelocity.len()<.5),p&&(p=E.Dist(u,c.center)>Math.max(4,Math.min(Math.min(c.width,c.height)*.15,16))/this.editor.zoomLevel),s.props[r.id]={type:"binding",boundShapeId:l.id,normalizedAnchor:p?{x:(u.x-c.minX)/c.width,y:(u.y-c.minY)/c.height}:{x:.5,y:.5},isExact:this.editor.inputs.altKey}}else s.props[r.id]={type:"point",x:r.x,y:r.y}}break}case"middle":{const{start:i,end:a}=Sr(this.editor,s),l=E.Sub(a,i),c=E.Per(l),u=E.Med(a,i),d=E.Sub(u,c),h=E.Add(u,c),f=E.NearestPointOnLineSegment(d,h,r,!1);let p=E.Dist(f,u);E.Clockwise(f,a,u)&&(p*=-1),s.props.bend=p;break}}return s});v(this,"onTranslateStart",t=>{let r=t.props.start.type==="binding"?t.props.start.boundShapeId:null,o=t.props.end.type==="binding"?t.props.end.boundShapeId:null;if(r&&this.editor.isWithinSelection(r)||o&&this.editor.isWithinSelection(o))return;r=null,o=null;const{start:s,end:i}=Sr(this.editor,t);return{id:t.id,type:t.type,props:{...t.props,start:{type:"point",x:s.x,y:s.y},end:{type:"point",x:i.x,y:i.y}}}});v(this,"onResize",(t,r)=>{const{scaleX:o,scaleY:s}=r,i=Sr(this.editor,t),{start:a,end:l}=yn(t.props);let{bend:c}=t.props;a.type==="point"&&(a.x=i.start.x*o,a.y=i.start.y*s),l.type==="point"&&(l.x=i.end.x*o,l.y=i.end.y*s);const u=Math.abs(o),d=Math.abs(s);return o<0&&s>=0?(c!==0&&(c*=-1,c*=Math.max(u,d)),a.type==="binding"&&(a.normalizedAnchor.x=1-a.normalizedAnchor.x),l.type==="binding"&&(l.normalizedAnchor.x=1-l.normalizedAnchor.x)):o>=0&&s<0?(c!==0&&(c*=-1,c*=Math.max(u,d)),a.type==="binding"&&(a.normalizedAnchor.y=1-a.normalizedAnchor.y),l.type==="binding"&&(l.normalizedAnchor.y=1-l.normalizedAnchor.y)):o>=0&&s>=0?c!==0&&(c*=Math.max(u,d)):o<0&&s<0&&(c!==0&&(c*=Math.max(u,d)),a.type==="binding"&&(a.normalizedAnchor.x=1-a.normalizedAnchor.x,a.normalizedAnchor.y=1-a.normalizedAnchor.y),l.type==="binding"&&(l.normalizedAnchor.x=1-l.normalizedAnchor.x,l.normalizedAnchor.y=1-l.normalizedAnchor.y)),{props:{start:a,end:l,bend:c}}});v(this,"onDoubleClickHandle",(t,r)=>{switch(r.id){case"start":return{id:t.id,type:t.type,props:{...t.props,arrowheadStart:t.props.arrowheadStart==="none"?"arrow":"none"}};case"end":return{id:t.id,type:t.type,props:{...t.props,arrowheadEnd:t.props.arrowheadEnd==="none"?"arrow":"none"}}}});v(this,"onEditEnd",t=>{const{id:r,type:o,props:{text:s}}=t;s.trimEnd()!==t.props.text&&this.editor.updateShapes([{id:r,type:o,props:{text:s.trimEnd()}}])})}getDefaultProps(){return{dash:"draw",size:"m",fill:"none",color:"black",labelColor:"black",bend:0,start:{type:"point",x:0,y:0},end:{type:"point",x:0,y:0},arrowheadStart:"none",arrowheadEnd:"arrow",text:"",font:"draw"}}getCenter(t){return this.editor.getBounds(t).center}getBounds(t){return ne.FromPoints(this.getOutlineWithoutLabel(t))}getOutlineWithoutLabel(t){const r=this.getArrowInfo(t);if(!r)return[];if(r.isStraight)return r.isValid?[E.From(r.start.point),E.From(r.end.point)]:[new E(0,0),new E(1,1)];if(!r.isValid)return[new E(0,0),new E(1,1)];const o=Math.max(5,Math.ceil(Math.abs(r.bodyArc.length)/16));if(o<=0&&!isFinite(o))return[new E(0,0),new E(1,1)];const s=Array(o),i=E.Angle(r.bodyArc.center,r.start.point),a=E.Angle(r.bodyArc.center,r.end.point),l=r.bodyArc.sweepFlag?a:i,c=r.bodyArc.sweepFlag?i:a,u=r.bodyArc.largeArcFlag?-bN(l,c):cs(l,c),d=Math.max(1,r.bodyArc.radius);for(let h=0;h<o;h++){const f=h/(o-1),p=l+u*f,m=ni(r.bodyArc.center.x,r.bodyArc.center.y,d,p);s[h]=m}return s}getOutline(t){const r=this.getOutlineWithoutLabel(t),o=this.getLabelBounds(t);if(!o)return r;const s=o.sides,i=[0,1,2,3];let a=r[0],l=!1;const c=[a];for(let u=1;u<r.length;u++){const d=r[u];if(!l){const h=LI(i.filter(f=>Gr(s[f][0],s[f][1],a,d)),f=>E.DistanceToLineSegment(s[f][0],s[f][1],a));if(h!==void 0){const f=E.NearestPointOnLineSegment(s[h][0],s[h][1],a);c.push(f);for(let p=0;p<4;p++){const m=(h+p)%4;c.push(s[m][1])}c.push(f),l=!0}}c.push(d),a=d}return c}snapPoints(t){return br}get infoCache(){return this.editor.store.createComputedCache("arrow infoCache",t=>Jl(t)?Gc(this.editor,t):$0(this.editor,t))}getArrowInfo(t){return this.infoCache.get(t.id)}getHandles(t){const r=this.infoCache.get(t.id);return[{id:"start",type:"vertex",index:"a0",x:r.start.handle.x,y:r.start.handle.y,canBind:!0},{id:"middle",type:"vertex",index:"a2",x:r.middle.x,y:r.middle.y,canBind:!1},{id:"end",type:"vertex",index:"a3",x:r.end.handle.x,y:r.end.handle.y,canBind:!0}]}hitTestPoint(t,r){const o=this.editor.getOutline(t),s=this.editor.zoomLevel,i=Ae[t.props.size]/s;for(let a=0;a<o.length-1;a++){const l=o[a],c=o[a+1];if(E.DistanceToLineSegment(l,c,r)<i)return!0}return!1}hitTestLineSegment(t,r,o){const s=this.editor.getOutline(t);for(let i=0;i<s.length-1;i++){const a=s[i],l=s[i+1];if(Gr(r,o,a,l))return!0}return!1}component(t){const r=Dt(),o=this.editor.onlySelectedShape,s=this.editor.isInAny("select.idle","select.pointing_handle","select.dragging_handle","arrow.dragging")&&!this.editor.isReadOnly,i=this.getArrowInfo(t),a=this.editor.getBounds(t),l=this.getLabelBounds(t),c=w.useMemo(()=>this.editor.isSafari?IK+=1:0,[t]);if(!(i!=null&&i.isValid))return null;const u=Ae[t.props.size],d=i.start.arrowhead&&ea(i,"start",u),h=i.end.arrowhead&&ea(i,"end",u),f=i.isStraight?am(i):lm(i);let p=null;if(o===t&&s){const{strokeDasharray:_,strokeDashoffset:I}=rn(i.isStraight?E.Dist(i.start.handle,i.end.handle):Math.abs(i.handleArc.length),2,{end:"skip",start:"skip",lengthRatio:2.5});p=t.props.start.type==="binding"||t.props.end.type==="binding"?g.jsx("path",{className:"tl-arrow-hint",d:i.isStraight?bK(i):PK(i),strokeDasharray:_,strokeDashoffset:I,strokeWidth:2,markerStart:t.props.start.type==="binding"?t.props.start.isExact?"":T2(t.props.start.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",markerEnd:t.props.end.type==="binding"?t.props.end.isExact?"":T2(t.props.end.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",opacity:.16}):null}const{strokeDasharray:m,strokeDashoffset:y}=rn(i.isStraight?i.length:Math.abs(i.bodyArc.length),u,{style:t.props.dash}),x=!(i.start.arrowhead==="none"||i.start.arrowhead==="arrow"),S=!(i.end.arrowhead==="none"||i.end.arrowhead==="arrow"),b=x||S||l,P=(t.id+"_clip_"+c).replace(":","_");return g.jsxs(g.Fragment,{children:[g.jsxs(kn,{id:t.id,style:{minWidth:50,minHeight:50},children:[b&&g.jsx("defs",{children:g.jsxs("mask",{id:P,children:[g.jsx("rect",{x:R(-100+a.minX),y:R(-100+a.minY),width:R(a.width+200),height:R(a.height+200),fill:"white"}),l&&g.jsx("rect",{x:R(l.x),y:R(l.y),width:R(l.w),height:R(l.h),fill:"black",rx:4,ry:4}),d&&x&&g.jsx("path",{d,fill:i.start.arrowhead==="arrow"?"none":"black",stroke:"none"}),h&&S&&g.jsx("path",{d:h,fill:i.end.arrowhead==="arrow"?"none":"black",stroke:"none"})]})}),g.jsxs("g",{fill:"none",stroke:r[t.props.color].solid,strokeWidth:u,strokeLinejoin:"round",strokeLinecap:"round",pointerEvents:"none",children:[p,g.jsxs("g",{...b?{mask:`url(#${P})`}:void 0,children:[b&&g.jsx("rect",{x:R(a.minX-100),y:R(a.minY-100),width:R(a.width+200),height:R(a.height+200),opacity:0}),g.jsx("path",{d:f,strokeDasharray:m,strokeDashoffset:y})]}),d&&x&&t.props.fill!=="none"&&g.jsx(St,{d,color:t.props.color,fill:t.props.fill}),h&&S&&t.props.fill!=="none"&&g.jsx(St,{d:h,color:t.props.color,fill:t.props.fill}),d&&g.jsx("path",{d}),h&&g.jsx("path",{d:h})]}),g.jsx("path",{d:f,className:"tl-hitarea-stroke"})]}),g.jsx(EK,{id:t.id,text:t.props.text,font:t.props.font,size:t.props.size,position:i.middle,width:(l==null?void 0:l.w)??0,labelColor:t.props.labelColor})]})}indicator(t){const{start:r,end:o}=Sr(this.editor,t),s=this.getArrowInfo(t),i=this.editor.getBounds(t),a=this.getLabelBounds(t);if(!s||E.Equals(r,o))return null;const l=Ae[t.props.size],c=s.start.arrowhead&&ea(s,"start",l),u=s.end.arrowhead&&ea(s,"end",l),d=s.isStraight?am(s):lm(s),h=c&&s.start.arrowhead!=="arrow"||u&&s.end.arrowhead!=="arrow"||a!==null,f=(t.id+"_clip").replace(":","_");return g.jsxs("g",{children:[h&&g.jsx("defs",{children:g.jsxs("mask",{id:f,children:[g.jsx("rect",{x:i.minX-100,y:i.minY-100,width:i.w+200,height:i.h+200,fill:"white"}),a&&g.jsx("rect",{x:a.x,y:a.y,width:a.w,height:a.h,fill:"black",rx:4,ry:4}),c&&g.jsx("path",{d:c,fill:s.start.arrowhead==="arrow"?"none":"black",stroke:"none"}),u&&g.jsx("path",{d:u,fill:s.end.arrowhead==="arrow"?"none":"black",stroke:"none"})]})}),g.jsxs("g",{...h?{mask:`url(#${f})`}:void 0,children:[h&&g.jsx("rect",{x:i.minX-100,y:i.minY-100,width:i.width+200,height:i.height+200,opacity:0}),g.jsx("path",{d})]}),c&&g.jsx("path",{d:c}),u&&g.jsx("path",{d:u}),a&&g.jsx("rect",{x:a.x,y:a.y,width:a.w,height:a.h,rx:4,ry:4})]})}get labelBoundsCache(){return this.editor.store.createComputedCache("labelBoundsCache",t=>{const r=this.getArrowInfo(t),o=this.editor.getBounds(t),{text:s,font:i,size:a}=t.props;if(!r||!s.trim())return null;const{w:l,h:c}=this.editor.textMeasure.measureText(s,{...At,fontFamily:bo[i],fontSize:ns[a],width:"fit-content"});let u=l,d=c;if(o.width>o.height){u=Math.max(Math.min(l,64),Math.min(o.width-64,l));const{w:h,h:f}=this.editor.textMeasure.measureText(s,{...At,fontFamily:bo[i],fontSize:ns[a],width:u+"px"});u=h,d=f}if(u>16*ns[a]){u=16*ns[a];const{w:h,h:f}=this.editor.textMeasure.measureText(s,{...At,fontFamily:bo[i],fontSize:ns[a],width:u+"px"});u=h,d=f}return new ne(r.middle.x-(u+8)/2,r.middle.y-(d+8)/2,u+8,d+8)})}getLabelBounds(t){return this.labelBoundsCache.get(t.id)||null}toSvg(t,r){const o=Sn(this.editor);r.addExportDef(q1(t.props.fill,o));const s=o[t.props.color].solid,i=this.getArrowInfo(t),a=Ae[t.props.size],l=document.createElementNS("http://www.w3.org/2000/svg","g");if(!i)return l;const c=i.start.arrowhead&&ea(i,"start",a),u=i.end.arrowhead&&ea(i,"end",a),d=this.editor.getBounds(t),h=this.getLabelBounds(t),f=(t.id+"_clip").replace(":","_");if(c||u||h){const b=document.createElementNS("http://www.w3.org/2000/svg","defs"),P=document.createElementNS("http://www.w3.org/2000/svg","mask");P.id=f;const C=document.createElementNS("http://www.w3.org/2000/svg","rect");if(C.setAttribute("x",d.minX-100+""),C.setAttribute("y",d.minY-100+""),C.setAttribute("width",d.width+200+""),C.setAttribute("height",d.height+200+""),C.setAttribute("fill","white"),P.appendChild(C),c&&P.appendChild(k2(c,i.start.arrowhead)),u&&P.appendChild(k2(u,i.end.arrowhead)),h){const _=document.createElementNS("http://www.w3.org/2000/svg","rect");_.setAttribute("x",h.x+""),_.setAttribute("y",h.y+""),_.setAttribute("width",h.w+""),_.setAttribute("height",h.h+""),_.setAttribute("fill","black"),P.appendChild(_)}b.appendChild(P),l.appendChild(b)}const p=document.createElementNS("http://www.w3.org/2000/svg","g");p.setAttribute("mask",`url(#${f})`),l.appendChild(p);const m=document.createElementNS("http://www.w3.org/2000/svg","rect");m.setAttribute("x","-100"),m.setAttribute("y","-100"),m.setAttribute("width",d.width+200+""),m.setAttribute("height",d.height+200+""),m.setAttribute("fill","transparent"),m.setAttribute("stroke","none"),p.appendChild(m);const y=kK(i.isStraight?am(i):lm(i),s,a),{strokeDasharray:x,strokeDashoffset:S}=rn(i.isStraight?i.length:Math.abs(i.bodyArc.length),a,{style:t.props.dash});if(y.setAttribute("stroke-dasharray",x),y.setAttribute("stroke-dashoffset",S),p.appendChild(y),c&&l.appendChild($2(c,t.props.color,a,t.props.arrowheadStart==="arrow"?"none":t.props.fill,o)),u&&l.appendChild($2(u,t.props.color,a,t.props.arrowheadEnd==="arrow"?"none":t.props.fill,o)),h){r.addExportDef(wp(t.props.font));const b={fontSize:ns[t.props.size],lineHeight:At.lineHeight,fontFamily:wu[t.props.font],padding:0,textAlign:"middle",width:h.w-8,verticalTextAlign:"middle",height:h.h,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},P=vp(this.editor,this.editor.textMeasure.measureTextSpans(t.props.text,b),b);P.setAttribute("fill",o[t.props.labelColor].solid),Array.from(P.children).forEach(I=>{const k=parseFloat(I.getAttribute("x")||"0"),T=parseFloat(I.getAttribute("y")||"0");I.setAttribute("x",k+4+h.x+"px"),I.setAttribute("y",T+h.y+"px")});const _=P.cloneNode(!0);_.setAttribute("stroke-width","2"),_.setAttribute("fill",o.background),_.setAttribute("stroke",o.background),l.appendChild(_),l.appendChild(P)}return l}getCanvasSvgDefs(){return[Q1()]}}v(Fe,"type","arrow");Yk([G],Fe.prototype,"infoCache",1);Yk([G],Fe.prototype,"labelBoundsCache",1);function k2(e,n){const t=document.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttribute("d",e),t.setAttribute("fill",n==="arrow"?"none":"black"),t.setAttribute("stroke","none"),t}function kK(e,n,t){const r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",e),r.setAttribute("fill","none"),r.setAttribute("stroke",n),r.setAttribute("stroke-width",t+""),r}function $2(e,n,t,r,o){const s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("d",e),s.setAttribute("fill","none"),s.setAttribute("stroke",o[n].solid),s.setAttribute("stroke-width",t+"");const i=to({d:e,fill:r,color:n,theme:o});if(i){const a=document.createElementNS("http://www.w3.org/2000/svg","g");return a.appendChild(i),a.appendChild(s),a}else return s}function T2(e){return e.x!==.5||e.y!==.5}var Km;let $K=(Km=class extends re{constructor(){super(...arguments);v(this,"onPointerDown",t=>{this.parent.transition("pointing",t)});v(this,"onEnter",()=>{this.editor.setCursor({type:"cross"})});v(this,"onCancel",()=>{this.editor.setSelectedTool("select")})}},v(Km,"id","idle"),Km);var Hm;let TK=(Hm=class extends re{constructor(){super(...arguments);v(this,"shape");v(this,"preciseTimeout",-1);v(this,"didTimeout",!1);v(this,"onEnter",()=>{var a,l;const{inputs:{currentPagePoint:t}}=this.editor;this.didTimeout=!1,this.editor.mark("creating");const r=Ue();this.editor.createShapes([{id:r,type:"arrow",x:t.x,y:t.y}]);const o=this.editor.getShapeUtil(Fe),s=this.editor.getShapeById(r);if(!s)return;const i=this.editor.getHandles(s);if(i){const c=this.editor.getPointInShapeSpace(s,t),u=(a=o.onHandleChange)==null?void 0:a.call(o,s,{handle:{...i[0],x:c.x,y:c.y},isPrecise:!0});if(u){const d=(l=u.props)==null?void 0:l.start;(d==null?void 0:d.type)==="binding"&&this.editor.setHintingIds([d.boundShapeId]),this.editor.updateShapes([u],!0)}}this.editor.select(r),this.shape=this.editor.getShapeById(r),this.startPreciseTimeout()});v(this,"onExit",()=>{this.clearPreciseTimeout()});v(this,"onPointerMove",()=>{var t;if(this.shape&&this.editor.inputs.isDragging){const r=this.editor.getHandles(this.shape);if(!r)throw this.editor.bailToMark("creating"),Error("No handles found");if(!this.didTimeout){const o=this.editor.getShapeUtil(Fe),s=this.editor.getShapeById(this.shape.id);if(!s)return;if(r){const{x:i,y:a}=this.editor.getPointInShapeSpace(s,this.editor.inputs.originPagePoint),l=(t=o.onHandleChange)==null?void 0:t.call(o,s,{handle:{...r[0],x:i,y:a},isPrecise:!1});l&&this.editor.updateShapes([l],!0)}}this.editor.setSelectedTool("select.dragging_handle",{shape:this.shape,handle:r.find(o=>o.id==="end"),isCreating:!0,onInteractionEnd:"arrow"})}});v(this,"onPointerUp",()=>{this.cancel()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.cancel()});v(this,"onInterrupt",()=>{this.cancel()})}startPreciseTimeout(){this.preciseTimeout=window.setTimeout(()=>{this.isActive&&this.shape&&(this.didTimeout=!0)},300)}clearPreciseTimeout(){clearTimeout(this.preciseTimeout)}cancel(){this.editor.bailToMark("creating"),this.editor.setHintingIds([]),this.parent.transition("idle",{})}},v(Hm,"id","pointing"),Hm);class lh extends re{constructor(){super(...arguments);v(this,"shapeType",Fe)}}v(lh,"id","arrow"),v(lh,"initial","idle"),v(lh,"children",()=>[$K,TK]);const MK=zn("arrow",{util:Fe,props:N9,migrations:z9,tool:lh}),M2="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E";function _u({url:e,zoomLevel:n}){return g.jsx("a",{className:de("tl-hyperlink-button",{"tl-hyperlink-button__hidden":n<.32}),href:e,target:"_blank",rel:"noopener noreferrer",onPointerDown:Vr,onPointerUp:Vr,title:e,draggable:!1,children:g.jsx("div",{className:"tl-hyperlink-button__icon",style:{mask:`url("${M2}") center 100% / 100% no-repeat`,WebkitMask:`url("${M2}") center 100% / 100% no-repeat`}})})}class Cu extends ll{constructor(){super(...arguments);v(this,"canResize",()=>!1);v(this,"hideSelectionBoundsBg",()=>!0);v(this,"hideSelectionBoundsFg",()=>!0);v(this,"onBeforeCreate",t=>{A2(this.editor,t)});v(this,"onBeforeUpdate",(t,r)=>{if(t.props.url!==r.props.url)if(k0(r.props.url))A2(this.editor,r);else return{...r,props:{...r.props,url:t.props.url}}})}getDefaultProps(){return{url:"",w:300,h:320,assetId:null}}component(t){const r=t.props.assetId?this.editor.getAssetById(t.props.assetId):null,o=this.editor.getPageRotation(t),s=AK(t);return g.jsx(Ya,{children:g.jsxs("div",{className:"tl-bookmark__container tl-hitarea-stroke",style:{boxShadow:K1(o)},children:[g.jsxs("div",{className:"tl-bookmark__image_container",children:[r!=null&&r.props.image?g.jsx("img",{className:"tl-bookmark__image",draggable:!1,src:r==null?void 0:r.props.image,alt:(r==null?void 0:r.props.title)||""}):g.jsx("div",{className:"tl-bookmark__placeholder"}),g.jsx(_u,{url:t.props.url,zoomLevel:this.editor.zoomLevel})]}),g.jsxs("div",{className:"tl-bookmark__copy_container",children:[(r==null?void 0:r.props.title)&&g.jsx("h2",{className:"tl-bookmark__heading",children:hc((r==null?void 0:r.props.title)||"",54)}),(r==null?void 0:r.props.description)&&g.jsx("p",{className:"tl-bookmark__description",children:hc((r==null?void 0:r.props.description)||"",128)}),g.jsx("a",{className:"tl-bookmark__link",href:t.props.url||"",target:"_blank",rel:"noopener noreferrer",onPointerDown:Vr,onPointerUp:Vr,onClick:Vr,children:hc(s,45)})]})]})})}indicator(t){return g.jsx("rect",{width:R(t.props.w),height:R(t.props.h),rx:"8",ry:"8"})}}v(Cu,"type","bookmark");const AK=e=>{try{const n=new URL(e.props.url),t=n.pathname.replace(/\/*$/,"");return`${n.hostname}${t}`}catch{return e.props.url}};function A2(e,n){const{url:t}=n.props,r=Oa.createId(sh(t));e.getAssetById(r)?n.props.assetId!==r&&e.updateShapes([{id:n.id,type:n.type,props:{assetId:r}}]):(e.updateShapes([{id:n.id,type:n.type,props:{assetId:null}}]),OK(e,n))}const OK=NI(async(e,n)=>{const{url:t}=n.props,r=await e.externalContentManager.createAssetFromUrl(e,t);r&&e.batch(()=>{e.createAssets([r]),e.updateShapes([{id:n.id,type:n.type,props:{assetId:r.id}}])})},500),RK=zn("bookmark",{util:Cu,props:B9,migrations:F9});function Ci(){const e=U();return J("zoom",()=>e.zoomLevel<.35,[e])}const Xk=e=>e*.65+SN(e*Ge/2)*.35,DK=e=>({size:1+e,thinning:.5,streamline:.62+(1+e)/8*.06,smoothing:.62,easing:Kt.easeOutSine,simulatePressure:!0}),LK=e=>({size:1+e*1.2,thinning:.62,streamline:.62,smoothing:.62,simulatePressure:!1,easing:Xk}),O2=e=>({size:1+e,thinning:0,streamline:.62+(1+e)/8*.06,smoothing:.62,simulatePressure:!1,easing:Kt.linear});function Gk({strokeWidth:e,showAsComplete:n,isPen:t}){return{size:1+e,thinning:.1,streamline:.5,smoothing:.5,simulatePressure:!t,easing:t?Xk:Kt.easeOutSine,last:n}}function cm(e,n,t,r){return{...r?O2(n):e.dash==="draw"?e.isPen?LK(n):DK(n):O2(n),last:e.isComplete||t}}function di(e){const n=[];for(const t of e)if(t.type==="free"||t.points.length<2)n.push(...t.points.map(E.Cast));else{const r=Math.max(4,Math.floor(E.Dist(t.points[0],t.points[1])/16));n.push(...E.PointsBetween(t.points[0],t.points[1],r))}return n}function R2(e,n){return{draw:"none",solid:"none",dotted:`0.1 ${n*2}`,dashed:`${n*2} ${n*2}`}[e.props.dash]}class Iu extends eo{constructor(){super(...arguments);v(this,"hideResizeHandles",t=>Pd(t));v(this,"hideRotateHandle",t=>Pd(t));v(this,"hideSelectionBoundsBg",t=>Pd(t));v(this,"hideSelectionBoundsFg",t=>Pd(t));v(this,"isClosed",t=>t.props.isClosed);v(this,"onResize",(t,r)=>{const{scaleX:o,scaleY:s}=r,i=[];for(const a of t.props.segments)i.push({...a,points:a.points.map(({x:l,y:c,z:u})=>({x:gf(o*l),y:gf(s*c),z:u}))});return{props:{segments:i}}})}getDefaultProps(){return{segments:[],color:"black",fill:"none",dash:"draw",size:"m",isComplete:!1,isClosed:!1,isPen:!1}}getBounds(t){return ne.FromPoints(this.editor.getOutline(t))}getOutline(t){return di(t.props.segments)}getCenter(t){return this.editor.getBounds(t).center}hitTestPoint(t,r){const o=this.editor.getOutline(t),s=this.editor.zoomLevel,i=Ae[t.props.size]/s;if(t.props.segments.length===1&&t.props.segments[0].points.length<4&&t.props.segments[0].points.some(a=>E.Dist(r,a)<i*1.5))return!0;if(this.isClosed(t))return sr(r,o);if(this.editor.getBounds(t).containsPoint(r))for(let a=0;a<o.length;a++){const l=o[a],c=o[(a+1)%o.length];if(E.DistanceToLineSegment(l,c,r)<i)return!0}return!1}hitTestLineSegment(t,r,o){const s=this.editor.getOutline(t);if(t.props.segments.length===1&&t.props.segments[0].points.length<4){const i=this.editor.zoomLevel,a=Ae[t.props.size]/i;if(t.props.segments[0].points.some(l=>E.DistanceToLineSegment(r,o,l)<a*1.5))return!0}if(this.isClosed(t))for(let i=0;i<s.length;i++){const a=s[i],l=s[(i+1)%s.length];if(Gr(r,o,a,l))return!0}else for(let i=0;i<s.length-1;i++){const a=s[i],l=s[i+1];if(Gr(r,o,a,l))return!0}return!1}component(t){var h;const r=Dt(),o=Ci(),s=Ae[t.props.size],i=di(t.props.segments),a=t.props.isComplete||((h=en(t.props.segments))==null?void 0:h.type)==="straight";let l=s;!o&&!t.props.isPen&&t.props.dash==="draw"&&i.length===1&&(l+=Aa(t.id)()*(s/6));const c=cm(t.props,l,a,o),u=xs(i,c),d=u.length>1?mi(u,t.props.isClosed):um(i[0],l);if(!o&&t.props.dash==="draw"||u.length<2){Uc(u,c);const f=Fc(u,c);return g.jsxs(kn,{id:t.id,children:[g.jsx(St,{fill:t.props.isClosed?t.props.fill:"none",color:t.props.color,d}),g.jsx("path",{d:Vc(f,!0),strokeLinecap:"round",fill:r[t.props.color].solid})]})}return g.jsxs(kn,{id:t.id,children:[g.jsx(St,{color:t.props.color,fill:t.props.isClosed?t.props.fill:"none",d}),g.jsx("path",{d,strokeLinecap:"round",fill:"none",stroke:r[t.props.color].solid,strokeWidth:s,strokeDasharray:R2(t,s),strokeDashoffset:"0"})]})}indicator(t){var d;const r=Ci(),o=Ae[t.props.size],s=di(t.props.segments);let i=o;!r&&!t.props.isPen&&t.props.dash==="draw"&&s.length===1&&(i+=Aa(t.id)()*(o/6));const a=t.props.isComplete||((d=en(t.props.segments))==null?void 0:d.type)==="straight",l=cm(t.props,i,a,!0),c=xs(s,l),u=c.length>1?mi(c,t.props.isClosed):um(s[0],i);return g.jsx("path",{d:u})}toSvg(t,r){var m;const o=Sn(this.editor);r.addExportDef(q1(t.props.fill,o));const{color:s}=t.props,i=Ae[t.props.size],a=di(t.props.segments),l=t.props.isComplete||((m=en(t.props.segments))==null?void 0:m.type)==="straight";let c=i;!t.props.isPen&&t.props.dash==="draw"&&a.length===1&&(c+=Aa(t.id)()*(i/6));const u=cm(t.props,c,l,!1),d=xs(a,u),h=d.length>1?mi(d,t.props.isClosed):um(a[0],c);let f;if(t.props.dash==="draw"||d.length<2){Uc(d,u);const y=Fc(d,u),x=document.createElementNS("http://www.w3.org/2000/svg","path");x.setAttribute("d",Vc(y,!0)),x.setAttribute("fill",o[s].solid),x.setAttribute("stroke-linecap","round"),f=x}else{const y=document.createElementNS("http://www.w3.org/2000/svg","path");y.setAttribute("d",h),y.setAttribute("stroke",o[s].solid),y.setAttribute("fill","none"),y.setAttribute("stroke-linecap","round"),y.setAttribute("stroke-width",i.toString()),y.setAttribute("stroke-dasharray",R2(t,i)),y.setAttribute("stroke-dashoffset","0"),f=y}const p=to({fill:t.props.isClosed?t.props.fill:"none",d:h,color:t.props.color,theme:o});if(p){const y=document.createElementNS("http://www.w3.org/2000/svg","g");return y.appendChild(p),y.appendChild(f),y}return f}getCanvasSvgDefs(){return[Q1()]}expandSelectionOutlinePx(t){const r=t.props.dash==="draw"?1.6:1;return Ae[t.props.size]*r/2}}v(Iu,"type","draw");function um(e,n){const t=(n+1)*.5;return`M ${e.x} ${e.y} m -${t}, 0 a ${t},${t} 0 1,0 ${t*2},0 a ${t},${t} 0 1,0 -${t*2},0`}function Pd(e){return e.props.segments.length===1&&e.props.segments[0].points.length<2}function jK(){const[e,n]=w.useState(!1);return w.useEffect(()=>{const r=CSS.supports("color","color(display-p3 1 1 1)"),o=matchMedia("(color-gamut: p3)");n(r&&o.matches);const s=()=>n(r&&o.matches);return o.addEventListener("change",s),()=>o.removeEventListener("change",s)},[]),J(pt.forceSrgb)||!e?"srgb":"p3"}const D2=.35,L2=.82;class xp extends eo{constructor(){super(...arguments);v(this,"hideResizeHandles",t=>Ed(t));v(this,"hideRotateHandle",t=>Ed(t));v(this,"hideSelectionBoundsBg",t=>Ed(t));v(this,"hideSelectionBoundsFg",t=>Ed(t));v(this,"onResize",(t,r)=>{const{scaleX:o,scaleY:s}=r,i=[];for(const a of t.props.segments)i.push({...a,points:a.points.map(({x:l,y:c,z:u})=>({x:o*l,y:s*c,z:u}))});return{props:{segments:i}}})}getDefaultProps(){return{segments:[],color:"black",size:"m",isComplete:!1,isPen:!1}}getBounds(t){return ne.FromPoints(this.editor.getOutline(t))}getOutline(t){return di(t.props.segments)}getCenter(t){return this.editor.getBounds(t).center}hitTestPoint(t,r){const o=this.editor.getOutline(t),s=this.editor.zoomLevel,i=Zo(t)/s;if(t.props.segments.length===1&&t.props.segments[0].points.length<4&&t.props.segments[0].points.some(a=>E.Dist(r,a)<i*1.5))return!0;if(this.editor.getBounds(t).containsPoint(r))for(let a=0;a<o.length;a++){const l=o[a],c=o[(a+1)%o.length];if(E.DistanceToLineSegment(l,c,r)<i)return!0}return!1}hitTestLineSegment(t,r,o){const s=this.editor.getOutline(t);if(t.props.segments.length===1&&t.props.segments[0].points.length<4){const i=this.editor.zoomLevel,a=Zo(t)/i;if(t.props.segments[0].points.some(l=>E.DistanceToLineSegment(r,o,l)<a*1.5))return!0}for(let i=0;i<s.length-1;i++){const a=s[i],l=s[i+1];if(Gr(r,o,a,l))return!0}return!1}component(t){return g.jsx(j2,{strokeWidth:Zo(t),shape:t,opacity:D2})}backgroundComponent(t){return g.jsx(j2,{strokeWidth:Zo(t),shape:t,opacity:L2})}indicator(t){var d;const r=Ci(),o=Zo(t),s=di(t.props.segments);let i=o;!r&&!t.props.isPen&&s.length===1&&(i+=Aa(t.id)()*(o/6));const a=t.props.isComplete||((d=en(t.props.segments))==null?void 0:d.type)==="straight",l=Gk({strokeWidth:o,showAsComplete:a,isPen:t.props.isPen}),c=xs(s,l);let u;return c.length<2?u=zK(s[0],i):u=mi(c,!1),g.jsx("path",{d:u})}expandSelectionOutlinePx(t){return Zo(t)/2}toSvg(t){const r=Sn(this.editor);return N2(Zo(t),t,D2,r)}toBackgroundSvg(t){const r=Sn(this.editor);return N2(Zo(t),t,L2,r)}}v(xp,"type","highlight");function NK(e){return`M ${e.x} ${e.y} m -${.1}, 0 a ${.1},${.1} 0 1,0 ${.1*2},0 a ${.1},${.1} 0 1,0 -${.1*2},0`}function zK(e,n){const t=n/2;return`M ${e.x} ${e.y} m -${t}, 0 a ${t},${t} 0 1,0 ${t*2},0 a ${t},${t} 0 1,0 -${t*2},0`}function qk(e,n,t){var c;const r=di(e.props.segments),o=e.props.isComplete||((c=en(e.props.segments))==null?void 0:c.type)==="straight";let s=n;!t&&!e.props.isPen&&r.length===1&&(s+=Aa(e.id)()*(n/6));const i=Gk({strokeWidth:s,showAsComplete:o,isPen:e.props.isPen}),a=xs(r,i);return{solidStrokePath:a.length>1?mi(a,!1):NK(r[0]),sw:s}}function j2({strokeWidth:e,shape:n,opacity:t}){const r=Dt(),o=Ci(),{solidStrokePath:s,sw:i}=qk(n,e,o),a=jK(),l=r[n.props.color].highlight[a];return g.jsx(kn,{id:n.id,style:{opacity:t},children:g.jsx("path",{d:s,strokeLinecap:"round",fill:"none",pointerEvents:"all",stroke:l,strokeWidth:i})})}function N2(e,n,t,r){const{solidStrokePath:o,sw:s}=qk(n,e,!1),i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("d",o),i.setAttribute("fill","none"),i.setAttribute("stroke",r[n.props.color].highlight.srgb),i.setAttribute("stroke-width",`${s}`),i.setAttribute("opacity",`${t}`),i}function Zo(e){return us[e.props.size]*1.12}function Ed(e){return e.props.segments.length===1&&e.props.segments[0].points.length<2}class J1 extends re{constructor(){super(...arguments);v(this,"info",{});v(this,"initialShape");v(this,"shapeType",this.parent.id==="highlight"?xp:Iu);v(this,"util",this.editor.getShapeUtil(this.shapeType));v(this,"isPen",!1);v(this,"segmentMode","free");v(this,"didJustShiftClickToExtendPreviousShapeLine",!1);v(this,"pagePointWhereCurrentSegmentChanged",{});v(this,"pagePointWhereNextSegmentChanged",null);v(this,"lastRecordedPoint",{});v(this,"mergeNextPoint",!1);v(this,"currentLineLength",0);v(this,"canDraw",!1);v(this,"onEnter",t=>{this.info=t,this.canDraw=!this.editor.isMenuOpen,this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.canDraw&&this.startShape()});v(this,"onPointerMove",()=>{const{editor:{inputs:t}}=this;this.isPen!==t.isPen&&this.cancel(),!this.canDraw&&t.isDragging&&(this.startShape(),this.canDraw=!0),this.canDraw&&(t.isPen?E.Dist(t.currentPagePoint,this.lastRecordedPoint)>=1/this.editor.zoomLevel?(this.lastRecordedPoint=t.currentPagePoint.clone(),this.mergeNextPoint=!1):this.mergeNextPoint=!0:this.mergeNextPoint=!1,this.updateShapes())});v(this,"onKeyDown",t=>{if(t.key==="Shift")switch(this.segmentMode){case"free":{this.segmentMode="starting_straight",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break}case"starting_free":this.segmentMode="starting_straight"}this.updateShapes()});v(this,"onKeyUp",t=>{if(t.key==="Shift")switch(this.editor.snaps.clear(),this.segmentMode){case"straight":{this.segmentMode="starting_free",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break}case"starting_straight":{this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";break}}this.updateShapes()});v(this,"onExit",()=>{this.editor.snaps.clear(),this.pagePointWhereCurrentSegmentChanged=this.editor.inputs.currentPagePoint.clone()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()});v(this,"onInterrupt",()=>{this.editor.inputs.isDragging||(this.editor.bail(),this.cancel())})}canClose(){return this.shapeType.type!=="highlight"}getIsClosed(t,r){if(!this.canClose())return!1;const o=Ae[r],s=t[0].points[0],i=t[t.length-1],a=i.points[i.points.length-1];return s!==a&&this.currentLineLength>o*4&&E.Dist(s,a)<o*2}startShape(){const{inputs:{originPagePoint:t,isPen:r}}=this.editor;this.editor.mark("draw create start"),this.isPen=r;const o=this.isPen?this.info.point.z*1.25:.5;if(this.segmentMode=this.editor.inputs.shiftKey?"straight":"free",this.didJustShiftClickToExtendPreviousShapeLine=!1,this.lastRecordedPoint=t.clone(),this.initialShape){const i=this.editor.getShapeById(this.initialShape.id);if(i&&this.segmentMode==="straight"){this.didJustShiftClickToExtendPreviousShapeLine=!0;const a=en(i.props.segments);if(!a)throw Error("Expected a previous segment!");const l=en(a.points);if(!l)throw Error("Expected a previous point!");const{x:c,y:u}=this.editor.getPointInShapeSpace(i,t).toFixed(),d=this.isPen?this.info.point.z*1.25:.5,h={type:this.segmentMode,points:[{x:l.x,y:l.y,z:+d.toFixed(2)},{x:c,y:u,z:+d.toFixed(2)}]},f=Y.applyToPoint(this.editor.getPageTransformById(i.id),l);this.pagePointWhereCurrentSegmentChanged=f,this.pagePointWhereNextSegmentChanged=null;const p=[...i.props.segments,h];this.currentLineLength=this.getLineLength(p);const m={id:i.id,type:this.shapeType.type,props:{segments:p}};this.canClose()&&(m.props.isClosed=this.getIsClosed(p,i.props.size)),this.editor.updateShapes([m]);return}}this.pagePointWhereCurrentSegmentChanged=t.clone();const s=Ue();this.editor.createShapes([{id:s,type:this.shapeType.type,x:t.x,y:t.y,props:{isPen:this.isPen,segments:[{type:this.segmentMode,points:[{x:0,y:0,z:+o.toFixed(2)}]}]}}]),this.currentLineLength=0,this.initialShape=this.editor.getShapeById(s)}updateShapes(){const{inputs:t}=this.editor,{initialShape:r}=this;if(!r)return;const{id:o,props:{size:s}}=r,i=this.editor.getShapeById(o);if(!i)return;const{segments:a}=i.props,{x:l,y:c,z:u}=this.editor.getPointInShapeSpace(i,t.currentPagePoint).toFixed(),d={x:l,y:c,z:this.isPen?+(u*1.25).toFixed(2):.5};switch(this.segmentMode){case"starting_straight":{const{pagePointWhereNextSegmentChanged:h}=this;if(h===null)throw Error("We should have a point where the segment changed");if(E.Dist(h,t.currentPagePoint)>Wc){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="straight";const p=en(a);if(!p)throw Error("Expected a previous segment!");const m=en(p.points);if(!m)throw Error("Expected a previous last point!");let y;const x=this.editor.getPointInShapeSpace(i,this.pagePointWhereCurrentSegmentChanged).toFixed().toJson();if(p.type==="straight"){this.currentLineLength+=E.Dist(m,x),y={type:"straight",points:[{...m},x]};const b=this.editor.getPageTransform(i);this.pagePointWhereCurrentSegmentChanged=Y.applyToPoint(b,m)}else y={type:"straight",points:[x,d]};const S={id:o,type:this.shapeType.type,props:{segments:[...a,y]}};this.canClose()&&(S.props.isClosed=this.getIsClosed(a,s)),this.editor.updateShapes([S],!0)}break}case"starting_free":{const{pagePointWhereNextSegmentChanged:h}=this;if(h===null)throw Error("We should have a point where the segment changed");if(E.Dist(h,t.currentPagePoint)>Wc){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";const p=a.slice(),m=p[p.length-1],y=en(m.points);if(!y)throw Error("No previous point!");const x={type:"free",points:[...E.PointsBetween(y,d,6).map(P=>P.toFixed().toJson())]},S=[...p,x];this.currentLineLength=this.getLineLength(S);const b={id:o,type:this.shapeType.type,props:{segments:S}};this.canClose()&&(b.props.isClosed=this.getIsClosed(S,s)),this.editor.updateShapes([b],!0)}break}case"straight":{const h=a.slice(),f=h[h.length-1],{pagePointWhereCurrentSegmentChanged:p}=this,{currentPagePoint:m,ctrlKey:y}=this.editor.inputs;if(!p)throw Error("We should have a point where the segment changed");let x,S=!1;this.didJustShiftClickToExtendPreviousShapeLine?this.editor.inputs.isDragging&&(S=!y,this.didJustShiftClickToExtendPreviousShapeLine=!1):S=!y;let b=this.editor.getPointInShapeSpace(i,m).toFixed().toJson(),P=!1,C;if((this.editor.isSnapMode?!y:y)&&h.length>2){let k,T=8/this.editor.zoomLevel;for(let M=0,O=a.length-2;M<O;M++){const z=a[M];if(!z)break;if(z.type==="free")continue;const B=z.points[0],D=en(z.points);if(!(B&&D))continue;const F=E.NearestPointOnLineSegment(B,D,b),V=E.Dist(F,b);if(V<T){k=F.toFixed().toJson(),T=V,C=z;break}}k&&(P=!0,b=k)}if(P&&C){const k=this.editor.getPageTransform(i),T=C.points[0],M=en(C.points);if(!M)throw Error("Expected a last point!");const O=Y.applyToPoint(k,T),z=Y.applyToPoint(k,M),B=Y.applyToPoint(k,b);this.editor.snaps.setLines([{id:nt(),type:"points",points:[O,B,z]}])}else{if(this.editor.snaps.clear(),S){const k=E.Angle(p,m),M=pf(k,24)-k;x=E.RotWith(m,p,M)}else x=m;b=this.editor.getPointInShapeSpace(i,x).toFixed().toJson()}this.currentLineLength+=E.Dist(f.points[0],b),h[h.length-1]={...f,type:"straight",points:[f.points[0],b]};const I={id:o,type:this.shapeType.type,props:{segments:h}};this.canClose()&&(I.props.isClosed=this.getIsClosed(a,s)),this.editor.updateShapes([I],!0);break}case"free":{const h=a.slice(),f=h[h.length-1],p=[...f.points];if(p.length&&this.mergeNextPoint){const{z:y}=p[p.length-1];p[p.length-1]={x:d.x,y:d.y,z:y?Math.max(y,d.z):d.z}}else this.currentLineLength+=E.Dist(p[p.length-1],d),p.push(d);h[h.length-1]={...f,points:p},this.currentLineLength=this.getLineLength(h);const m={id:o,type:this.shapeType.type,props:{segments:h}};if(this.canClose()&&(m.props.isClosed=this.getIsClosed(h,s)),this.editor.updateShapes([m],!0),p.length>500){this.editor.updateShapes([{id:o,type:this.shapeType.type,props:{isComplete:!0}}]);const{currentPagePoint:y}=this.editor.inputs,x=Ue();this.editor.createShapes([{id:x,type:this.shapeType.type,x:gf(y.x),y:gf(y.y),props:{isPen:this.isPen,segments:[{type:"free",points:[{x:0,y:0,z:this.isPen?+(u*1.25).toFixed():.5}]}]}}]),this.initialShape=So(this.editor.getShapeById(x)),this.mergeNextPoint=!1,this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.currentLineLength=0}break}}}getLineLength(t){let r=0;for(const o of t)for(let s=0;s<o.points.length-1;s++){const i=o.points[s],a=o.points[s+1];r+=E.Sub(a,i).len2()}return Math.sqrt(r)}complete(){if(!this.canDraw){this.cancel();return}const{initialShape:t}=this;t&&(this.editor.updateShapes([{id:t.id,type:t.type,props:{isComplete:!0}}]),this.parent.transition("idle",{}))}cancel(){this.parent.transition("idle",this.info)}}v(J1,"id","drawing");var Vm;let Qk=(Vm=class extends re{constructor(){super(...arguments);v(this,"onPointerDown",t=>{this.parent.transition("drawing",t)});v(this,"onEnter",()=>{this.editor.setCursor({type:"cross"})});v(this,"onCancel",()=>{this.editor.setSelectedTool("select")})}},v(Vm,"id","idle"),Vm);class ch extends re{constructor(){super(...arguments);v(this,"shapeType",Iu);v(this,"onExit",()=>{const t=this.children.drawing;t.initialShape=void 0})}}v(ch,"id","draw"),v(ch,"initial","idle"),v(ch,"children",()=>[Qk,J1]);const BK=zn("draw",{util:Iu,props:U9,migrations:K9,tool:ch}),FK=zn("embed",{util:Is,props:V9,migrations:W9});var Wm;let UK=(Wm=class extends re{constructor(){super(...arguments);v(this,"onPointerDown",t=>{this.parent.transition("pointing",t)});v(this,"onEnter",()=>{this.editor.setCursor({type:"cross"})});v(this,"onCancel",()=>{this.editor.setSelectedTool("select")})}},v(Wm,"id","idle"),Wm);var Ym;let KK=(Ym=class extends re{constructor(){super(...arguments);v(this,"markId","creating");v(this,"wasFocusedOnEnter",!1);v(this,"onEnter",()=>{const{isMenuOpen:t}=this.editor;this.wasFocusedOnEnter=!t});v(this,"onPointerMove",t=>{if(this.editor.inputs.isDragging){const{originPagePoint:r}=this.editor.inputs,o=this.parent.shapeType.type,s=Ue();this.editor.mark(this.markId),this.editor.createShapes([{id:s,type:o,x:r.x,y:r.y,props:{w:1,h:1}}],!0),this.editor.setSelectedTool("select.resizing",{...t,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:this.parent.id})}});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()});v(this,"onInterrupt",()=>{this.cancel()})}complete(){const{originPagePoint:t}=this.editor.inputs;if(!this.wasFocusedOnEnter)return;this.editor.mark(this.markId);const r=this.parent.shapeType.type,o=Ue();this.editor.mark(this.markId),this.editor.createShapes([{id:o,type:r,x:t.x,y:t.y}]);const s=this.editor.getShapeById(o),{w:i,h:a}=this.editor.getShapeUtil(s).getDefaultProps(),l=this.editor.getDeltaInParentSpace(s,new E(i/2,a/2));this.editor.updateShapes([{id:o,type:r,x:s.x-l.x,y:s.y-l.y}]),this.editor.setSelectedIds([o]),this.editor.instanceState.isToolLocked?this.parent.transition("idle",{}):this.editor.setSelectedTool("select.idle")}cancel(){this.parent.transition("idle",{})}},v(Ym,"id","pointing"),Ym);class uh extends re{}v(uh,"id","box"),v(uh,"initial","idle"),v(uh,"children",()=>[UK,KK]);function z2({bounds:e,zoomLevel:n,className:t}){return g.jsx("g",{className:t,pointerEvents:"none",strokeLinecap:"round",strokeLinejoin:"round",children:e.sides.map((r,o)=>{const{strokeDasharray:s,strokeDashoffset:i}=rn(r[0].dist(r[1]),1/n,{style:"dashed",lengthRatio:4});return g.jsx("line",{x1:r[0].x,y1:r[0].y,x2:r[1].x,y2:r[1].y,strokeDasharray:s,strokeDashoffset:i},o)})})}const zf=class zf extends eo{constructor(){super(...arguments);v(this,"type","group");v(this,"hideSelectionBoundsBg",()=>!1);v(this,"hideSelectionBoundsFg",()=>!0);v(this,"canBind",()=>!1);v(this,"onChildrenChange",t=>{const r=this.editor.getSortedChildIds(t.id);if(r.length===0){this.editor.pageState.focusLayerId===t.id&&this.editor.popFocusLayer(),this.editor.deleteShapes([t.id]);return}else if(r.length===1){this.editor.pageState.focusLayerId===t.id&&this.editor.popFocusLayer(),this.editor.reparentShapesById(r,t.parentId),this.editor.deleteShapes([t.id]);return}})}getDefaultProps(){return{}}getBounds(t){const r=this.editor.getSortedChildIds(t.id);if(r.length===0)return new ne;const o=r.flatMap(s=>{const i=this.editor.getShapeById(s);return this.editor.getOutlineById(s).map(a=>Y.applyToPoint(this.editor.getTransform(i),a))});return ne.FromPoints(o)}getCenter(t){return this.editor.getBounds(t).center}getOutline(t){return this.editor.getBounds(t).corners}component(t){const{erasingIdsSet:r,pageState:{hintingIds:o,focusLayerId:s},zoomLevel:i}=this.editor,a=r.has(t.id),l=o.length>0&&o.some(u=>u!==t.id&&this.editor.isShapeOfType(this.editor.getShapeById(u),zf));if(!a&&(t.id!==s||l))return null;const c=this.editor.getBounds(t);return g.jsx(kn,{id:t.id,children:g.jsx(z2,{className:"tl-group",bounds:c,zoomLevel:i})})}indicator(t){const{camera:{z:r}}=this.editor,o=this.editor.getBounds(t);return g.jsx(z2,{className:"",bounds:o,zoomLevel:r})}};v(zf,"type","group");let Ye=zf;const HK=w.forwardRef(({id:e,name:n,isEditing:t},r)=>{const o=U(),s=w.useCallback(l=>{l.key==="Enter"&&(l.stopPropagation(),l.currentTarget.blur(),o.setEditingId(null))},[o]),i=w.useCallback(l=>{const c=o.getShapeById(e);if(!c)return;const u=c.props.name,d=l.currentTarget.value.trim();u!==d&&o.updateShapes([{id:e,type:"frame",props:{name:d}}],!0)},[e,o]),a=w.useCallback(l=>{const c=o.getShapeById(e);if(!c)return;const u=c.props.name,d=l.currentTarget.value;u!==d&&o.updateShapes([{id:e,type:"frame",props:{name:d}}],!0)},[e,o]);return g.jsxs("div",{className:`tl-frame-label ${t?"tl-frame-label__editing":""}`,children:[g.jsx("input",{className:"tl-frame-name-input",ref:r,style:{display:t?void 0:"none"},value:n,autoFocus:!0,onKeyDown:s,onBlur:i,onChange:a}),Rk(n,"Frame")+String.fromCharCode(8203)]})}),VK=function({id:n,name:t,width:r,height:o}){const s=U(),i=j1(s.getPageRotationById(n)),a=G1(n),l=w.useRef(null);w.useEffect(()=>{const f=l.current;f&&a&&(f.focus(),f.select(),requestAnimationFrame(()=>{document.activeElement!==f&&(f.focus(),f.select())}))},[l,a]);const u=((i+Math.PI/4)*(2/Math.PI)+4)%4,d=["top","left","bottom","right"][Math.floor(u)];let h;switch(d){case"top":h="";break;case"right":h=`translate(${R(r)}px, 0px) rotate(90deg)`;break;case"bottom":h=`translate(${R(r)}px, ${R(o)}px) rotate(180deg)`;break;case"left":h=`translate(0px, ${R(o)}px) rotate(270deg)`;break}return g.jsx("div",{className:"tl-frame-heading",style:{overflow:a?"visible":"hidden",maxWidth:`calc(var(--tl-zoom) * ${Math.ceil(d==="top"||d==="bottom"?r:o)}px + var(--space-5))`,bottom:Math.ceil(o),transform:`${h} scale(var(--tl-scale)) translateX(calc(-1 * var(--space-3))`},children:g.jsx("div",{className:"tl-frame-heading-hit-area",children:g.jsx(HK,{ref:l,id:n,name:t,isEditing:a})})})};class kt extends ll{constructor(){super(...arguments);v(this,"canBind",()=>!0);v(this,"canEdit",()=>!0);v(this,"canReceiveNewChildrenOfType",(t,r)=>!t.isLocked);v(this,"canDropShapes",(t,r)=>!t.isLocked);v(this,"onDragShapesOver",(t,r)=>r.every(o=>o.parentId===t.id)?{shouldHint:!1}:(this.editor.reparentShapesById(r.map(o=>o.id),t.id),{shouldHint:!0}));v(this,"onDragShapesOut",(t,r)=>{const o=this.editor.getShapeById(t.parentId);o&&this.editor.isShapeOfType(o,Ye)?this.editor.reparentShapesById(r.map(i=>i.id),o.id):this.editor.reparentShapesById(r.map(i=>i.id),this.editor.currentPageId)});v(this,"onResizeEnd",t=>{const r=this.editor.getPageBounds(t),o=this.editor.getSortedChildIds(t.id),s=[];for(const i of o){const a=this.editor.getPageBoundsById(i);r.includes(a)||s.push(i)}s.length>0&&this.editor.reparentShapesById(s,this.editor.currentPageId)})}getDefaultProps(){return{w:160*2,h:90*2,name:""}}component(t){const r=this.editor.getBounds(t),o=Dt();return g.jsxs(g.Fragment,{children:[g.jsxs(kn,{children:[g.jsx("rect",{className:"tl-hitarea-stroke",width:r.width,height:r.height}),g.jsx("rect",{className:"tl-frame__body",width:r.width,height:r.height,fill:o.solid,stroke:o.text})]}),g.jsx(VK,{id:t.id,name:t.props.name,width:r.width,height:r.height})]})}toSvg(t){const r=Sn(this.editor),o=document.createElementNS("http://www.w3.org/2000/svg","g"),s=document.createElementNS("http://www.w3.org/2000/svg","rect");s.setAttribute("width",t.props.w.toString()),s.setAttribute("height",t.props.h.toString()),s.setAttribute("fill",r.solid),s.setAttribute("stroke",r.black.solid),s.setAttribute("stroke-width","1"),s.setAttribute("rx","1"),s.setAttribute("ry","1"),o.appendChild(s);const l=((j1(this.editor.getPageRotationById(t.id))+Math.PI/4)*(2/Math.PI)+4)%4,c=["top","left","bottom","right"][Math.floor(l)];let u;switch(c){case"top":u="";break;case"right":u=`translate(${R(t.props.w)}px, 0px) rotate(90deg)`;break;case"bottom":u=`translate(${R(t.props.w)}px, ${R(t.props.h)}px) rotate(180deg)`;break;case"left":u=`translate(0px, ${R(t.props.h)}px) rotate(270deg)`;break;default:u=""}const d={fontSize:12,fontFamily:"Inter, sans-serif",textAlign:"start",width:t.props.w,height:32,padding:0,lineHeight:1,fontStyle:"normal",fontWeight:"normal",overflow:"truncate-ellipsis",verticalTextAlign:"middle"},h=this.editor.textMeasure.measureTextSpans(Rk(t.props.name,"Frame")+String.fromCharCode(8203),d),f=h[0],p=en(h),m=p.box.w+p.box.x-f.box.x,y=vp(this.editor,h,{offsetY:-d.height-2,...d});y.style.setProperty("transform",u);const x=document.createElementNS("http://www.w3.org/2000/svg","rect");return x.setAttribute("x","-8px"),x.setAttribute("y",-d.height-4+"px"),x.setAttribute("width",m+16+"px"),x.setAttribute("height",`${d.height}px`),x.setAttribute("rx","4px"),x.setAttribute("ry","4px"),x.setAttribute("fill",r.background),o.appendChild(x),o.appendChild(y),o}indicator(t){const r=this.editor.getBounds(t);return g.jsx("rect",{width:R(r.width),height:R(r.height),className:"tl-frame-indicator"})}providesBackgroundForChildren(){return!0}}v(kt,"type","frame");class T0 extends uh{constructor(){super(...arguments);v(this,"shapeType",kt)}}v(T0,"id","frame"),v(T0,"initial","idle");const WK=zn("frame",{util:kt,props:Y9,migrations:X9,tool:T0});function YK(e,n,t,r){if((e==="start-legacy"||e==="end-legacy")&&t.length!==0){const o=ne.From(t[0].box);for(const{box:s}of t)o.union(s);if(e==="start-legacy")return(r-2*n-o.width)/2;if(e==="end-legacy")return-(r-2*n-o.width)/2}}function XK(e){return e==="start-legacy"||e==="middle-legacy"||e==="end-legacy"}function Zk({bounds:e,editor:n,font:t,shape:r}){const s={fontSize:yi[r.props.size],fontFamily:t,textAlign:r.props.align,verticalTextAlign:r.props.verticalAlign,width:Math.ceil(e.width),height:Math.ceil(e.height),padding:16,lineHeight:At.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap",offsetX:0},i=n.textMeasure.measureTextSpans(r.props.text,s),a=YK(r.props.align,16,i,e.width);return a&&(s.offsetX=a),vp(n,i,s)}const Jk=oe.memo(function({id:n,type:t,text:r,size:o,labelColor:s,font:i,align:a,verticalAlign:l,wrap:c}){const{rInput:u,isEmpty:d,isEditing:h,isEditableFromHover:f,handleFocus:p,handleChange:m,handleKeyDown:y,handleBlur:x}=Z1(n,t,r),S=h||f,b=Ss.normalizeTextForDom(r),P=b.trim().length>0,C=XK(a),_=Dt();return g.jsx("div",{className:"tl-text-label","data-font":i,"data-align":a,"data-hastext":!d,"data-isediting":h,"data-textwrap":!!c,style:P||S?{justifyContent:a==="middle"||C?"center":a,alignItems:l==="middle"?"center":l}:void 0,children:g.jsxs("div",{className:"tl-text-label__inner",style:{fontSize:yi[o],lineHeight:yi[o]*At.lineHeight+"px",minHeight:d?yi[o]*At.lineHeight+32:0,minWidth:d?33:0,color:_[s].solid},children:[g.jsx("div",{className:"tl-text tl-text-content",dir:"ltr",children:b}),S?g.jsx("textarea",{ref:u,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:h,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:r,onFocus:p,onChange:m,onKeyDown:y,onBlur:x,onContextMenu:Vr}):null]})})}),GK=w.memo(function({w:n,h:t,strokeWidth:r,dash:o,color:s,fill:i}){const a=Dt(),l=n/2,c=t/2,u=Math.max(0,l-r/2),d=Math.max(0,c-r/2),h=Bc(u,d),{strokeDasharray:f,strokeDashoffset:p}=rn(h<64?h*2:h,r,{style:o,snap:4,closed:!0}),m=`M${l-u},${c}a${u},${d},0,1,1,${u*2},0a${u},${d},0,1,1,-${u*2},0`;return g.jsxs(g.Fragment,{children:[g.jsx(St,{d:m,color:s,fill:i}),g.jsx("path",{d:m,strokeWidth:r,width:R(n),height:R(t),fill:"none",stroke:a[s].solid,strokeDasharray:f,strokeDashoffset:p,pointerEvents:"all"})]})});function qK({w:e,h:n,strokeWidth:t,dash:r,color:o,theme:s,fill:i}){const a=e/2,l=n/2,c=Math.max(0,a-t/2),u=Math.max(0,l-t/2),d=Bc(c,u),{strokeDasharray:h,strokeDashoffset:f}=rn(d<64?d*2:d,t,{style:r,snap:4,closed:!0}),p=`M${a-c},${l}a${c},${u},0,1,1,${c*2},0a${c},${u},0,1,1,-${c*2},0`,m=document.createElementNS("http://www.w3.org/2000/svg","path");m.setAttribute("d",p),m.setAttribute("stroke-width",t.toString()),m.setAttribute("width",e.toString()),m.setAttribute("height",n.toString()),m.setAttribute("fill","none"),m.setAttribute("stroke",s[o].solid),m.setAttribute("stroke-dasharray",h),m.setAttribute("stroke-dashoffset",f);const y=to({d:p,fill:i,color:o,theme:s});return Fs(m,y)}function e$(e,n){if(n>e){const r=e/2;return`
    M0,${r}
    a${r},${r},0,1,1,${r*2},0
    L${e},${n-r}
    a${r},${r},0,1,1,-${r*2},0
    Z`}const t=n/2;return`
    M${t},0
    L${e-t},0
    a${t},${t},0,1,1,0,${t*2}
    L${t},${n}
    a${t},${t},0,1,1,0,${-t*2}
    Z`}function t$(e,n){if(e>n){const r=n/2;return Bc(r,r)+(e-r*2)*2}const t=e/2;return Bc(t,t)+(n-t*2)*2}const QK=w.memo(function({w:n,h:t,strokeWidth:r,dash:o,color:s,fill:i}){const a=Dt(),l=e$(n,t),c=t$(n,t),{strokeDasharray:u,strokeDashoffset:d}=rn(c<64?c*2:c,r,{style:o,snap:4,start:"outset",end:"outset",closed:!0});return g.jsxs(g.Fragment,{children:[g.jsx(St,{d:l,color:s,fill:i}),g.jsx("path",{d:l,strokeWidth:r,width:R(n),height:R(t),fill:"none",stroke:a[s].solid,strokeDasharray:u,strokeDashoffset:d,pointerEvents:"all"})]})});function B2({w:e,h:n,strokeWidth:t,dash:r,color:o,theme:s,fill:i}){const a=e$(e,n),l=t$(e,n),{strokeDasharray:c,strokeDashoffset:u}=rn(l<64?l*2:l,t,{style:r,snap:4,closed:!0}),d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d",a),d.setAttribute("stroke-width",t.toString()),d.setAttribute("width",e.toString()),d.setAttribute("height",n.toString()),d.setAttribute("fill","none"),d.setAttribute("stroke",s[o].solid),d.setAttribute("stroke-dasharray",c),d.setAttribute("stroke-dashoffset",u);const h=to({d:a,fill:i,color:o,theme:s});return Fs(d,h)}const ZK=w.memo(function({dash:n,fill:t,color:r,strokeWidth:o,outline:s,lines:i}){const a=Dt(),l="M"+s[0]+"L"+s.slice(1)+"Z";return g.jsxs(g.Fragment,{children:[g.jsx(St,{d:l,fill:t,color:r}),i&&i.map((c,u)=>g.jsx("path",{className:"tl-hitarea-stroke",fill:"none",d:`M${c[0].x},${c[0].y}L${c[1].x},${c[1].y}`},`line_bg_${u}`)),g.jsxs("g",{strokeWidth:o,stroke:a[r].solid,fill:"none",pointerEvents:"all",children:[Array.from(Array(s.length)).map((c,u)=>{const d=s[u],h=s[(u+1)%s.length],f=E.Dist(d,h),{strokeDasharray:p,strokeDashoffset:m}=rn(f,o,{style:n,start:"outset",end:"outset"});return g.jsx("line",{x1:d.x,y1:d.y,x2:h.x,y2:h.y,strokeDasharray:p,strokeDashoffset:m},u)}),i&&i.map(([c,u],d)=>{const h=E.Dist(c,u),{strokeDasharray:f,strokeDashoffset:p}=rn(h,o,{style:n,start:"skip",end:"outset",snap:n==="dotted"?4:void 0});return g.jsx("path",{d:`M${c.x},${c.y}L${u.x},${u.y}`,stroke:a[r].solid,strokeWidth:o,fill:"none",strokeDasharray:f,strokeDashoffset:p},`line_fg_${d}`)})]})]})});function JK({dash:e,fill:n,color:t,theme:r,strokeWidth:o,outline:s,lines:i}){const a=document.createElementNS("http://www.w3.org/2000/svg","g");if(a.setAttribute("stroke-width",o.toString()),a.setAttribute("stroke",r[t].solid),a.setAttribute("fill","none"),Array.from(Array(s.length)).forEach((c,u)=>{const d=s[u],h=s[(u+1)%s.length],f=E.Dist(d,h),{strokeDasharray:p,strokeDashoffset:m}=rn(f,o,{style:e}),y=document.createElementNS("http://www.w3.org/2000/svg","line");y.setAttribute("x1",d.x.toString()),y.setAttribute("y1",d.y.toString()),y.setAttribute("x2",h.x.toString()),y.setAttribute("y2",h.y.toString()),y.setAttribute("stroke-dasharray",p.toString()),y.setAttribute("stroke-dashoffset",m.toString()),a.appendChild(y)}),i)for(const[c,u]of i){const d=E.Dist(c,u),{strokeDasharray:h,strokeDashoffset:f}=rn(d,o,{style:e,start:"skip",end:"skip",snap:e==="dotted"?4:2}),p=document.createElementNS("http://www.w3.org/2000/svg","line");p.setAttribute("x1",c.x.toString()),p.setAttribute("y1",c.y.toString()),p.setAttribute("x2",u.x.toString()),p.setAttribute("y2",u.y.toString()),p.setAttribute("stroke-dasharray",h.toString()),p.setAttribute("stroke-dashoffset",f.toString()),a.appendChild(p)}const l=to({d:"M"+s[0]+"L"+s.slice(1)+"Z",fill:n,color:t,theme:r});return Fs(a,l)}w.memo(function({id:n,w:t,h:r,strokeWidth:o,fill:s,color:i}){const a=Dt(),l=ew(n,t,r,o),c=o$(n,t,r,o);return g.jsxs(g.Fragment,{children:[g.jsx(St,{d:l,color:i,fill:s}),g.jsx("path",{d:c,fill:a[i].solid,strokeWidth:0,pointerEvents:"all"})]})});function eH({id:e,w:n,h:t,strokeWidth:r,fill:o,color:s,theme:i}){const a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",o$(e,n,t,r)),a.setAttribute("fill",i[s].solid);const l=to({d:ew(e,n,t,r),fill:o,color:s,theme:i});return Fs(a,l)}function n$(e){return{size:1+e,thinning:.25,end:{taper:e},start:{taper:e},streamline:0,smoothing:1,simulatePressure:!1}}function r$(e,n,t,r){const o=Aa(e),s=n/2,i=t/2,a=Bc(s,i),l=[],c=qe*o(),u=qe+_e/2+Math.abs(o())*_e,d=Math.max(16,a/10);for(let h=0;h<d;h++){const f=h/(d-1),p=c+f*u,m=Math.cos(p),y=Math.sin(p);l.push(new E(s*m+n*.5+.05*o(),i*y+t/2+.05*o(),Math.min(1,.5+Math.abs(.5-(o()>0?Kt.easeInOutSine(f):Kt.easeInExpo(f)))/2)))}return xs(l,n$(r))}function o$(e,n,t,r){const o=n$(r);return Vc(Fc(Uc(r$(e,n,t,r),o),o))}function ew(e,n,t,r){return mi(r$(e,n,t,r))}const tH=w.memo(function({id:n,outline:t,lines:r,fill:o,color:s,strokeWidth:i}){const a=Dt(),l=Hc(n,t,i/3,i*2,2);let c=Kc(l);if(r)for(const[h,f]of r)c+=`M${h.x},${h.y}L${f.x},${f.y}`;const u=Hc(n,t,0,i*2,1),d=Kc(u);return g.jsxs(g.Fragment,{children:[g.jsx(St,{d,fill:o,color:s}),g.jsx("path",{d:c,stroke:a[s].solid,strokeWidth:i,fill:"none"})]})});function nH({id:e,outline:n,lines:t,fill:r,color:o,theme:s,strokeWidth:i}){const a=Hc(e,n,i/3,i*2,2);let l=Kc(a);if(t)for(const[f,p]of t)l+=`M${f.x},${f.y}L${p.x},${p.y}`;const c=Hc(e,n,0,i*2,1),u=Kc(c),d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d",l),d.setAttribute("fill","none"),d.setAttribute("stroke",s[o].solid),d.setAttribute("stroke-width",i.toString());const h=to({d:u,fill:r,color:o,theme:s});return Fs(d,h)}const F2=w.memo(function({w:n,h:t,strokeWidth:r,fill:o,color:s}){const i=Dt(),a=n/2,l=t/2,c=Math.max(0,a),u=Math.max(0,l),d=`M${a-c},${l}a${c},${u},0,1,1,${c*2},0a${c},${u},0,1,1,-${c*2},0`;return g.jsxs(g.Fragment,{children:[g.jsx(St,{d,color:s,fill:o}),g.jsx("path",{d,stroke:i[s].solid,strokeWidth:r,fill:"none"})]})});function rH({w:e,h:n,strokeWidth:t,fill:r,color:o,theme:s}){const i=e/2,a=n/2,l=Math.max(0,i),c=Math.max(0,a),u=`M${i-l},${a}a${l},${c},0,1,1,${l*2},0a${l},${c},0,1,1,-${l*2},0`,d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d",u),d.setAttribute("stroke-width",t.toString()),d.setAttribute("width",e.toString()),d.setAttribute("height",n.toString()),d.setAttribute("fill","none"),d.setAttribute("stroke",s[o].solid);const h=to({d:u,fill:r,color:o,theme:s});return Fs(d,h)}const U2=w.memo(function({w:n,h:t,strokeWidth:r,fill:o,color:s}){const i=Dt(),a=tw(n,t);return g.jsxs(g.Fragment,{children:[g.jsx(St,{d:a,color:s,fill:o}),g.jsx("path",{d:a,stroke:i[s].solid,strokeWidth:r,fill:"none"})]})});function oH({w:e,h:n,strokeWidth:t,fill:r,color:o,theme:s}){const i=tw(e,n),a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",i),a.setAttribute("stroke-width",t.toString()),a.setAttribute("width",e.toString()),a.setAttribute("height",n.toString()),a.setAttribute("fill","none"),a.setAttribute("stroke",s[o].solid);const l=to({d:i,fill:r,color:o,theme:s});return Fs(a,l)}function tw(e,n){let t;if(n>e){const r=e/2;t=`
    M0,${r}
    a${r},${r},0,1,1,${r*2},0
    L${e},${n-r}
    a${r},${r},0,1,1,-${r*2},0
    Z`}else{const r=n/2;t=`
    M${r},0
    L${e-r},0
    a${r},${r},0,1,1,0,${r*2}
    L${r},${n}
    a${r},${r},0,1,1,0,${-r*2}
    Z`}return t}const sH=w.memo(function({outline:n,lines:t,fill:r,color:o,strokeWidth:s}){const i=Dt();let a="M"+n[0]+"L"+n.slice(1)+"Z";if(t)for(const[l,c]of t)a+=`M${l.x},${l.y}L${c.x},${c.y}`;return g.jsxs(g.Fragment,{children:[g.jsx(St,{d:a,fill:r,color:o}),g.jsx("path",{d:a,stroke:i[o].solid,strokeWidth:s,fill:"none"})]})});function iH({outline:e,lines:n,fill:t,color:r,strokeWidth:o,theme:s}){const i="M"+e[0]+"L"+e.slice(1)+"Z",a=i;let l=i;if(n)for(const[d,h]of n)l+=`M${d.x},${d.y}L${h.x},${h.y}`;const c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d",l),c.setAttribute("stroke-width",o.toString()),c.setAttribute("stroke",s[r].solid),c.setAttribute("fill","none");const u=to({d:a,fill:t,color:r,theme:s});return Fs(c,u)}const dm=16,Vn=17*3;class cl extends ll{constructor(){super(...arguments);v(this,"canEdit",()=>!0);v(this,"onEditEnd",t=>{const{id:r,type:o,props:{text:s}}=t;s.trimEnd()!==t.props.text&&this.editor.updateShapes([{id:r,type:o,props:{text:s.trimEnd()}}])});v(this,"onResize",(t,{initialBounds:r,handle:o,newPoint:s,scaleX:i,scaleY:a})=>{let l=r.width*i,c=r.height*a,u=0,d=0;if(t.props.text.trim()){let m=Math.max(Math.abs(l),Vn),y=Math.max(Math.abs(c),Vn);m<Vn&&y===Vn&&(m=Vn),m===Vn&&y<Vn&&(y=Vn);const x=hm(this.editor,{...t,props:{...t.props,w:m,h:y}}),S=Math.max(Math.abs(l),x.w)*Math.sign(l),b=Math.max(Math.abs(c),x.h)*Math.sign(c);u=Math.abs(S)-Math.abs(l),d=Math.abs(b)-Math.abs(c),l=S,c=b}const h=new E(0,0);i<0&&(h.x+=l),(o==="left"||o==="top_left"||o==="bottom_left")&&(h.x+=i<0?u:-u),a<0&&(h.y+=c),(o==="top"||o==="top_left"||o==="top_right")&&(h.y+=a<0?d:-d);const{x:f,y:p}=h.rot(t.rotation).add(s);return{x:f,y:p,props:{w:Math.max(Math.abs(l),1),h:Math.max(Math.abs(c),1),growY:0}}});v(this,"onBeforeCreate",t=>{if(!t.props.text)return t.props.growY?{...t,props:{...t.props,growY:0}}:void 0;const r=t.props.h,o=hm(this.editor,t).h;let s=null;if(o>r?s=o-r:t.props.growY&&(s=0),s!==null)return{...t,props:{...t.props,growY:s}}});v(this,"onBeforeUpdate",(t,r)=>{const o=t.props.text.trimEnd(),s=r.props.text.trimEnd();if(o===s&&t.props.font===r.props.font&&t.props.size===r.props.size)return;if(o&&!s)return{...r,props:{...r.props,growY:0}};const i=t.props.w,a=t.props.h,l=hm(this.editor,r),c=l.w,u=l.h;if(!o&&s&&s.length===1){let h=Math.max(i,c),f=Math.max(a,u);return t.props.w<Vn&&t.props.h<Vn&&(h=Math.max(h,Vn),f=Math.max(f,Vn),h=Math.max(h,f),f=Math.max(h,f)),{...r,props:{...r.props,w:h,h:f,growY:0}}}let d=null;if(u>a?d=u-a:t.props.growY&&(d=0),d!==null)return{...r,props:{...r.props,growY:d,w:Math.max(r.props.w,c)}};if(c>t.props.w)return{...r,props:{...r.props,w:c}}});v(this,"onDoubleClick",t=>{if(this.editor.inputs.altKey)switch(t.props.geo){case"rectangle":return{...t,props:{geo:"check-box"}};case"check-box":return{...t,props:{geo:"rectangle"}}}})}getDefaultProps(){return{w:100,h:100,geo:"rectangle",color:"black",labelColor:"black",fill:"none",dash:"draw",size:"m",font:"draw",text:"",align:"middle",verticalAlign:"middle",growY:0,url:""}}hitTestLineSegment(t,r,o){const s=this.editor.getOutline(t);for(let a=0;a<s.length;a++){const l=s[a],c=s[(a+1)%s.length];if(Gr(r,o,l,c))return!0}const i=Nl(t.props,0);if(i!==void 0){for(const[a,l]of i)if(Gr(r,o,a,l))return!0}return!1}hitTestPoint(t,r){const o=this.editor.getOutline(t);if(t.props.fill==="none"){const s=this.editor.zoomLevel,i=Ae[t.props.size]/s;for(let l=0;l<o.length;l++){const c=o[l],u=o[(l+1)%o.length];if(E.DistanceToLineSegment(c,u,r)<i)return!0}const a=Nl(t.props,1);if(a!==void 0){for(const[l,c]of a)if(E.DistanceToLineSegment(l,c,r)<i)return!0}return!1}return sr(r,o)}getBounds(t){return new ne(0,0,t.props.w,t.props.h+t.props.growY)}getCenter(t){return new E(t.props.w/2,(t.props.h+t.props.growY)/2)}getOutline(t){const r=Math.max(1,t.props.w),o=Math.max(1,t.props.h+t.props.growY),s=r/2,i=o/2;switch(t.props.geo){case"triangle":return[new E(s,0),new E(r,o),new E(0,o)];case"diamond":return[new E(s,0),new E(r,i),new E(s,o),new E(0,i)];case"pentagon":return Jg(r,o,5);case"hexagon":return Jg(r,o,6);case"octagon":return Jg(r,o,8);case"ellipse":{const a=Math.pow(s-i,2)/Math.pow(s+i,2),l=Ge*(s+i)*(1+3*a/(10+Math.sqrt(4-3*a)));let c=Math.max(4,Math.ceil(l/10));c=Math.ceil(c/4)*4;const u=qe/c,d=Math.cos(u),h=Math.sin(u);let f=0,p=1,m=0,y=1;const x=Array(c);for(let S=0;S<c;S++)x[S]=new E(s+s*p,i+i*f),m=h*p+d*f,y=d*p-h*f,f=m,p=y;return x}case"oval":{const l=Array(20);if(o>r)for(let c=0;c<10;c++){const u=-Ge+Ge*c/8,d=Ge*c/(10-2);l[c]=new E(s+s*Math.cos(u),s+s*Math.sin(u)),l[c+10]=new E(s+s*Math.cos(d),o-s+s*Math.sin(d))}else for(let c=0;c<10;c++){const u=-_e+Ge*c/8,d=_e+Ge*-c/(10-2);l[c]=new E(r-i+i*Math.cos(u),o-i+i*Math.sin(u)),l[c+10]=new E(i-i*Math.cos(d),o-i+i*Math.sin(d))}return l}case"star":{const l=qe/5/2,c=Math.floor(5/4)*2,u=5*2-c,d=0,h=Math.floor(5/2)*2,f=Math.cos(-_e+c*l)*r/2,p=Math.cos(-_e+u*l)*r/2,m=Math.sin(-_e+d*l)*o/2,y=Math.sin(-_e+h*l)*o/2,x=r-Math.abs(f-p),S=o-Math.abs(y-m),b=r/2+p-(r/2-f),P=o/2+m-(o/2-y),C=1,_=(r-b)/2,I=(o-P)/2,k=(r+x)/2,T=(o+S)/2,M=k*C/2,O=T*C/2;return Array.from(Array(5*2)).map((z,B)=>{const D=-_e+B*l;return new E(_+(B%2?M:k)*Math.cos(D),I+(B%2?O:T)*Math.sin(D))})}case"rhombus":{const a=Math.min(r*.38,o*.38);return[new E(a,0),new E(r,0),new E(r-a,o),new E(0,o)]}case"rhombus-2":{const a=Math.min(r*.38,o*.38);return[new E(0,0),new E(r-a,0),new E(r,o),new E(a,o)]}case"trapezoid":{const a=Math.min(r*.38,o*.38);return[new E(a,0),new E(r-a,0),new E(r,o),new E(0,o)]}case"arrow-right":{const a=Math.min(r,o)*.38,l=o*.16;return[new E(0,l),new E(r-a,l),new E(r-a,0),new E(r,o/2),new E(r-a,o),new E(r-a,o-l),new E(0,o-l)]}case"arrow-left":{const a=Math.min(r,o)*.38,l=o*.16;return[new E(a,0),new E(a,l),new E(r,l),new E(r,o-l),new E(a,o-l),new E(a,o),new E(0,o/2)]}case"arrow-up":{const a=r*.16,l=Math.min(r,o)*.38;return[new E(r/2,0),new E(r,l),new E(r-a,l),new E(r-a,o),new E(a,o),new E(a,l),new E(0,l)]}case"arrow-down":{const a=r*.16,l=Math.min(r,o)*.38;return[new E(a,0),new E(r-a,0),new E(r-a,o-l),new E(r,o-l),new E(r/2,o),new E(0,o-l),new E(a,o-l)]}case"check-box":case"x-box":case"rectangle":return[new E(0,0),new E(r,0),new E(r,o),new E(0,o)]}}component(t){const{id:r,type:o,props:s}=t,i=Ci(),a=Ae[s.size],{w:l,color:c,labelColor:u,fill:d,dash:h,growY:f,font:p,align:m,verticalAlign:y,size:x,text:S}=s,b=()=>{const P=s.h+f;switch(s.geo){case"ellipse":{if(h==="solid"||h==="draw"&&i)return g.jsx(F2,{strokeWidth:a,w:l,h:P,color:c,fill:d});if(h==="dashed"||h==="dotted")return g.jsx(GK,{id:r,strokeWidth:a,w:l,h:P,dash:h==="dashed"?h:x==="s"&&i?"dashed":h,color:c,fill:d});if(h==="draw")return g.jsx(F2,{strokeWidth:a,w:l,h:P,color:c,fill:d});break}case"oval":{if(h==="solid"||h==="draw"&&i)return g.jsx(U2,{strokeWidth:a,w:l,h:P,color:c,fill:d});if(h==="dashed"||h==="dotted")return g.jsx(QK,{id:r,strokeWidth:a,w:l,h:P,dash:h==="dashed"?h:x==="s"&&i?"dashed":h,color:c,fill:d});if(h==="draw")return g.jsx(U2,{strokeWidth:a,w:l,h:P,color:c,fill:d});break}default:{const C=this.editor.getOutline(t),_=Nl(t.props,a);if(h==="solid"||h==="draw"&&i)return g.jsx(sH,{fill:d,color:c,strokeWidth:a,outline:C,lines:_});if(h==="dashed"||h==="dotted")return g.jsx(ZK,{dash:h==="dashed"?h:x==="s"&&i?"dashed":h,fill:d,color:c,strokeWidth:a,outline:C,lines:_});if(h==="draw")return g.jsx(tH,{id:r,fill:d,color:c,strokeWidth:a,outline:C,lines:_})}}};return g.jsxs(g.Fragment,{children:[g.jsx(kn,{id:r,children:b()}),g.jsx(Jk,{id:r,type:o,font:p,fill:d,size:x,align:m,verticalAlign:y,text:S,labelColor:u,wrap:!0}),t.props.url&&g.jsx(_u,{url:t.props.url,zoomLevel:this.editor.zoomLevel})]})}indicator(t){const{id:r,props:o}=t,{w:s,h:i,growY:a,size:l}=o,c=Ci(),u=Ae[l];switch(o.geo){case"ellipse":return o.dash==="draw"&&!c?g.jsx("path",{d:ew(r,s,i+a,u)}):g.jsx("ellipse",{cx:s/2,cy:(i+a)/2,rx:s/2,ry:(i+a)/2});case"oval":return g.jsx("path",{d:tw(s,i+a)});default:{const d=this.editor.getOutline(t);let h;if(o.dash==="draw"&&!c){const p=Hc(r,d,0,u*2,1);h=Kc(p)}else h="M"+d[0]+"L"+d.slice(1)+"Z";const f=Nl(t.props,u);if(f)for(const[p,m]of f)h+=`M${p.x},${p.y}L${m.x},${m.y}`;return g.jsx("path",{d:h})}}}toSvg(t,r){const{id:o,props:s}=t,i=Ae[s.size],a=Sn(this.editor);r.addExportDef(q1(t.props.fill,a));let l;switch(s.geo){case"ellipse":{switch(s.dash){case"draw":l=eH({id:o,w:s.w,h:s.h,color:s.color,fill:s.fill,strokeWidth:i,theme:a});break;case"solid":l=rH({strokeWidth:i,w:s.w,h:s.h,color:s.color,fill:s.fill,theme:a});break;default:l=qK({id:o,strokeWidth:i,w:s.w,h:s.h,dash:s.dash,color:s.color,fill:s.fill,theme:a});break}break}case"oval":{switch(s.dash){case"draw":l=B2({id:o,strokeWidth:i,w:s.w,h:s.h,dash:s.dash,color:s.color,fill:s.fill,theme:a});break;case"solid":l=oH({strokeWidth:i,w:s.w,h:s.h,color:s.color,fill:s.fill,theme:a});break;default:l=B2({id:o,strokeWidth:i,w:s.w,h:s.h,dash:s.dash,color:s.color,fill:s.fill,theme:a})}break}default:{const c=this.editor.getOutline(t),u=Nl(t.props,i);switch(s.dash){case"draw":l=nH({id:o,fill:s.fill,color:s.color,strokeWidth:i,outline:c,lines:u,theme:a});break;case"solid":l=iH({fill:s.fill,color:s.color,strokeWidth:i,outline:c,lines:u,theme:a});break;default:l=JK({dash:s.dash,fill:s.fill,color:s.color,strokeWidth:i,outline:c,lines:u,theme:a});break}break}}if(s.text){const c=this.editor.getBounds(t);r.addExportDef(wp(t.props.font));const u=Zk({editor:this.editor,shape:t,font:wu[t.props.font],bounds:c}),d=u.cloneNode(!0);d.setAttribute("fill",a[t.props.labelColor].solid),d.setAttribute("stroke","none");const h=u.cloneNode(!0);h.setAttribute("stroke-width","2"),h.setAttribute("fill",a.background),h.setAttribute("stroke",a.background);const f=document.createElementNS("http://www.w3.org/2000/svg","g");if(f.append(h),f.append(d),l.nodeName==="g")return l.appendChild(f),l;{const p=document.createElementNS("http://www.w3.org/2000/svg","g");return p.appendChild(l),p.appendChild(f),p}}return l}getCanvasSvgDefs(){return[Q1()]}}v(cl,"type","geo");function hm(e,n){const t=n.props.text.trimEnd();if(!t)return{w:0,h:0};const r=e.textMeasure.measureText("w",{...At,fontFamily:bo[n.props.font],fontSize:yi[n.props.size],width:"fit-content",maxWidth:"100px"}),o={s:2,m:3.5,l:5,xl:10},s=e.textMeasure.measureText(t,{...At,fontFamily:bo[n.props.font],fontSize:yi[n.props.size],width:"fit-content",minWidth:r.w+"px",maxWidth:Math.max(0,Math.ceil(r.w+o[n.props.size]),Math.ceil(n.props.w-dm*2))+"px"});return{w:s.w+dm*2,h:s.h+dm*2}}function Nl(e,n){switch(e.geo){case"x-box":return aH(e.w,e.h,n,e.dash);case"check-box":return lH(e.w,e.h);default:return}}function aH(e,n,t,r){const o=r==="draw"?.62:0;return r==="dashed"?[[new E(0,0),new E(e/2,n/2)],[new E(e,n),new E(e/2,n/2)],[new E(0,n),new E(e/2,n/2)],[new E(e,0),new E(e/2,n/2)]]:[[new E(t*o,t*o),new E(e-t*o,n-t*o)],[new E(t*o,n-t*o),new E(e-t*o,t*o)]]}function lH(e,n){const t=Math.min(e,n)*.82,r=(e-t)/2,o=(n-t)/2;return[[new E(r+t*.25,o+t*.52),new E(r+t*.45,o+t*.82)],[new E(r+t*.45,o+t*.82),new E(r+t*.82,o+t*.22)]]}var Xm;let cH=(Xm=class extends re{constructor(){super(...arguments);v(this,"onPointerDown",t=>{this.parent.transition("pointing",t)});v(this,"onEnter",()=>{this.editor.setCursor({type:"cross"})});v(this,"onKeyUp",t=>{if(t.key==="Enter"){const r=this.editor.onlySelectedShape;r&&this.editor.isShapeOfType(r,cl)&&(this.editor.mark("editing shape"),this.editor.setEditingId(r.id),this.editor.setSelectedTool("select.editing_shape",{...t,target:"shape",shape:r}))}});v(this,"onCancel",()=>{this.editor.setSelectedTool("select")})}},v(Xm,"id","idle"),Xm);var Gm;let uH=(Gm=class extends re{constructor(){super(...arguments);v(this,"onPointerMove",t=>{if(this.editor.inputs.isDragging){const{originPagePoint:r}=this.editor.inputs,o=Ue();this.editor.mark("creating"),this.editor.createShapes([{id:o,type:"geo",x:r.x,y:r.y,props:{w:1,h:1,geo:this.editor.getStyleForNextShape(Hr)}}]),this.editor.select(o),this.editor.setSelectedTool("select.resizing",{...t,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"geo"})}});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()});v(this,"onInterrupt",()=>{this.cancel()})}complete(){const{originPagePoint:t}=this.editor.inputs,r=Ue();this.editor.mark("creating"),this.editor.createShapes([{id:r,type:"geo",x:t.x,y:t.y,props:{geo:this.editor.getStyleForNextShape(Hr),w:1,h:1}}]);const o=this.editor.getShapeById(r);if(!o)return;const s=o.props.geo==="star"?CN(5,200,200):new ne(0,0,200,200),i=this.editor.getDeltaInParentSpace(o,s.center);this.editor.select(r),this.editor.updateShapes([{id:o.id,type:"geo",x:o.x-i.x,y:o.y-i.y,props:{geo:this.editor.getStyleForNextShape(Hr),w:s.width,h:s.height}}]),this.editor.instanceState.isToolLocked?this.parent.transition("idle",{}):this.editor.setSelectedTool("select",{})}cancel(){this.parent.transition("idle",{})}},v(Gm,"id","pointing"),Gm);class dh extends re{constructor(){super(...arguments);v(this,"shapeType",cl)}}v(dh,"id","geo"),v(dh,"initial","idle"),v(dh,"children",()=>[cH,uH]);const dH=zn("geo",{util:cl,props:G9,migrations:q9,tool:dh}),hH=zn("group",{util:Ye,props:Q9,migrations:Z9});class hh extends re{constructor(){super(...arguments);v(this,"shapeType",xp);v(this,"onExit",()=>{const t=this.children.drawing;t.initialShape=void 0})}}v(hh,"id","highlight"),v(hh,"initial","idle"),v(hh,"children",()=>[Qk,J1]);const fH=zn("highlight",{util:xp,props:J9,migrations:eN,tool:hh});function K2(e){const n=U();return J("isCropping",()=>n.croppingId===e,[n,e])}const pH=async e=>new Promise((n,t)=>{const r=new Image;r.onload=()=>n(r),r.onerror=()=>t(new Error("Failed to load image")),r.crossOrigin="anonymous",r.src=e}),gH=async e=>{const n=await pH(e),t=document.createElement("canvas");t.width=n.width,t.height=n.height;const r=t.getContext("2d");if(r)return r.drawImage(n,0,0),t.toDataURL()};async function mH(e){const t=await(await fetch(e)).blob();return new Promise((r,o)=>{const s=new FileReader;s.onloadend=()=>r(s.result),s.onerror=o,s.readAsDataURL(t)})}class nw extends ll{constructor(){super(...arguments);v(this,"isAspectRatioLocked",()=>!0);v(this,"canCrop",()=>!0);v(this,"onDoubleClick",t=>{const r=t.props.assetId?this.editor.getAssetById(t.props.assetId):void 0;!r||!(r.props.src&&"mimeType"in r.props&&r.props.mimeType==="image/gif")||this.editor.updateShapes([{type:"image",id:t.id,props:{playing:!t.props.playing}}])});v(this,"onDoubleClickEdge",t=>{const r=t.props;if(!r||this.editor.croppingId!==t.id)return;const o=yn(r.crop)||{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},s=1/(o.bottomRight.x-o.topLeft.x)*t.props.w,i=1/(o.bottomRight.y-o.topLeft.y)*t.props.h,a=new E(o.topLeft.x*s,o.topLeft.y*i).rot(t.rotation),l={id:t.id,type:t.type,x:t.x-a.x,y:t.y-a.y,props:{crop:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},w:s,h:i}};this.editor.updateShapes([l])})}getDefaultProps(){return{w:100,h:100,assetId:null,playing:!0,url:"",crop:null}}component(t){var p,m;const r=H2(t),o=K2(t.id),s=uk(),[i,a]=w.useState(""),{w:l,h:c}=t.props,u=t.props.assetId?this.editor.getAssetById(t.props.assetId):void 0;if((u==null?void 0:u.type)==="bookmark")throw Error("Bookmark assets can't be rendered as images");const h=J("onlySelectedShape",()=>{var y;return t.id===((y=this.editor.onlySelectedShape)==null?void 0:y.id)},[this.editor])&&o&&this.editor.isInAny("select.crop","select.cropping","select.pointing_crop_handle"),f=s&&(((p=u==null?void 0:u.props.mimeType)==null?void 0:p.includes("video"))||((m=u==null?void 0:u.props.mimeType)==null?void 0:m.includes("gif")));return w.useEffect(()=>{if(u!=null&&u.props.src&&"mimeType"in u.props&&(u==null?void 0:u.props.mimeType)==="image/gif"){let y=!1;return(async()=>{const S=await gH(u.props.src);y||S&&a(S)})(),()=>{y=!0}}},[s,u==null?void 0:u.props]),g.jsxs(g.Fragment,{children:[(u==null?void 0:u.props.src)&&h&&g.jsx("div",{style:r,children:g.jsx("div",{className:`tl-image tl-image-${t.id}-crop`,style:{opacity:.1,backgroundImage:`url(${!t.props.playing||f?i:u.props.src})`},draggable:!1})}),g.jsx(Ya,{id:t.id,style:{overflow:"hidden"},children:g.jsxs("div",{className:"tl-image-container",style:r,children:[u!=null&&u.props.src?g.jsx("div",{className:`tl-image tl-image-${t.id}`,style:{backgroundImage:`url(${!t.props.playing||f?i:u.props.src})`},draggable:!1}):g.jsx("g",{transform:`translate(${(l-38)/2}, ${(c-38)/2})`,children:g.jsx(fp,{})}),(u==null?void 0:u.props.isAnimated)&&!t.props.playing&&g.jsx("div",{className:"tl-image__tg",children:"GIF"})]})}),"url"in t.props&&t.props.url&&g.jsx(_u,{url:t.props.url,zoomLevel:this.editor.zoomLevel})]})}indicator(t){return K2(t.id)?null:g.jsx("rect",{width:R(t.props.w),height:R(t.props.h)})}async toSvg(t){const r=document.createElementNS("http://www.w3.org/2000/svg","g"),o=t.props.assetId?this.editor.getAssetById(t.props.assetId):null;let s=(o==null?void 0:o.props.src)||"";s&&s.startsWith("http")&&(s=await mH(s)||"");const i=document.createElementNS("http://www.w3.org/2000/svg","image");i.setAttributeNS("http://www.w3.org/1999/xlink","href",s);const a=H2(t),l=t.props.crop;if(a&&l){const{transform:c,width:u,height:d}=a,h=[new E(l.topLeft.x*u,l.topLeft.y*d),new E(l.bottomRight.x*u,l.topLeft.y*d),new E(l.bottomRight.x*u,l.bottomRight.y*d),new E(l.topLeft.x*u,l.bottomRight.y*d)],f=document.createElementNS("http://www.w3.org/2000/svg","g");f.style.clipPath=`polygon(${h.map(p=>`${p.x}px ${p.y}px`).join(",")})`,i.setAttribute("width",u.toString()),i.setAttribute("height",d.toString()),i.style.transform=c,f.appendChild(i),r.appendChild(f)}else i.setAttribute("width",t.props.w.toString()),i.setAttribute("height",t.props.h.toString()),r.appendChild(i);return r}}v(nw,"type","image");function H2(e){const n=e.props.crop,t=n==null?void 0:n.topLeft;if(!t)return;const r=1/(n.bottomRight.x-n.topLeft.x)*e.props.w,o=1/(n.bottomRight.y-n.topLeft.y)*e.props.h,s=-t.x*r,i=-t.y*o;return{transform:`translate(${s}px, ${i}px)`,width:r,height:o}}const yH=zn("image",{util:nw,props:nN,migrations:rN});function s$(e){const{segments:n}=e,t=[];for(let r=0,o=n.length;r<o;r++){const i=n[r].lut,a=i.length-1;r>0?t.push(E.Lrp(i[0],i[1],.25)):t.push(i[0]);for(let l=1;l<a;l++)t.push(i[l]);r<o-1?t.push(E.Lrp(i[a-1],i[a],.75)):t.push(i[a])}return t}function i$(e){return{size:e,thinning:.4,streamline:0,smoothing:.5,simulatePressure:!0,last:!0}}function a$(e,n,t){const r=s$(n),o=i$(t);return xs(r,o)}function vH(e,n,t){const r=i$(t);return Fc(Uc(a$(e,n,t),r),r)}function l$(e,n,t){const r=vH(e,n,t);return Vc(r)}function wH(e,n,t){if(e.props.dash==="draw"){const r=a$(e,n,t);return mi(r)}return n.path}function xH({shape:e,strokeWidth:n,spline:t,color:r}){const o=l$(e,t,n),s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("stroke-width","0"),s.setAttribute("stroke","none"),s.setAttribute("fill",r),s.setAttribute("d",o),s}function SH({dash:e,strokeWidth:n,spline:t,color:r}){const{segments:o}=t,s=document.createElementNS("http://www.w3.org/2000/svg","g");return s.setAttribute("stroke",r),s.setAttribute("stroke-width",n.toString()),o.forEach((i,a)=>{const l=document.createElementNS("http://www.w3.org/2000/svg","path"),{strokeDasharray:c,strokeDashoffset:u}=rn(i.length,n,{style:e,start:a>0?"outset":"none",end:a<o.length-1?"outset":"none"});l.setAttribute("stroke-dasharray",c.toString()),l.setAttribute("stroke-dashoffset",u.toString()),l.setAttribute("d",i.path),l.setAttribute("fill","none"),s.appendChild(l)}),s}function bH({strokeWidth:e,spline:n,color:t}){const{path:r}=n,o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("stroke-width",e.toString()),o.setAttribute("stroke",t),o.setAttribute("fill","none"),o.setAttribute("d",r),o}function PH(e,n,t,r){switch(e.props.dash){case"draw":return xH({shape:e,strokeWidth:r,spline:n,color:t});case"solid":return bH({strokeWidth:r,spline:n,color:t});default:return SH({strokeWidth:r,spline:n,dash:e.props.dash,color:t})}}const EH=new yp,_H=new yp;class Sp extends eo{constructor(){super(...arguments);v(this,"hideResizeHandles",()=>!0);v(this,"hideRotateHandle",()=>!0);v(this,"hideSelectionBoundsBg",()=>!0);v(this,"hideSelectionBoundsFg",()=>!0);v(this,"isClosed",()=>!1);v(this,"onResize",(t,r)=>{const{scaleX:o,scaleY:s}=r,i=yn(t.props.handles);return Object.values(t.props.handles).forEach(({id:a,x:l,y:c})=>{i[a].x=l*o,i[a].y=c*s}),{props:{handles:i}}});v(this,"onHandleChange",(t,{handle:r})=>{const o=yn(t);switch(r.id){case"start":case"end":{o.props.handles[r.id]={...o.props.handles[r.id],x:r.x,y:r.y};break}default:{const s="handle:"+r.index,i=t.props.handles[s];i?o.props.handles[s]={...i,x:r.x,y:r.y}:o.props.handles[s]={id:s,type:"vertex",canBind:!1,index:r.index,x:r.x,y:r.y};break}}return o})}getDefaultProps(){return{dash:"draw",size:"m",color:"black",spline:"line",handles:{start:{id:"start",type:"vertex",canBind:!1,index:"a1",x:0,y:0},end:{id:"end",type:"vertex",canBind:!1,index:"a2",x:0,y:0}}}}getBounds(t){return Zs(t).bounds}getHandles(t){return _H.get(t.props,()=>{const r=t.props.handles,o=Zs(t),s=Object.values(r).sort(un),i=s.slice();for(let a=0;a<o.segments.length;a++){const c=o.segments[a].midPoint,u=cc(s[a].index,s[a+1].index);i.push({id:`mid-${a}`,type:"create",index:u,x:c.x,y:c.y})}return i.sort(un)})}getOutline(t){return s$(Zs(t))}getOutlineSegments(t){const r=Zs(t);return t.props.spline==="cubic"?r.segments.map(o=>o.lut):r.segments.map(o=>[o.getPoint(0),o.getPoint(1)])}hitTestPoint(t,r){const o=this.editor.zoomLevel,s=Ae[t.props.size]/o;return IN(r,this.editor.getOutline(t),s)}hitTestLineSegment(t,r,o){return F1(r,o,this.editor.getOutline(t))!==null}component(t){const r=Dt(),o=Ci(),s=Zs(t),i=Ae[t.props.size],{dash:a,color:l}=t.props;if(t.props.spline==="line"){if(a==="solid"){const c=s.points,u="M"+c[0]+"L"+c.slice(1);return g.jsxs(kn,{id:t.id,children:[g.jsx(St,{d:u,fill:"none",color:l}),g.jsx("path",{d:u,stroke:r[l].solid,strokeWidth:i,fill:"none"})]})}if(a==="dashed"||a==="dotted"){const c=s.points,u="M"+c[0]+"L"+c.slice(1);return g.jsxs(kn,{id:t.id,children:[g.jsx(St,{d:u,fill:"none",color:l}),g.jsx("g",{stroke:r[l].solid,strokeWidth:i,children:s.segments.map((d,h)=>{const{strokeDasharray:f,strokeDashoffset:p}=rn(d.length,i,{style:a,start:h>0?"outset":"none",end:h<s.segments.length-1?"outset":"none"});return g.jsx("path",{strokeDasharray:f,strokeDashoffset:p,d:d.path,fill:"none"},h)})})]})}if(a==="draw"){const c=s.points,[u,d]=Yb(t.id,c,i);return g.jsxs(kn,{id:t.id,children:[g.jsx(St,{d:u,fill:"none",color:l}),g.jsx("path",{d,stroke:r[l].solid,strokeWidth:i,fill:"none"})]})}}if(t.props.spline==="cubic"){const c=s.path;if(a==="solid"||a==="draw"&&o)return g.jsxs(kn,{id:t.id,children:[g.jsx(St,{d:c,fill:"none",color:l}),g.jsx("path",{strokeWidth:i,stroke:r[l].solid,fill:"none",d:c})]});if(a==="dashed"||a==="dotted")return g.jsxs(kn,{id:t.id,children:[g.jsx(St,{d:c,fill:"none",color:l}),g.jsx("g",{stroke:r[l].solid,strokeWidth:i,children:s.segments.map((u,d)=>{const{strokeDasharray:h,strokeDashoffset:f}=rn(u.length,i,{style:a,start:d>0?"outset":"none",end:d<s.segments.length-1?"outset":"none"});return g.jsx("path",{strokeDasharray:h,strokeDashoffset:f,d:u.path,fill:"none"},d)})})]});if(a==="draw")return g.jsxs(kn,{id:t.id,children:[g.jsx(St,{d:c,fill:"none",color:l}),g.jsx("path",{d:l$(t,s,i),strokeWidth:1,stroke:r[l].solid,fill:r[l].solid})]})}}indicator(t){const r=Ae[t.props.size],o=Zs(t),{dash:s}=t.props;let i;if(t.props.spline==="line"){const a=o.points;if(s==="solid"||s==="dotted"||s==="dashed")i="M"+a[0]+"L"+a.slice(1);else{const[l]=Yb(t.id,a,r);i=l}}else i=wH(t,o,r);return g.jsx("path",{d:i})}toSvg(t){const o=Sn(this.editor)[t.props.color].solid,s=Zs(t);return PH(t,s,o,Ae[t.props.size])}}v(Sp,"type","line");function Zs(e){return EH.get(e.props,()=>{const{spline:n,handles:t}=e.props,r=Object.values(t).sort(un).map(E.From);switch(n){case"cubic":return new N1(r,r.length===2?2:1.2,20);case"line":return new z1(r)}})}var qm;let CH=(qm=class extends re{constructor(){super(...arguments);v(this,"shapeId","");v(this,"onEnter",t=>{this.shapeId=t.shapeId,this.editor.setCursor({type:"cross"})});v(this,"onPointerDown",()=>{this.parent.transition("pointing",{shapeId:this.shapeId})});v(this,"onCancel",()=>{this.editor.setSelectedTool("select")})}},v(qm,"id","idle"),qm);var Qm;let IH=(Qm=class extends re{constructor(){super(...arguments);v(this,"shape",{});v(this,"markPointId","");v(this,"onEnter",t=>{const{inputs:r}=this.editor,{currentPagePoint:o}=r;this.markPointId=this.editor.mark("creating");let s=!1;if(t.shapeId){const i=this.editor.getShapeById(t.shapeId);i&&(s=!0,this.shape=i)}if(r.shiftKey&&s){const i=this.editor.getHandles(this.shape);if(!i)return;const a=i.filter(p=>p.type==="vertex").sort(un),l=a[a.length-1],c=Y.applyToPoint(this.editor.getParentTransform(this.shape),new E(this.shape.x,this.shape.y));let u,d,h;a.length===2&&a[1].x===1&&a[1].y===1?(u=a[1].index,d=a[1].id,h={...a[1],x:o.x-c.x,y:o.y-c.y}):(u=po(l.index),d="handle:"+u,h={x:o.x-c.x,y:o.y-c.y,index:u,canBind:!1,type:"vertex",id:d});const f=So(this.shape.props.handles);f[h.id]=h,this.editor.updateShapes([{id:this.shape.id,type:this.shape.type,props:{handles:f}}])}else{const i=Ue();this.editor.createShapes([{id:i,type:"line",x:o.x,y:o.y}]),this.editor.select(i),this.shape=this.editor.getShapeById(i)}});v(this,"onPointerMove",()=>{if(this.shape&&this.editor.inputs.isDragging){const t=this.editor.getHandles(this.shape);if(!t)throw this.editor.bailToMark("creating"),Error("No handles found");this.editor.setSelectedTool("select.dragging_handle",{shape:this.shape,isCreating:!0,handle:en(t),onInteractionEnd:"line"})}});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()});v(this,"onInterrupt",()=>{this.parent.transition("idle",{}),this.editor.bailToMark("creating"),this.editor.snaps.clear()})}complete(){this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}cancel(){this.editor.bailToMark(this.markPointId),this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}},v(Qm,"id","pointing"),Qm);class fh extends re{constructor(){super(...arguments);v(this,"shapeType",Sp)}}v(fh,"id","line"),v(fh,"initial","idle"),v(fh,"children",()=>[CH,IH]);const kH=zn("line",{util:Sp,props:iN,migrations:aN,tool:fh}),Nr=200;class rw extends eo{constructor(){super(...arguments);v(this,"canEdit",()=>!0);v(this,"hideResizeHandles",()=>!0);v(this,"hideSelectionBoundsBg",()=>!0);v(this,"hideSelectionBoundsFg",()=>!0);v(this,"onBeforeCreate",t=>V2(this.editor,t,t.props.growY));v(this,"onBeforeUpdate",(t,r)=>{if(!(t.props.text===r.props.text&&t.props.font===r.props.font&&t.props.size===r.props.size))return V2(this.editor,r,t.props.growY)});v(this,"onEditEnd",t=>{const{id:r,type:o,props:{text:s}}=t;s.trimEnd()!==t.props.text&&this.editor.updateShapes([{id:r,type:o,props:{text:s.trimEnd()}}])})}getDefaultProps(){return{color:"black",size:"m",text:"",font:"draw",align:"middle",verticalAlign:"middle",growY:0,url:""}}getHeight(t){return Nr+t.props.growY}getBounds(t){const r=this.getHeight(t);return new ne(0,0,Nr,r)}getOutline(t){return this.editor.getBounds(t).corners}getCenter(t){return new E(Nr/2,this.getHeight(t)/2)}component(t){const{id:r,type:o,props:{color:s,font:i,size:a,align:l,text:c,verticalAlign:u}}=t,d=Dt(),h=s==="black"?"yellow":s;return g.jsxs(g.Fragment,{children:[g.jsx("div",{style:{position:"absolute",width:Nr,height:this.getHeight(t)},children:g.jsxs("div",{className:"tl-note__container tl-hitarea-fill",style:{color:d[h].solid,backgroundColor:d[h].solid},children:[g.jsx("div",{className:"tl-note__scrim"}),g.jsx(Jk,{id:r,type:o,font:i,size:a,align:l,verticalAlign:u,text:c,labelColor:"black",wrap:!0})]})}),"url"in t.props&&t.props.url&&g.jsx(_u,{url:t.props.url,zoomLevel:this.editor.zoomLevel})]})}indicator(t){return g.jsx("rect",{rx:"7",width:R(Nr),height:R(this.getHeight(t))})}toSvg(t,r){r.addExportDef(wp(t.props.font));const o=Sn(this.editor),s=this.getBounds(t),i=document.createElementNS("http://www.w3.org/2000/svg","g"),a=t.props.color==="black"?"yellow":t.props.color,l=document.createElementNS("http://www.w3.org/2000/svg","rect");l.setAttribute("rx","10"),l.setAttribute("width",Nr.toString()),l.setAttribute("height",s.height.toString()),l.setAttribute("fill",o[a].solid),l.setAttribute("stroke",o[a].solid),l.setAttribute("stroke-width","1"),i.appendChild(l);const c=document.createElementNS("http://www.w3.org/2000/svg","rect");c.setAttribute("rx","10"),c.setAttribute("width",Nr.toString()),c.setAttribute("height",s.height.toString()),c.setAttribute("fill",o.background),c.setAttribute("opacity",".28"),i.appendChild(c);const u=Zk({editor:this.editor,shape:t,font:wu[t.props.font],bounds:s});return u.setAttribute("fill",o.text),u.setAttribute("stroke","none"),i.appendChild(u),i}}v(rw,"type","note");function V2(e,n,t=0){const s=e.textMeasure.measureText(n.props.text,{...At,fontFamily:bo[n.props.font],fontSize:yi[n.props.size],width:Nr-34+"px"}).h+17*2;let i=null;if(s>Nr?i=s-Nr:t&&(i=0),i!==null)return{...n,props:{...n.props,growY:i}}}var Zm;let $H=(Zm=class extends re{constructor(){super(...arguments);v(this,"onPointerDown",t=>{this.parent.transition("pointing",t)});v(this,"onEnter",()=>{this.editor.setCursor({type:"cross"})});v(this,"onCancel",()=>{this.editor.setSelectedTool("select")})}},v(Zm,"id","idle"),Zm);var Jm;let TH=(Jm=class extends re{constructor(){super(...arguments);v(this,"dragged",!1);v(this,"info",{});v(this,"wasFocusedOnEnter",!1);v(this,"markPointId","creating");v(this,"onEnter",()=>{this.wasFocusedOnEnter=!this.editor.isMenuOpen});v(this,"onPointerMove",t=>{if(this.editor.inputs.isDragging){this.editor.mark(this.markPointId);const r=this.createShape();if(!r)return;this.editor.setSelectedTool("select.translating",{...t,target:"shape",shape:r,isCreating:!0,editAfterComplete:!0,onInteractionEnd:"note"})}});v(this,"onPointerUp",()=>{this.complete()});v(this,"onInterrupt",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()})}complete(){if(!this.wasFocusedOnEnter)return;this.editor.mark(this.markPointId);const t=this.createShape();if(this.editor.instanceState.isToolLocked)this.parent.transition("idle",{});else{if(!t)return;this.editor.setEditingId(t.id),this.editor.setSelectedTool("select.editing_shape",{...this.info,target:"shape",shape:t})}}cancel(){this.editor.bailToMark(this.markPointId),this.parent.transition("idle",this.info)}createShape(){const{inputs:{originPagePoint:t}}=this.editor,r=Ue();this.editor.createShapes([{id:r,type:"note",x:t.x,y:t.y}],!0);const o=this.editor.getShapeById(r),s=this.editor.getBounds(o);return this.editor.updateShapes([{id:r,type:"note",x:o.x-s.width/2,y:o.y-s.height/2}]),this.editor.getShapeById(r)}},v(Jm,"id","pointing"),Jm);class ph extends re{constructor(){super(...arguments);v(this,"shapeType",rw)}}v(ph,"id","note"),v(ph,"initial","idle"),v(ph,"children",()=>[$H,TH]);const MH=zn("note",{util:rw,props:lN,migrations:cN,tool:ph});var ey;let AH=(ey=class extends re{constructor(){super(...arguments);v(this,"onPointerEnter",t=>{switch(t.target){case"canvas":break;case"shape":{const{selectedIds:r,focusLayerId:o}=this.editor,s=this.editor.getOutermostSelectableShape(t.shape,i=>!r.includes(i.id));s.id!==o&&this.editor.isShapeOfType(s,Mr)&&this.editor.setHoveredId(s.id);break}}});v(this,"onPointerLeave",t=>{switch(t.target){case"shape":{this.editor.setHoveredId(null);break}}});v(this,"onPointerDown",t=>{const{hoveredId:r}=this.editor;if(r){const o=this.editor.getShapeById(r);if(this.editor.isShapeOfType(o,Mr)){requestAnimationFrame(()=>{this.editor.setSelectedIds([o.id]),this.editor.setEditingId(o.id),this.editor.setSelectedTool("select.editing_shape",{...t,target:"shape",shape:o})});return}}this.parent.transition("pointing",t)});v(this,"onEnter",()=>{this.editor.setCursor({type:"cross"})});v(this,"onKeyDown",t=>{if(t.key==="Enter"){const r=this.editor.selectedShapes[0];r&&this.editor.isShapeOfType(r,cl)&&(this.editor.setSelectedTool("select"),this.editor.setEditingId(r.id),this.editor.root.current.value.transition("editing_shape",{...t,target:"shape",shape:r}))}});v(this,"onCancel",()=>{this.editor.setSelectedTool("select")})}},v(ey,"id","idle"),ey);var ty;let OH=(ty=class extends re{constructor(){super(...arguments);v(this,"shape");v(this,"onExit",()=>{this.editor.setHintingIds([])});v(this,"onPointerMove",t=>{if(this.editor.inputs.isDragging){const{inputs:{originPagePoint:r}}=this.editor,o=Ue();if(this.editor.mark("creating"),this.editor.createShapes([{id:o,type:"text",x:r.x,y:r.y,props:{text:"",autoSize:!1,w:20}}]),this.editor.select(o),this.shape=this.editor.getShapeById(o),!this.shape)return;this.editor.setSelectedTool("select.resizing",{...t,target:"selection",handle:"right",isCreating:!0,creationCursorOffset:{x:1,y:1},editAfterComplete:!0,onInteractionEnd:"text"})}});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.cancel()});v(this,"onCancel",()=>{this.cancel()});v(this,"onInterrupt",()=>{this.cancel()})}complete(){var s;this.editor.mark("creating text shape");const t=Ue(),{x:r,y:o}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:t,type:"text",x:r,y:o,props:{text:"",autoSize:!0}}],!0),this.editor.setEditingId(t),this.editor.setSelectedTool("select"),(s=this.editor.root.current.value)==null||s.transition("editing_shape",{})}cancel(){this.parent.transition("idle",{}),this.editor.bailToMark("creating")}},v(ty,"id","pointing"),ty);class gh extends re{constructor(){super(...arguments);v(this,"shapeType",Mr)}}v(gh,"id","text"),v(gh,"initial","idle"),v(gh,"children",()=>[AH,OH]);const RH=zn("text",{util:Mr,props:uN,migrations:dN,tool:gh});class c$ extends ll{constructor(){super(...arguments);v(this,"canEdit",()=>!0);v(this,"isAspectRatioLocked",()=>!0)}getDefaultProps(){return{w:100,h:100,assetId:null,time:0,playing:!0,url:""}}component(t){return g.jsx(LH,{shape:t,videoUtil:this})}indicator(t){return g.jsx("rect",{width:R(t.props.w),height:R(t.props.h)})}toSvg(t){const r=document.createElementNS("http://www.w3.org/2000/svg","g"),o=document.createElementNS("http://www.w3.org/2000/svg","image");return o.setAttributeNS("http://www.w3.org/1999/xlink","href",DH(t.id)),o.setAttribute("width",t.props.w.toString()),o.setAttribute("height",t.props.h.toString()),r.appendChild(o),r}}v(c$,"type","video");function DH(e){const n=e.split(":")[1],t=document.querySelector(`.tl-video-shape-${n}`);if(t){const r=document.createElement("canvas");return r.width=t.videoWidth,r.height=t.videoHeight,r.getContext("2d").drawImage(t,0,0),r.toDataURL("image/png")}else throw new Error("Video with id "+n+" not found")}const LH=me(function(n){const{shape:t,videoUtil:r}=n,o=r.editor.getBounds(t).w*r.editor.zoomLevel>=110,s=t.props.assetId?r.editor.getAssetById(t.props.assetId):null,{w:i,h:a,time:l,playing:c}=t.props,u=G1(t.id),d=uk(),h=w.useRef(null),f=w.useCallback(b=>{const P=b.currentTarget;r.editor.updateShapes([{type:"video",id:t.id,props:{playing:!0,time:P.currentTime}}])},[t.id,r.editor]),p=w.useCallback(b=>{const P=b.currentTarget;r.editor.updateShapes([{type:"video",id:t.id,props:{playing:!1,time:P.currentTime}}])},[t.id,r.editor]),m=w.useCallback(b=>{const P=b.currentTarget;u&&r.editor.updateShapes([{type:"video",id:t.id,props:{time:P.currentTime}}])},[u,t.id,r.editor]),[y,x]=w.useState(!1),S=w.useCallback(b=>{const P=b.currentTarget;l!==P.currentTime&&(P.currentTime=l),c||P.pause(),x(!0)},[c,l]);return w.useEffect(()=>{const b=h.current;b&&y&&!u&&l!==b.currentTime&&(b.currentTime=l)},[u,y,l]),w.useEffect(()=>{if(d){const b=h.current;b.pause(),b.currentTime=0}},[h,d]),g.jsxs(g.Fragment,{children:[g.jsx(Ya,{id:t.id,children:g.jsx("div",{className:"tl-counter-scaled",children:s!=null&&s.props.src?g.jsx("video",{ref:h,className:`tl-video tl-video-shape-${t.id.split(":")[1]} tl-hitarea-stroke`,width:"100%",height:"100%",draggable:!1,playsInline:!0,autoPlay:!0,muted:!0,loop:!0,disableRemotePlayback:!0,disablePictureInPicture:!0,controls:u&&o,onPlay:f,onPause:p,onTimeUpdate:m,onLoadedData:S,hidden:!y,children:g.jsx("source",{src:s.props.src})}):g.jsx("g",{transform:`translate(${(i-38)/2}, ${(a-38)/2})`,children:g.jsx(fp,{})})})}),"url"in t.props&&t.props.url&&g.jsx(_u,{url:t.props.url,zoomLevel:r.editor.zoomLevel})]})}),jH=zn("video",{util:c$,props:hN,migrations:fN}),u$=[hH,FK,RK,yH,RH],NH=[BK,dH,kH,MH,WK,MK,fH,jH],zH=new Set(u$.map(e=>e.type));function d$(e){const n=[...u$],t=new Set;for(const r of e){if(zH.has(r.type))throw new Error(`Shape type "${r.type}" is a core shapes type and cannot be overridden`);if(t.has(r.type))throw new Error(`Shape type "${r.type}" is defined more than once`);n.push(r),t.add(r.type)}return n}function W2(e,n){if(!n)return!1;switch(e.type){case"mixed":return n.type==="mixed";case"shared":return n.type==="shared"&&e.value===n.value;default:throw P1(e)}}class BH{constructor(n){v(this,"map");this.map=new Map(n)}get(n){return this.map.get(n)}getAsKnownValue(n){const t=this.get(n);if(t&&t.type!=="mixed")return t.value}get size(){return this.map.size}equals(n){if(this.size!==n.size)return!1;const t=new Set;for(const[r,o]of this){if(!W2(o,n.get(r)))return!1;t.add(r)}for(const[r,o]of n)if(!t.has(r)&&!W2(o,this.get(r)))return!1;return!0}keys(){return this.map.keys()}values(){return this.map.values()}entries(){return this.map.entries()}[Symbol.iterator](){return this.map[Symbol.iterator]()}}class M0 extends BH{set(n,t){this.map.set(n,t)}applyValue(n,t){const r=this.get(n);if(!r){this.set(n,{type:"shared",value:t});return}switch(r.type){case"mixed":return;case"shared":r.value!==t&&this.set(n,{type:"mixed"});return;default:P1(r,"type")}}}function Y2(e,n){let t=0;for(;e[n+t];)t+=e[n+t]+1;return t+1}function FH(e){return new TextDecoder("ascii").decode(e.slice(0,3))==="GIF"}function UH(e){const n=new Uint8Array(e);let t,r,o=0,s=0;if(!FH(e))return!1;for(t=n[10]&128,r=n[10]&7,o+=6,o+=7,o+=t?3*Math.pow(2,r+1):0;s<2&&o<n.length;)switch(n[o]){case 44:s+=1,t=n[o+9]&128,r=n[o+9]&7,o+=10,o+=t?3*Math.pow(2,r+1):0,o+=Y2(n,o+1)+1;break;case 33:o+=2,o+=Y2(n,o);break;case 59:o=n.length;break;default:o=n.length;break}return s>1}let A0=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(A0=new Int32Array(A0));const KH=(e,n)=>{let t=n===0?0:~~n^-1;for(let r=0;r<e.length;r++)t=A0[(t^e[r])&255]^t>>>8;return t^-1};function h$(e,n){return e.getUint8(n+0)===137&&e.getUint8(n+1)===80&&e.getUint8(n+2)===78&&e.getUint8(n+3)===71&&e.getUint8(n+4)===13&&e.getUint8(n+5)===10&&e.getUint8(n+6)===26&&e.getUint8(n+7)===10}function HH(e,n){return[String.fromCharCode(e.getUint8(n)),String.fromCharCode(e.getUint8(n+1)),String.fromCharCode(e.getUint8(n+2)),String.fromCharCode(e.getUint8(n+3))].join("")}const X2=4,G2=4;function VH(e,n=0){const t={};if(!h$(e,n))throw new Error("Not a PNG");for(n+=8;n<=e.buffer.byteLength;){const r=n,o=e.getInt32(n);n+=4;const s=HH(e,n);if(s==="IDAT"&&t[s]){n+=o+X2+G2;continue}if(s==="IEND")break;t[s]={start:r,dataOffset:n+4,size:o},n+=o+X2+G2}return t}function WH(e,n){return{ppux:e.getUint32(n),ppuy:e.getUint32(n+4),unit:e.getUint8(n+4)}}function O0(e,n){return VH(e)[n]}function YH(e,n=1,t){let r=46,o=0;const s=O0(e,"pHYs");s&&(r=s.start,o=s.size);const i=O0(e,"IDAT");i&&(r=i.start,o=0);const a=new ArrayBuffer(21),l=new DataView(a);l.setUint32(0,9),l.setUint8(4,"p".charCodeAt(0)),l.setUint8(5,"H".charCodeAt(0)),l.setUint8(6,"Y".charCodeAt(0)),l.setUint8(7,"s".charCodeAt(0));const c=2835.5;l.setInt32(8,c*n),l.setInt32(12,c*n),l.setInt8(16,1);const u=new Uint8Array(a.slice(4,17));l.setInt32(17,KH(u));const d=e.buffer.slice(0,r),h=e.buffer.slice(r+o);return new Blob([d,a,h],t)}const ow=["image/jpeg","image/png","image/gif","image/svg+xml"],f$=["video/mp4","video/quicktime"],XH=ow.concat(f$).join(", "),p$=e=>ow.includes(e);async function GH(e){return await new Promise((n,t)=>{const r=document.createElement("video");r.onloadeddata=()=>n({w:r.videoWidth,h:r.videoHeight}),r.onerror=o=>{console.error(o),t(new Error("Could not get video size"))},r.crossOrigin="anonymous",r.src=e})}async function qH(e){return fetch(e).then(function(n){return n.arrayBuffer()})}async function QH(e){return await new Promise((n,t)=>{const r=new Image;r.onload=async()=>{try{const o=await qH(e),s=new DataView(o);if(h$(s,0)){const i=O0(s,"pHYs");if(i){const a=WH(s,i.dataOffset);if(a.unit===0&&a.ppux===a.ppuy){const l=Math.round(a.ppux/2834.5);n({w:r.width/l,h:r.height/l});return}}}n({w:r.width,h:r.height})}catch(o){console.error(o),n({w:r.width,h:r.height})}},r.onerror=o=>{console.error(o),t(new Error("Could not get image size"))},r.crossOrigin="anonymous",r.src=e})}async function ZH(e,n,t){return await new Promise(r=>{const o=new Image;o.onload=()=>{const s=document.createElement("canvas"),i=s.getContext("2d");if(!i)return;s.width=n*2,s.height=t*2,i.drawImage(o,0,0,s.width,s.height);const a=s.toDataURL();r(a)},o.crossOrigin="anonymous",o.src=e})}async function JH(e){return e.type==="image/gif"?await new Promise((n,t)=>{const r=new FileReader;r.onerror=()=>t(r.error),r.onload=()=>{n({isAnimated:r.result?UH(r.result):!1})},r.readAsArrayBuffer(e)}):{isAnimated:!p$(e.type)}}function eV(e,n){const t=e.w/n.w,r=e.h/n.h;return t<=1&&r<=1?e:t>r?{w:e.w/t,h:e.h/t}:{w:e.w/r,h:e.h/r}}const tV=e=>{try{const n=new URL(e);return n.protocol==="http:"||n.protocol==="https:"}catch{return!1}},nV=e=>{const n=e.split(/[\n\s]/);for(const t of n)try{const r=new URL(t);if(!(r.protocol==="http:"||r.protocol==="https:"))return}catch{return}return $k(n)},rV=e=>/^<svg/.test(e);function oV(e,n,t){return fetch(e).then(function(r){return r.arrayBuffer()}).then(function(r){return new File([r],n,{type:t})})}function g$({editor:e}){const{selectionRotation:n,selectionPageCenter:t,inputs:{originPagePoint:r},selectedShapes:o}=e;return t?{selectionPageCenter:t,initialCursorAngle:t.angle(r),initialSelectionRotation:n,shapeSnapshots:o.map(s=>({shape:So(s),initialPagePoint:e.getPagePointById(s.id)}))}:null}function mh({delta:e,editor:n,snapshot:t,stage:r}){const{selectionPageCenter:o,shapeSnapshots:s}=t;n.updateShapes(s.map(({shape:a,initialPagePoint:l})=>{const c=Wn(a.parentId)?n.getPageTransformById(a.parentId):Y.Identity(),u=E.RotWith(l,o,e),d=Y.applyToPoint(Y.Inverse(c),u),h=j1(a.rotation+e);return{id:a.id,type:a.type,x:d.x,y:d.y,rotation:h}}));const i=[];s.forEach(({shape:a})=>{var d,h,f;const l=n.getShapeById(a.id);if(!l)return;const c=n.getShapeUtil(a);if(r==="start"||r==="one-off"){const p=(d=c.onRotateStart)==null?void 0:d.call(c,a);p&&i.push(p)}const u=(h=c.onRotate)==null?void 0:h.call(c,a,l);if(u&&i.push(u),r==="end"||r==="one-off"){const p=(f=c.onRotateEnd)==null?void 0:f.call(c,a,l);p&&i.push(p)}}),i.length>0&&n.updateShapes(i)}const sV=e=>{const{store:n}=e,t=n.query.filterHistory("shape"),r=n.query.records("shape",()=>({type:{eq:"arrow"}}));function o(){const s=r.value,i={};for(const a of s){const{start:l,end:c}=a.props;if(l.type==="binding"){const u=i[l.boundShapeId];u?u.push({arrowId:a.id,handleId:"start"}):i[l.boundShapeId]=[{arrowId:a.id,handleId:"start"}]}if(c.type==="binding"){const u=i[c.boundShapeId];u?u.push({arrowId:a.id,handleId:"end"}):i[c.boundShapeId]=[{arrowId:a.id,handleId:"end"}]}}return i}return G("arrowBindingsIndex",(s,i)=>{if(Ma(s))return o();const a=s,l=t.getDiffSince(i);if(l===Rn)return o();let c;function u(f){c||(c={...a}),c[f]?c[f]===a[f]&&(c[f]=[...c[f]]):c[f]=[]}function d(f,p,m){u(f),c[f]=c[f].filter(y=>y.arrowId!==p||y.handleId!==m),c[f].length===0&&delete c[f]}function h(f,p,m){u(f),c[f].push({arrowId:p,handleId:m})}for(const f of l){for(const p of Object.values(f.added))if(e.isShapeOfType(p,Fe)){const{start:m,end:y}=p.props;m.type==="binding"&&h(m.boundShapeId,p.id,"start"),y.type==="binding"&&h(y.boundShapeId,p.id,"end")}for(const[p,m]of Object.values(f.updated))if(!(!e.isShapeOfType(p,Fe)||!e.isShapeOfType(m,Fe)))for(const y of["start","end"]){const x=p.props[y],S=m.props[y];x.type==="binding"&&S.type==="point"?d(x.boundShapeId,p.id,y):x.type==="point"&&S.type==="binding"?h(S.boundShapeId,m.id,y):x.type==="binding"&&S.type==="binding"&&x.boundShapeId!==S.boundShapeId&&(d(x.boundShapeId,p.id,y),h(S.boundShapeId,m.id,y))}for(const p of Object.values(f.removed))if(e.isShapeOfType(p,Fe)){const{start:m,end:y}=p.props;m.type==="binding"&&d(m.boundShapeId,p.id,"start"),y.type==="binding"&&d(y.boundShapeId,p.id,"end")}}return c??a})},iV=e=>{const n=e.query.ids("shape");function t(){const r={};return n.value.forEach(o=>{const s=e.get(o);r[s.parentId]||(r[s.parentId]=[]),r[s.parentId].push([o,s.index])}),Object.values(r).forEach(o=>o.sort((s,i)=>s[1]<i[1]?-1:1)),r}return G("parentsToChildrenWithIndexes",(r,o)=>{if(Ma(r))return t();const s=e.history.getDiffSince(o);if(s===Rn)return t();if(s.length===0)return r;let i=null;const a=u=>{i||(i={...r}),i[u]?i[u]===r[u]&&(i[u]=[...i[u]]):i[u]=[]},l=new Set;let c;for(let u=0,d=s.length;u<d;u++){c=s[u];for(const h of Object.values(c.added))ci(h)&&(a(h.parentId),i[h.parentId].push([h.id,h.index]),l.add(i[h.parentId]));for(const[h,f]of Object.values(c.updated))if(ci(f)&&ci(h)){if(h.parentId!==f.parentId)a(h.parentId),a(f.parentId),i[h.parentId].splice(i[h.parentId].findIndex(p=>p[0]===f.id),1),i[f.parentId].push([f.id,f.index]),l.add(i[f.parentId]);else if(h.index!==f.index){a(f.parentId);const p=i[f.parentId].findIndex(m=>m[0]===f.id);i[f.parentId][p]=[f.id,f.index],l.add(i[f.parentId])}}for(const h of Object.values(c.removed))ci(h)&&(a(h.parentId),i[h.parentId].splice(i[h.parentId].findIndex(f=>f[0]===h.id),1))}for(const u of l)u.sort((d,h)=>d[1]<h[1]?-1:1);return i??r})},fm=(e,n,t)=>{for(;!Qt(t.parentId);){const r=e.get(t.parentId);if(!r)return!1;t=r}return t.parentId===n},aV=(e,n)=>{const t=e.query.ids("shape");let r=null;function o(){const s=n();return r=s,new Set([...t.value].filter(i=>fm(e,s,e.get(i))))}return G("_shapeIdsInCurrentPage",(s,i)=>{if(Ma(s))return o();const a=n();if(a!==r)return o();const l=e.history.getDiffSince(i);if(l===Rn)return o();const c=new oh(s);for(const d of l){for(const h of Object.values(d.added))ci(h)&&fm(e,a,h)&&c.add(h.id);for(const[h,f]of Object.values(d.updated))ci(f)&&(fm(e,a,f)?c.add(f.id):c.remove(f.id));for(const h of Object.keys(d.removed))Wn(h)&&c.remove(h)}const u=c.get();return u?ql(u.value,u.diff):s})},lV=40;class cV{constructor(n){v(this,"_clickId","");v(this,"_clickTimeout");v(this,"_clickScreenPoint");v(this,"_previousScreenPoint");v(this,"_getClickTimeout",(n,t=nt())=>{this._clickId=t,clearTimeout(this._clickTimeout),this._clickTimeout=setTimeout(()=>{if(this._clickState===n&&this._clickId===t){switch(this._clickState){case"pendingTriple":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"double_click",phase:"settle"});break}case"pendingQuadruple":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"triple_click",phase:"settle"});break}case"pendingOverflow":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"settle"});break}}this._clickState="idle"}},n==="idle"||n==="pendingDouble"?lz:cz)});v(this,"_clickState","idle");v(this,"lastPointerInfo",{});v(this,"transformPointerDownEvent",n=>{if(!this._clickState)return n;switch(this._clickScreenPoint=E.From(n.point),this._previousScreenPoint&&this._previousScreenPoint.dist(this._clickScreenPoint)>lV&&(this._clickState="idle"),this._previousScreenPoint=this._clickScreenPoint,this.lastPointerInfo=n,this._clickState){case"idle":return this._clickState="pendingDouble",this._clickTimeout=this._getClickTimeout(this._clickState),n;case"pendingDouble":return this._clickState="pendingTriple",this._clickTimeout=this._getClickTimeout(this._clickState),{...n,type:"click",name:"double_click",phase:"down"};case"pendingTriple":return this._clickState="pendingQuadruple",this._clickTimeout=this._getClickTimeout(this._clickState),{...n,type:"click",name:"triple_click",phase:"down"};case"pendingQuadruple":return this._clickState="pendingOverflow",this._clickTimeout=this._getClickTimeout(this._clickState),{...n,type:"click",name:"quadruple_click",phase:"down"};case"pendingOverflow":return this._clickState="overflow",this._clickTimeout=this._getClickTimeout(this._clickState),n;default:return this._clickTimeout=this._getClickTimeout(this._clickState),n}});v(this,"transformPointerUpEvent",n=>{if(!this._clickState)return n;switch(this._clickScreenPoint=E.From(n.point),this._clickState){case"pendingTriple":return{...this.lastPointerInfo,type:"click",name:"double_click",phase:"up"};case"pendingQuadruple":return{...this.lastPointerInfo,type:"click",name:"triple_click",phase:"up"};case"pendingOverflow":return{...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"up"};default:return n}});v(this,"cancelDoubleClickTimeout",()=>{this._clickTimeout=clearTimeout(this._clickTimeout),this._clickState="idle"});v(this,"handleMove",()=>{this._clickState!=="idle"&&this._clickScreenPoint&&this._clickScreenPoint.dist(this.editor.inputs.currentScreenPoint)>(this.editor.isCoarsePointer?_0:Wc)&&this.cancelDoubleClickTimeout()});this.editor=n}get clickState(){return this._clickState}}class uV{constructor(n){v(this,"handleContent",async n=>{switch(n.type){case"text":return await this.handleText(this.editor,n);case"files":return await this.handleFiles(this.editor,n);case"embed":return await this.handleEmbed(this.editor,n);case"svg-text":return await this.handleSvgText(this.editor,n);case"url":return await this.handleUrl(this.editor,n)}});v(this,"handleUrl",async(n,{point:t,url:r})=>{const o=mo(r);if(o)return this.handleEmbed(n,{type:"embed",url:o.url,point:t,embed:o.definition});const s=t??(n.inputs.shiftKey?n.inputs.currentPagePoint:n.viewportPageCenter),i=Oa.createId(sh(r));let a=n.getAssetById(i),l=!1;a||(l=!0,a=await this.createAssetFromUrl(n,r)),n.batch(()=>{l&&n.createAssets([a]),this.createShapesForAssets(n,[a],s)})});this.editor=n}async handleSvgText(n,{point:t,text:r}){const o=t??(n.inputs.shiftKey?n.inputs.currentPagePoint:n.viewportPageCenter),s=new DOMParser().parseFromString(r,"image/svg+xml").querySelector("svg");if(!s)throw new Error("No <svg/> element present");let i=parseFloat(s.getAttribute("width")||"0"),a=parseFloat(s.getAttribute("height")||"0");if(!(i&&a)){document.body.appendChild(s);const c=s.getBoundingClientRect();document.body.removeChild(s),i=c.width,a=c.height}const l=await this.createAssetFromFile(n,new File([r],"asset.svg",{type:"image/svg+xml"}));this.createShapesForAssets(n,[l],o)}async handleEmbed(n,{point:t,url:r,embed:o}){const s=t??(n.inputs.shiftKey?n.inputs.currentPagePoint:n.viewportPageCenter),{width:i,height:a}=o,l={id:Ue(),type:"embed",x:s.x-(i||450)/2,y:s.y-(a||450)/2,props:{w:i,h:a,url:r}};n.createShapes([l],!0)}async handleFiles(n,{point:t,files:r}){const o=t??(n.inputs.shiftKey?n.inputs.currentPagePoint:n.viewportPageCenter),s=new E(o.x,o.y),i=[];await Promise.all(r.map(async(a,l)=>{if(!a.type)throw new Error("No mime type");if(!ow.concat(f$).includes(a.type))return console.warn(`${a.name} not loaded - Extension not allowed.`),null;try{const c=await this.createAssetFromFile(n,a);if(!c)throw Error("Could not create an asset");i[l]=c}catch(c){return console.error(c),null}})),this.createShapesForAssets(n,he(i),s)}async handleText(n,{point:t,text:r}){const o=t??(n.inputs.shiftKey?n.inputs.currentPagePoint:n.viewportPageCenter),s=n.getShapeUtil(Mr).getDefaultProps(),i=pV(fV(hV(r)));let a,l,c,u="middle";const d=i.split(`
`).length>1,h=dV.test(i);d&&(u=d?h?"end":"start":"middle");const f=n.textMeasure.measureText(i,{...At,fontFamily:bo[s.font],fontSize:us[s.size],width:"fit-content"}),p=Math.min(d?n.viewportPageBounds.width*.9:920,Math.max(200,n.viewportPageBounds.width*.9));if(f.w>p){const m=n.textMeasure.measureText(i,{...At,fontFamily:bo[s.font],fontSize:us[s.size],width:p+"px"});a=m.w,l=m.h,c=!1,u=h?"end":"start"}else a=f.w,l=f.h,c=!0;o.y-l/2<n.viewportPageBounds.minY+40&&(o.y=n.viewportPageBounds.minY+40+l/2),n.createShapes([{id:Ue(),type:"text",x:o.x-a/2,y:o.y-l/2,props:{text:i,align:u,autoSize:c,w:a}}])}async createShapesForAssets(n,t,r){if(!t.length)return;const o=E.From(r),s=[];for(const i of t)switch(i.type){case"bookmark":{s.push({id:Ue(),type:"bookmark",x:o.x-150,y:o.y-160,opacity:1,props:{assetId:i.id,url:i.props.src}}),o.x+=300;break}case"image":{s.push({id:Ue(),type:"image",x:o.x-i.props.w/2,y:o.y-i.props.h/2,opacity:1,props:{assetId:i.id,w:i.props.w,h:i.props.h}}),o.x+=i.props.w;break}case"video":s.push({id:Ue(),type:"video",x:o.x-i.props.w/2,y:o.y-i.props.h/2,opacity:1,props:{assetId:i.id,w:i.props.w,h:i.props.h}}),o.x+=i.props.w}n.batch(()=>{const i=t.filter(c=>!n.getAssetById(c.id));i.length&&n.createAssets(i),n.createShapes(s,!0);const{viewportPageBounds:a}=n;let{selectedPageBounds:l}=n;if(l){const c=l.center.sub(r);n.updateShapes(s.map(u=>({id:u.id,type:u.type,x:u.x-c.x,y:u.y-c.y})))}l=n.selectedPageBounds,l&&!a.contains(l)&&n.zoomToSelection()})}async createAssetFromFile(n,t){return await new Promise((r,o)=>{const s=new FileReader;s.onerror=()=>o(s.error),s.onload=async()=>{let i=s.result;const a=p$(t.type),l=a?QH:GH;t.type==="video/quicktime"&&i.includes("video/quicktime")&&(i=i.replace("video/quicktime","video/mp4"));const c=await l(i),u=eV(c,{w:sz,h:iz});u!==c&&(t.type==="image/jpeg"||t.type==="image/png")&&(i=await ZH(i,u.w,u.h));const d=Oa.createId(sh(i)),h=await JH(t),f={id:d,type:a?"image":"video",typeName:"asset",props:{name:t.name,src:i,w:u.w,h:u.h,mimeType:t.type,isAnimated:h.isAnimated},meta:{}};r(f)},s.readAsDataURL(t)})}async createAssetFromUrl(n,t){var o,s,i;let r;try{const l=await(await fetch(t,{method:"GET",mode:"no-cors"})).text(),c=new DOMParser().parseFromString(l,"text/html");r={image:((o=c.head.querySelector('meta[property="og:image"]'))==null?void 0:o.getAttribute("content"))??"",title:((s=c.head.querySelector('meta[property="og:title"]'))==null?void 0:s.getAttribute("content"))??hc(t,32),description:((i=c.head.querySelector('meta[property="og:description"]'))==null?void 0:i.getAttribute("content"))??""}}catch(a){console.error(a),r={image:"",title:hc(t,32),description:""}}return{id:Oa.createId(sh(t)),typeName:"asset",type:"bookmark",props:{src:t,description:r.description,image:r.image,title:r.title},meta:{}}}}const dV=/[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/;function hV(e){return e.replace(/\t/g,ba)}function fV(e){const n=e.split(`
`);for(;n[0].trim().length===0;)n.shift();let t=1/0;for(const r of n)if(r.trim().length>0){const o=r.length-r.trimStart().length;t=Math.min(t,o)}return n.map(r=>r.slice(t)).join(`
`)}function pV(e){return e.replace(/[ \t]+$/gm,"").replace(/\n+$/,"")}function Js(e){if(e){let n=q2;for(;e.length;)n=n.push(e.pop());return n}return q2}class gV{constructor(){v(this,"length",0);v(this,"head",null);v(this,"tail",this)}push(n){return new sw(n,this)}toArray(){return br}[Symbol.iterator](){return{next(){return{value:void 0,done:!0}}}}}const q2=new gV;class sw{constructor(n,t){v(this,"length");this.head=n,this.tail=t,this.length=t.length+1}push(n){return new sw(n,this)}toArray(){return Array.from(this)}[Symbol.iterator](){let n=this;return{next(){if(n.length){const t=n.head;return n=n.tail,{value:t,done:!1}}else return{value:void 0,done:!0}}}}}class mV{constructor(n,t,r){v(this,"_undos",dt("HistoryManager.undos",Js()));v(this,"_redos",dt("HistoryManager.redos",Js()));v(this,"_batchDepth",0);v(this,"_commands",{});v(this,"createCommand",(n,t,r)=>{if(this._commands[n])throw new Error(`Duplicate command: ${n}`);this._commands[n]=r;const o=(...s)=>{if(!this._batchDepth)return this.batch(()=>o(...s)),this.ctx;const i=t(...s);if(!i)return this.ctx;const{data:a,ephemeral:l,squashing:c,preservesRedoStack:u}=i;if(this.ignoringUpdates((d,h)=>(r.do(a),{undos:d,redos:h})),!l){const d=this._undos.value.head;c&&d&&d.type==="command"&&d.name===n&&d.preservesRedoStack===u?this._undos.update(h=>h.tail.push({...d,id:nt(),data:r.squash(d.data,a)})):this._undos.update(h=>h.push({type:"command",name:n,data:a,id:nt(),preservesRedoStack:u})),i.preservesRedoStack||this._redos.set(Js()),this.ctx.emit("change-history",{reason:"push"})}return this.ctx};return o});v(this,"batch",n=>{try{this._batchDepth++,this._batchDepth===1?Gn(()=>{var r,o;const t=(r=this._undos.value.head)==null?void 0:r.id;n(),t!==((o=this._undos.value.head)==null?void 0:o.id)&&this.onBatchComplete()}):n()}catch(t){throw this.annotateError(t),t}finally{this._batchDepth--}return this});v(this,"ignoringUpdates",n=>{let t=this._undos.value,r=this._redos.value;this._undos.set(Js()),this._redos.set(Js());try{({undos:t,redos:r}=Gn(()=>n(t,r)))}finally{this._undos.set(t),this._redos.set(r)}});v(this,"_undo",({pushToRedoStack:n,toMark:t=void 0})=>(this.ignoringUpdates((r,o)=>{var s;if(r.length===0)return{undos:r,redos:o};for(;((s=r.head)==null?void 0:s.type)==="STOP";){const i=r.head;if(r=r.tail,n&&(o=o.push(i)),i.id===t)return this.ctx.emit("change-history",n?{reason:"undo"}:{reason:"bail",markId:t}),{undos:r,redos:o}}if(r.length===0)return this.ctx.emit("change-history",n?{reason:"undo"}:{reason:"bail",markId:t}),{undos:r,redos:o};for(;r.head;){const i=r.head;if(r=r.tail,n&&(o=o.push(i)),i.type==="STOP"){if(i.onUndo&&(!t||i.id===t))return this.ctx.emit("change-history",n?{reason:"undo"}:{reason:"bail",markId:t}),{undos:r,redos:o}}else this._commands[i.name].undo(i.data)}return this.ctx.emit("change-history",n?{reason:"undo"}:{reason:"bail",markId:t}),{undos:r,redos:o}}),this));v(this,"undo",()=>(this._undo({pushToRedoStack:!0}),this));v(this,"redo",()=>(this.ignoringUpdates((n,t)=>{var r;if(t.length===0)return{undos:n,redos:t};for(;((r=t.head)==null?void 0:r.type)==="STOP";)n=n.push(t.head),t=t.tail;if(t.length===0)return this.ctx.emit("change-history",{reason:"redo"}),{undos:n,redos:t};for(;t.head;){const o=t.head;if(n=n.push(t.head),t=t.tail,o.type==="STOP"){if(o.onRedo)break}else{const s=this._commands[o.name];s.redo?s.redo(o.data):s.do(o.data)}}return this.ctx.emit("change-history",{reason:"redo"}),{undos:n,redos:t}}),this));v(this,"bail",()=>(this._undo({pushToRedoStack:!1}),this));v(this,"bailToMark",n=>(this._undo({pushToRedoStack:!1,toMark:n}),this));v(this,"mark",(n=nt(),t=!0,r=!0)=>{const o=this._undos.value.head;return o&&o.type==="STOP"&&o.id===n&&o.onUndo===t&&o.onRedo===r?o.id:(this._undos.update(s=>s.push({type:"STOP",id:n,onUndo:t,onRedo:r})),this.ctx.emit("mark-history",{id:n}),n)});this.ctx=n,this.onBatchComplete=t,this.annotateError=r}get numUndos(){return this._undos.value.length}get numRedos(){return this._redos.value.length}clear(){this._undos.set(Js()),this._redos.set(Js())}}var yV=Object.defineProperty,vV=Object.getOwnPropertyDescriptor,Di=(e,n,t,r)=>{for(var o=r>1?void 0:r?vV(n,t):n,s=e.length-1,i;s>=0;s--)(i=e[s])&&(o=(r?i(n,t,o):i(o))||o);return r&&o&&yV(n,t,o),o};const ce=e=>Math.round(e*10**8)/10**8;function uo(e,n,t,r,o,s){if(s>20)return[];const i=e.filter(l=>(r==="forward"?l.startNode.id===n:l.endNode.id===n)&&ce(l.length)===ce(t)&&yr(l.breadthIntersection[0],l.breadthIntersection[1],o[0],o[1]));if(i.length===0)return[];const a=new Set;for(const l of i){const c=r==="forward"?l.endNode.id:l.startNode.id;a.has(c)||(a.add(c),i.push(...uo(e,c,t,r,yr(l.breadthIntersection[0],l.breadthIntersection[1],o[0],o[1]),s+1)))}return i}function wV(e){e.sort((n,t)=>t.gaps.length-n.gaps.length);for(let n=e.length-1;n>0;n--){const t=e[n];for(let r=n-1;r>=0;r--){const o=e[r];if(o.direction===t.direction&&t.gaps.every(s=>o.gaps.some(i=>ce(s.startEdge[0].x)===ce(i.startEdge[0].x)&&ce(s.startEdge[0].y)===ce(i.startEdge[0].y)&&ce(s.startEdge[1].x)===ce(i.startEdge[1].x)&&ce(s.startEdge[1].y)===ce(i.startEdge[1].y))&&o.gaps.some(i=>ce(s.endEdge[0].x)===ce(i.endEdge[0].x)&&ce(s.endEdge[0].y)===ce(i.endEdge[0].y)&&ce(s.endEdge[1].x)===ce(i.endEdge[1].x)&&ce(s.endEdge[1].y)===ce(i.endEdge[1].y)))){e.splice(n,1);break}}}}class Us{constructor(n){v(this,"_snapLines",dt("snapLines",void 0));this.editor=n}get lines(){return this._snapLines.value??br}clear(){this.lines.length&&this._snapLines.set(void 0)}setLines(n){this._snapLines.set(n)}get snapPointsCache(){return this.editor.store.createComputedCache("snapPoints",n=>{const t=this.editor.getPageTransformById(n.id);return t?this.editor.getShapeUtil(n).snapPoints(n).map((s,i)=>{const{x:a,y:l}=Y.applyToPoint(t,s);return{x:a,y:l,id:`${n.id}:${i}`}}):void 0})}get snapThreshold(){return 8/this.editor.zoomLevel}get snappableShapes(){const{editor:n}=this,{selectedIds:t,renderingBounds:r}=n,o=[],s=i=>{const a=n.getSortedChildIds(i);for(const l of a){if(t.includes(l))continue;const c=n.getShapeById(l);if(!c)continue;const u=n.getShapeUtil(c);if(!u.canSnap(c))continue;const d=n.getPageBoundsById(l);if(d&&r.includes(d)){if(n.isShapeOfType(c,Ye)){s(l);continue}o.push({id:l,pageBounds:d,isClosed:u.isClosed(c)})}}};return s(this.currentCommonAncestor??n.currentPageId),o}get currentCommonAncestor(){return this.editor.findCommonAncestor(this.editor.selectedShapes)}get snappablePoints(){const{snappableShapes:n,snapPointsCache:t}=this,r=[];return n.forEach(o=>{const s=t.get(o.id);s&&r.push(...s)}),r}get visibleGaps(){const n=[],t=[];let r,o;const s=this.snappableShapes.sort((a,l)=>a.pageBounds.minX-l.pageBounds.minX);for(let a=0;a<s.length;a++){r=s[a];for(let l=a+1;l<s.length;l++)o=s[l],r.pageBounds.maxX<o.pageBounds.minX&&Ol(r.pageBounds.minY,r.pageBounds.maxY,o.pageBounds.minY,o.pageBounds.maxY)&&n.push({startNode:r,endNode:o,startEdge:[new E(r.pageBounds.maxX,r.pageBounds.minY),new E(r.pageBounds.maxX,r.pageBounds.maxY)],endEdge:[new E(o.pageBounds.minX,o.pageBounds.minY),new E(o.pageBounds.minX,o.pageBounds.maxY)],length:o.pageBounds.minX-r.pageBounds.maxX,breadthIntersection:yr(r.pageBounds.minY,r.pageBounds.maxY,o.pageBounds.minY,o.pageBounds.maxY)})}const i=s.sort((a,l)=>a.pageBounds.minY-l.pageBounds.minY);for(let a=0;a<i.length;a++){r=i[a];for(let l=a+1;l<i.length;l++)o=i[l],r.pageBounds.maxY<o.pageBounds.minY&&Ol(r.pageBounds.minX,r.pageBounds.maxX,o.pageBounds.minX,o.pageBounds.maxX)&&t.push({startNode:r,endNode:o,startEdge:[new E(r.pageBounds.minX,r.pageBounds.maxY),new E(r.pageBounds.maxX,r.pageBounds.maxY)],endEdge:[new E(o.pageBounds.minX,o.pageBounds.minY),new E(o.pageBounds.maxX,o.pageBounds.minY)],length:o.pageBounds.minY-r.pageBounds.maxY,breadthIntersection:yr(r.pageBounds.minX,r.pageBounds.maxX,o.pageBounds.minX,o.pageBounds.maxX)})}return{horizontal:n,vertical:t}}snapTranslate({lockedAxis:n,initialSelectionPageBounds:t,initialSelectionSnapPoints:r,dragDelta:o}){var y,x;const{snappablePoints:s,snapThreshold:i}=this,a=t.clone().translate(o),l=r.map(({x:S,y:b},P)=>({id:"selection:"+P,x:S+o.x,y:b+o.y})),c=s,u=[],d=[],h=new E(i,i);this.collectPointSnaps({minOffset:h,nearestSnapsX:u,nearestSnapsY:d,otherNodeSnapPoints:c,selectionSnapPoints:l}),this.collectGapSnaps({selectionPageBounds:a,nearestSnapsX:u,nearestSnapsY:d,minOffset:h});const f=new E(n==="x"?0:((y=u[0])==null?void 0:y.nudge)??0,n==="y"?0:((x=d[0])==null?void 0:x.nudge)??0);h.x=0,h.y=0,u.length=0,d.length=0,l.forEach(S=>{S.x+=f.x,S.y+=f.y}),a.translate(f),this.collectPointSnaps({minOffset:h,nearestSnapsX:u,nearestSnapsY:d,otherNodeSnapPoints:c,selectionSnapPoints:l}),this.collectGapSnaps({selectionPageBounds:a,nearestSnapsX:u,nearestSnapsY:d,minOffset:h});const p=this.getPointSnapLines({nearestSnapsX:u,nearestSnapsY:d}),m=this.getGapSnapLines({selectionPageBounds:a,nearestSnapsX:u,nearestSnapsY:d});return this._snapLines.set([...m,...p]),{nudge:f}}get outlinesInPageSpace(){return this.snappableShapes.map(({id:n,isClosed:t})=>{const r=yn(this.editor.getOutlineById(n));t&&r.push(r[0]);const o=this.editor.getPageTransformById(n);if(!o)throw Error("No page transform");return Y.applyToPoints(o,r)})}getSnappingHandleDelta({handlePoint:n,additionalSegments:t}){const{outlinesInPageSpace:r,snapThreshold:o}=this;let s=o,i=null,a,l,c,u;const d=[...r,...t];for(const h of d)for(let f=0;f<h.length-1;f++)a=h[f],l=h[f+1],c=E.NearestPointOnLineSegment(a,l,n),u=E.Dist(n,c),!isNaN(u)&&u<s&&(s=u,i=c);return i?(this._snapLines.set([{id:nt(),type:"points",points:[i]}]),E.Sub(i,n)):null}snapResize({initialSelectionPageBounds:n,dragDelta:t,handle:r,isAspectRatioLocked:o,isResizingFromCenter:s}){var I,k;const{snapThreshold:i}=this,{box:a,scaleX:l,scaleY:c}=ne.Resize(n,r,s?t.x*2:t.x,s?t.y*2:t.y,o);let u=r;l<0&&(u=$N(u)),c<0&&(u=kN(u)),s&&(a.center=n.center);const d=u==="top"||u==="bottom",h=u==="left"||u==="right",f=Q2(u,a),p=this.snappablePoints,m=[],y=[],x=new E(i,i);this.collectPointSnaps({minOffset:x,nearestSnapsX:m,nearestSnapsY:y,otherNodeSnapPoints:p,selectionSnapPoints:f});const S=new E(d?0:((I=m[0])==null?void 0:I.nudge)??0,h?0:((k=y[0])==null?void 0:k.nudge)??0);if(o&&TN(u)&&S.len()!==0){const T=m.length&&y.length?Math.abs(S.x)<Math.abs(S.y)?"x":"y":m.length?"x":"y",M=n.aspectRatio;T==="x"?(y.length=0,S.y=S.x/M,(u==="bottom_left"||u==="top_right")&&(S.y=-S.y)):(m.length=0,S.x=S.y*M,(u==="bottom_left"||u==="top_right")&&(S.x=-S.x))}const b=E.Add(t,S),{box:P}=ne.Resize(n,r,s?b.x*2:b.x,s?b.y*2:b.y,o);s&&(P.center=n.center);const C=Q2("any",P);m.length=0,y.length=0,x.x=0,x.y=0,this.collectPointSnaps({minOffset:x,nearestSnapsX:m,nearestSnapsY:y,otherNodeSnapPoints:p,selectionSnapPoints:C});const _=this.getPointSnapLines({nearestSnapsX:m,nearestSnapsY:y});return this._snapLines.set([..._]),{nudge:S}}collectPointSnaps({selectionSnapPoints:n,otherNodeSnapPoints:t,minOffset:r,nearestSnapsX:o,nearestSnapsY:s}){for(const i of n)for(const a of t){const l=E.Sub(i,a),c=Math.abs(l.x),u=Math.abs(l.y);ce(c)<=ce(r.x)&&(ce(c)<ce(r.x)&&(o.length=0),o.push({type:"points",points:{thisPoint:i,otherPoint:a},nudge:a.x-i.x}),r.x=c),ce(u)<=ce(r.y)&&(ce(u)<ce(r.y)&&(s.length=0),s.push({type:"points",points:{thisPoint:i,otherPoint:a},nudge:a.y-i.y}),r.y=u)}}collectGapSnaps({selectionPageBounds:n,minOffset:t,nearestSnapsX:r,nearestSnapsY:o}){const{horizontal:s,vertical:i}=this.visibleGaps;for(const a of s){if(!Ol(a.breadthIntersection[0],a.breadthIntersection[1],n.minY,n.maxY))continue;const c=a.startEdge[0].x+a.length/2-n.center.x;if(a.length>n.width&&ce(Math.abs(c))<=ce(t.x)){ce(Math.abs(c))<ce(t.x)&&(r.length=0),t.x=Math.abs(c);const x={type:"gap_center",gap:a,nudge:c},S=r.find(({type:P})=>P==="gap_center"),b=S&&yr(a.breadthIntersection[0],a.breadthIntersection[1],S.gap.breadthIntersection[0],S.gap.breadthIntersection[1]);S&&S.gap.length>a.length&&b?r[r.indexOf(S)]=x:(!S||!b)&&r.push(x)}const d=a.startNode.pageBounds.minX-a.length,h=n.maxX,f=d-h;ce(Math.abs(f))<=ce(t.x)&&(ce(Math.abs(f))<ce(t.x)&&(r.length=0),t.x=Math.abs(f),r.push({type:"gap_duplicate",gap:a,protrusionDirection:"left",nudge:f}));const p=a.endNode.pageBounds.maxX+a.length,m=n.minX,y=p-m;ce(Math.abs(y))<=ce(t.x)&&(ce(Math.abs(y))<ce(t.x)&&(r.length=0),t.x=Math.abs(y),r.push({type:"gap_duplicate",gap:a,protrusionDirection:"right",nudge:y}))}for(const a of i){if(!Ol(a.breadthIntersection[0],a.breadthIntersection[1],n.minX,n.maxX))continue;const c=a.startEdge[0].y+a.length/2-n.center.y;if(a.length>n.height&&ce(Math.abs(c))<=ce(t.y)){ce(Math.abs(c))<ce(t.y)&&(o.length=0),t.y=Math.abs(c);const x={type:"gap_center",gap:a,nudge:c},S=o.find(({type:P})=>P==="gap_center"),b=S&&Ol(S.gap.breadthIntersection[0],S.gap.breadthIntersection[1],a.breadthIntersection[0],a.breadthIntersection[1]);S&&S.gap.length>a.length&&b?o[o.indexOf(S)]=x:(!S||!b)&&o.push(x);continue}const d=a.startNode.pageBounds.minY-a.length,h=n.maxY,f=d-h;ce(Math.abs(f))<=ce(t.y)&&(ce(Math.abs(f))<ce(t.y)&&(o.length=0),t.y=Math.abs(f),o.push({type:"gap_duplicate",gap:a,protrusionDirection:"top",nudge:f}));const p=a.endNode.pageBounds.maxY+a.length,m=n.minY,y=p-m;ce(Math.abs(y))<=ce(t.y)&&(ce(Math.abs(y))<ce(t.y)&&(o.length=0),t.y=Math.abs(y),o.push({type:"gap_duplicate",gap:a,protrusionDirection:"bottom",nudge:y}))}}getPointSnapLines({nearestSnapsX:n,nearestSnapsY:t}){const r={},o={};if(n.length>0){for(const s of n)if(s.type==="points"){const i=ce(s.points.otherPoint.x);r[i]||(r[i]=[]),r[i].push(s.points)}}if(t.length>0){for(const s of t)if(s.type==="points"){const i=ce(s.points.otherPoint.y);o[i]||(o[i]=[]),o[i].push(s.points)}}return Object.values(r).concat(Object.values(o)).map(s=>({id:nt(),type:"points",points:rf(s.map(i=>E.From(i.otherPoint)).concat(s.map(i=>E.From(i.thisPoint))),(i,a)=>i.equals(a))}))}getGapSnapLines({selectionPageBounds:n,nearestSnapsX:t,nearestSnapsY:r}){const{vertical:o,horizontal:s}=this.visibleGaps,i={top:n.sides[0],right:n.sides[1],bottom:[n.corners[3],n.corners[2]],left:[n.corners[0],n.corners[3]]},a=[];if(t.length>0)for(const l of t){if(l.type==="points")continue;const{gap:{breadthIntersection:c,startEdge:u,startNode:d,endNode:h,length:f,endEdge:p}}=l;switch(l.type){case"gap_center":{const m=(f-n.width)/2,y=yr(c[0],c[1],n.minY,n.maxY);a.push({type:"gaps",direction:"horizontal",id:nt(),gaps:[...uo(s,d.id,m,"backward",y,0),{startEdge:u,endEdge:i.left},{startEdge:i.right,endEdge:p},...uo(s,h.id,m,"forward",y,0)]});break}case"gap_duplicate":{const m=yr(c[0],c[1],n.minY,n.maxY);a.push({type:"gaps",direction:"horizontal",id:nt(),gaps:l.protrusionDirection==="left"?[{startEdge:i.right,endEdge:u.map(y=>y.clone().addXY(-d.pageBounds.width,0))},{startEdge:u,endEdge:p},...uo(s,h.id,f,"forward",m,0)]:[...uo(s,d.id,f,"backward",m,0),{startEdge:u,endEdge:p},{startEdge:p.map(y=>y.clone().addXY(l.gap.endNode.pageBounds.width,0)),endEdge:i.left}]});break}}}if(r.length>0)for(const l of r){if(l.type==="points")continue;const{gap:{breadthIntersection:c,startEdge:u,startNode:d,endNode:h,length:f,endEdge:p}}=l;switch(l.type){case"gap_center":{const m=(f-n.height)/2,y=yr(c[0],c[1],n.minX,n.maxX);a.push({type:"gaps",direction:"vertical",id:nt(),gaps:[...uo(o,d.id,m,"backward",y,0),{startEdge:u,endEdge:i.top},{startEdge:i.bottom,endEdge:p},...uo(o,l.gap.endNode.id,m,"forward",y,0)]});break}case"gap_duplicate":{const m=yr(c[0],c[1],n.minX,n.maxX);a.push({type:"gaps",direction:"vertical",id:nt(),gaps:l.protrusionDirection==="top"?[{startEdge:i.bottom,endEdge:u.map(y=>y.clone().addXY(0,-d.pageBounds.height))},{startEdge:u,endEdge:p},...uo(o,h.id,f,"forward",m,0)]:[...uo(o,d.id,f,"backward",m,0),{startEdge:u,endEdge:p},{startEdge:p.map(y=>y.clone().addXY(0,h.pageBounds.height)),endEdge:i.top}]})}break}}return wV(a),a}}Di([G],Us.prototype,"snapPointsCache",1);Di([G],Us.prototype,"snapThreshold",1);Di([G],Us.prototype,"snappableShapes",1);Di([G],Us.prototype,"currentCommonAncestor",1);Di([G],Us.prototype,"snappablePoints",1);Di([G],Us.prototype,"visibleGaps",1);Di([G],Us.prototype,"outlinesInPageSpace",1);function Q2(e,n){const{minX:t,maxX:r,minY:o,maxY:s}=n,i=[];switch(e){case"top":case"left":case"top_left":case"any":i.push({id:"top_left",handle:"top_left",x:t,y:o})}switch(e){case"top":case"right":case"top_right":case"any":i.push({id:"top_right",handle:"top_right",x:r,y:o})}switch(e){case"bottom":case"right":case"bottom_right":case"any":i.push({id:"bottom_right",handle:"bottom_right",x:r,y:s})}switch(e){case"bottom":case"left":case"bottom_left":case"any":i.push({id:"bottom_left",handle:"bottom_left",x:t,y:s})}return i}const xV={start:"left","start-legacy":"left",middle:"center","middle-legacy":"center",end:"right","end-legacy":"right"},SV=/\s/;class bV{constructor(n){v(this,"measureText",(n,t)=>{const r=this.getTextElement();r.setAttribute("dir","ltr"),r.style.setProperty("font-family",t.fontFamily),r.style.setProperty("font-style",t.fontStyle),r.style.setProperty("font-weight",t.fontWeight),r.style.setProperty("font-size",t.fontSize+"px"),r.style.setProperty("line-height",t.lineHeight*t.fontSize+"px"),r.style.setProperty("width",t.width),r.style.setProperty("min-width",t.minWidth??null),r.style.setProperty("max-width",t.maxWidth),r.style.setProperty("padding",t.padding),r.textContent=Ss.normalizeTextForDom(n);const o=r.getBoundingClientRect();return{x:0,y:0,w:o.width,h:o.height}});this.editor=n}getTextElement(){const n=document.querySelector(".tl-text-measure");n==null||n.remove();const t=document.createElement("div");return this.editor.getContainer().appendChild(t),t.id=`__textMeasure_${nt()}`,t.classList.add("tl-text"),t.classList.add("tl-text-measure"),t.tabIndex=-1,t}measureElementTextNodeSpans(n,{shouldTruncateToFirstLine:t=!1}={}){const r=[],o=n.getBoundingClientRect(),s=-o.left,i=-o.top,a=new Range,l=n.childNodes[0];let c=0,u=null,d=null,h=0,f=!1;for(const p of n.childNodes)if(p.nodeType===Node.TEXT_NODE)for(const m of p.textContent??""){a.setStart(l,c),a.setEnd(l,c+m.length);const y=a.getClientRects(),x=y[y.length-1],S=x.top+i,b=x.left+s,P=x.right+s,C=SV.test(m);if(C!==d||S!==h||!u){if(u){if(t&&S!==h){f=!0;break}r.push(u)}u={box:{x:b,y:S,w:x.width,h:x.height},text:m}}else u.box.w=P-u.box.x,u.text+=m;d=C,h=S,c+=m.length}return u&&r.push(u),{spans:r,didTruncate:f}}measureTextSpans(n,t){const r=t.overflow==="truncate-ellipsis"||t.overflow==="truncate-clip",o=this.getTextElement(),s=Math.ceil(t.width-t.padding*2);o.style.setProperty("width",`${s}px`),o.style.setProperty("height","min-content"),o.style.setProperty("dir","ltr"),o.style.setProperty("font-size",`${t.fontSize}px`),o.style.setProperty("font-family",t.fontFamily),o.style.setProperty("font-weight",t.fontWeight),o.style.setProperty("line-height",`${t.lineHeight*t.fontSize}px`),o.style.setProperty("text-align",xV[t.textAlign]),r&&(o.style.setProperty("overflow-wrap","anywhere"),o.style.setProperty("word-break","break-all")),o.textContent=n;const{spans:i,didTruncate:a}=this.measureElementTextNodeSpans(o,{shouldTruncateToFirstLine:r});if(t.overflow==="truncate-ellipsis"&&a){o.textContent="";const l=Math.ceil(this.measureElementTextNodeSpans(o).spans[0].box.w);o.style.setProperty("width",`${s-l}px`),o.textContent=n;const c=this.measureElementTextNodeSpans(o,{shouldTruncateToFirstLine:!0}).spans,u=c[c.length-1];return c.push({text:"",box:{x:Math.min(u.box.x+u.box.w,t.width-t.padding-l),y:u.box.y,w:l,h:u.box.h}}),c}return o.remove(),i}}class PV{constructor(n){v(this,"raf");v(this,"isPaused",!0);v(this,"last",0);v(this,"t",0);v(this,"start",()=>{this.isPaused=!1,cancelAnimationFrame(this.raf),this.raf=requestAnimationFrame(this.tick),this.last=Date.now()});v(this,"tick",()=>{if(this.isPaused)return;const n=Date.now(),t=n-this.last;if(this.last=n,this.t+=t,this.editor.emit("frame",t),this.t<16){this.raf=requestAnimationFrame(this.tick);return}this.t-=16,this.updatePointerVelocity(t),this.editor.emit("tick",t),this.raf=requestAnimationFrame(this.tick)});v(this,"dispose",()=>{this.isPaused=!0,cancelAnimationFrame(this.raf)});v(this,"prevPoint",new E);v(this,"updatePointerVelocity",n=>{const{prevPoint:t,editor:{inputs:{currentScreenPoint:r,pointerVelocity:o}}}=this;if(n===0)return;const s=E.Sub(r,t);this.prevPoint=r.clone();const i=s.len(),a=i?s.div(i):new E(0,0),l=o.clone().lrp(a.mul(i/n),.5);Math.abs(l.x)<.01&&(l.x=0),Math.abs(l.y)<.01&&(l.y=0),o.equals(l)||(this.editor.inputs.pointerVelocity=l)});this.editor=n,this.editor.disposables.add(this.dispose),this.start()}}class EV{constructor(n){v(this,"updateUserPreferences",n=>{this.user.setUserPreferences({...this.user.userPreferences.value,...n})});this.user=n}get userPreferences(){return this.user.userPreferences}get isDarkMode(){return this.user.userPreferences.value.isDarkMode}get animationSpeed(){return this.user.userPreferences.value.animationSpeed}get id(){return this.user.userPreferences.value.id}get name(){return this.user.userPreferences.value.name}get locale(){return this.user.userPreferences.value.locale}get color(){return this.user.userPreferences.value.color}get isSnapMode(){return this.user.userPreferences.value.isSnapMode}}class m$ extends re{constructor(){super(...arguments);v(this,"info",{});v(this,"brush",new ne);v(this,"initialSelectedIds",[]);v(this,"excludedShapeIds",new Set);v(this,"initialStartShape",null);v(this,"onEnter",t=>{const{altKey:r,currentPagePoint:o}=this.editor.inputs;if(r){this.parent.transition("scribble_brushing",t);return}this.excludedShapeIds=new Set(this.editor.shapesArray.filter(s=>this.editor.isShapeOfType(s,Ye)||this.editor.isShapeOrAncestorLocked(s)).map(s=>s.id)),this.info=t,this.initialSelectedIds=this.editor.selectedIds.slice(),this.initialStartShape=this.editor.getShapesAtPoint(o)[0],this.onPointerMove()});v(this,"onExit",()=>{this.initialSelectedIds=[],this.editor.setBrush(null)});v(this,"onPointerMove",()=>{this.hitTestShapes()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onCancel",t=>{this.editor.setSelectedIds(this.initialSelectedIds,!0),this.parent.transition("idle",t)});v(this,"onKeyDown",t=>{this.editor.inputs.altKey?this.parent.transition("scribble_brushing",t):this.hitTestShapes()});v(this,"onKeyUp",()=>{this.hitTestShapes()});v(this,"onInterrupt",()=>{this.editor.setBrush(null)})}complete(){this.parent.transition("idle",{})}hitTestShapes(){const{currentPageId:t,shapesArray:r,inputs:{originPagePoint:o,currentPagePoint:s,shiftKey:i,ctrlKey:a}}=this.editor;this.brush.setTo(ne.FromPoints([o,s]));const l=new Set(i?this.initialSelectedIds:[]);let c,u,d,h,f,p,m;const{corners:y}=this.brush,{excludedShapeIds:x}=this;e:for(let S=0,b=r.length;S<b;S++){if(d=r[S],x.has(d.id)||l.has(d.id)||(f=this.editor.getPageBounds(d),!f))continue e;if(this.brush.contains(f)){this.handleHit(d,s,t,l,y);continue e}if(a||this.editor.isShapeOfType(d,kt))continue e;if(this.brush.collides(f)){if(h=this.editor.getShapeUtil(d),p=this.editor.getPageTransform(d),!p)continue e;m=Y.applyToPoints(Y.Inverse(p),y);t:for(let P=0;P<m.length;P++)if(c=m[P],u=m[(P+1)%m.length],h.hitTestLineSegment(d,c,u)){this.handleHit(d,s,t,l,y);break t}}}this.editor.setBrush({...this.brush.toJson()}),this.editor.setSelectedIds(Array.from(l),!0)}handleHit(t,r,o,s,i){if(t.parentId===o){s.add(t.id);return}const a=this.editor.getOutermostSelectableShape(t),l=this.editor.getPageMaskById(a.id);l&&BN(l,i)!==null&&!sr(r,l)||s.add(a.id)}}v(m$,"id","brushing");function y$(e,n,t){if(!n)throw Error("Needs to translate a cropped shape!");const{crop:r}=n.props;if(!r)return;const o=e.inputs.shiftKey?Math.abs(t.x)<Math.abs(t.y)?"x":"y":null;o==="x"?t.x=0:o==="y"&&(t.y=0),t.rot(-n.rotation);const s=1/(r.bottomRight.x-r.topLeft.x)*n.props.w,i=1/(r.bottomRight.y-r.topLeft.y)*n.props.h,a=r.bottomRight.y-r.topLeft.y,l=r.bottomRight.x-r.topLeft.x,c=yn(r);return c.topLeft.x=Math.min(1-l,Math.max(0,c.topLeft.x-t.x/s)),c.topLeft.y=Math.min(1-a,Math.max(0,c.topLeft.y-t.y/i)),c.bottomRight.x=c.topLeft.x+l,c.bottomRight.y=c.topLeft.y+a,{id:n.id,type:n.type,props:{crop:c}}}var ny;let _V=(ny=class extends re{constructor(){super(...arguments);v(this,"onEnter",()=>{this.editor.setCursor({type:"default"});const{onlySelectedShape:t}=this.editor;this.editor.on("change-history",this.cleanupCroppingState),this.editor.mark("crop"),t&&this.editor.setCroppingId(t.id)});v(this,"onExit",()=>{this.editor.setCursor({type:"default"}),this.editor.off("change-history",this.cleanupCroppingState)});v(this,"onCancel",()=>{this.editor.setCroppingId(null),this.editor.setSelectedTool("select.idle",{})});v(this,"onPointerDown",t=>{var r;if(!this.editor.isMenuOpen){if(t.ctrlKey){this.editor.setCroppingId(null),this.editor.setSelectedTool("select.brushing",t);return}switch(t.target){case"canvas":{this.cancel();break}case"shape":{if(t.shape.id===this.editor.croppingId){this.editor.setSelectedTool("select.crop.pointing_crop",t);return}else(r=this.editor.getShapeUtil(t.shape))!=null&&r.canCrop(t.shape)?(this.editor.setCroppingId(t.shape.id),this.editor.setSelectedIds([t.shape.id]),this.editor.setSelectedTool("select.crop.pointing_crop",t)):this.cancel();break}case"selection":{switch(t.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{this.editor.setSelectedTool("select.pointing_rotate_handle",{...t,onInteractionEnd:"select.crop"});break}case"top":case"right":case"bottom":case"left":{this.editor.setSelectedTool("select.pointing_crop_handle",{...t,onInteractionEnd:"select.crop"});break}case"top_left":case"top_right":case"bottom_left":case"bottom_right":{this.editor.setSelectedTool("select.pointing_crop_handle",{...t,onInteractionEnd:"select.crop"});break}default:this.cancel()}break}}}});v(this,"onDoubleClick",t=>{var s;if(t.phase!=="up"||!this.editor.croppingId)return;const r=this.editor.getShapeById(this.editor.croppingId);if(!r)return;const o=this.editor.getShapeUtil(r);o&&t.target==="selection"&&((s=o.onDoubleClickEdge)==null||s.call(o,r))});v(this,"onKeyDown",()=>{this.nudgeCroppingImage(!1)});v(this,"onKeyRepeat",()=>{this.nudgeCroppingImage(!0)});v(this,"onKeyUp",t=>{switch(t.code){case"Enter":{this.editor.setCroppingId(null),this.editor.setSelectedTool("select.idle",{});break}}});v(this,"cleanupCroppingState",()=>{this.editor.croppingId||this.editor.setSelectedTool("select.idle",{})})}cancel(){this.editor.setCroppingId(null),this.editor.setSelectedTool("select.idle",{})}nudgeCroppingImage(t=!1){const{editor:{inputs:{keys:r}}}=this,o=r.has("ShiftLeft"),s=new E(0,0);if(r.has("ArrowLeft")&&(s.x+=1),r.has("ArrowRight")&&(s.x-=1),r.has("ArrowUp")&&(s.y+=1),r.has("ArrowDown")&&(s.y-=1),s.equals(new E(0,0)))return;o&&s.mul(10);const i=this.editor.getShapeById(this.editor.croppingId);if(!i)return;const a=y$(this.editor,i,s);a&&(t||this.editor.mark("translate crop"),this.editor.updateShapes([a]))}},v(ny,"id","idle"),ny);class v$ extends re{constructor(){super(...arguments);v(this,"onCancel",()=>{this.editor.setSelectedTool("select.crop.idle",{})});v(this,"onPointerMove",t=>{this.editor.inputs.isDragging&&this.editor.setSelectedTool("select.crop.translating_crop",t)});v(this,"onPointerUp",t=>{this.editor.setSelectedTool("select.crop.idle",t)})}}v(v$,"id","pointing_crop");class w$ extends re{constructor(){super(...arguments);v(this,"info",{});v(this,"markId","translating crop");v(this,"snapshot",{});v(this,"onEnter",t=>{this.info=t,this.snapshot=this.createSnapshot(),this.editor.mark(this.markId),this.editor.setCursor({type:"move"}),this.updateShapes()});v(this,"onExit",()=>{this.editor.setCursor({type:"default"})});v(this,"onPointerMove",()=>{this.updateShapes()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onKeyDown",t=>{switch(t.key){case"Alt":case"Shift":{this.updateShapes();return}}});v(this,"onKeyUp",t=>{switch(t.key){case"Enter":{this.complete();return}case"Alt":case"Shift":this.updateShapes()}})}complete(){this.updateShapes(),this.editor.setSelectedTool("select.crop.idle",this.info)}cancel(){this.editor.bailToMark(this.markId),this.editor.setSelectedTool("select.crop.idle",this.info)}createSnapshot(){return{shape:this.editor.onlySelectedShape}}updateShapes(){const t=this.snapshot.shape;if(!t)return;const{originPagePoint:r,currentPagePoint:o}=this.editor.inputs,s=o.clone().sub(r),i=y$(this.editor,t,s);i&&this.editor.updateShapes([i],!0)}}v(w$,"id","translating_crop");class yh extends re{}v(yh,"id","crop"),v(yh,"initial","idle"),v(yh,"children",()=>[_V,w$,v$]);const Xa={bottom:"ns-resize",top:"ns-resize",left:"ew-resize",right:"ew-resize",bottom_left:"nesw-resize",bottom_right:"nwse-resize",top_left:"nwse-resize",top_right:"nesw-resize",bottom_left_rotate:"swne-rotate",bottom_right_rotate:"senw-rotate",top_left_rotate:"nwse-rotate",top_right_rotate:"nesw-rotate",mobile_rotate:"grabbing"};class x$ extends re{constructor(){super(...arguments);v(this,"info",{});v(this,"onEnter",t=>{this.info=t,this.updateCursor()});v(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.parent.transition("resizing",this.info)});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.cancel()});v(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){const t=this.editor.selectedShapes,r=Xa[this.info.handle];this.editor.setCursor({type:r,rotation:t.length===1?t[0].rotation:0})}complete(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}cancel(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}}v(x$,"id","pointing_resize_handle");class S$ extends re{constructor(){super(...arguments);v(this,"info",{});v(this,"markId","");v(this,"snapshot",{});v(this,"onEnter",t=>{this.info=t,this.markId=this.editor.mark("cropping"),this.snapshot=this.createSnapshot(),this.updateShapes()});v(this,"onPointerMove",()=>{this.updateShapes()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"getDefaultCrop",()=>({topLeft:{x:0,y:0},bottomRight:{x:1,y:1}}))}updateCursor(){const t=this.editor.selectedShapes[0];if(!t)return;const r=Xa[this.info.handle];this.editor.setCursor({type:r,rotation:t.rotation})}updateShapes(){const{shape:t,cursorHandleOffset:r}=this.snapshot;if(!t||!this.editor.getShapeUtil(nw))return;const s=t.props,i=this.editor.inputs.currentPagePoint.clone().sub(r),a=this.editor.inputs.originPagePoint.clone().sub(r),l=i.clone().sub(a).rot(-t.rotation),c=s.crop??this.getDefaultCrop(),u=yn(c),d=new E(t.x,t.y),h=new E(0,0),f=1/(c.bottomRight.x-c.topLeft.x)*s.w,p=1/(c.bottomRight.y-c.topLeft.y)*s.h;let m=!1;switch(this.info.handle){case"top":case"top_left":case"top_right":{if(p<Hn)break;m=!0,u.topLeft.y=u.topLeft.y+l.y/p,p*(u.bottomRight.y-u.topLeft.y)<Hn?(u.topLeft.y=u.bottomRight.y-Hn/p,h.y=(u.topLeft.y-c.topLeft.y)*p):u.topLeft.y<=0?(u.topLeft.y=0,h.y=(u.topLeft.y-c.topLeft.y)*p):h.y=l.y;break}case"bottom":case"bottom_left":case"bottom_right":{if(p<Hn)break;m=!0,u.bottomRight.y=Math.min(1,u.bottomRight.y+l.y/p),p*(u.bottomRight.y-u.topLeft.y)<Hn&&(u.bottomRight.y=u.topLeft.y+Hn/p);break}}switch(this.info.handle){case"left":case"top_left":case"bottom_left":{if(f<Hn)break;m=!0,u.topLeft.x=u.topLeft.x+l.x/f,f*(u.bottomRight.x-u.topLeft.x)<Hn?(u.topLeft.x=u.bottomRight.x-Hn/f,h.x=(u.topLeft.x-c.topLeft.x)*f):u.topLeft.x<=0?(u.topLeft.x=0,h.x=(u.topLeft.x-c.topLeft.x)*f):h.x=l.x;break}case"right":case"top_right":case"bottom_right":{if(f<Hn)break;m=!0,u.bottomRight.x=Math.min(1,u.bottomRight.x+l.x/f),f*(u.bottomRight.x-u.topLeft.x)<Hn&&(u.bottomRight.x=u.topLeft.x+Hn/f);break}}if(!m)return;d.add(h.rot(t.rotation));const y={id:t.id,type:t.type,x:d.x,y:d.y,props:{crop:u,w:(u.bottomRight.x-u.topLeft.x)*f,h:(u.bottomRight.y-u.topLeft.y)*p}};this.editor.updateShapes([y],!0),this.updateCursor()}complete(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))}createSnapshot(){const{selectionRotation:t,inputs:{originPagePoint:r}}=this.editor,o=this.editor.onlySelectedShape,s=this.editor.selectionBounds,i=E.RotWith(s.getHandlePoint(this.info.handle),s.point,t),a=E.Sub(r,i);return{shape:o,cursorHandleOffset:a}}}v(S$,"id","cropping");class b$ extends re{constructor(){super(...arguments);v(this,"shapeId","");v(this,"initialHandle",{});v(this,"initialAdjacentHandle",null);v(this,"markId","");v(this,"initialPageTransform");v(this,"initialPageRotation");v(this,"info",{});v(this,"isPrecise",!1);v(this,"isPreciseId",null);v(this,"pointingId",null);v(this,"onEnter",t=>{const{shape:r,isCreating:o,handle:s}=t;this.info=t,this.shapeId=r.id,this.markId=o?"creating":this.editor.mark("dragging handle"),this.initialHandle=yn(s),this.initialPageTransform=this.editor.getPageTransform(r),this.initialPageRotation=this.editor.getPageRotation(r),this.editor.setCursor({type:o?"cross":"grabbing",rotation:0});const i=this.editor.getHandles(r).sort(un),a=i.findIndex(c=>c.id===t.handle.id);this.initialAdjacentHandle=null;for(let c=a+1;c<i.length;c++){const u=i[c];if(u.type==="vertex"&&u.id!=="middle"&&u.id!==t.handle.id){this.initialAdjacentHandle=u;break}}if(!this.initialAdjacentHandle)for(let c=i.length-1;c>=0;c--){const u=i[c];if(u.type==="vertex"&&u.id!=="middle"&&u.id!==t.handle.id){this.initialAdjacentHandle=u;break}}const l=r.props[t.handle.id];this.isPrecise=!1,(l==null?void 0:l.type)==="binding"&&(this.editor.setHintingIds([l.boundShapeId]),this.isPrecise=!E.Equals(l.normalizedAnchor,{x:.5,y:.5}),this.isPrecise?this.isPreciseId=l.boundShapeId:this.resetExactTimeout()),this.update()});v(this,"exactTimeout",-1);v(this,"onPointerMove",()=>{this.update()});v(this,"onKeyDown",()=>{this.update()});v(this,"onKeyUp",()=>{this.update()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onExit",()=>{this.editor.setHintingIds([]),this.editor.snaps.clear(),this.editor.setCursor({type:"default"})})}resetExactTimeout(){this.exactTimeout!==-1&&this.clearExactTimeout(),this.exactTimeout=setTimeout(()=>{this.isActive&&!this.isPrecise&&(this.isPrecise=!0,this.isPreciseId=this.pointingId,this.update()),this.exactTimeout=-1},750)}clearExactTimeout(){this.exactTimeout!==-1&&(clearTimeout(this.exactTimeout),this.exactTimeout=-1)}complete(){this.editor.snaps.clear();const{onInteractionEnd:t}=this.info;if(this.editor.instanceState.isToolLocked&&t){this.editor.setSelectedTool(t,{shapeId:this.shapeId});return}this.parent.transition("idle",{})}cancel(){this.editor.bailToMark(this.markId),this.editor.snaps.clear();const{onInteractionEnd:t}=this.info;if(t){this.editor.setSelectedTool(t,{shapeId:this.shapeId});return}this.parent.transition("idle",{})}update(){var C;const{editor:t,shapeId:r}=this,{initialHandle:o,initialPageRotation:s,initialAdjacentHandle:i}=this,{isSnapMode:a,hintingIds:l,snaps:c,inputs:{currentPagePoint:u,originPagePoint:d,shiftKey:h,ctrlKey:f,altKey:p,pointerVelocity:m}}=t,y=t.getShapeById(r);if(!y)return;const x=t.getShapeUtil(y);let S=u.clone().sub(d).rot(-s).add(o);if(h&&i&&o.id!=="middle"){const _=E.Angle(i,S),k=pf(_,24)-_;S=E.RotWith(S,i,k)}if(t.snaps.clear(),a?!f:f){const _=t.getPageTransformById(y.id);if(!_)throw Error("Expected a page transform");const I=x.getOutlineSegments(y).map(M=>Y.applyToPoints(_,M)),k=t.getHandles(y).filter(({type:M})=>M==="vertex").sort(un).findIndex(({index:M})=>o.index===M);I.splice(k-1,2);const T=c.getSnappingHandleDelta({additionalSegments:I,handlePoint:Y.applyToPoint(_,S)});T&&S.add(t.getDeltaInShapeSpace(y,T))}const b=(C=x.onHandleChange)==null?void 0:C.call(x,y,{handle:{...o,x:S.x,y:S.y},isPrecise:this.isPrecise||p}),P={...y,...b};if(o.canBind){const _=P.props[o.id];(_==null?void 0:_.type)==="binding"?l[0]!==_.boundShapeId&&(t.setHintingIds([_.boundShapeId]),this.pointingId=_.boundShapeId,this.isPrecise=m.len()<.5||p,this.isPreciseId=this.isPrecise?_.boundShapeId:null,this.resetExactTimeout()):l.length>0&&(t.setHintingIds([]),this.pointingId=null,this.isPrecise=!1,this.isPreciseId=null,this.resetExactTimeout())}b&&t.updateShapes([P],!0)}}v(b$,"id","dragging_handle");class P$ extends re{constructor(){super(...arguments);v(this,"onPointerEnter",t=>{switch(t.target){case"shape":{const{selectedIds:r,focusLayerId:o}=this.editor,s=this.editor.getOutermostSelectableShape(t.shape,i=>!r.includes(i.id));s.id!==o&&this.editor.setHoveredId(s.id);break}}});v(this,"onPointerLeave",t=>{switch(t.target){case"shape":{this.editor.setHoveredId(null);break}}});v(this,"onExit",()=>{var s;if(!this.editor.pageState.editingId)return;const{editingId:t}=this.editor.pageState;if(!t)return;this.editor.setEditingId(null);const r=this.editor.getShapeById(t),o=this.editor.getShapeUtil(r);(s=o.onEditEnd)==null||s.call(o,r)});v(this,"onPointerDown",t=>{var r,o,s,i;switch(t.target){case"shape":{const{shape:a}=t,{editingId:l}=this.editor.pageState;if(l){if(a.id===l)return;const c=this.editor.getShapeById(l);if(c){const u=this.editor.getShapeUtil(c);(r=u.onEditEnd)==null||r.call(u,c);const d=this.editor.getShapeUtil(a);if(a.type===c.type&&((o=d.canEdit)!=null&&o.call(d,a))&&!this.editor.isShapeOrAncestorLocked(a)){this.editor.setEditingId(a.id),this.editor.setHoveredId(a.id),this.editor.setSelectedIds([a.id]);return}}}}}this.parent.transition("idle",t),(i=(s=this.parent.current.value)==null?void 0:s.onPointerDown)==null||i.call(s,t)});v(this,"onComplete",t=>{this.parent.transition("idle",t)});v(this,"onCancel",t=>{this.parent.transition("idle",t)})}}v(P$,"id","editing_shape");var ry;let CV=(ry=class extends re{constructor(){super(...arguments);v(this,"isDarwin",window.navigator.userAgent.toLowerCase().indexOf("mac")>-1);v(this,"onPointerEnter",t=>{switch(t.target){case"canvas":break;case"shape":{const{selectedIds:r,focusLayerId:o}=this.editor,s=this.editor.getOutermostSelectableShape(t.shape,i=>!r.includes(i.id));if(s.id!==o&&this.editor.setHoveredId(s.id),pt.debugCursors.value){if(s.type!=="geo")break;const i=s.props.text;try{this.editor.setCursor({type:i})}catch{console.error(`Cursor type not recognized: '${i}'`),this.editor.setCursor({type:"default"})}}break}}});v(this,"onPointerLeave",t=>{switch(t.target){case"shape":{this.editor.setHoveredId(null);break}}});v(this,"onPointerDown",t=>{if(this.editor.isMenuOpen)return;const r=this.shouldEnterCropMode(t,!0);if(t.ctrlKey&&!r){if(t.target==="shape"&&this.isDarwin&&this.editor.inputs.keys.has("ControlLeft")&&!this.editor.isShapeOrAncestorLocked(t.shape)){this.parent.transition("pointing_shape",t);return}this.parent.transition("brushing",t);return}switch(t.target){case"canvas":{this.parent.transition("pointing_canvas",t);break}case"shape":{if(this.editor.isShapeOrAncestorLocked(t.shape))break;this.parent.transition("pointing_shape",t);break}case"handle":{if(this.editor.isReadOnly)break;this.editor.inputs.altKey?this.parent.transition("pointing_shape",t):this.parent.transition("pointing_handle",t);break}case"selection":{switch(t.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{this.parent.transition("pointing_rotate_handle",t);break}case"top":case"right":case"bottom":case"left":{r?this.parent.transition("pointing_crop_handle",t):this.parent.transition("pointing_resize_handle",t);break}case"top_left":case"top_right":case"bottom_left":case"bottom_right":{r?this.parent.transition("pointing_crop_handle",t):this.parent.transition("pointing_resize_handle",t);break}default:this.parent.transition("pointing_selection",t)}break}}});v(this,"onDoubleClick",t=>{var r,o,s,i;if(t.phase==="up")switch(t.target){case"canvas":{if(this.editor.isReadOnly)break;this.handleDoubleClickOnCanvas(t);break}case"selection":{if(this.editor.isReadOnly)break;const{onlySelectedShape:a}=this.editor;if(a){const l=this.editor.getShapeUtil(a);if(t.handle==="right"||t.handle==="left"||t.handle==="top"||t.handle==="bottom"){const c=(r=l.onDoubleClickEdge)==null?void 0:r.call(l,a);if(c){this.editor.mark("double click edge"),this.editor.updateShapes([c]);return}}if(l.canCrop(a)&&!this.editor.isShapeOrAncestorLocked(a)){this.parent.transition("crop",t);return}this.shouldStartEditingShape(a)&&this.startEditingShape(a,t)}break}case"shape":{const{shape:a}=t,l=this.editor.getShapeUtil(a);if(a.type!=="video"&&a.type!=="embed"&&this.editor.isReadOnly)break;if(l.onDoubleClick){const c=(o=l.onDoubleClick)==null?void 0:o.call(l,a);if(c){this.editor.updateShapes([c]);return}else if(l.canCrop(a)&&!this.editor.isShapeOrAncestorLocked(a)){this.editor.mark("select and crop"),this.editor.select((s=t.shape)==null?void 0:s.id),this.parent.transition("crop",t);return}}this.shouldStartEditingShape(a)?this.startEditingShape(a,t):this.handleDoubleClickOnCanvas(t);break}case"handle":{if(this.editor.isReadOnly)break;const{shape:a,handle:l}=t,c=this.editor.getShapeUtil(a),u=(i=c.onDoubleClickHandle)==null?void 0:i.call(c,a,l);u?this.editor.updateShapes([u]):this.shouldStartEditingShape(a)&&this.startEditingShape(a,t)}}});v(this,"onRightClick",t=>{switch(t.target){case"canvas":{this.editor.selectNone();break}case"shape":{const{selectedIds:r}=this.editor.pageState,{shape:o}=t,s=this.editor.getOutermostSelectableShape(o,i=>!this.editor.isSelected(i.id));r.includes(s.id)||(this.editor.mark("selecting shape"),this.editor.setSelectedIds([s.id]));break}}});v(this,"onEnter",()=>{this.editor.setHoveredId(null),this.editor.setCursor({type:"default"})});v(this,"onCancel",()=>{this.editor.focusLayerId!==this.editor.currentPageId&&this.editor.selectedIds.length>0?this.editor.popFocusLayer():(this.editor.mark("clearing selection"),this.editor.selectNone())});v(this,"onKeyDown",t=>{switch(t.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!1);break}}});v(this,"onKeyRepeat",t=>{switch(t.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!0);break}}});v(this,"onKeyUp",t=>{if(this.editor.isReadOnly)switch(t.code){case"Enter":{if(this.shouldStartEditingShape()&&this.editor.onlySelectedShape){this.startEditingShape(this.editor.onlySelectedShape,{...t,target:"shape",shape:this.editor.onlySelectedShape});return}break}}else switch(t.code){case"Enter":{const{selectedShapes:r}=this.editor;if(r.every(o=>this.editor.isShapeOfType(o,Ye))){this.editor.setSelectedIds(r.flatMap(o=>this.editor.getSortedChildIds(o.id)));return}if(this.shouldStartEditingShape()&&this.editor.onlySelectedShape){this.startEditingShape(this.editor.onlySelectedShape,{...t,target:"shape",shape:this.editor.onlySelectedShape});return}this.shouldEnterCropMode(t,!1)&&this.parent.transition("crop",t);break}}})}shouldStartEditingShape(t=this.editor.onlySelectedShape){return!t||this.editor.isShapeOrAncestorLocked(t)&&t.type!=="embed"?!1:this.editor.getShapeUtil(t).canEdit(t)}shouldEnterCropMode(t,r){const o=this.editor.onlySelectedShape;if(!o||this.editor.isShapeOrAncestorLocked(o))return!1;const s=this.editor.getShapeUtil(o);return r?s.canCrop(o)&&t.ctrlKey:s.canCrop(o)}startEditingShape(t,r){this.editor.isShapeOrAncestorLocked(t)&&t.type!=="embed"||(this.editor.mark("editing shape"),this.editor.setEditingId(t.id),this.parent.transition("editing_shape",r))}handleDoubleClickOnCanvas(t){this.editor.mark("creating text shape");const r=Ue(),{x:o,y:s}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:r,type:"text",x:o,y:s,props:{text:"",autoSize:!0}}]);const i=this.editor.getShapeById(r);if(!i)return;const a=this.editor.getBounds(i);this.editor.updateShapes([{id:r,type:"text",x:i.x-a.width/2,y:i.y-a.height/2}]),this.editor.setEditingId(r),this.editor.select(r),this.parent.transition("editing_shape",t)}nudgeSelectedShapes(t=!1){const{editor:{inputs:{keys:r}}}=this,o=r.has("ShiftLeft"),s=new E(0,0);r.has("ArrowLeft")&&(s.x-=1),r.has("ArrowRight")&&(s.x+=1),r.has("ArrowUp")&&(s.y-=1),r.has("ArrowDown")&&(s.y+=1),!s.equals(new E(0,0))&&(t||this.editor.mark("nudge shapes"),this.editor.nudgeShapes(this.editor.selectedIds,s,o))}},v(ry,"id","idle"),ry);class E$ extends re{constructor(){super(...arguments);v(this,"onEnter",()=>{const{inputs:t}=this.editor;t.shiftKey||this.editor.selectedIds.length>0&&(this.editor.mark("selecting none"),this.editor.selectNone())});v(this,"onPointerMove",t=>{this.editor.inputs.isDragging&&this.parent.transition("brushing",t)});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onInterrupt",()=>{this.parent.transition("idle",{})})}_clickWasInsideFocusedGroup(){const{focusLayerId:t,inputs:r}=this.editor;if(!Wn(t))return!1;const o=this.editor.getShapeById(t);if(!o)return!1;const s=this.editor.getPointInShapeSpace(o,r.currentPagePoint);return this.editor.getShapeUtil(o).hitTestPoint(o,s)}complete(){const{shiftKey:t}=this.editor.inputs;t||(this.editor.selectNone(),this._clickWasInsideFocusedGroup()||this.editor.setFocusLayer(null)),this.parent.transition("idle",{})}}v(E$,"id","pointing_canvas");class _$ extends re{constructor(){super(...arguments);v(this,"info",{});v(this,"onEnter",t=>{this.info=t;const r=this.editor.selectedShapes[0];r&&(this.updateCursor(r),this.editor.setCroppingId(r.id))});v(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.parent.transition("cropping",{...this.info,onInteractionEnd:this.info.onInteractionEnd})});v(this,"onPointerUp",()=>{this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.cancel()});v(this,"onInterrupt",()=>{this.cancel()})}updateCursor(t){const r=Xa[this.info.handle];this.editor.setCursor({type:r,rotation:t.rotation})}cancel(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))}}v(_$,"id","pointing_crop_handle");class C$ extends re{constructor(){super(...arguments);v(this,"info",{});v(this,"onEnter",t=>{this.info=t;const r=t.shape.props[t.handle.id];(r==null?void 0:r.type)==="binding"&&this.editor.setHintingIds([r.boundShapeId]),this.editor.setCursor({type:"grabbing"})});v(this,"onExit",()=>{this.editor.setHintingIds([]),this.editor.setCursor({type:"default"})});v(this,"onPointerUp",()=>{this.parent.transition("idle",this.info)});v(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.parent.transition("dragging_handle",this.info)});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.cancel()});v(this,"onInterrupt",()=>{this.cancel()})}cancel(){this.parent.transition("idle",{})}}v(C$,"id","pointing_handle");class I$ extends re{constructor(){super(...arguments);v(this,"info",{});v(this,"onEnter",t=>{this.info=t,this.updateCursor()});v(this,"onPointerMove",()=>{const{isDragging:t}=this.editor.inputs;t&&this.parent.transition("rotating",this.info)});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.cancel()});v(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){const{selectionRotation:t}=this.editor;this.editor.setCursor({type:Xa[this.info.handle],rotation:t})}complete(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}cancel(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}}v(I$,"id","pointing_rotate_handle");class k$ extends re{constructor(){super(...arguments);v(this,"info",{});v(this,"onEnter",t=>{this.info=t});v(this,"onPointerUp",t=>{this.editor.selectNone(),this.parent.transition("idle",t)});v(this,"onPointerMove",t=>{if(this.editor.inputs.isDragging){if(this.editor.isReadOnly)return;this.parent.transition("translating",t)}});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.cancel()});v(this,"onInterrupt",()=>{this.cancel()})}cancel(){this.parent.transition("idle",{})}}v(k$,"id","pointing_selection");class $$ extends re{constructor(){super(...arguments);v(this,"eventTargetShape",{});v(this,"selectingShape",{});v(this,"didSelectOnEnter",!1);v(this,"onEnter",t=>{var i;if(this.eventTargetShape=t.shape,this.selectingShape=this.editor.getOutermostSelectableShape(t.shape),this.editor.getShapeUtil(t.shape).onClick||this.selectingShape.id===this.editor.focusLayerId){this.didSelectOnEnter=!1;return}const o=this.editor.isWithinSelection(this.selectingShape.id),s=this.editor.selectedIds.length>1&&((i=this.editor.selectionBounds)==null?void 0:i.containsPoint(this.editor.inputs.currentPagePoint));if(this.didSelectOnEnter=!o&&this.selectingShape.id!==this.editor.focusLayerId&&!s,this.didSelectOnEnter){const{inputs:a,selectedIds:l}=this.editor,c=this.editor.getParentShape(t.shape);c&&this.editor.isShapeOfType(c,Ye)&&this.editor.cancelDoubleClick(),a.shiftKey&&!a.altKey?l.includes(this.selectingShape.id)||(this.editor.mark("shift selecting shape"),this.editor.setSelectedIds([...l,this.selectingShape.id])):(this.editor.mark("selecting shape"),this.editor.setSelectedIds([this.selectingShape.id]))}});v(this,"onPointerUp",t=>{var o;const{shape:r}=t;if(r){const s=this.editor.getShapeUtil(r);if(s.onClick){const i=(o=s.onClick)==null?void 0:o.call(s,r);if(i){this.editor.updateShapes([i]),this.parent.transition("idle",t);return}}}if(!this.didSelectOnEnter&&this.selectingShape.id!==this.editor.focusLayerId){this.editor.mark("selecting shape (pointer up)");const s=this.editor.getOutermostSelectableShape(this.eventTargetShape,i=>!this.editor.isSelected(i.id));if(this.editor.selectedIds.includes(s.id))this.editor.setSelectedIds(this.editor.inputs.shiftKey?this.editor.selectedIds.filter(i=>i!==this.selectingShape.id):[this.selectingShape.id]);else if(this.editor.inputs.shiftKey){const i=this.editor.getAncestors(s);this.editor.setSelectedIds([...this.editor.selectedIds.filter(a=>!i.find(l=>l.id===a)),s.id])}else this.editor.setSelectedIds([s.id])}else this.selectingShape.id===this.editor.focusLayerId&&(this.editor.selectedIds.length>0?this.editor.setSelectedIds([]):this.editor.popFocusLayer());this.parent.transition("idle",t)});v(this,"onPointerMove",t=>{if(this.editor.inputs.isDragging){if(this.editor.isReadOnly)return;this.parent.transition("translating",t)}});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.cancel()});v(this,"onInterrupt",()=>{this.cancel()})}cancel(){this.parent.transition("idle",{})}}v($$,"id","pointing_shape");class T$ extends re{constructor(){super(...arguments);v(this,"info",{});v(this,"markId","");v(this,"creationCursorOffset",{x:0,y:0});v(this,"editAfterComplete",!1);v(this,"snapshot",{});v(this,"onEnter",t=>{const{isCreating:r=!1,editAfterComplete:o=!1,creationCursorOffset:s={x:0,y:0}}=t;this.info=t,this.editAfterComplete=o,this.creationCursorOffset=s,t.isCreating&&this.editor.setCursor({type:"cross",rotation:0}),this.snapshot=this._createSnapshot(),this.markId=r?"creating":this.editor.mark("starting resizing"),this.handleResizeStart(),this.updateShapes()});v(this,"onPointerMove",()=>{this.updateShapes()});v(this,"onKeyDown",()=>{this.updateShapes()});v(this,"onKeyUp",()=>{this.updateShapes()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onExit",()=>{this.editor.snaps.clear()});v(this,"_createSnapshot",()=>{const{selectedIds:t,selectionRotation:r,inputs:{originPagePoint:o}}=this.editor,s=this.editor.selectionBounds,i=E.RotWith(s.getHandlePoint(this.info.handle),s.point,r),a=E.Sub(o,i),l=new Map;t.forEach(u=>{const d=this.editor.getShapeById(u);if(d){if(l.set(d.id,this._createShapeSnapshot(d)),this.editor.isShapeOfType(d,kt)&&t.length===1)return;this.editor.visitDescendants(d.id,h=>{const f=this.editor.getShapeById(h);if(f&&(l.set(f.id,this._createShapeSnapshot(f)),this.editor.isShapeOfType(f,kt)))return!1})}});const c=![...l.values()].some(u=>!ok(u.pageRotation,r)||u.isAspectRatioLocked);return{shapeSnapshots:l,selectionBounds:s,cursorHandleOffset:a,selectionRotation:r,selectedIds:t,canShapesDeform:c,initialSelectionPageBounds:this.editor.selectedPageBounds}});v(this,"_createShapeSnapshot",t=>{const r=this.editor.getPageTransform(t),o=this.editor.getShapeUtil(t);return{shape:t,bounds:this.editor.getBounds(t),pageTransform:r,pageRotation:Y.Decompose(r).rotation,isAspectRatioLocked:o.isAspectRatioLocked(t)}})}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}complete(){if(this.handleResizeEnd(),this.editAfterComplete&&this.editor.onlySelectedShape){this.editor.setEditingId(this.editor.onlySelectedShape.id),this.editor.setSelectedTool("select"),this.editor.root.current.value.transition("editing_shape",{});return}if(this.editor.instanceState.isToolLocked&&this.info.onInteractionEnd){this.editor.setSelectedTool(this.info.onInteractionEnd,{});return}this.parent.transition("idle",{})}handleResizeStart(){const{shapeSnapshots:t}=this.snapshot,r=[];t.forEach(({shape:o})=>{var a;const s=this.editor.getShapeUtil(o),i=(a=s.onResizeStart)==null?void 0:a.call(s,o);i&&r.push(i)}),r.length>0&&this.editor.updateShapes(r)}handleResizeEnd(){const{shapeSnapshots:t}=this.snapshot,r=[];t.forEach(({shape:o})=>{var l;const s=this.editor.getShapeById(o.id),i=this.editor.getShapeUtil(o),a=(l=i.onResizeEnd)==null?void 0:l.call(i,o,s);a&&r.push(a)}),r.length>0&&this.editor.updateShapes(r)}updateShapes(){const{altKey:t,shiftKey:r}=this.editor.inputs,{shapeSnapshots:o,selectionBounds:s,cursorHandleOffset:i,selectedIds:a,selectionRotation:l,canShapesDeform:c}=this.snapshot,u=r||!c,{ctrlKey:d}=this.editor.inputs,h=this.editor.inputs.currentPagePoint.clone().sub(i).sub(this.creationCursorOffset),f=this.editor.inputs.originPagePoint.clone().sub(i);this.editor.isGridMode&&!d&&h.snapToGrid(this.editor.gridSize);const p=this.info.handle,m=Z2(p,Math.PI);if(this.editor.snaps.clear(),(this.editor.isSnapMode?!d:d)&&l%_e===0){const{nudge:I}=this.editor.snaps.snapResize({dragDelta:E.Sub(h,f),initialSelectionPageBounds:this.snapshot.initialSelectionPageBounds,handle:Z2(p,l),isAspectRatioLocked:u,isResizingFromCenter:t});h.add(I)}const x=E.RotWith(t?s.center:s.getHandlePoint(m),s.point,l),S=E.Sub(h,x).rot(-l),b=E.Sub(f,x).rot(-l),P=E.DivV(S,b);Number.isFinite(P.x)||(P.x=1),Number.isFinite(P.y)||(P.y=1);const C=p==="top"||p==="bottom",_=p==="left"||p==="right";u?_?P.y=Math.abs(P.x):C?P.x=Math.abs(P.y):Math.abs(P.x)>Math.abs(P.y)?P.y=Math.abs(P.x)*(P.y<0?-1:1):P.x=Math.abs(P.y)*(P.x<0?-1:1):(C&&(P.x=1),_&&(P.y=1)),this.info.isCreating||this.updateCursor({dragHandle:p,isFlippedX:P.x<0,isFlippedY:P.y<0,rotation:l});for(const I of o.keys()){const k=o.get(I);this.editor.resizeShape(I,P,{initialBounds:k.bounds,dragHandle:p,initialPageTransform:k.pageTransform,initialShape:k.shape,mode:a.length===1&&I===a[0]?"resize_bounds":"scale_shape",scaleOrigin:x,scaleAxisRotation:l})}}updateCursor({dragHandle:t,isFlippedX:r,isFlippedY:o,rotation:s}){const i={...this.editor.cursor};switch(t){case"top_left":case"bottom_right":{i.type="nwse-resize",r!==o&&(i.type="nesw-resize");break}case"top_right":case"bottom_left":{i.type="nesw-resize",r!==o&&(i.type="nwse-resize");break}}i.rotation=s,this.editor.setCursor(i)}}v(T$,"id","resizing");const pm=["top","top_right","right","bottom_right","bottom","bottom_left","left","top_left"];function Z2(e,n){n=n%qe;const t=Math.round(n/(Ge/4)),r=pm.indexOf(e);return pm[(r+t)%pm.length]}class M$ extends re{constructor(){super(...arguments);v(this,"snapshot",{});v(this,"info",{});v(this,"markId","");v(this,"onEnter",t=>{this.info=t,this.markId=this.editor.mark("rotate start");const r=g$({editor:this.editor});if(!r)return this.parent.transition("idle",this.info);this.snapshot=r,this.handleStart()});v(this,"onExit",()=>{this.editor.setCursor({type:"none"}),this.snapshot={}});v(this,"onPointerMove",()=>{this.update()});v(this,"onKeyDown",()=>{this.update()});v(this,"onKeyUp",()=>{this.update()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"update",()=>{const t=this._getRotationFromPointerPosition({snapToNearestDegree:!1});mh({editor:this.editor,delta:t,snapshot:this.snapshot,stage:"update"}),this.editor.setCursor({type:Xa[this.info.handle],rotation:t+this.snapshot.initialSelectionRotation})});v(this,"cancel",()=>{this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)});v(this,"complete",()=>{mh({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!0}),snapshot:this.snapshot,stage:"end"}),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)})}handleStart(){const t=this._getRotationFromPointerPosition({snapToNearestDegree:!1});mh({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!1}),snapshot:this.snapshot,stage:"start"}),this.editor.setCursor({type:Xa[this.info.handle],rotation:t+this.snapshot.initialSelectionRotation})}_getRotationFromPointerPosition({snapToNearestDegree:t}){const{selectionPageCenter:r,inputs:{shiftKey:o,currentPagePoint:s}}=this.editor,{initialCursorAngle:i,initialSelectionRotation:a}=this.snapshot;if(!r)return a;const l=r.angle(s)-i;let c=a+l;if(o)c=pf(c,24);else if(t&&(c=Math.round(c/Ub)*Ub,this.editor.isCoarsePointer)){const u=pf(c,4),d=nk(c,u);Math.abs(d)<EN(5)&&(c=u)}return c-a}}v(M$,"id","rotating");class iw{constructor(n){v(this,"state");v(this,"points");v(this,"size");v(this,"color");v(this,"opacity");v(this,"delay");v(this,"timeoutMs",0);v(this,"delayRemaining",0);v(this,"onUpdate");v(this,"onComplete");v(this,"prev",null);v(this,"next",null);v(this,"resume",()=>{this.state="active"});v(this,"pause",()=>{this.state="starting"});v(this,"stop",()=>{this.delayRemaining=Math.min(this.delayRemaining,200),this.state="stopping"});v(this,"addPoint",(n,t)=>{const{prev:r}=this,o={x:n,y:t,z:.5};r&&E.Dist(r,o)<1||(this.next=o)});v(this,"tick",n=>{this.timeoutMs+=n,this.delayRemaining>0&&(this.delayRemaining=Math.max(0,this.delayRemaining-n)),this.timeoutMs>=16&&(this.timeoutMs=0);const{timeoutMs:t,state:r,prev:o,next:s,points:i}=this;switch(r){case"active":{s&&s!==o?(this.prev=s,i.push(s),this.delayRemaining===0&&i.length>8&&i.shift(),this.updateScribble()):t===0&&(i.length>1?(i.shift(),this.updateScribble()):this.delayRemaining=this.delay);break}case"stopping":{if(this.delayRemaining===0&&t===0){if(i.length===1){this.state="paused",this.onComplete();return}this.size*=.9,i.shift(),this.updateScribble()}break}}});const{size:t=20,color:r="accent",opacity:o=.8,delay:s=0,onComplete:i,onUpdate:a}=n;this.onUpdate=a,this.onComplete=i,this.size=t,this.color=r,this.delay=s,this.opacity=o,this.points=[],this.state="starting",this.prev=null,this.next=null,this.delayRemaining=this.delay,this.resume()}getScribble(){return{state:this.state,size:this.size,color:this.color,opacity:this.opacity,delay:this.delay,points:[...this.points]}}updateScribble(){this.onUpdate(this.getScribble())}}class A$ extends re{constructor(){super(...arguments);v(this,"hits",new Set);v(this,"size",0);v(this,"scribble",{});v(this,"initialSelectedIds",new Set);v(this,"newlySelectedIds",new Set);v(this,"onEnter",()=>{this.initialSelectedIds=new Set(this.editor.inputs.shiftKey?this.editor.selectedIds:[]),this.newlySelectedIds=new Set,this.size=0,this.hits.clear(),this.startScribble(),this.updateBrushSelection(),requestAnimationFrame(()=>{this.editor.setBrush(null)})});v(this,"onExit",()=>{this.editor.setErasingIds([]),this.scribble.stop()});v(this,"onPointerMove",()=>{this.updateBrushSelection()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onKeyDown",()=>{this.updateBrushSelection()});v(this,"onKeyUp",()=>{this.editor.inputs.altKey?this.updateBrushSelection():this.parent.transition("brushing",{})});v(this,"startScribble",()=>{var t;this.scribble.tick&&this.editor.off("tick",(t=this.scribble)==null?void 0:t.tick),this.scribble=new iw({onUpdate:this.onScribbleUpdate,onComplete:this.onScribbleComplete,color:"selection-stroke",opacity:.32,size:12}),this.editor.on("tick",this.scribble.tick)});v(this,"pushPointToScribble",()=>{const{x:t,y:r}=this.editor.inputs.currentPagePoint;this.scribble.addPoint(t,r)});v(this,"onScribbleUpdate",t=>{this.editor.setScribble(t)});v(this,"onScribbleComplete",()=>{this.editor.off("tick",this.scribble.tick),this.editor.setScribble(null)});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()})}updateBrushSelection(){const{shapesArray:t,inputs:{originPagePoint:r,previousPagePoint:o,currentPagePoint:s}}=this.editor;this.pushPointToScribble();const i=t;let a,l;for(let c=0,u=i.length;c<u;c++)if(a=i[c],l=this.editor.getShapeUtil(a),!(this.editor.isShapeOfType(a,Ye)||this.newlySelectedIds.has(a.id)||this.editor.isShapeOfType(a,kt)&&l.hitTestPoint(a,this.editor.getPointInShapeSpace(a,r))||this.editor.isShapeOrAncestorLocked(a))&&l.hitTestLineSegment(a,this.editor.getPointInShapeSpace(a,o),this.editor.getPointInShapeSpace(a,s))){const d=this.editor.getOutermostSelectableShape(a),h=this.editor.getPageMaskById(d.id);if(h&&F1(o,s,h)!==null&&!sr(s,h))continue;this.newlySelectedIds.add(d.id)}this.editor.setSelectedIds([...new Set([...this.newlySelectedIds,...this.initialSelectedIds])],!0)}complete(){this.parent.transition("idle",{})}cancel(){this.editor.setSelectedIds([...this.initialSelectedIds],!0),this.parent.transition("idle",{})}}v(A$,"id","scribble_brushing");const J2=100;class IV{constructor(n){v(this,"prevDroppingShapeId",null);v(this,"currDroppingShapeId",null);v(this,"droppingNodeTimer",null);v(this,"dispose",()=>{this.clear()});this.editor=n,n.disposables.add(this.dispose)}updateDroppingNode(n,t){var r;if(this.droppingNodeTimer===null){const{currentPagePoint:o}=this.editor.inputs;this.currDroppingShapeId=((r=this.editor.getDroppingShape(o,n))==null?void 0:r.id)??null,this.setDragTimer(n,J2*10,t)}else this.editor.inputs.pointerVelocity.len()>.5&&(clearInterval(this.droppingNodeTimer),this.setDragTimer(n,J2,t))}setDragTimer(n,t,r){this.droppingNodeTimer=setTimeout(()=>{this.editor.batch(()=>{this.handleDrag(n,r)}),this.droppingNodeTimer=null},t)}handleDrag(n,t){var l,c,u,d,h;const{currentPagePoint:r}=this.editor.inputs;n=he(n.map(f=>this.editor.getShapeById(f.id)));const o=((l=this.editor.getDroppingShape(r,n))==null?void 0:l.id)??null;o!==this.currDroppingShapeId&&(this.prevDroppingShapeId=this.currDroppingShapeId,this.currDroppingShapeId=o);const{prevDroppingShapeId:s}=this;if(o===s)return;const i=s&&this.editor.getShapeById(s),a=o&&this.editor.getShapeById(o);if(this.prevDroppingShapeId=this.currDroppingShapeId,i&&((u=(c=this.editor.getShapeUtil(i)).onDragShapesOut)==null||u.call(c,i,n)),a){const f=(h=(d=this.editor.getShapeUtil(a)).onDragShapesOver)==null?void 0:h.call(d,a,n);f&&f.shouldHint&&this.editor.setHintingIds([a.id])}else this.editor.setHintingIds([]);t==null||t()}dropShapes(n){var r,o;const{currDroppingShapeId:t}=this;if(this.handleDrag(n),t){const s=this.editor.getShapeById(t);if(!s)return;(o=(r=this.editor.getShapeUtil(s)).onDropShapesOver)==null||o.call(r,s,n)}}clear(){this.prevDroppingShapeId=null,this.currDroppingShapeId=null,this.droppingNodeTimer!==null&&clearInterval(this.droppingNodeTimer),this.droppingNodeTimer=null,this.editor.setHintingIds([])}}class O$ extends re{constructor(){super(...arguments);v(this,"info",{});v(this,"selectionSnapshot",{});v(this,"snapshot",{});v(this,"markId","");v(this,"isCloning",!1);v(this,"isCreating",!1);v(this,"editAfterComplete",!1);v(this,"dragAndDropManager",new IV(this.editor));v(this,"onEnter",t=>{const{isCreating:r=!1,editAfterComplete:o=!1}=t;this.info=t,this.isCreating=r,this.editAfterComplete=o,this.markId=r?"creating":this.editor.mark("translating"),this.handleEnter(t),this.editor.on("tick",this.updateParent)});v(this,"updateParent",()=>{const{snapshot:t}=this;this.dragAndDropManager.updateDroppingNode(t.movingShapes,this.updateParentTransforms)});v(this,"onExit",()=>{this.editor.off("tick",this.updateParent),this.selectionSnapshot={},this.snapshot={},this.editor.snaps.clear(),this.editor.setCursor({type:"default"}),this.dragAndDropManager.clear()});v(this,"onPointerMove",()=>{this.updateShapes()});v(this,"onKeyDown",()=>{if(this.editor.inputs.altKey&&!this.isCloning){this.startCloning();return}this.updateShapes()});v(this,"onKeyUp",()=>{if(!this.editor.inputs.altKey&&this.isCloning){this.stopCloning();return}this.updateShapes()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"updateParentTransforms",()=>{const{editor:t,snapshot:{shapeSnapshots:r}}=this;r.forEach(o=>{const s=t.getShapeById(o.shape.id);if(!s)return null;const i=Qt(s.parentId)?null:Y.Inverse(t.getPageTransformById(s.parentId));o.parentTransform=i})})}reset(){this.editor.bailToMark(this.markId)}startCloning(){this.isCreating||(this.isCloning=!0,this.reset(),this.markId=this.editor.mark("translating"),this.editor.duplicateShapes(),this.snapshot=eP(this.editor),this.handleStart(),this.updateShapes())}stopCloning(){this.isCloning=!1,this.snapshot=this.selectionSnapshot,this.reset(),this.markId=this.editor.mark("translating"),this.updateShapes()}complete(){if(this.updateShapes(),this.dragAndDropManager.dropShapes(this.snapshot.movingShapes),this.handleEnd(),this.editor.instanceState.isToolLocked&&this.info.onInteractionEnd)this.editor.setSelectedTool(this.info.onInteractionEnd);else if(this.editAfterComplete){const t=this.editor.onlySelectedShape;t&&(this.editor.setEditingId(t.id),this.editor.setSelectedTool("select"),this.editor.root.current.value.transition("editing_shape",{}))}else this.parent.transition("idle",{})}cancel(){this.reset(),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd):this.parent.transition("idle",this.info)}handleEnter(t){if(this.isCloning=!1,this.info=t,this.editor.setCursor({type:"move"}),this.selectionSnapshot=eP(this.editor),!this.isCreating&&this.editor.inputs.altKey){this.startCloning();return}this.snapshot=this.selectionSnapshot,this.handleStart(),this.updateShapes()}handleStart(){const{movingShapes:t}=this.snapshot,r=[];t.forEach(o=>{var a;const s=this.editor.getShapeUtil(o),i=(a=s.onTranslateStart)==null?void 0:a.call(s,o);i&&r.push(i)}),r.length>0&&this.editor.updateShapes(r)}handleEnd(){const{movingShapes:t}=this.snapshot,r=[];t.forEach(o=>{var l;const s=this.editor.getShapeById(o.id),i=this.editor.getShapeUtil(o),a=(l=i.onTranslateEnd)==null?void 0:l.call(i,o,s);a&&r.push(a)}),r.length>0&&this.editor.updateShapes(r)}handleChange(){const{movingShapes:t}=this.snapshot,r=[];t.forEach(o=>{var l;const s=this.editor.getShapeById(o.id),i=this.editor.getShapeUtil(o),a=(l=i.onTranslate)==null?void 0:l.call(i,o,s);a&&r.push(a)}),r.length>0&&this.editor.updateShapes(r)}updateShapes(){const{snapshot:t}=this;this.dragAndDropManager.updateDroppingNode(t.movingShapes,this.updateParentTransforms),kV({editor:this.editor,shapeSnapshots:t.shapeSnapshots,averagePagePoint:t.averagePagePoint,initialSelectionPageBounds:t.initialPageBounds,initialSelectionSnapPoints:t.initialSnapPoints}),this.handleChange()}}v(O$,"id","translating");function eP(e){const n=[],t=[],r=he(e.selectedIds.map(o=>{const s=e.getShapeById(o);if(!s)return null;n.push(s);const i=e.getPagePointById(o);if(!i)return null;t.push(i);const a=Jn.isId(s.parentId)?null:Y.Inverse(e.getPageTransformById(s.parentId));return{shape:s,pagePoint:i,parentTransform:a}}));return{averagePagePoint:E.Average(t),movingShapes:n,shapeSnapshots:r,initialPageBounds:e.selectedPageBounds,initialSnapPoints:e.selectedIds.length===1?e.snaps.snapPointsCache.get(e.selectedIds[0]):e.selectedPageBounds?e.selectedPageBounds.snapPoints.map((o,s)=>({id:"selection:"+s,x:o.x,y:o.y})):[]}}function kV({editor:e,shapeSnapshots:n,averagePagePoint:t,initialSelectionPageBounds:r,initialSelectionSnapPoints:o}){const{inputs:s,isGridMode:i,gridSize:a}=e,l=E.Sub(s.currentPagePoint,s.originPagePoint),c=e.inputs.shiftKey?Math.abs(l.x)<Math.abs(l.y)?"x":"y":null;if(c==="x"?l.x=0:c==="y"&&(l.y=0),e.snaps.clear(),(e.isSnapMode?!s.ctrlKey:s.ctrlKey)&&e.inputs.pointerVelocity.len()<.5){const{nudge:f}=e.snaps.snapTranslate({dragDelta:l,initialSelectionPageBounds:r,lockedAxis:c,initialSelectionSnapPoints:o});l.add(f)}const d=E.Add(t,l);i&&!s.ctrlKey&&d.snapToGrid(a);const h=E.Sub(d,t);e.updateShapes(he(n.map(({shape:f,pagePoint:p,parentTransform:m})=>{const y=E.Add(p,h),x=m?Y.applyToPoint(m,y):y;return{id:f.id,type:f.type,x:x.x,y:x.y}})),!0)}class vh extends re{constructor(){super(...arguments);v(this,"onExit",()=>{this.editor.pageState.editingId&&this.editor.setEditingId(null)})}}v(vh,"id","select"),v(vh,"initial","idle"),v(vh,"children",()=>[yh,S$,CV,E$,$$,O$,m$,A$,_$,k$,x$,P$,T$,M$,I$,C$,b$]);var oy;let $V=(oy=class extends re{constructor(){super(...arguments);v(this,"info",{});v(this,"onEnter",t=>{this.info=t});v(this,"onPointerDown",()=>{this.parent.transition("pointing",this.info)})}},v(oy,"id","idle"),oy);var sy;let TV=(sy=class extends re{constructor(){super(...arguments);v(this,"info",{});v(this,"onEnter",t=>{this.info=t});v(this,"onPointerUp",()=>{this.complete()});v(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.parent.transition("zoom_brushing",this.info)});v(this,"onCancel",()=>{this.cancel()})}complete(){const{currentScreenPoint:t}=this.editor.inputs;this.editor.inputs.altKey?this.editor.zoomOut(t,{duration:220}):this.editor.zoomIn(t,{duration:220}),this.parent.transition("idle",this.info)}cancel(){this.parent.transition("idle",this.info)}},v(sy,"id","pointing"),sy);class R$ extends re{constructor(){super(...arguments);v(this,"info",{});v(this,"zoomBrush",new ne);v(this,"onEnter",t=>{this.info=t,this.update()});v(this,"onExit",()=>{this.editor.setZoomBrush(null)});v(this,"onPointerMove",()=>{this.update()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()})}update(){const{inputs:{originPagePoint:t,currentPagePoint:r}}=this.editor;this.zoomBrush.setTo(ne.FromPoints([t,r])),this.editor.setZoomBrush(this.zoomBrush.toJson())}cancel(){this.parent.transition("idle",this.info)}complete(){const{zoomBrush:t}=this,r=8/this.editor.zoomLevel;if(t.width<r&&t.height<r){const o=this.editor.inputs.currentScreenPoint;this.editor.inputs.altKey?this.editor.zoomOut(o,{duration:220}):this.editor.zoomIn(o,{duration:220})}else{const o=this.editor.inputs.altKey?this.editor.zoomLevel/2:void 0;this.editor.zoomToBounds(t.x,t.y,t.width,t.height,o,{duration:220})}this.parent.transition("idle",this.info)}}v(R$,"id","zoom_brushing");class wh extends re{constructor(){super(...arguments);v(this,"info",{});v(this,"onEnter",t=>{this.info=t,this.updateCursor()});v(this,"onExit",()=>{this.editor.setZoomBrush(null),this.editor.setCursor({type:"default"})});v(this,"onKeyDown",()=>{this.updateCursor()});v(this,"onKeyUp",t=>{this.updateCursor(),t.code==="KeyZ"&&this.complete()});v(this,"onInterrupt",()=>{this.complete()})}updateCursor(){this.editor.inputs.altKey?this.editor.setCursor({type:"zoom-out"}):this.editor.setCursor({type:"zoom-in"})}complete(){this.info.onInteractionEnd&&this.info.onInteractionEnd!=="select"?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):this.parent.transition("select",{})}}v(wh,"id","zoom"),v(wh,"initial","idle"),v(wh,"children",()=>[$V,R$,TV]);class xh extends re{constructor(){super(...arguments);v(this,"onKeyDown",t=>{var r;switch(t.code){case"KeyZ":{if(!(t.shiftKey||t.ctrlKey)){const o=this.current.value;o&&((r=o.current.value)==null?void 0:r.id)==="idle"&&this.editor.setSelectedTool("zoom",{...t,onInteractionEnd:o.id})}break}}})}}v(xh,"id","root"),v(xh,"initial","select"),v(xh,"children",()=>[vh,wh]);var MV=Object.defineProperty,AV=Object.getOwnPropertyDescriptor,le=(e,n,t,r)=>{for(var o=r>1?void 0:r?AV(n,t):n,s=e.length-1,i;s>=0;s--)(i=e[s])&&(o=(r?i(n,t,o):i(o))||o);return r&&o&&MV(n,t,o),o};class ae extends uK.EventEmitter{constructor({store:t,user:r,shapes:o,tools:s,getContainer:i}){super();v(this,"store");v(this,"root");v(this,"disposables",new Set);v(this,"_tickManager",new PV(this));v(this,"_updateDepth",0);v(this,"snaps",new Us(this));v(this,"user");v(this,"textMeasure");v(this,"isSafari");v(this,"isIos");v(this,"isChromeForIos");v(this,"getContainer");v(this,"history",new mV(this,()=>this._complete(),t=>{this.annotateError(t,{origin:"history.batch",willCrashApp:!0}),this.crash(t)}));v(this,"shapeUtils");v(this,"_invalidParents",new Set);v(this,"_crashingError",null);v(this,"_canMoveCamera",dt("can move camera",!0));v(this,"_isFocused",dt("_isFocused",!1));v(this,"_dpr",dt("devicePixelRatio",typeof window>"u"?1:window.devicePixelRatio));v(this,"_isCoarsePointer",dt("isCoarsePointer",!1));v(this,"_openMenus",dt("open-menus",[]));v(this,"_isChangingStyle",dt("isChangingStyle",!1));v(this,"_isChangingStyleTimeout",-1);v(this,"_isPenMode",dt("isPenMode",!1));v(this,"_isReadOnly",dt("isReadOnly",!1));v(this,"_updateInstanceState",this.history.createCommand("updateTabState",(t,r=!1,o=!1)=>{const s=this.instanceState,i={...s,...t};return{data:{prev:s,next:i},squashing:o,ephemeral:r}},{do:({next:t})=>{this.store.put([t])},undo:({prev:t})=>{this.store.put([t])},squash({prev:t},{next:r}){return{prev:t,next:r}}}));v(this,"_setInstancePageState",this.history.createCommand("setInstancePageState",(t,r=!1)=>({data:{prev:this.store.get(t.id??this.pageState.id),partial:t},ephemeral:r}),{do:({prev:t,partial:r})=>{this.store.update(t.id,o=>({...o,...r}))},undo:({prev:t})=>{this.store.update(t.id,()=>t)}}));v(this,"_setSelectedIds",this.history.createCommand("setSelectedIds",(t,r=!1)=>{const o=this.pageState.selectedIds,s=new Set(this.pageState.selectedIds);return t.length===s.size&&t.every(i=>s.has(i))?null:{data:{ids:t,prevSelectedIds:o},squashing:r,preservesRedoStack:!0}},{do:({ids:t})=>{this.store.update(this.pageState.id,r=>({...r,selectedIds:t}))},undo:({prevSelectedIds:t})=>{this.store.update(this.pageState.id,()=>({...this.pageState,selectedIds:t}))},squash(t,r){return{ids:r.ids,prevSelectedIds:t.prevSelectedIds}}}));v(this,"_setFocusLayer",this.history.createCommand("setFocusLayer",t=>t===null&&!this.canUndo?void 0:{data:{prev:this.pageState.focusLayerId,next:t},preservesRedoStack:!0,squashing:!0},{do:({next:t})=>{this.store.update(this.pageState.id,r=>({...r,focusLayerId:t}))},undo:({prev:t})=>{this.store.update(this.pageState.id,r=>({...r,focusLayerId:t}))},squash({prev:t},{next:r}){return{prev:t,next:r}}}));v(this,"_willSetInitialBounds",!0);v(this,"_viewportAnimation",null);v(this,"_cameraState",dt("camera state","idle"));v(this,"_cameraStateTimeoutRemaining",0);v(this,"_lastUpdateRenderingBoundsTimestamp",Date.now());v(this,"_decayCameraStateTimeout",t=>{this._cameraStateTimeoutRemaining-=t,this._cameraStateTimeoutRemaining<=0&&(this.off("tick",this._decayCameraStateTimeout),this._cameraState.set("idle"),this.updateRenderingBounds())});v(this,"_tickCameraState",()=>{this._cameraStateTimeoutRemaining=fz;const t=Date.now();this._cameraState.__unsafe__getWithoutCapture()==="idle"?(this._lastUpdateRenderingBoundsTimestamp=t,this._cameraState.set("moving"),this.on("tick",this._decayCameraStateTimeout)):t-this._lastUpdateRenderingBoundsTimestamp>pz&&this.updateRenderingBounds()});v(this,"_renderingBounds",dt("rendering viewport",new ne));v(this,"_renderingBoundsExpanded",dt("rendering viewport expanded",new ne));v(this,"_currentPageShapeIds");v(this,"_setCurrentPageId",this.history.createCommand("setCurrentPage",(t,{stopFollowing:r=!0}={})=>{if(!this.store.has(t)){console.error("Tried to set the current page id to a page that doesn't exist.");return}return r&&this.instanceState.followingUserId&&this.stopFollowingUser(),{data:{toId:t,fromId:this.currentPageId},squashing:!0,preservesRedoStack:!0}},{do:({toId:t})=>{if(this.store.has(t)){if(!this.getPageStateByPageId(t)){const r=Bt.create({id:Bt.createId(t)});this.store.put([r,Ft.create({id:Ft.createId(t),pageId:t})])}this.store.put([{...this.instanceState,currentPageId:t}]),this.updateRenderingBounds()}},undo:({fromId:t})=>{this.store.has(t)&&(this.store.put([{...this.instanceState,currentPageId:t}]),this.updateRenderingBounds())},squash:({fromId:t},{toId:r})=>({toId:r,fromId:t})}));v(this,"_updatePage",this.history.createCommand("updatePage",(t,r=!1)=>{if(this.isReadOnly)return null;const o=this.getPageById(t.id);return o?{data:{prev:o,partial:t},squashing:r}:null},{do:({partial:t})=>{this.store.update(t.id,r=>({...r,...t}))},undo:({prev:t,partial:r})=>{this.store.update(r.id,()=>t)},squash(t,r){return{prev:{...t.prev,...r.prev},partial:r.partial}}}));v(this,"_createPage",this.history.createCommand("createPage",(t,r=Jn.createId(),o)=>{var d,h;if(this.isReadOnly||this.pages.length>=yf)return null;const s=this.pages,i=o??((d=s[s.length-1])==null?void 0:d.index)??"a1",a=(h=s[s.findIndex(f=>f.index===i)+1])==null?void 0:h.index;t=tK(t,s.map(f=>f.name));const l=Jn.create({id:r,name:t,index:a&&i!==a?cc(i,a):po(i),meta:{}}),c=Bt.create({id:Bt.createId(l.id)}),u=Ft.create({id:Ft.createId(l.id),pageId:l.id});return{data:{prevSelectedPageId:this.currentPageId,newPage:l,newTabPageState:u,newCamera:c}}},{do:({newPage:t,newTabPageState:r,newCamera:o})=>{this.store.put([t,o,r,{...this.instanceState,currentPageId:t.id}]),this.updateRenderingBounds()},undo:({newPage:t,prevSelectedPageId:r,newTabPageState:o,newCamera:s})=>{this.pages.length!==1&&(this.store.remove([o.id,t.id,s.id]),this.store.has(r)&&this.currentPageId!==r&&this.store.put([{...this.instanceState,currentPageId:r}]),this.updateRenderingBounds())}}));v(this,"_deletePage",this.history.createCommand("delete_page",t=>{if(this.isReadOnly)return null;const{pages:r}=this;if(r.length===1)return null;const o=this.getPageById(t),s=this._pageStates.value.filter(i=>i.pageId===t);if(!o)return null;if(t===this.currentPageId){const i=r.findIndex(l=>l.id===t),a=r[i-1]??r[i+1];this.setCurrentPageId(a.id)}return{data:{id:t,deletedPage:o,deletedPageStates:s}}},{do:({deletedPage:t,deletedPageStates:r})=>{const{pages:o}=this;if(o.length!==1){if(t.id===this.currentPageId){const s=o.findIndex(a=>a.id===t.id),i=o[s-1]??o[s+1];this.setCurrentPageId(i.id)}this.store.remove(r.map(s=>s.id)),this.store.remove([t.id]),this.updateRenderingBounds()}},undo:({deletedPage:t,deletedPageStates:r})=>{this.store.put([t]),this.store.put(r),this.updateRenderingBounds()}}));v(this,"_createAssets",this.history.createCommand("createAssets",t=>this.isReadOnly||t.length<=0?null:{data:{assets:t}},{do:({assets:t})=>{this.store.put(t)},undo:({assets:t})=>{this.store.remove(t.map(r=>r.id))}}));v(this,"_deleteAssets",this.history.createCommand("deleteAssets",t=>{if(this.isReadOnly||t.length<=0)return;const r=he(t.map(o=>this.store.get(o)));return{data:{ids:t,prev:r}}},{do:({ids:t})=>{this.store.remove(t)},undo:({prev:t})=>{this.store.put(t)}}));v(this,"_updateAssets",this.history.createCommand("updateAssets",t=>this.isReadOnly||t.length<=0?void 0:{data:{snapshots:{},assets:t}},{do:({assets:t,snapshots:r})=>{this.store.put(t.map(o=>{const s=this.store.get(o.id);return r[o.id]=s,{...s,...o}}))},undo:({snapshots:t})=>{this.store.put(Object.values(t))}}));v(this,"_parentIdsToChildIds");v(this,"_childIdsCache",new yp);v(this,"_createShapes",this.history.createCommand("createShapes",(t,r=!1)=>{if(this.isReadOnly||t.length<=0)return null;const{currentPageShapeIds:o,selectedIds:s}=this,i=r?s:void 0,a=t.length+o.size>co;a&&_d(this);const l=a?t.slice(0,co-o.size):t;return l.length===0?null:{data:{currentPageId:this.currentPageId,createdIds:t.map(c=>c.id),prevSelectedIds:i,partials:l,select:r}}},{do:({createdIds:t,partials:r,select:o})=>{var l,c;const{focusLayerId:s}=this;r=r.map(u=>{if(!u.parentId||!this.store.get(u.parentId)&&!r.find(d=>d.id===u.parentId)){u={...u};const d=this.getParentIdForNewShapeAtPoint({x:u.x??0,y:u.y??0},u.type);if(u.parentId=d,Wn(d)){const h=this.getPointInShapeSpace(this.getShapeById(d),{x:u.x??0,y:u.y??0});u.x=h.x,u.y=h.y,u.rotation=-this.getPageRotationById(d)+(u.rotation??0)}return u.parentId===u.id&&(u.parentId=s),u}return u});const i=new Map,a=[];for(const u of r){const d=this.getShapeUtil(u);let h=u.index;if(!h){const y=u.parentId??s;i.has(y)||i.set(y,this.getHighestIndexForParent(y)),h=i.get(y),i.set(y,po(h))}const f=d.getDefaultProps();for(const[y,x]of d.styleProps)f[x]=this.getStyleForNextShape(y);let p=this.store.schema.types.shape.create({...u,index:h,opacity:u.opacity??this.instanceState.opacityForNextShape,parentId:u.parentId??s,props:"props"in u?{...f,...u.props}:f});if(p.index===void 0)throw Error("no index!");const m=(c=(l=this.getShapeUtil(p)).onBeforeCreate)==null?void 0:c.call(l,p);m&&(p=m),a.push(p)}a.forEach(u=>{u.meta=this.getInitialMetaForShape(u)}),this.store.put(a),o&&this.store.update(this.pageState.id,u=>({...u,selectedIds:t}))},undo:({createdIds:t,prevSelectedIds:r})=>{this.store.remove(t),r&&this.store.update(this.pageState.id,o=>({...o,selectedIds:r}))}}));v(this,"animatingShapes",new Map);v(this,"_updateShapes",this.history.createCommand("updateShapes",(t,r=!1)=>{if(this.isReadOnly)return null;const o=he(t),s=Object.fromEntries(he(o.map(({id:l})=>this.getShapeById(l))).map(l=>[l.id,l]));if(o.length<=0)return null;const i=he(o.map(l=>{const c=s[l.id];if(!c)return null;let u=null;for(const[d,h]of Object.entries(l))if(h!==void 0)switch(d){case"id":case"type":continue;default:if(h!==c[d])if(u||(u={...c}),d==="props"){const f={...c.props};for(const[p,m]of Object.entries(h))m!==void 0&&(f[p]=m);u.props=f}else if(d==="meta"){const f={...c.meta};for(const[p,m]of Object.entries(h))m!==void 0&&(f[p]=m);u.meta=f}else u[d]=h}return u??c})),a=Object.fromEntries(i.map(l=>[l.id,l]));return{data:{snapshots:s,updates:a},squashing:r}},{do:({updates:t})=>{var o,s;const r=Object.values(t);for(let i=0;i<r.length;i++){const a=r[i],l=this.store.get(a.id);if(!l)continue;const c=(s=(o=this.getShapeUtil(a)).onBeforeUpdate)==null?void 0:s.call(o,l,a);c&&(r[i]=c)}this.store.put(r)},undo:({snapshots:t})=>{this.store.put(Object.values(t))},squash(t,r){return{snapshots:{...r.snapshots,...t.snapshots},updates:{...t.updates,...r.updates}}}}));v(this,"_deleteShapes",this.history.createCommand("delete_shapes",t=>{if(this.isReadOnly||t.length===0)return null;const r=[...this.pageState.selectedIds],o=new Set(t);for(const c of t)this.visitDescendants(c,u=>{o.add(u)});const s=[...o],i=this._arrowBindingsIndex.value,a=he(s.flatMap(c=>{const u=this.getShapeById(c),d=i[c];return d&&d.length>0?d.map(({arrowId:h})=>this.getShapeById(h)).concat(u):u})),l=r.filter(c=>!o.has(c));return{data:{deletedIds:s,snapshots:a,prevSelectedIds:r,postSelectedIds:l}}},{do:({deletedIds:t,postSelectedIds:r})=>{this.store.remove(t),this.store.update(this.pageState.id,o=>({...o,selectedIds:r}))},undo:({snapshots:t,prevSelectedIds:r})=>{this.store.put(t),this.store.update(this.pageState.id,o=>({...o,selectedIds:r}))}}));v(this,"_selectionSharedStyles",G("_selectionSharedStyles",()=>{const{selectedShapes:t}=this,r=new M0;for(const o of t)this._extractSharedStyles(o,r);return r}));v(this,"externalContentManager",new uV(this));v(this,"inputs",{originPagePoint:new E,originScreenPoint:new E,previousPagePoint:new E,previousScreenPoint:new E,currentPagePoint:new E,currentScreenPoint:new E,keys:new Set,buttons:new Set,isPen:!1,shiftKey:!1,ctrlKey:!1,altKey:!1,isDragging:!1,isPointing:!1,isPinching:!1,isEditing:!1,isPanning:!1,pointerVelocity:new E});v(this,"_clickManager",new cV(this));v(this,"_prevCursor","default");v(this,"_shiftKeyTimeout",-1);v(this,"_setShiftKeyTimeout",()=>{this.inputs.shiftKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Shift",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"ShiftLeft"})});v(this,"_altKeyTimeout",-1);v(this,"_setAltKeyTimeout",()=>{this.inputs.altKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Alt",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"AltLeft"})});v(this,"_ctrlKeyTimeout",-1);v(this,"_setCtrlKeyTimeout",()=>{this.inputs.ctrlKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Ctrl",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"ControlLeft"})});v(this,"_restoreToolId","select");v(this,"_pinchStart",1);v(this,"_didPinch",!1);v(this,"_selectedIdsAtPointerDown",[]);v(this,"capturedPointerId",null);this.store=t,this.user=new EV(r??Hk()),this.getContainer=i??(()=>document.body),this.textMeasure=new bV(this),this.root=new xh(this);const a=d$(o),l=new Set(Object.keys(t.schema.types.shape.migrations.subTypeMigrations));for(const p of a){if(!l.has(p.type))throw Error(`Editor and store have different shapes: "${p.type}" was passed into the editor but not the schema`);l.delete(p.type)}if(l.size>0)throw Error(`Editor and store have different shapes: "${[...l][0]}" is present in the store schema but not provided to the editor`);const c={},u=new Map;for(const{util:p,props:m}of a){const y=GI(m??{});c[p.type]=new p(this,p.type,y);for(const x of y.keys())if(!u.has(x.id))u.set(x.id,x);else if(u.get(x.id)!==x)throw Error(`Multiple style props with id "${x.id}" in use. Style prop IDs must be unique.`)}this.shapeUtils=c;for(const{tool:p}of a)if(p){if(Dc(this.root.children,p.id))throw Error(`Can't override tool with id "${p.id}"`);this.root.children[p.id]=new p(this)}for(const p of s){if(Dc(this.root.children,p.id))throw Error(`Can't override tool with id "${p.id}"`);this.root.children[p.id]=new p(this)}typeof window<"u"&&"navigator"in window?(this.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this.isIos=!!navigator.userAgent.match(/iPad/i)||!!navigator.userAgent.match(/iPhone/i),this.isChromeForIos=/crios.*safari/i.test(navigator.userAgent)):(this.isSafari=!1,this.isIos=!1,this.isChromeForIos=!1),this.store.onBeforeDelete=p=>{p.typeName==="shape"?this._shapeWillBeDeleted(p):p.typeName==="page"&&this._pageWillBeDeleted(p)},this.store.onAfterChange=(p,m)=>{this._updateDepth++,this._updateDepth>1e3&&console.error("[onAfterChange] Maximum update depth exceeded, bailing out."),p.typeName==="shape"&&m.typeName==="shape"?this._shapeDidChange(p,m):p.typeName==="instance_page_state"&&m.typeName==="instance_page_state"&&this._pageStateDidChange(p,m),this._updateDepth--},this.store.onAfterCreate=p=>{if(p.typeName==="shape"&&this.isShapeOfType(p,Fe)&&this._arrowDidUpdate(p),p.typeName==="page"){const m=Bt.createId(p.id),y=Ft.createId(p.id);this.store.has(m)||this.store.put([Bt.create({id:m})]),this.store.has(y)||this.store.put([Ft.create({id:y,pageId:p.id})])}},this._currentPageShapeIds=aV(this.store,()=>this.currentPageId),this._parentIdsToChildIds=iV(this.store),this.disposables.add(this.store.listen(p=>{this.emit("change",p)}));const d=this.getContainer(),h=()=>{this._isFocused.set(!0)},f=()=>{this._isFocused.set(!1)};d.addEventListener("focusin",h),d.addEventListener("focus",h),d.addEventListener("focusout",f),d.addEventListener("blur",f),this.disposables.add(()=>{d.removeEventListener("focusin",h),d.removeEventListener("focus",h),d.removeEventListener("focusout",f),d.removeEventListener("blur",f)}),this.store.ensureStoreIsUsable(),this.setPageState({editingId:null,hoveredId:null,erasingIds:[]},!0),this.root.enter(void 0,"initial"),this.instanceState.followingUserId&&this.stopFollowingUser(),this.updateRenderingBounds(),requestAnimationFrame(()=>{this._tickManager.start()})}dispose(){this.disposables.forEach(t=>t()),this.disposables.clear()}undo(){return this.history.undo()}get canUndo(){return this.history.numUndos>0}redo(){return this.history.redo(),this}get canRedo(){return this.history.numRedos>0}mark(t,r,o){return this.history.mark(t,r,o)}bail(){return this.history.bail(),this}bailToMark(t){return this.history.bailToMark(t),this}batch(t){return this.history.batch(t),this}getShapeUtil(t){const r=gi(this.shapeUtils,t.type);return Rc(r,`No shape util found for type "${t.type}"`),"prototype"in t&&t.prototype instanceof eo&&Rc(r instanceof t,`Shape util found for type "${t.type}" is not an instance of the provided constructor`),r}get _arrowBindingsIndex(){return sV(this)}getArrowsBoundTo(t){return this._arrowBindingsIndex.value[t]||br}_reparentArrow(t){const r=this.getShapeById(t);if(!r)return;const{start:o,end:s}=r.props,i=o.type==="binding"?this.getShapeById(o.boundShapeId):void 0,a=s.type==="binding"?this.getShapeById(s.boundShapeId):void 0,l=this.getAncestorPageId(r);if(!l)return;let c;if(i&&a)c=this.findCommonAncestor([i,a])??l;else if(i||a)c=l;else return;c&&c!==r.parentId&&this.reparentShapesById([t],c);const u=this.getShapeById(t);if(!u)throw Error("no reparented arrow");const d=this.getShapeNearestSibling(u,i),h=this.getShapeNearestSibling(u,a);let f;if(d&&h)f=d.index>h.index?d:h;else if(d&&!h)f=d;else if(h&&!d)f=h;else return;let p;const m=this.getSortedChildIds(f.parentId).map(y=>this.getShapeById(y)).filter(y=>y.index>f.index);if(m.length){const y=m.find(x=>x.type!=="arrow");if(u.index>f.index&&(!y||u.index<y.index))return;p=cc(f.index,m[0].index)}else p=po(f.index);p!==u.index&&this.updateShapes([{id:t,type:"arrow",index:p}])}_unbindArrowTerminal(t,r){const{x:o,y:s}=Sr(this,t)[r];this.store.put([{...t,props:{...t.props,[r]:{type:"point",x:o,y:s}}}])}get _allPageStates(){return this.store.query.records("instance_page_state")}_shapeWillBeDeleted(t){t.parentId&&Wn(t.parentId)&&this._invalidParents.add(t.parentId);const r=this._arrowBindingsIndex.value[t.id];if(r!=null&&r.length)for(const{arrowId:a,handleId:l}of r){const c=this.getShapeById(a);c&&this._unbindArrowTerminal(c,l)}const o=this._allPageStates.value,s=new Set([t.id]),i=he(o.map(a=>this._cleanupInstancePageState(a,s)));i.length&&this.store.put(i)}_arrowDidUpdate(t){for(const r of["start","end"]){const o=t.props[r];if(o.type!=="binding")continue;const s=this.getShapeById(o.boundShapeId),i=this.getAncestorPageId(t)===this.getAncestorPageId(s);(!s||!i)&&this._unbindArrowTerminal(t,r)}this._reparentArrow(t.id)}_complete(){var t;for(const r of this._invalidParents){this._invalidParents.delete(r);const o=this.getShapeById(r);if(!o)continue;const s=this.getShapeUtil(o),i=(t=s.onChildrenChange)==null?void 0:t.call(s,o);i!=null&&i.length&&this.updateShapes(i,!0)}this.emit("update")}_shapeDidChange(t,r){if(this.isShapeOfType(r,Fe)&&this._arrowDidUpdate(r),t.parentId!==r.parentId){const o=s=>{const i=this._arrowBindingsIndex.value[s];if(i!=null&&i.length)for(const a of i)this._reparentArrow(a.arrowId)};o(r.id),this.visitDescendants(r.id,o)}if(t.parentId!==r.parentId&&Qt(r.parentId)){const o=new Set([t.id]);this.visitDescendants(t.id,s=>{o.add(s)});for(const s of this._allPageStates.value){if(s.pageId===r.parentId)continue;const i=this._cleanupInstancePageState(s,o);i&&this.store.put([i])}}t.parentId&&Wn(t.parentId)&&this._invalidParents.add(t.parentId),r.parentId!==t.parentId&&Wn(r.parentId)&&this._invalidParents.add(r.parentId)}_pageStateDidChange(t,r){if((t==null?void 0:t.selectedIds)!==(r==null?void 0:r.selectedIds)){const o=r.selectedIds.filter(i=>{var l,c;let a=(l=this.getShapeById(i))==null?void 0:l.parentId;for(;Wn(a);){if(r.selectedIds.includes(a))return!1;a=(c=this.getShapeById(a))==null?void 0:c.parentId}return!0}),s=o.length===0?r==null?void 0:r.focusLayerId:this.findCommonAncestor(he(o.map(i=>this.getShapeById(i))),i=>this.isShapeOfType(i,Ye));(o.length!==r.selectedIds.length||s!=r.focusLayerId)&&this.store.put([{...r,selectedIds:o,focusLayerId:s??null}])}}_pageWillBeDeleted(t){var i;if(this.instanceState.currentPageId!==t.id)return;const r=(i=this.pages.find(a=>a.id!==t.id))==null?void 0:i.id;if(!r)return;this.store.put([{...this.instanceState,currentPageId:r}]);const o=Bt.createId(t.id),s=Ft.createId(t.id);this.store.remove([o,s])}annotateError(t,{origin:r,willCrashApp:o,tags:s,extras:i}){const a=this.createErrorAnnotations(r,o);E1(t,{tags:{...a.tags,...s},extras:{...a.extras,...i}}),o&&this.store.markAsPossiblyCorrupted()}createErrorAnnotations(t,r){try{return{tags:{origin:t,willCrashApp:r},extras:{activeStateNode:this.root.path.value,selectedShapes:this.selectedShapes,editingShape:this.editingId?this.getShapeById(this.editingId):void 0,inputs:this.inputs}}}catch{return{tags:{origin:t,willCrashApp:r},extras:{}}}}get crashingError(){return this._crashingError}crash(t){this._crashingError=t,this.store.markAsPossiblyCorrupted(),this.emit("crash",{error:t})}isIn(t){const r=t.split(".").reverse();let o=this.root;for(;r.length>0;){const s=r.pop();if(!s)return!0;const i=o.current.value;if((i==null?void 0:i.id)===s){if(r.length===0)return!0;o=i;continue}else return!1}return!1}isInAny(...t){return t.some(r=>this.isIn(r))}get currentToolId(){var o;const t=this.root.current.value;let r=t==null?void 0:t.id;if(r==="select"||r==="zoom"){const s=t==null?void 0:t.current.value;r=((o=s==null?void 0:s.info)==null?void 0:o.onInteractionEnd)??"select"}return r??"select"}setSelectedTool(t,r={}){return this.root.transition(t,r),this}getStateDescendant(t){var s;const r=t.split(".").reverse();let o=this.root;for(;r.length>0;){const i=r.pop();if(!i)return o;const a=(s=o.children)==null?void 0:s[i];if(!a)return;o=a}return o}blur(){return this.complete(),this.getContainer().blur(),this._isFocused.set(!1),this}focus(){return this.getContainer().focus(),this._isFocused.set(!0),this}get canMoveCamera(){return this._canMoveCamera.value}set canMoveCamera(t){this._canMoveCamera.set(t)}get isFocused(){return this._isFocused.value}get devicePixelRatio(){return this._dpr.value}setDevicePixelRatio(t){return this._dpr.set(t),this}get isCoarsePointer(){return this._isCoarsePointer.value}set isCoarsePointer(t){this._isCoarsePointer.set(t)}get openMenus(){return this._openMenus.value}addOpenMenu(t){const r=new Set(this.openMenus);return r.has(t)||(r.add(t),this._openMenus.set([...r])),this}deleteOpenMenu(t){const r=new Set(this.openMenus);return r.has(t)&&(r.delete(t),this._openMenus.set([...r])),this}get isMenuOpen(){return this.openMenus.length>0}get isChangingStyle(){return this._isChangingStyle.value}set isChangingStyle(t){this._isChangingStyle.set(t),clearTimeout(this._isChangingStyleTimeout),t&&(this._isChangingStyleTimeout=setTimeout(()=>this.isChangingStyle=!1,2e3))}get isPenMode(){return this._isPenMode.value}setPenMode(t){return t!==this.isPenMode&&this._isPenMode.set(t),this}setReadOnly(t){return this._isReadOnly.set(t),t&&this.setSelectedTool("hand"),this}get isReadOnly(){return this._isReadOnly.value}get documentSettings(){return this.store.get(b0)}updateDocumentSettings(t){this.store.put([{...this.documentSettings,...t}])}get gridSize(){return this.documentSettings.gridSize}get projectName(){return this.documentSettings.name}setProjectName(t){this.updateDocumentSettings({name:t})}get locale(){return this.user.locale}setLocale(t){this.user.updateUserPreferences({locale:t})}get isSnapMode(){return this.user.isSnapMode}setSnapMode(t){return t!==this.isSnapMode&&this.user.updateUserPreferences({isSnapMode:t}),this}get isDarkMode(){return this.user.isDarkMode}setDarkMode(t){return t!==this.isDarkMode&&this.user.updateUserPreferences({isDarkMode:t}),this}get animationSpeed(){return this.user.animationSpeed}setAnimationSpeed(t){return t!==this.animationSpeed&&this.user.updateUserPreferences({animationSpeed:t}),this}get instanceState(){return this.store.get(hn)}get cursor(){return this.instanceState.cursor}get brush(){return this.instanceState.brush}setBrush(t=null){return!t&&!this.brush?this:(this.updateInstanceState({brush:t},!0),this)}get zoomBrush(){return this.instanceState.zoomBrush}setZoomBrush(t=null){return!t&&!this.zoomBrush?this:(this.updateInstanceState({zoomBrush:t},!0),this)}get scribble(){return this.instanceState.scribble}setScribble(t=null){return this.updateInstanceState({scribble:t},!0),this}get isFocusMode(){return this.instanceState.isFocusMode}setFocusMode(t){return t!==this.isFocusMode&&this.updateInstanceState({isFocusMode:t},!0),this}get isToolLocked(){return this.instanceState.isToolLocked}setToolLocked(t){return t!==this.isToolLocked&&this.updateInstanceState({isToolLocked:t},!0),this}get isGridMode(){return this.instanceState.isGridMode}setGridMode(t){return t!==this.isGridMode&&this.updateInstanceState({isGridMode:t},!0),this}updateInstanceState(t,r=!1,o=!1){return this._updateInstanceState(t,r,o),this}setCursor(t){const r=this.cursor,o={...r,rotation:0,...t};return r.type===o.type&&r.rotation===o.rotation&&r.color===o.color||this.updateInstanceState({cursor:o},!0),this}get _pageStates(){return this.store.query.records("instance_page_state")}getPageStateByPageId(t){return this._pageStates.value.find(r=>r.pageId===t)}get pageStateId(){return Ft.createId(this.currentPageId)}get pageState(){return this.store.get(this.pageStateId)}setPageState(t,r=!1){this._setInstancePageState(t,r)}get selectedIds(){return this.pageState.selectedIds}get selectedIdsSet(){return new Set(this.selectedIds)}setSelectedIds(t,r=!1){return this._setSelectedIds(t,r),this}isSelected(t){return this.selectedIdsSet.has(t)}isWithinSelection(t){const r=this.getShapeById(t);return r?this.isSelected(t)?!0:!!this.findAncestor(r,o=>this.isSelected(o.id)):!1}select(...t){return this.setSelectedIds(t),this}deselect(...t){const{selectedIds:r}=this;return r.length>0&&t.length>0&&this.setSelectedIds(r.filter(o=>!t.includes(o))),this}selectAll(){const t=this.getSortedChildIds(this.currentPageId);return t.length<=0?this:(this.setSelectedIds(this._getUnlockedShapeIds(t)),this)}selectNone(){return this.selectedIds.length>0&&this.setSelectedIds([]),this}get selectedShapes(){const{selectedIds:t}=this.pageState;return he(t.map(r=>this.store.get(r)))}get onlySelectedShape(){const{selectedShapes:t}=this;return t.length===1?t[0]:null}get selectedPageBounds(){const{pageState:{selectedIds:t}}=this;return t.length===0?null:ne.Common(he(t.map(r=>this.getPageBoundsById(r))))}get selectionRotation(){const{selectedIds:t}=this;if(t.length===0)return 0;if(t.length===1)return this.getPageRotationById(this.selectedIds[0]);const r=t.map(o=>this.getPageRotationById(o)%(Math.PI/2));return r.every(o=>Math.abs(o-r[0])<Math.PI/180)?this.getPageRotationById(t[0]):0}get selectionBounds(){const{selectedIds:t}=this;if(t.length===0)return;const{selectionRotation:r}=this;if(r===0)return this.selectedPageBounds;if(t.length===1){const i=this.getBounds(this.getShapeById(t[0])).clone();return i.point=Y.applyToPoint(this.getPageTransformById(t[0]),i.point),i}const o=this.selectedIds.flatMap(i=>{const a=this.getPageTransformById(i);return a?this.getOutlineById(i).map(l=>Y.applyToPoint(a,l)):[]}).map(i=>E.Rot(i,-r)),s=ne.FromPoints(o);return s.point=s.point.rot(r),s}get selectionPageCenter(){const{selectionBounds:t,selectionRotation:r}=this;return t?E.RotWith(t.center,t.point,r):null}get focusLayerId(){return this.pageState.focusLayerId??this.currentPageId}get focusLayerShape(){const t=this.pageState.focusLayerId;if(t)return this.getShapeById(t)}popFocusLayer(){const t=this.pageState.focusLayerId,r=t&&this.getShapeById(t);if(r){const o=this.findAncestor(r,s=>this.isShapeOfType(s,Ye));this.setFocusLayer((o==null?void 0:o.id)??null),this.select(r.id)}else this.setFocusLayer(null),this.selectNone();return this}setFocusLayer(t){return this._setFocusLayer(t),this}get editingId(){return this.pageState.editingId}setEditingId(t){if(!t)this.setPageState({editingId:null});else if(t!==this.editingId){const r=this.getShapeById(t),o=this.getShapeUtil(r);r&&o.canEdit(r)&&this.setPageState({editingId:t,hoveredId:null},!1)}return this}get editingShape(){return this.editingId?this.getShapeById(this.editingId)??null:null}get hoveredId(){return this.pageState.hoveredId}setHoveredId(t=null){return t===this.pageState.hoveredId?this:(this.setPageState({hoveredId:t},!0),this)}get hoveredShape(){return this.hoveredId?this.getShapeById(this.hoveredId)??null:null}get hintingIds(){return this.pageState.hintingIds}setHintingIds(t){return this.store.update(this.pageState.id,r=>({...r,hintingIds:rf(t)})),this}get erasingIds(){return this.pageState.erasingIds}get erasingIdsSet(){return new Set(this.erasingIds)}setErasingIds(t=[]){const r=this.erasingIdsSet;return t.length===r.size&&t.every(o=>r.has(o))?this:(this.setPageState({erasingIds:t},!0),this)}get croppingId(){return this.pageState.croppingId}setCroppingId(t){if(t!==this.croppingId)if(!t)this.setPageState({croppingId:null}),this.isInAny("select.crop","select.pointing_crop_handle","select.cropping")&&this.setSelectedTool("select.idle");else{const r=this.getShapeById(t),o=this.getShapeUtil(r);r&&o.canCrop(r)&&this.setPageState({croppingId:t,hoveredId:null})}return this}_cleanupInstancePageState(t,r){let o=null;const s=t.selectedIds.filter(l=>!r.has(l));s.length!==t.selectedIds.length&&(o||(o={...t}),o.selectedIds=s);const i=t.erasingIds.filter(l=>!r.has(l));i.length!==t.erasingIds.length&&(o||(o={...t}),o.erasingIds=i),t.hoveredId&&r.has(t.hoveredId)&&(o||(o={...t}),o.hoveredId=null),t.editingId&&r.has(t.editingId)&&(o||(o={...t}),o.editingId=null);const a=t.hintingIds.filter(l=>!r.has(l));return a.length!==t.hintingIds.length&&(o||(o={...t}),o.hintingIds=a),t.focusLayerId&&r.has(t.focusLayerId)&&(o||(o={...t}),o.focusLayerId=null),o}get cameraId(){return Bt.createId(this.currentPageId)}get camera(){return this.store.get(this.cameraId)}get zoomLevel(){return this.camera.z}_setCamera(t,r,o=this.camera.z){const s=this.camera;if(s.x===t&&s.y===r&&s.z===o)return this;const i={...s,x:t,y:r,z:o};return this.batch(()=>{this.store.put([i]);const{currentScreenPoint:a}=this.inputs;this.dispatch({type:"pointer",target:"canvas",name:"pointer_move",point:a,pointerId:Zb.CAMERA_MOVE,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,shiftKey:this.inputs.shiftKey,button:0,isPen:this.isPenMode??!1}),this._tickCameraState()}),this}setCamera(t,r,o=this.camera.z,{stopFollowing:s=!0}={}){return this.stopCameraAnimation(),s&&this.instanceState.followingUserId&&this.stopFollowingUser(),t=Number.isNaN(t)?0:t,r=Number.isNaN(r)?0:r,o=Number.isNaN(o)?1:o,this._setCamera(t,r,o),this}animateCamera(t,r,o=this.camera.z,s=qb){t=Number.isNaN(t)?0:t,r=Number.isNaN(r)?0:r,o=Number.isNaN(o)?1:o;const{width:i,height:a}=this.viewportScreenBounds,l=i/o,c=a/o,u=new ne(-t,-r,l,c);return this._animateToViewport(u,s)}centerOnPoint(t,r,o){if(!this.canMoveCamera)return this;const{viewportPageBounds:{width:s,height:i},camera:a}=this;return o!=null&&o.duration?this.animateCamera(-(t-s/2),-(r-i/2),a.z,o):this.setCamera(-(t-s/2),-(r-i/2),a.z),this}zoomToContent(){const t=this.selectedPageBounds??this.allShapesCommonBounds;return t&&this.zoomToBounds(t.minX,t.minY,t.width,t.height,Math.min(1,this.zoomLevel),{duration:220}),this}zoomToFit(t){if(!this.canMoveCamera)return this;const r=[...this.currentPageShapeIds];if(r.length<=0)return this;const o=ne.Common(he(r.map(s=>this.getPageBoundsById(s))));return this.zoomToBounds(o.minX,o.minY,o.width,o.height,void 0,t),this}resetZoom(t=this.viewportScreenCenter,r){if(!this.canMoveCamera)return this;const{x:o,y:s,z:i}=this.camera,{x:a,y:l}=t;return r!=null&&r.duration?this.animateCamera(o+(a/1-a)-(a/i-a),s+(l/1-l)-(l/i-l),1,r):this.setCamera(o+(a/1-a)-(a/i-a),s+(l/1-l)-(l/i-l),1),this}zoomIn(t=this.viewportScreenCenter,r){if(!this.canMoveCamera)return this;const{x:o,y:s,z:i}=this.camera;let a=ss;for(let u=1;u<qi.length;u++){const d=qi[u-1],h=qi[u];if(!(h-i<=(h-d)/2)){a=h;break}}const{x:l,y:c}=t;return r!=null&&r.duration?this.animateCamera(o+(l/a-l)-(l/i-l),s+(c/a-c)-(c/i-c),a,r):this.setCamera(o+(l/a-l)-(l/i-l),s+(c/a-c)-(c/i-c),a),this}zoomOut(t=this.viewportScreenCenter,r){if(!this.canMoveCamera)return this;const{x:o,y:s,z:i}=this.camera;let a=Dl;for(let u=qi.length-1;u>0;u--){const d=qi[u-1],h=qi[u];if(!(h-i>=(h-d)/2)){a=d;break}}const{x:l,y:c}=t;return r!=null&&r.duration?this.animateCamera(o+(l/a-l)-(l/i-l),s+(c/a-c)-(c/i-c),a,r):this.setCamera(o+(l/a-l)-(l/i-l),s+(c/a-c)-(c/i-c),a),this}zoomToSelection(t){if(!this.canMoveCamera)return this;const r=this.selectedIds;if(r.length<=0)return this;const o=ne.Common(he(r.map(s=>this.getPageBoundsById(s))));return this.zoomToBounds(o.minX,o.minY,o.width,o.height,Math.max(1,this.camera.z),t),this}panZoomIntoView(t,r){if(!this.canMoveCamera)return this;if(t.length<=0)return this;const o=ne.Common(he(t.map(i=>this.getPageBoundsById(i)))),{viewportPageBounds:s}=this;if(s.h<o.h||s.w<o.w)return this.zoomToBounds(o.minX,o.minY,o.width,o.height,this.camera.z,r),this;{const i=this.viewportPageBounds.clone().expandBy(-32/this.zoomLevel);let a=0,l=0;i.maxY<o.maxY?l=i.maxY-o.maxY:i.minY>o.minY&&(l=i.minY-o.minY),i.maxX<o.maxX?a=i.maxX-o.maxX:i.minX>o.minX&&(a=i.minX-o.minX);const{camera:c}=this;r!=null&&r.duration?this.animateCamera(c.x+a,c.y+l,c.z,r):this.setCamera(c.x+a,c.y+l,c.z)}return this}zoomToBounds(t,r,o,s,i,a){if(!this.canMoveCamera)return this;const{viewportScreenBounds:l}=this,c=Math.min(256,l.width*.28);let u=xr(Math.min((l.width-c)/o,(l.height-c)/s),Dl,ss);return i!==void 0&&(u=Math.min(i,u)),a!=null&&a.duration?this.animateCamera(-t+(l.width-o*u)/2/u,-r+(l.height-s*u)/2/u,u,a):this.setCamera(-t+(l.width-o*u)/2/u,-r+(l.height-s*u)/2/u,u),this}pan(t,r,o){if(!this.canMoveCamera)return this;const{camera:s}=this,{x:i,y:a,z:l}=s,c=new E(t,r).div(l);return(o==null?void 0:o.duration)??0>0?this.animateCamera(i+c.x,a+c.y,l,o):(this.setCamera(i+c.x,a+c.y,l),this)}stopCameraAnimation(){return this.emit("stop-camera-animation"),this}_animateViewport(t){if(!this._viewportAnimation)return;const r=()=>{this.removeListener("tick",this._animateViewport),this.removeListener("stop-camera-animation",r),this._viewportAnimation=null};this.once("stop-camera-animation",r),this._viewportAnimation.elapsed+=t;const{elapsed:o,easing:s,duration:i,start:a,end:l}=this._viewportAnimation;if(o>i){const b=this.viewportScreenBounds.width/l.width,P=-l.x,C=-l.y;this._setCamera(P,C,b),r();return}const c=i-o,u=s(1-c/i),d=a.minX+(l.minX-a.minX)*u,h=a.minY+(l.minY-a.minY)*u,f=a.maxX+(l.maxX-a.maxX)*u,p=a.maxY+(l.maxY-a.maxY)*u,m=new ne(d,h,f-d,p-h),y=this.viewportScreenBounds.width/m.width,x=-m.x,S=-m.y;this._setCamera(x,S,y)}_animateToViewport(t,r={}){const{duration:o=0,easing:s=Kt.easeInOutCubic}=r,{animationSpeed:i,viewportPageBounds:a}=this;return this.stopCameraAnimation(),this.instanceState.followingUserId&&this.stopFollowingUser(),o===0||i===0?this._setCamera(-t.x,-t.y,this.viewportScreenBounds.width/t.width):(this._viewportAnimation={elapsed:0,duration:o/i,easing:s,start:a.clone(),end:t},this.addListener("tick",this._animateViewport),this)}slideCamera(t={}){if(!this.canMoveCamera)return this;this.stopCameraAnimation();const{animationSpeed:r}=this;if(r===0)return;const{speed:o,friction:s,direction:i,speedThreshold:a=.01}=t;let l=Math.min(o,1);const c=()=>{this.removeListener("tick",u),this.removeListener("stop-camera-animation",c)};this.once("stop-camera-animation",c);const u=d=>{const{x:h,y:f,z:p}=this.camera,m=i.clone().mul(l*d/p);l*=1-s,l<a?c():this._setCamera(h+m.x,f+m.y,p)};return this.addListener("tick",u),this}animateToUser(t){const o=[...this.store.query.records("instance_presence",()=>({userId:{eq:t}})).value].sort((s,i)=>s.lastActivityTimestamp-i.lastActivityTimestamp).pop();o&&this.batch(()=>{this.instanceState.followingUserId!==null&&this.stopFollowingUser();const s=o.currentPageId===this.currentPageId;s||this.setCurrentPageId(o.currentPageId);const i=s?{duration:500}:void 0,a=o.cursor;this.centerOnPoint(a.x,a.y,i);const{highlightedUserIds:l}=this.instanceState;this.updateInstanceState({highlightedUserIds:[...l,t]}),setTimeout(()=>{const c=[...this.instanceState.highlightedUserIds],u=c.indexOf(t);u<0||(c.splice(u,1),this.updateInstanceState({highlightedUserIds:c}))},hk)})}animateToShape(t,r=qb){if(!this.canMoveCamera)return this;const o=this.viewportScreenBounds.clone().expandBy(-32),s=o.width/o.height,i=this.getPageBoundsById(t);if(!i)return this;const a=i.width/i.height,l=i.clone(),c=i.width/o.width;return l.width+=(o.minX+o.maxX)*c,l.height+=(o.minY+o.maxY)*c,l.x-=o.minX*c,l.y-=o.minY*c,a>s?(l.height=i.width/s,l.y-=(l.height-i.height)/2):(l.width=i.height*s,l.x-=(l.width-i.width)/2),this._animateToViewport(l,r)}updateViewportScreenBounds(t=!1){const r=this.getContainer();if(!r)return this;const o=r.getBoundingClientRect(),s=new ne(0,0,Math.max(o.width,1),Math.max(o.height,1)),i=s.equals(this.viewportScreenBounds),{_willSetInitialBounds:a}=this;if(i)this._willSetInitialBounds=!1;else if(a)this._willSetInitialBounds=!1,this.updateInstanceState({screenBounds:s.toJson()},!0,!0);else{const{zoomLevel:c}=this;if(t){const u=this.viewportPageCenter;this.updateInstanceState({screenBounds:s.toJson()},!0,!0);const d=this.viewportPageCenter;this.instanceState.followingUserId||this.pan((d.x-u.x)*c,(d.y-u.y)*c)}else{const u=this.screenToPage(0,0);this.updateInstanceState({screenBounds:s.toJson()},!0,!0);const d=this.screenToPage(0,0);this.instanceState.followingUserId||this.pan((d.x-u.x)*c,(d.y-u.y)*c)}}this._tickCameraState(),this.updateRenderingBounds();const{editingId:l}=this;return l&&this.panZoomIntoView([l]),this}get viewportScreenBounds(){const{x:t,y:r,w:o,h:s}=this.instanceState.screenBounds;return new ne(t,r,o,s)}get viewportScreenCenter(){return this.viewportScreenBounds.center}get viewportPageBounds(){const{x:t,y:r,w:o,h:s}=this.viewportScreenBounds,i=this.screenToPage(t,r),a=this.screenToPage(t+o,r+s);return new ne(i.x,i.y,a.x-i.x,a.y-i.y)}get viewportPageCenter(){return this.viewportPageBounds.center}screenToPage(t,r,o=.5,s=this.camera){const{screenBounds:i}=this.store.unsafeGetWithoutCapture(hn),{x:a,y:l,z:c=1}=s;return{x:(t-i.x)/c-a,y:(r-i.y)/c-l,z:o}}pageToScreen(t,r,o=.5,s=this.camera){const{x:i,y:a,z:l=1}=s;return{x:t+i*l,y:r+a*l,z:o}}startFollowingUser(t){const r=this.store.query.records("instance_presence",()=>({userId:{eq:t}})),o=this.user.id;if(o||console.warn("You should set the userId for the current instance before following a user"),r.value.some(l=>l.followingUserId===o))return;Gn(()=>{this.stopFollowingUser(),this.updateInstanceState({followingUserId:t},!0)});const s=()=>{this.removeListener("frame",a),this.removeListener("stop-following",s)};let i=!1;const a=()=>{const l=[...r.value].sort((B,D)=>B.lastActivityTimestamp-D.lastActivityTimestamp).pop();if(!l){this.stopFollowingUser();return}const c=l.currentPageId===this.currentPageId,u=c?ZN:1;c||this.setCurrentPageId(l.currentPageId,{stopFollowing:!1});const{center:d,width:h,height:f}=this.viewportPageBounds,p=ne.From(l.screenBounds),m=p.width/l.camera.z,y=p.height/l.camera.z,x=new E(m/2-l.camera.x,y/2-l.camera.y),S=l.followingUserId===o,b=h+(m-h)*u,P=f+(y-f)*u,C=S?f/P:Math.min(h/b,f/P),_=xr(this.camera.z*C,Dl,ss),I=this.viewportScreenBounds.w/_,k=this.viewportScreenBounds.h/_,T=x.sub(d),M=E.Add(d,E.Mul(T,u)),O=E.Sub(M,d).len(),z=Math.abs(_-this.camera.z);if(O<JN&&z<tz){i=!0;return}i&&O<ez&&z<nz||(i=!1,this.stopCameraAnimation(),this.setCamera(-(M.x-I/2),-(M.y-k/2),_,{stopFollowing:!1}))};return this.once("stop-following",s),this.addListener("frame",a),this}stopFollowingUser(){return this.updateInstanceState({followingUserId:null},!0),this.emit("stop-following"),this}get cameraState(){return this._cameraState.value}computeUnorderedRenderingShapes(t,{renderingBounds:r,renderingBoundsExpanded:o,erasingIdsSet:s,editingId:i}={}){const a=[];let l=co,c=0;const u=(d,h,f)=>{if(Jn.isId(d)){for(const _ of this.getSortedChildIds(d))u(_,h,f);return}const p=this.getShapeById(d);if(!p)return;let m=p.opacity*h,y=!1;!f&&(s!=null&&s.has(d))&&(y=!0,m*=.32);const x=this.getMaskedPageBoundsById(d),S=x?(r==null?void 0:r.includes(x))??!0:!1,b=x?(i!==d&&!(o!=null&&o.includes(x)))??!0:!0;a.push({id:d,index:l,backgroundIndex:c,opacity:m,isCulled:b,isInViewport:S,maskedPageBounds:x}),l+=1,c+=1;const P=this.getSortedChildIds(d);if(!P.length)return;let C=null;this.getShapeUtil(p).providesBackgroundForChildren(p)&&(C=c,c=l,l+=co);for(const _ of P)u(_,m,f||y);C!==null&&(c=C)};for(const d of t)u(d,1,!1);return a}get renderingShapes(){return this.computeUnorderedRenderingShapes([this.currentPageId],{renderingBounds:this.renderingBounds,renderingBoundsExpanded:this.renderingBoundsExpanded,erasingIdsSet:this.erasingIdsSet,editingId:this.editingId}).sort(Lj)}get renderingBounds(){return this._renderingBounds.value}get renderingBoundsExpanded(){return this._renderingBoundsExpanded.value}updateRenderingBounds(){const{viewportPageBounds:t}=this;return t.equals(this._renderingBounds.__unsafe__getWithoutCapture())?this:(this._renderingBounds.set(t.clone()),this._renderingBoundsExpanded.set(t.clone().expandBy(100/this.zoomLevel)),this)}get _pages(){return this.store.query.records("page")}get pages(){return this._pages.value.sort(un)}get currentPage(){const t=this.getPageById(this.currentPageId);if(!t)throw Error(`No current page (id ${this.currentPageId}, ${this.pages.length} pages))`);return t}get currentPageId(){return this.instanceState.currentPageId}getPageById(t){return this.store.get(t)}getPageInfoById(t){return this.store.get(t)}get currentPageShapeIds(){return this._currentPageShapeIds.value}getShapeIdsInPage(t){const r=this.store.query.exec("shape",{parentId:{eq:t}});return this.getShapeAndDescendantIds(r.map(o=>o.id))}setCurrentPageId(t,{stopFollowing:r=!0}={}){return this._setCurrentPageId(t,{stopFollowing:r}),this}updatePage(t,r=!1){return this._updatePage(t,r),this}createPage(t,r=Jn.createId(),o){return this._createPage(t,r,o),this}duplicatePage(t=this.currentPageId,r=Jn.createId()){if(this.pages.length>=yf)return this;const o=this.getPageById(t);if(!o)return this;const s={...this.camera},i=this.getContent(this.getSortedChildIds(o.id));return this.batch(()=>{if(this.createPage(o.name+" Copy",r,o.index),this.setCurrentPageId(r),this.setCamera(s.x,s.y,s.z),i)return this.putContent(i)}),this}renamePage(t,r,o=!1){return this.isReadOnly?this:(this.updatePage({id:t,name:r},o),this)}deletePage(t){this._deletePage(t)}get _assets(){return this.store.query.records("asset")}get assets(){return this._assets.value}createAssets(t){return this._createAssets(t),this}deleteAssets(t){return this._deleteAssets(t),this}updateAssets(t){return this._updateAssets(t),this}getAssetBySrc(t){return this.assets.find(r=>r.props.src===t)}getAssetById(t){return this.store.get(t)}get _boundsCache(){return this.store.createComputedCache("bounds",t=>this.getShapeUtil(t).getBounds(t))}getBounds(t){const r=this._boundsCache.get(t.id)??new ne;return r.width===0||r.height===0?new ne(r.x,r.y,Math.max(r.width,1),Math.max(r.height,1)):r}getBoundsById(t){return this.getBounds(this.getShapeById(t))}get _outlineCache(){return this.store.createComputedCache("outline",t=>this.getShapeUtil(t).getOutline(t))}getOutline(t){return this._outlineCache.get(t.id)??br}getOutlineById(t){return this.getOutline(this.getShapeById(t))}get _outlineSegmentsCache(){return this.store.createComputedCache("outline-segments",t=>this.getShapeUtil(t).getOutlineSegments(t))}getOutlineSegments(t){return this._outlineSegmentsCache.get(t.id)??br}getOutlineSegmentsById(t){return this.getOutlineSegments(this.getShapeById(t))}get handlesCache(){return this.store.createComputedCache("handles",t=>{var r,o;return(o=(r=this.getShapeUtil(t)).getHandles)==null?void 0:o.call(r,t)})}getHandlesById(t){return this.handlesCache.get(t)}getHandles(t){return this.getHandlesById(t.id)}getTransform(t){return Y.Compose(Y.Translate(t.x,t.y),Y.Rotate(t.rotation))}get _pageTransformCache(){return this.store.createComputedCache("pageTransformCache",t=>{if(Qt(t.parentId))return this.getTransform(t);const r=this._pageTransformCache.get(t.parentId)??Y.Identity();return Y.Compose(r,this.getTransform(t))})}getParentTransform(t){return Qt(t.parentId)?Y.Identity():this._pageTransformCache.get(t.parentId)??Y.Identity()}getPageTransform(t){return this.getPageTransformById(t.id)}getPageTransformById(t){return this._pageTransformCache.get(t)}getPagePointById(t){const r=this.getPageTransformById(t);if(r)return Y.applyToPoint(r,new E)}getPageCenter(t){const r=this.getPageTransformById(t.id);if(!r)return null;const s=this.getShapeUtil(t).center(t);return Y.applyToPoint(r,s)}getPageCenterById(t){const r=this.getShapeById(t);return this.getPageCenter(r)}getPageRotation(t){return this.getPageRotationById(t.id)}getPageRotationById(t){const r=this.getPageTransformById(t);return r?Y.Decompose(r).rotation:0}get _pageBoundsCache(){return this.store.createComputedCache("pageBoundsCache",t=>{const r=this._pageTransformCache.get(t.id);return r?ne.FromPoints(Y.applyToPoints(r,this.getOutline(t))):new ne})}getPageBounds(t){return this.getPageBoundsById(t.id)}getPageBoundsById(t){return this._pageBoundsCache.get(t)}get _clipPathCache(){return this.store.createComputedCache("clipPathCache",t=>{const r=this._pageMaskCache.get(t.id);if(!r)return;const o=this._pageTransformCache.get(t.id);return o?r.length===0?"polygon(0px 0px, 0px 0px, 0px 0px)":`polygon(${Y.applyToPoints(Y.Inverse(o),r).map(i=>`${i.x}px ${i.y}px`).join(",")})`:void 0})}getClipPathById(t){return this._clipPathCache.get(t)}get _pageMaskCache(){return this.store.createComputedCache("pageMaskCache",t=>{if(Qt(t.parentId))return;const r=this.getAncestorsById(t.id).filter(s=>this.isShapeOfType(s,kt));return r.length===0?void 0:r.map(s=>Y.applyToPoints(this._pageTransformCache.get(s.id),this.getOutline(s))).reduce((s,i)=>i&&s?E0(s,i)??void 0:void 0)})}getPageMaskById(t){return this._pageMaskCache.get(t)}getMaskedPageBounds(t){return this.getMaskedPageBoundsById(t.id)}getMaskedPageBoundsById(t){const r=this._pageBoundsCache.get(t);if(!r)return;const o=this._pageMaskCache.get(t);if(o){const s=E0(o,r.corners);return s?ne.FromPoints(s):void 0}return r}getAncestors(t,r=[]){const o=t.parentId;if(Qt(o))return r.reverse(),r;const s=this.store.get(o);return s?(r.push(s),this.getAncestors(s,r)):r}getAncestorsById(t,r=[]){const o=this.getShapeById(t);return o?this.getAncestors(o,r):r}findAncestor(t,r){const o=t.parentId;if(Qt(o))return;const s=this.getShapeById(o);if(s)return r(s)?s:this.findAncestor(s,r)}hasAncestor(t,r){return t?t.parentId===r?!0:this.hasAncestor(this.getParentShape(t),r):!1}findCommonAncestor(t,r){var a;if(t.length===0)return;if(t.length===1){const l=t[0].parentId;return Qt(l)?void 0:r?(a=this.findAncestor(t[0],r))==null?void 0:a.id:l}const[o,...s]=t;let i=this.getParentShape(o);for(;i;){if(r&&!r(i)){i=this.getParentShape(i);continue}if(s.every(l=>this.hasAncestor(l,i.id)))return i.id;i=this.getParentShape(i)}}isShapeOrAncestorLocked(t){return t===void 0?!1:t.isLocked?!0:this.isShapeOrAncestorLocked(this.getParentShape(t))}get allShapesCommonBounds(){let t=null;return this.currentPageShapeIds.forEach(r=>{const o=this.getMaskedPageBoundsById(r);o&&(t?t.expand(o):t=o.clone())}),t}getPageCorners(t){const r=this.getAncestors(t),o=this.getBounds(t).corners,s=Y.Compose(...r.flatMap(i=>[Y.Translate(i.x,i.y),Y.Rotate(i.rotation)]),Y.Translate(t.x,t.y),Y.Rotate(t.rotation,0,0));return Y.applyToPoints(s,o)}isPointInShape(t,r){const o=this.getShapeUtil(r),s=this._pageMaskCache.get(r.id);return s&&!sr(t,s)?!1:o.hitTestPoint(r,this.getPointInShapeSpace(r,t))}getShapesAtPoint(t){return this.shapesArray.filter(r=>{const o=this._pageMaskCache.get(r.id);return o?sr(t,o):this.getShapeUtil(r).hitTestPoint(r,this.getPointInShapeSpace(r,t))})}getPointInShapeSpace(t,r){return Y.applyToPoint(Y.Inverse(this.getPageTransform(t)),r)}getPointInParentSpace(t,r){const o=this.getShapeById(t);if(!o)return new E(0,0);if(Qt(o.parentId))return E.From(r);const s=this.getPageTransformById(o.parentId);return s?Y.applyToPoint(Y.Inverse(s),r):E.From(r)}getDeltaInShapeSpace(t,r){const o=this.getPageTransform(t);return o?E.Rot(r,-Y.Decompose(o).rotation):E.From(r)}getDeltaInParentSpace(t,r){if(Qt(t.parentId))return E.From(r);const o=this.getShapeById(t.parentId);return o?this.getDeltaInShapeSpace(o,r):E.From(r)}getParentsMappedToChildren(t){const r=t.map(s=>this.store.get(s)),o=new Map;return r.forEach(s=>{var i;o.has(s.parentId)||o.set(s.parentId,new Set),(i=o.get(s.parentId))==null||i.add(s)}),o}get shapesArray(){return Array.from(this.currentPageShapeIds,t=>this.store.get(t))}get sortedShapesArray(){const t=new Set(this.shapesArray.sort(un)),r=[];function o(s){r.push(s),t.delete(s),t.forEach(i=>{i.parentId===s.id&&o(i)})}return t.forEach(s=>{const i=this.getShapeById(s.parentId);ci(i)||o(s)}),r}isShapeOfType(t,r){return t.type===r.type}getShapeById(t){if(Wn(t))return this.store.get(t)}getParentShape(t){if(!(t===void 0||!Wn(t.parentId)))return this.store.get(t.parentId)}getShapeNearestSibling(t,r){return r?r.parentId===t.parentId?r:this.findAncestor(r,s=>s.parentId===t.parentId):void 0}isShapeInPage(t,r=this.currentPageId){let o=!1;if(t.parentId===r)o=!0;else{let s=this.getShapeById(t.parentId);e:for(;s;){if(s.parentId===r){o=!0;break e}s=this.getShapeById(s.parentId)}}return o}getAncestorPageId(t){if(t!==void 0)return Qt(t.parentId)?t.parentId:this.getAncestorPageId(this.getShapeById(t.parentId))}reparentShapesById(t,r,o){const s=[],i=Qt(r)?Y.Identity():this.getPageTransformById(r),a=i.decompose().rotation;let l=[];const c=he(this.getSortedChildIds(r).map(d=>this.getShapeById(d)));if(o){const d=c.find(h=>h.index===o);if(d){const h=c[c.indexOf(d)+1];h?l=Xi(o,h.index,t.length):l=Hg(o,t.length)}else{const h=c.sort(un).find(f=>f.index>o);h?l=Xi(o,h.index,t.length):l=Hg(o,t.length)}}else{const d=c.length&&c[c.length-1];l=d?Hg(d.index,t.length):CI(t.length)}let u;for(let d=0;d<t.length;d++){u=t[d];const h=this.getShapeById(u),f=this.getPagePointById(u);if(!h||!f)continue;const p=Y.applyToPoint(Y.Inverse(i),f),m=this.getPageRotation(h)-a;s.push({id:h.id,type:h.type,parentId:r,x:p.x,y:p.y,rotation:m,index:l[d]})}return this.updateShapes(s),this}getHighestIndexForParent(t){const r=this._parentIdsToChildIds.value[t];return!r||r.length===0?"a1":po(r[r.length-1][1])}getSortedChildIds(t){const r=this._parentIdsToChildIds.value[t];return r?this._childIdsCache.get(r,()=>r.map(([o])=>o)):br}visitDescendants(t,r){const o=this.getSortedChildIds(t);for(const s of o)r(s)!==!1&&this.visitDescendants(s,r)}getShapeAndDescendantIds(t){const r=new Set,o=[...t];for(;o.length>0;){const s=o.pop();if(!s)break;r.has(s)||(r.add(s),this.getSortedChildIds(s).forEach(i=>{o.push(i)}))}return r}getParentIdForNewShapeAtPoint(t,r){const o=this.sortedShapesArray;for(let s=o.length-1;s>=0;s--){const i=o[s],a=this.getShapeUtil(i);if(!a.canReceiveNewChildrenOfType(i,r))continue;const l=this.getMaskedPageBoundsById(i.id);if(l&&l.containsPoint(t)&&a.hitTestPoint(i,this.getPointInShapeSpace(i,t)))return i.id}return this.focusLayerId}getDroppingShape(t,r=[]){const o=this.sortedShapesArray;for(let s=o.length-1;s>=0;s--){const i=o[s];if(r.find(c=>c.id===i.id||this.hasAncestor(i,c.id)))continue;const a=this.getShapeUtil(i);if(!a.canDropShapes(i,r))continue;const l=this.getMaskedPageBoundsById(i.id);if(l&&l.containsPoint(t)&&a.hitTestPoint(i,this.getPointInShapeSpace(i,t)))return i}}getOutermostSelectableShape(t,r){let o=t,s=t;for(;s;){if(this.isShapeOfType(s,Ye)&&this.focusLayerId!==s.id&&!this.hasAncestor(this.focusLayerShape,s.id)&&((r==null?void 0:r(s))??!0))o=s;else if(this.focusLayerId===s.id)break;s=this.getParentShape(s)}return o}rotateShapesBy(t,r){if(t.length<=0)return this;const o=g$({editor:this});return o?(mh({delta:r,snapshot:o,editor:this,stage:"one-off"}),this):this}nudgeShapes(t,r,o=!1,s=!1){var c,u;if(t.length<=0)return this;const i=this.isGridMode?o?this.gridSize*az:this.gridSize:o?rz:oz,a=E.Mul(r,i),l=[];for(const d of t){const h=this.getShapeById(d);if(!h)throw Error(`Could not find a shape with the id ${d}.`);const f=this.getDeltaInParentSpace(h,a),p=(u=(c=this.getShapeUtil(h)).onTranslateStart)==null?void 0:u.call(c,h);l.push(p?{...p,x:h.x+f.x,y:h.y+f.y}:{id:d,x:h.x+f.x,y:h.y+f.y,type:h.type})}return this.updateShapes(l,s),this}duplicateShapes(t=this.selectedIds,r){if(t.length<=0)return this;const o=new Set(t),s=[],i=[...t];for(;i.length>0;){const c=i.pop();if(!c)break;s.push(c),this.getSortedChildIds(c).forEach(u=>i.push(u))}s.reverse();const a=new Map(s.map(c=>[c,Ue()])),l=he(s.map(c=>{const u=this.getShapeById(c);if(!u)return null;const d=a.get(c);let h=0,f=0;if(r&&o.has(c)){const C=this.getParentTransform(u),_=new E(r.x,r.y).rot(-Y.Decompose(C).rotation);h=_.x,f=_.y}const p=u.parentId??this.currentPageId,m=this.getSortedChildIds(p),y=m.indexOf(u.id),x=m[y+1],S=x?this.getShapeById(x):null,b=S?cc(u.index,S.index):po(u.index);let P=yn(u);if(this.isShapeOfType(u,Fe)&&this.isShapeOfType(P,Fe)){const C=this.getShapeUtil(Fe).getArrowInfo(u);let _,I;if(u.props.start.type==="binding"&&(_=a.get(u.props.start.boundShapeId),!_))if(C!=null&&C.isValid){const{x:T,y:M}=C.start.point;P.props.start={type:"point",x:T,y:M}}else{const{start:T}=Sr(this,u);P.props.start={type:"point",x:T.x,y:T.y}}if(u.props.end.type==="binding"&&(I=a.get(u.props.end.boundShapeId),!I))if(C!=null&&C.isValid){const{x:T,y:M}=C.end.point;P.props.end={type:"point",x:T,y:M}}else{const{end:T}=Sr(this,u);P.props.start={type:"point",x:T.x,y:T.y}}const k=Jl(P)?Gc(this,P):$0(this,P);if(C!=null&&C.isValid&&(k!=null&&k.isValid)&&!Jl(u)){const T=E.Med(C.start.handle,C.end.handle),M=E.Dist(C.middle,T),O=E.Dist(k.middle,T);P.props.bend<0?P.props.bend+=O-M:P.props.bend-=O-M}P.props.start.type==="binding"&&_&&(P.props.start.boundShapeId=_),P.props.end.type==="binding"&&I&&(P.props.end.boundShapeId=I)}return P={...P,id:d,x:u.x+h,y:u.y+f,index:b},P}));return l.forEach(c=>{Wn(c.parentId)&&a.has(c.parentId)&&(c.parentId=a.get(c.parentId))}),this.history.batch(()=>{const c=l.length+this.currentPageShapeIds.size>co;c&&_d(this);const u=c?l.slice(0,co-this.currentPageShapeIds.size):l,d=u.map(h=>h.id);if(this.createShapes(u),this.setSelectedIds(d),r!==void 0){const{viewportPageBounds:h,selectedPageBounds:f}=this;f&&!h.contains(f)&&this.centerOnPoint(f.center.x,f.center.y,{duration:go})}}),this}moveShapesToPage(t,r){if(t.length===0)return this;if(this.isReadOnly)return this;const{currentPageId:o}=this;if(r===o)return this;if(!this.store.has(r))return this;const s=this.getContent(t);if(!s)return this;if(this.getShapeIdsInPage(r).size+s.shapes.length>co)return _d(this,r),this;const i=this.camera.z;return this.history.batch(()=>{this.deleteShapes(t),this.setCurrentPageId(r),this.setFocusLayer(null),this.selectNone(),this.putContent(s,{select:!0,preserveIds:!0,preservePosition:!0});const{center:{x:a,y:l}}=this.selectionBounds;this.setCamera(this.camera.x,this.camera.y,i),this.centerOnPoint(a,l)}),this}toggleLock(t=this.selectedIds){if(this.isReadOnly||t.length===0)return this;let r=!0,o=!0;const s=[];for(const i of t){const a=this.getShapeById(i);a&&(s.push(a),a.isLocked?o=!1:r=!1)}return o?(this.updateShapes(s.map(i=>({id:i.id,type:i.type,isLocked:!0}))),this.setSelectedIds([])):r?this.updateShapes(s.map(i=>({id:i.id,type:i.type,isLocked:!1}))):this.updateShapes(s.map(i=>({id:i.id,type:i.type,isLocked:!0}))),this}reorderShapes(t,r){if(this.isReadOnly)return this;if(r.length===0)return this;const o=this.getParentsMappedToChildren(r),s=[];switch(t){case"toBack":{o.forEach((i,a)=>{const l=he(this.getSortedChildIds(a).map(h=>this.getShapeById(h)));if(i.size===l.length)return;let c,u;for(const h of l){if(!i.has(h)){u=h.index;break}i.delete(h),c=h.index}if(i.size===0)return;const d=Xi(c,u,i.size);Array.from(i.values()).sort(un).forEach((h,f)=>s.push({id:h.id,type:h.type,index:d[f]}))});break}case"toFront":{o.forEach((i,a)=>{const l=he(this.getSortedChildIds(a).map(f=>this.getShapeById(f))),c=l.length;if(i.size===c)return;let u,d;for(let f=c-1;f>-1;f--){const p=l[f];if(!i.has(p)){u=p.index;break}i.delete(p),d=p.index}if(i.size===0)return;const h=Xi(u,d,i.size);Array.from(i.values()).sort(un).forEach((f,p)=>s.push({id:f.id,type:f.type,index:h[p]}))});break}case"forward":{o.forEach((i,a)=>{var y;const l=he(this.getSortedChildIds(a).map(x=>this.getShapeById(x))),c=l.length;if(i.size===c)return;const u=new Set(Array.from(i).map(x=>l.indexOf(x)));let d=-1,h=!1,f,p,m;for(let x=0;x<c;x++){const S=u.has(x);if(!h&&S)h=!0,d=x,p=void 0;else if(h&&!S){h=!1,m=x-d,f=l[x].index,p=(y=l[x+1])==null?void 0:y.index;const b=Xi(f,p,m);for(let P=0;P<m;P++){const C=l[d+P];s.push({id:C.id,type:C.type,index:b[P]})}}}});break}case"backward":{o.forEach((i,a)=>{var p;const l=he(this.getSortedChildIds(a).map(m=>this.getShapeById(m))),c=l.length;if(i.size===c)return;const u=new Set(Array.from(i).map(m=>l.indexOf(m)));let d=-1,h=!1,f;for(let m=c-1;m>-1;m--){const y=u.has(m);if(!h&&y)h=!0,d=m;else if(h&&!y){h=!1,f=d-m;const x=Xi((p=l[m-1])==null?void 0:p.index,l[m].index,f);for(let S=0;S<f;S++){const b=l[m+S+1];s.push({id:b.id,type:b.type,index:x[S]})}}}});break}}return this.updateShapes(s),this}sendToBack(t=this.pageState.selectedIds){return this.reorderShapes("toBack",t),this}sendBackward(t=this.pageState.selectedIds){return this.reorderShapes("backward",t),this}bringForward(t=this.pageState.selectedIds){return this.reorderShapes("forward",t),this}bringToFront(t=this.pageState.selectedIds){return this.reorderShapes("toFront",t),this}flipShapes(t,r=this.selectedIds){if(this.isReadOnly)return this;let o=he(r.map(i=>this.getShapeById(i)));if(!o.length)return this;o=he(o.map(i=>this.isShapeOfType(i,Ye)?this.getSortedChildIds(i.id).map(a=>this.getShapeById(a)):i).flat());const s=ne.Common(he(o.map(i=>this.getPageBounds(i)))).center;return this.batch(()=>{for(const i of o){const a=this.getBounds(i),l=this.getPageTransformById(i.id);l&&this.resizeShape(i.id,{x:t==="horizontal"?-1:1,y:t==="vertical"?-1:1},{initialBounds:a,initialPageTransform:l,initialShape:i,mode:"scale_shape",scaleOrigin:s,scaleAxisRotation:0})}}),this}stackShapes(t,r=this.pageState.selectedIds,o){if(this.isReadOnly)return this;const s=he(r.map(m=>this.getShapeById(m))).filter(m=>!(!m||this.isShapeOfType(m,Fe)&&(m.props.start.type==="binding"||m.props.end.type==="binding"))),i=s.length;if(o===void 0&&i<3||i<2)return this;const a=Object.fromEntries(s.map(m=>[m.id,this.getPageBounds(m)]));let l,c,u,d;t==="horizontal"?(l="x",c="minX",u="maxX",d="width"):(l="y",c="minY",u="maxY",d="height");let h;if(o===void 0){const m=[];s.sort((x,S)=>a[x.id][c]-a[S.id][c]);for(let x=0;x<i-1;x++){const S=s[x],b=s[x+1],P=a[S.id],_=a[b.id][c]-P[u],I=m.find(k=>k.gap===_);I?I.count++:m.push({gap:_,count:1})}let y=0;m.forEach(x=>{x.count>y&&(y=x.count,h=x.gap)}),y===1&&(h=Math.max(0,m.reduce((x,S)=>x+S.gap*S.count,0)/(i-1)))}else h=o;const f=[];let p=a[s[0].id][u];return s.forEach((m,y)=>{var C,_;if(y===0)return;const x={x:0,y:0};x[l]=p+h-a[m.id][l];const S=this.getParentShape(m),b=S?E.Rot(x,-this.getPageRotation(S)):x,P=(_=(C=this.getShapeUtil(m)).onTranslateStart)==null?void 0:_.call(C,m);f.push(P?{...P,[l]:m[l]+b[l]}:{id:m.id,type:m.type,[l]:m[l]+b[l]}),p+=a[m.id][d]+h}),this.updateShapes(f),this}packShapes(t=this.pageState.selectedIds,r=16){var _,I;if(this.isReadOnly)return this;if(t.length<2)return this;const o=he(t.map(k=>this.getShapeById(k)).filter(k=>!(!k||this.isShapeOfType(k,Fe)&&(k.props.start.type==="binding"||k.props.end.type==="binding")))),s={},i={};let a,l,c=0;for(let k=0;k<o.length;k++)a=o[k],l=this.getPageBounds(a),s[a.id]=l,i[a.id]=l.clone(),c+=l.width*l.height;const u=ne.Common(he(Object.values(s))),d=u.width;o.sort((k,T)=>s[T.id].height-s[k.id].height);const h=Math.max(Math.ceil(Math.sqrt(c/.95)),d),f=[new ne(u.x,u.y,h,1/0)];let p=0,m=0,y,x;for(let k=0;k<o.length;k++){a=o[k],l=i[a.id];for(let T=f.length-1;T>=0;T--)if(y=f[T],!(l.width>y.width||l.height>y.height)){l.x=y.x,l.y=y.y,m=Math.max(m,l.maxY),p=Math.max(p,l.maxX),l.width===y.width&&l.height===y.height?(x=f.pop(),T<f.length&&(f[T]=x)):l.height===y.height?(y.x+=l.width+r,y.width-=l.width+r):l.width===y.width?(y.y+=l.height+r,y.height-=l.height+r):(f.push(new ne(y.x+(l.width+r),y.y,y.width-(l.width+r),l.height)),y.y+=l.height+r,y.height-=l.height+r);break}}const S=ne.Common(Object.values(i)),b=E.Sub(u.center,S.center);let P;const C=[];for(let k=0;k<o.length;k++){a=o[k],l=s[a.id],P=i[a.id];const T=this.getDeltaInParentSpace(a,E.Sub(P.point,l.point).add(b)),M={id:a.id,type:a.type,x:a.x+T.x,y:a.y+T.y},O=(I=(_=this.getShapeUtil(a)).onTranslateStart)==null?void 0:I.call(_,{...a,...M});O?C.push({...M,...O}):C.push(M)}return C.length&&this.updateShapes(C),this}alignShapes(t,r=this.pageState.selectedIds){if(this.isReadOnly)return this;if(r.length<2)return this;const o=he(r.map(l=>this.getShapeById(l))),s=Object.fromEntries(o.map(l=>[l.id,this.getPageBounds(l)])),i=ne.Common(he(Object.values(s))),a=[];return o.forEach(l=>{var p,m;const c=s[l.id];if(!c)return;const u={x:0,y:0};switch(t){case"top":{u.y=i.minY-c.minY;break}case"center-vertical":{u.y=i.midY-c.minY-c.height/2;break}case"bottom":{u.y=i.maxY-c.minY-c.height;break}case"left":{u.x=i.minX-c.minX;break}case"center-horizontal":{u.x=i.midX-c.minX-c.width/2;break}case"right":{u.x=i.maxX-c.minX-c.width;break}}const d=this.getParentShape(l),h=d?E.Rot(u,-this.getPageRotation(d)):u,f=(m=(p=this.getShapeUtil(l)).onTranslateStart)==null?void 0:m.call(p,l);a.push(f?{...f,x:l.x+h.x,y:l.y+h.y}:{id:l.id,type:l.type,x:l.x+h.x,y:l.y+h.y})}),this.updateShapes(a),this}distributeShapes(t,r=this.pageState.selectedIds){if(this.isReadOnly)return this;if(r.length<3)return this;const o=r.length,s=he(r.map(S=>this.getShapeById(S))),i=Object.fromEntries(s.map(S=>[S.id,this.getPageBounds(S)]));let a,l,c,u,d;t==="horizontal"?(a="x",l="minX",c="maxX",u="midX",d="width"):(a="y",l="minY",c="maxY",u="midY",d="height");const h=[],f=s.sort((S,b)=>i[S.id][l]-i[b.id][l])[0],p=s.sort((S,b)=>i[b.id][c]-i[S.id][c])[0],m=i[f.id][u],y=(i[p.id][u]-m)/(o-1),x=m+y;return s.filter(S=>S!==f&&S!==p).sort((S,b)=>i[S.id][u]-i[b.id][u]).forEach((S,b)=>{var k,T;const P={x:0,y:0};P[a]=x+y*b-i[S.id][d]/2-i[S.id][a];const C=this.getParentShape(S),_=C?E.Rot(P,-this.getPageRotation(C)):P,I=(T=(k=this.getShapeUtil(S)).onTranslateStart)==null?void 0:T.call(k,S);h.push(I?{...I,[a]:S[a]+_[a]}:{id:S.id,type:S.type,[a]:S[a]+_[a]})}),this.updateShapes(h),this}stretchShapes(t,r=this.pageState.selectedIds){if(this.isReadOnly)return this;if(r.length<2)return this;const o=he(r.map(c=>this.getShapeById(c))),s=Object.fromEntries(o.map(c=>[c.id,this.getBounds(c)])),i=Object.fromEntries(o.map(c=>[c.id,this.getPageBounds(c)])),a=ne.Common(he(Object.values(i))),l=[];switch(t){case"vertical":{this.batch(()=>{for(const c of o){if(this.getPageRotation(c)%qe)continue;const d=s[c.id],h=i[c.id],f=this.getDeltaInParentSpace(c,new E(0,a.minY-h.minY)),{x:p,y:m}=E.Add(f,c);this.updateShapes([{id:c.id,type:c.type,x:p,y:m}],!0);const y=new E(1,a.height/h.height);this.resizeShape(c.id,y,{initialBounds:d,scaleOrigin:new E(h.center.x,a.minY),scaleAxisRotation:0})}});break}case"horizontal":{this.batch(()=>{for(const c of o){const u=s[c.id],d=i[c.id];if(this.getPageRotation(c)%qe)continue;const f=this.getDeltaInParentSpace(c,new E(a.minX-d.minX,0)),{x:p,y:m}=E.Add(f,c);this.updateShapes([{id:c.id,type:c.type,x:p,y:m}],!0);const y=new E(a.width/d.width,1);this.resizeShape(c.id,y,{initialBounds:u,scaleOrigin:new E(a.minX,d.center.y),scaleAxisRotation:0})}});break}}return this.updateShapes(l),this}resizeShape(t,r,o={}){var h;if(this.isReadOnly)return this;Number.isFinite(r.x)||(r=new E(1,r.y)),Number.isFinite(r.y)||(r=new E(r.x,1));const s=o.initialShape??this.getShapeById(t);if(!s)return this;const i=o.scaleOrigin??((h=this.getPageBoundsById(t))==null?void 0:h.center);if(!i)return this;const a=this.getPageRotationById(t);if(a==null)return this;const l=o.scaleAxisRotation??a,c=o.initialPageTransform??this.getPageTransformById(t);if(!c)return this;const u=o.initialBounds??this.getBoundsById(t);if(!u)return this;if(!ok(a,l))return this._resizeUnalignedShape(t,r,{...o,initialBounds:u,scaleOrigin:i,scaleAxisRotation:l,initialPageTransform:c,initialShape:s});const d=this.getShapeUtil(s);if(d.isAspectRatioLocked(s)&&(Math.abs(r.x)>Math.abs(r.y)?r=new E(r.x,Math.sign(r.y)*Math.abs(r.x)):r=new E(Math.sign(r.x)*Math.abs(r.y),r.y)),d.onResize&&d.canResize(s)){const f=this._scalePagePoint(Y.applyToPoint(c,new E(0,0)),i,r,l),p=this.getPointInParentSpace(s.id,f),m=new E(r.x,r.y),y=dc((a-l)%Math.PI,0);m.x=y?r.x:r.y,m.y=y?r.y:r.x;const x=Y.applyToPoint(c,new E),{x:S,y:b}=this.getPointInParentSpace(s.id,x);this.updateShapes([{id:t,type:s.type,x:p.x,y:p.y,...d.onResize({...s,x:S,y:b},{newPoint:p,handle:o.dragHandle??"bottom_right",mode:o.mode??"scale_shape",scaleX:m.x,scaleY:m.y,initialBounds:u,initialShape:s})}],!0)}else{const f=Y.applyToPoint(c,u.center),p=this._scalePagePoint(f,i,r,l),m=this.getPointInParentSpace(s.id,f),y=this.getPointInParentSpace(s.id,p),x=E.Sub(y,m);this.updateShapes([{id:t,type:s.type,x:s.x+x.x,y:s.y+x.y}],!0)}return this}_resizeUnalignedShape(t,r,o){const{type:s}=o.initialShape,i=new E(r.x,r.y);if(Math.abs(r.x)>Math.abs(r.y)?i.x=Math.sign(r.x)*Math.abs(r.y):i.y=Math.sign(r.y)*Math.abs(r.x),this.resizeShape(t,i,{initialShape:o.initialShape,initialBounds:o.initialBounds}),Math.sign(r.x)*Math.sign(r.y)<0){let{rotation:m}=Y.Decompose(o.initialPageTransform);m-=2*m,this.updateShapes([{id:t,type:s,rotation:m}],!0)}const a=Y.applyToPoint(o.initialPageTransform,o.initialBounds.center),l=this._scalePagePoint(a,o.scaleOrigin,r,o.scaleAxisRotation),c=this.getPageCenterById(t),u=this.getPagePointById(t);if(!c||!u)return this;const d=E.Sub(l,c),h=E.Add(u,d),{x:f,y:p}=this.getPointInParentSpace(t,h);return this.updateShapes([{id:t,type:s,x:f,y:p}],!0),this}_scalePagePoint(t,r,o,s){const i=E.RotWith(t,r,-s).sub(r),a=E.MulV(i,o);return E.Add(a,r).rotWith(r,s)}getInitialMetaForShape(t){return{}}createShapes(t,r=!1){return this._createShapes(t,r),this}animateShapes(t,r={}){const{duration:o=500,ease:s=Kt.linear}=r,i=nt();let a=o,l;const c=[];t.forEach(h=>{if(!h)return;const f={partial:h,values:[]},p=this.getShapeById(h.id);if(p){for(const m of["x","y","rotation"])h[m]!==void 0&&p[m]!==h[m]&&f.values.push({prop:m,from:p[m],to:h[m]});c.push(f),this.animatingShapes.set(p.id,i)}});let u;const d=h=>{if(a-=h,a<0){const{animatingShapes:p}=this,m=t.filter(y=>y&&p.get(y.id)===i);m.length&&this.updateShapes(m,!1),this.removeListener("tick",d);return}l=s(1-a/o);const{animatingShapes:f}=this;try{const p=[];for(let m=0;m<c.length;m++)u=c[m],f.get(u.partial.id)===i&&p.push({id:u.partial.id,type:u.partial.type,...u.values.reduce((y,{prop:x,from:S,to:b})=>(y[x]=S+(b-S)*l,y),{})});this._updateShapes(p,!0)}catch{}};return this.addListener("tick",d),this}groupShapes(t=this.selectedIds,r=Ue()){var h;if(this.isReadOnly)return this;if(t.length<=1)return this;const o=he(this._getUnlockedShapeIds(t).map(f=>this.getShapeById(f))),s=o.sort(un).map(f=>f.id),i=ne.Common(he(o.map(f=>this.getPageBounds(f)))),{x:a,y:l}=i.point,c=this.findCommonAncestor(o)??this.currentPageId;if(this.currentToolId!=="select")return this;this.isIn("select.idle")||this.cancel();const u=o.filter(f=>f.parentId===c).sort(un),d=(h=u[u.length-1])==null?void 0:h.index;return this.batch(()=>{this.createShapes([{id:r,type:"group",parentId:c,index:d,x:a,y:l,opacity:1,props:{}}]),this.reparentShapesById(s,r),this.select(r)}),this}ungroupShapes(t=this.selectedIds){if(this.isReadOnly)return this;if(t.length===0)return this;if(this.currentToolId!=="select")return this;this.isIn("select.idle")||this.cancel();const r=new Set,o=he(t.map(i=>this.getShapeById(i))),s=[];return o.forEach(i=>{this.isShapeOfType(i,Ye)?s.push(i):r.add(i.id)}),s.length===0?this:(this.batch(()=>{let i;for(let a=0,l=s.length;a<l;a++){i=s[a];const c=this.getSortedChildIds(i.id);for(let u=0,d=c.length;u<d;u++)r.add(c[u]);this.reparentShapesById(c,i.parentId,i.index)}this.deleteShapes(s.map(a=>a.id)),this.select(...r)}),this)}updateShapes(t,r=!1){let o=he(t);return this.animatingShapes.size>0&&o.forEach(s=>this.animatingShapes.delete(s.id)),o=o.filter(s=>{const i=this.getShapeById(s.id);return!(!i||this.isShapeOrAncestorLocked(i)&&!Object.hasOwn(s,"isLocked"))}),this._updateShapes(o,r),this}_getUnlockedShapeIds(t){return t.filter(r=>{var o;return!((o=this.getShapeById(r))!=null&&o.isLocked)})}deleteShapes(t=this.selectedIds){return this._deleteShapes(this._getUnlockedShapeIds(t)),this}_extractSharedStyles(t,r){if(this.isShapeOfType(t,Ye)){const o=this._parentIdsToChildIds.value[t.id];if(!o)return;for(let s=0,i=o.length;s<i;s++)this._extractSharedStyles(this.getShapeById(o[s][0]),r)}else{const o=this.getShapeUtil(t);for(const[s,i]of o.styleProps)r.applyValue(s,gi(t.props,i))}}get _stylesForNextShape(){return this.instanceState.stylesForNextShape}getStyleForNextShape(t){const r=this._stylesForNextShape[t.id];return r===void 0?t.defaultValue:r}getShapeStyleIfExists(t,r){const s=this.getShapeUtil(t).styleProps.get(r);if(s!==void 0)return gi(t.props,s)}get sharedStyles(){if(this.isIn("select")&&this.selectedIds.length>0)return this._selectionSharedStyles.value;const t=this.root.current.value,r=new M0;if(t.shapeType)for(const o of this.getShapeUtil(t.shapeType).styleProps.keys())r.applyValue(o,this.getStyleForNextShape(o));return r}get sharedOpacity(){if(this.isIn("select")&&this.selectedIds.length>0){const t=[],r=s=>{const i=this.getShapeById(s);if(i)if(this.isShapeOfType(i,Ye))for(const a of this.getSortedChildIds(i.id))r(a);else t.push(i)};for(const s of this.selectedIds)r(s);let o=null;for(const s of t)if(o===null)o=s.opacity;else if(o!==s.opacity)return{type:"mixed"};if(o!==null)return{type:"shared",value:o}}return{type:"shared",value:this.instanceState.opacityForNextShape}}setOpacity(t,r=!1,o=!1){return this.history.batch(()=>{if(this.isIn("select")){const{pageState:{selectedIds:s}}=this,i=[],a=l=>{const c=this.getShapeById(l);if(c)if(this.isShapeOfType(c,Ye)){const u=this.getSortedChildIds(l);for(const d of u)a(d)}else i.push(c)};if(s.length>0){for(const l of s)a(l);this.updateShapes(i.map(l=>({id:l.id,type:l.type,opacity:t})),r)}}this.updateInstanceState({opacityForNextShape:t},r,o)}),this}setStyle(t,r,o=!1,s=!1){return this.history.batch(()=>{if(this.isIn("select")){const{pageState:{selectedIds:i}}=this;if(i.length>0){const a=[],l=c=>{const u=this.getShapeById(c);if(u)if(this.isShapeOfType(u,Ye)){const d=this.getSortedChildIds(c);for(const h of d)l(h)}else{const d=this.getShapeUtil(u),h=d.styleProps.get(t);if(h){const f={id:u.id,type:u.type,props:{[h]:r}};a.push({util:d,originalShape:u,updatePartial:f})}}};for(const c of i)l(c);this.updateShapes(a.map(({updatePartial:c})=>c),o)}}this.updateInstanceState({stylesForNextShape:{...this._stylesForNextShape,[t.id]:r}},o,s)}),this}getContent(t=this.selectedIds){if(!t||t.length===0)return;const r={};let o=rf(t.map(a=>this.getShapeById(a)).sort(un).flatMap(a=>{const l=[a];return this.visitDescendants(a.id,c=>{l.push(this.getShapeById(c))}),l}));o=o.map(a=>{if(r[a.id]=this.getPageTransformById(a.id),a=So(a),this.isShapeOfType(a,Fe)){const l=a.props.start.type==="binding"?a.props.start.boundShapeId:void 0,c=a.props.end.type==="binding"?a.props.end.boundShapeId:void 0,u=this.getShapeUtil(Fe).getArrowInfo(a);if(a.props.start.type==="binding"&&!o.some(h=>h.id===l))if(u!=null&&u.isValid){const{x:h,y:f}=u.start.point;a.props.start={type:"point",x:h,y:f}}else{const{start:h}=Sr(this,a);a.props.start={type:"point",x:h.x,y:h.y}}if(a.props.end.type==="binding"&&!o.some(h=>h.id===c))if(u!=null&&u.isValid){const{x:h,y:f}=u.end.point;a.props.end={type:"point",x:h,y:f}}else{const{end:h}=Sr(this,a);a.props.end={type:"point",x:h.x,y:h.y}}const d=Jl(a)?Gc(this,a):$0(this,a);if(u!=null&&u.isValid&&(d!=null&&d.isValid)&&!Jl(a)){const h=E.Med(u.start.handle,u.end.handle),f=E.Dist(u.middle,h),p=E.Dist(d.middle,h);a.props.bend<0?a.props.bend+=p-f:a.props.bend-=p-f}return a}return a});const s=[];o.forEach(a=>{if(o.find(l=>l.id===a.parentId)===void 0){const l=this.getPagePointById(a.id),c=this.getPageRotationById(a.id);a.x=l.x,a.y=l.y,a.rotation=c,a.parentId=this.currentPageId,s.push(a.id)}});const i=new Set;return o.forEach(a=>{"assetId"in a.props&&a.props.assetId!==null&&i.add(a.props.assetId)}),{shapes:o,rootShapeIds:s,schema:this.store.schema.serialize(),assets:he(Array.from(i).map(a=>this.getAssetById(a)))}}putContent(t,r={}){if(this.isReadOnly)return this;if(!t.schema)throw Error("Could not put content: content is missing a schema.");const{select:o=!1,preserveIds:s=!1,preservePosition:i=!1}=r;let{point:a=void 0}=r;const{currentPageId:l}=this,{assets:c,shapes:u,rootShapeIds:d}=t,h=new Map(u.map(C=>[C.id,Ue()]));let f=this.currentPageId,p=1/0,m=[];for(const C of this.selectedShapes){if(p===0)break;const _=this.isShapeOfType(C,kt),I=this.getAncestors(C);_&&I.push(C);const k=_?I.length+1:I.length;if(k<p)p=k,m=I,f=_?C.id:C.parentId;else if(k===p){if(m.length!==I.length)throw Error(`Ancestors: ${m.length} !== ${I.length}`);if(m.length===0){f=l;break}else{f=l;for(let T=0;T<m.length&&I[T]===m[T];T++)f=I[T].id}}}let y=!1;if(!Qt(f)){const C=this.getShapeById(f);if(C){if(!this.viewportPageBounds.includes(this.getPageBounds(C)))f=l;else if(d.length===1){const _=u.find(I=>I.id===d[0]);this.isShapeOfType(C,kt)&&this.isShapeOfType(_,kt)&&_.props.w===(C==null?void 0:C.props.w)&&_.props.h===(C==null?void 0:C.props.h)&&(y=!0)}}else f=l}y||(y=h.has(f)),y&&(f=this.getShapeById(f).parentId);let x=this.getHighestIndexForParent(f);const S=[],b=u.map(C=>{let _;if(s)_=yn(C),h.set(C.id,C.id);else{const I=h.get(C.id);_=yn({...C,id:I})}if(d.includes(C.id)&&(_.parentId=l,S.push(_)),h.has(_.parentId)?_.parentId=h.get(C.parentId):(d.push(_.id),_.index=x,x=po(x)),this.isShapeOfType(_,Fe)){if(_.props.start.type==="binding"){const I=h.get(_.props.start.boundShapeId);_.props.start=I?{..._.props.start,boundShapeId:I}:{type:"point",x:0,y:0}}if(_.props.end.type==="binding"){const I=h.get(_.props.end.boundShapeId);_.props.end=I?{..._.props.end,boundShapeId:I}:{type:"point",x:0,y:0}}}return _});if(b.length+this.currentPageShapeIds.size>co)return _d(this),this;let P=[];if(c){for(let _=0;_<c.length;_++){const I=c[_],k=this.store.schema.migratePersistedRecord(I,t.schema);if(k.type==="success")c[_]=k.value;else throw Error(`Could not put content: could not migrate content for asset:
${JSON.stringify(I,null,2)}`)}const C=[];P=c.filter(_=>!this.store.has(_.id)).map(_=>{var I;return(_.type==="image"||_.type==="video")&&(_.props.src&&((I=_.props.src)!=null&&I.startsWith("data:image"))?(C.push(So(_)),_.props.src=null):C.push(So(_))),_}),Promise.allSettled(C.map(async _=>{const I=await oV(_.props.src,_.props.name,_.props.mimeType??"image/png"),k=await this.externalContentManager.createAssetFromFile(this,I);return[_,k]})).then(_=>{this.updateAssets(he(_.map(I=>I.status==="fulfilled"?{...I.value[1],id:I.value[0].id}:void 0)))})}for(let C=0;C<b.length;C++){const _=b[C],I=this.store.schema.migratePersistedRecord(_,t.schema);if(I.type==="success")b[C]=I.value;else throw Error(`Could not put content: could not migrate content for shape:
${JSON.stringify(_,null,2)}`)}return this.batch(()=>{P.length>0&&this.createAssets(P),this.createShapes(b,o),f!==l&&this.reparentShapesById(S.map(I=>I.id),f);const C=b.map(I=>this.getShapeById(I.id)),_=ne.Common(C.map(I=>this.getPageBounds(I)));if(a===void 0)if(Qt(f)){const{viewportPageBounds:I}=this;i||I.includes(ne.From(_))?a=_.center:a=I.center}else{const I=this.getShapeById(f);a=this.getShapeUtil(I).center(I)}if(S.length===1){const I=S[0];if(this.isShapeOfType(I,kt))for(;this.getShapesAtPoint(a).some(k=>this.isShapeOfType(k,kt)&&k.props.w===I.props.w&&k.props.h===I.props.h);)a.x+=_.w+16}this.updateShapes(S.map(I=>{const k={x:(I.x??0)-(_.x+_.w/2),y:(I.y??0)-(_.y+_.h/2)};return{id:I.id,type:I.type,x:a.x+k.x,y:a.y+k.y}}))}),this}replaceStoreContentsWithRecordsForOtherDocument(t){Gn(()=>{this.store.clear();const[r,o]=Tj(t,i=>i.typeName==="shape");this.store.put(o,"initialize"),this.store.ensureStoreIsUsable(),this.store.put(r,"initialize"),this.history.clear(),this.updateViewportScreenBounds(),this.updateRenderingBounds();const s=this.allShapesCommonBounds;s&&this.zoomToBounds(s.minX,s.minY,s.width,s.height,1)})}async putExternalContent(t){this.externalContentManager.handleContent(t)}async getSvg(t=this.selectedIds.length?this.selectedIds:Object.keys(this.currentPageShapeIds),r={}){var P,C;if(t.length===0)return;if(!window.document)throw Error("No document");const{scale:o=1,background:s=!1,padding:i=uz,preserveAspectRatio:a=!1}=r,l=Sn(this),c=this.getShapeAndDescendantIds(t),u=this.computeUnorderedRenderingShapes([this.currentPageId]).filter(({id:_})=>c.has(_));let d=null;for(const{maskedPageBounds:_}of u)_&&(d?d.union(_):d=_.clone());if(!d)return;const h=t.length===1&&this.isShapeOfType(this.getShapeById(t[0]),kt)?t[0]:null;h||d.expandBy(i);const f=d.width*o,p=d.height*o,m=window.document.createElementNS("http://www.w3.org/2000/svg","svg");a&&m.setAttribute("preserveAspectRatio",a),m.setAttribute("direction","ltr"),m.setAttribute("width",f+""),m.setAttribute("height",p+""),m.setAttribute("viewBox",`${d.minX} ${d.minY} ${d.width} ${d.height}`),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round"),s?h?m.style.setProperty("background",l.solid):m.style.setProperty("background-color",l.background):m.style.setProperty("background-color","transparent");try{(C=(P=document.body).focus)==null||C.call(P)}catch{}const y=window.document.createElementNS("http://www.w3.org/2000/svg","defs");m.append(y);const x=new Map,S={addExportDef:_=>{if(x.has(_.key))return;const I=(async()=>{const k=await _.getElement();if(!k)return;const T=document.createComment(`def: ${_.key}`);y.appendChild(T);for(const M of Array.isArray(k)?k:[k])y.appendChild(M)})();x.set(_.key,I)}},b=(await Promise.all(u.map(async({id:_,opacity:I,index:k,backgroundIndex:T})=>{var q,L;if(_===h)return[];const M=this.getShapeById(_);if(this.isShapeOfType(M,Ye))return[];const O=this.getShapeUtil(M);let z=await((q=O.toSvg)==null?void 0:q.call(O,M,S)),B=await((L=O.toBackgroundSvg)==null?void 0:L.call(O,M,S));if(z){const N=document.createElementNS("http://www.w3.org/2000/svg","g");N.appendChild(z),z=N}if(B){const N=document.createElementNS("http://www.w3.org/2000/svg","g");N.appendChild(B),B=N}if(!z&&!B){const N=this.getPageBounds(M),H=window.document.createElementNS("http://www.w3.org/2000/svg","rect");H.setAttribute("width",N.width+""),H.setAttribute("height",N.height+""),H.setAttribute("fill",l.solid),H.setAttribute("stroke",l.grey.pattern),H.setAttribute("stroke-width","1"),z=H}let D=this.getPageTransform(M).toCssString();"scale"in M.props&&M.props.scale!==1&&(D=`${D} scale(${M.props.scale}, ${M.props.scale})`),z==null||z.setAttribute("transform",D),B==null||B.setAttribute("transform",D),z==null||z.setAttribute("opacity",I+""),B==null||B.setAttribute("opacity",I+"");const F=this.getPageMaskById(M.id);if(F){const N=document.createElementNS("http://www.w3.org/2000/svg","clipPath");y.appendChild(N);const H=Nk();N.id=H;const Q=document.createElementNS("http://www.w3.org/2000/svg","path");if(Q.setAttribute("d",`M${F.map(({x:Z,y:Ee})=>`${Z},${Ee}`).join("L")}Z`),N.appendChild(Q),z){const Z=document.createElementNS("http://www.w3.org/2000/svg","g");Z.setAttribute("clip-path",`url(#${H})`),Z.appendChild(z),z=Z}if(B){const Z=document.createElementNS("http://www.w3.org/2000/svg","g");Z.setAttribute("clip-path",`url(#${H})`),Z.appendChild(B),B=Z}}const V=[];return z&&V.push({zIndex:k,element:z}),B&&V.push({zIndex:T,element:B}),V}))).flat();await Promise.all(x.values());for(const{element:_}of b.sort((I,k)=>I.zIndex-k.zIndex))m.appendChild(_);return m}_updateInputsFromEvent(t){var p;const{previousScreenPoint:r,previousPagePoint:o,currentScreenPoint:s,currentPagePoint:i}=this.inputs,{screenBounds:a}=this.store.unsafeGetWithoutCapture(hn),{x:l,y:c,z:u}=t.point,{x:d,y:h,z:f}=this.camera;r.setTo(s),o.setTo(i),s.set(l,c),i.set((l-a.x)/f-d,(c-a.y)/f-h,u??.5),this.inputs.isPen=t.type==="pointer"&&t.isPen,t.name==="pointer_down"&&this.inputs.pointerVelocity.set(0,0),this.store.put([{id:lf,typeName:"pointer",x:i.x,y:i.y,lastActivityTimestamp:t.type==="pointer"&&t.pointerId===Zb.CAMERA_MOVE?((p=this.store.get(lf))==null?void 0:p.lastActivityTimestamp)??Date.now():Date.now(),meta:{}}])}cancel(){return this.dispatch({type:"misc",name:"cancel"}),this}interrupt(){return this.dispatch({type:"misc",name:"interrupt"}),this}complete(){return this.dispatch({type:"misc",name:"complete"}),this}cancelDoubleClick(){this._clickManager.cancelDoubleClickTimeout()}dispatch(t){if(this.crashingError)return this;const{inputs:r}=this,{type:o}=t;return this.batch(()=>{if(t.type==="misc"){(t.name==="cancel"||t.name==="complete")&&(this.inputs.isDragging=!1,this.inputs.isPanning&&(this.inputs.isPanning=!1,this.setCursor({type:this._prevCursor}))),this.root.handleEvent(t);return}t.shiftKey?(clearInterval(this._shiftKeyTimeout),this._shiftKeyTimeout=-1,r.shiftKey=!0):!t.shiftKey&&r.shiftKey&&this._shiftKeyTimeout===-1&&(this._shiftKeyTimeout=setTimeout(this._setShiftKeyTimeout,150)),t.altKey?(clearInterval(this._altKeyTimeout),this._altKeyTimeout=-1,r.altKey=!0):!t.altKey&&r.altKey&&this._altKeyTimeout===-1&&(this._altKeyTimeout=setTimeout(this._setAltKeyTimeout,150)),t.ctrlKey?(clearInterval(this._ctrlKeyTimeout),this._ctrlKeyTimeout=-1,r.ctrlKey=!0):!t.ctrlKey&&r.ctrlKey&&this._ctrlKeyTimeout===-1&&(this._ctrlKeyTimeout=setTimeout(this._setCtrlKeyTimeout,150));const{originPagePoint:s,originScreenPoint:i,currentPagePoint:a,currentScreenPoint:l}=r;switch(r.isPointing||(r.isDragging=!1),o){case"pinch":{if(!this.canMoveCamera)return;switch(this._updateInputsFromEvent(t),t.name){case"pinch_start":{if(r.isPinching)return;r.isEditing||(this._pinchStart=this.camera.z,this._selectedIdsAtPointerDown.length||(this._selectedIdsAtPointerDown=this.selectedIds.slice()),this._didPinch=!0,r.isPinching=!0,this.interrupt());return}case"pinch":{if(!r.isPinching)return;const{point:{x:c,y:u,z:d=1},delta:{x:h,y:f}}=t,{camera:{x:p,y:m,z:y}}=this,x=Math.min(ss,Math.max(Dl,d));this.setCamera(p+h/y-c/y+c/x,m+f/y-u/y+u/x,x);return}case"pinch_end":{if(!r.isPinching)return this;r.isPinching=!1;const{_selectedIdsAtPointerDown:c}=this;this.setSelectedIds(this._selectedIdsAtPointerDown,!0),this._selectedIdsAtPointerDown=[];const{camera:{x:u,y:d,z:h}}=this;let f;if(h>.9&&h<1.05?f=1:h>.49&&h<.505&&(f=.5),h>this._pinchStart-.1&&h<this._pinchStart+.05&&(f=this._pinchStart),f!==void 0){const{x:p,y:m}=this.viewportScreenCenter;this.animateCamera(u+(p/f-p)-(p/h-p),d+(m/f-m)-(m/h-m),f,{duration:100})}this._didPinch&&(this._didPinch=!1,requestAnimationFrame(()=>{this._didPinch||this.setSelectedIds(c,!0)}));return}}}case"wheel":{if(!this.canMoveCamera)return;if(!this.isMenuOpen){if(r.ctrlKey){const{x:c,y:u}=this.inputs.currentScreenPoint,{x:d,y:h,z:f}=this.camera,p=Math.min(ss,Math.max(Dl,f+(t.delta.z??0)*f));this.setCamera(d+(c/p-c)-(c/f-c),h+(u/p-u)-(u/f-u),p);return}this.pan(t.delta.x,t.delta.y),!r.isDragging&&r.isPointing&&s.dist(a)>(this.isCoarsePointer?_0:Wc)/this.zoomLevel&&(r.isDragging=!0)}break}case"pointer":{if(r.isPinching)return;this._updateInputsFromEvent(t);const{isPen:c}=t;switch(t.name){case"pointer_down":{if(this._selectedIdsAtPointerDown=this.selectedIds.slice(),t.button===0&&(this.capturedPointerId=t.pointerId),r.buttons.add(t.button),r.isPointing=!0,r.isDragging=!1,this.isPenMode){if(!c)return}else c&&this.setPenMode(!0);if(t.button===5?(this._restoreToolId=this.currentToolId,this.complete(),this.setSelectedTool("eraser")):t.button===1&&(this.inputs.isPanning||(this._prevCursor=this.instanceState.cursor.type),this.inputs.isPanning=!0),this.inputs.isPanning)return this.stopCameraAnimation(),this.setCursor({type:"grabbing"}),this;i.setTo(l),s.setTo(a);break}case"pointer_move":{if(!c&&this.isPenMode)return;if(this.inputs.isPanning&&this.inputs.isPointing){const{currentScreenPoint:u,previousScreenPoint:d}=this.inputs,h=E.Sub(u,d);this.pan(h.x,h.y);return}!r.isDragging&&r.isPointing&&s.dist(a)>(this.isCoarsePointer?_0:Wc)/this.zoomLevel&&(r.isDragging=!0);break}case"pointer_up":{if(r.buttons.delete(t.button),r.isPointing=!1,r.isDragging=!1,this.isMenuOpen||!c&&this.isPenMode)return;this.capturedPointerId===t.pointerId&&(this.capturedPointerId=null,t.button=0),r.isPanning?t.button===1?this.inputs.keys.has(" ")?(this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:ih}),this.setCursor({type:"grab"})):(r.isPanning=!1,this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:ih}),this.setCursor({type:this._prevCursor})):t.button===0&&(this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:ih}),this.setCursor({type:"grab"})):t.button===5&&(this.complete(),this.setSelectedTool(this._restoreToolId));break}}break}case"keyboard":{switch(t.key==="ShiftRight"&&(t.key="ShiftLeft"),t.key==="AltRight"&&(t.key="AltLeft"),t.code==="ControlRight"&&(t.code="ControlLeft"),t.name){case"key_down":{r.keys.add(t.code),!t.ctrlKey&&t.code==="Space"&&(this.inputs.isPanning||(this._prevCursor=this.instanceState.cursor.type),this.inputs.isPanning=!0,this.setCursor({type:this.inputs.isPointing?"grabbing":"grab"}));break}case"key_up":{r.keys.delete(t.code),t.code==="Space"&&!this.inputs.buttons.has(1)&&(this.inputs.isPanning=!1,this.setCursor({type:this._prevCursor}));break}}break}}if(t.type==="pointer"&&(t.button===1?t.name="middle_click":t.button===2&&(t.name="right_click"),t.isPen===this.isPenMode))switch(t.name){case"pointer_down":{const c=this._clickManager.transformPointerDownEvent(t);if(t.name!==c.name){this.root.handleEvent(t),this.emit("event",t),this.root.handleEvent(c),this.emit("event",c);return}break}case"pointer_up":{const c=this._clickManager.transformPointerUpEvent(t);if(t.name!==c.name){this.root.handleEvent(t),this.emit("event",t),this.root.handleEvent(c),this.emit("event",c);return}break}case"pointer_move":{this._clickManager.handleMove();break}}this.root.handleEvent(t),this.emit("event",t)}),this}}le([G],ae.prototype,"canUndo",1);le([G],ae.prototype,"canRedo",1);le([G],ae.prototype,"_arrowBindingsIndex",1);le([G],ae.prototype,"_allPageStates",1);le([G],ae.prototype,"devicePixelRatio",1);le([G],ae.prototype,"openMenus",1);le([G],ae.prototype,"isMenuOpen",1);le([G],ae.prototype,"documentSettings",1);le([G],ae.prototype,"_pageStates",1);le([G],ae.prototype,"pageStateId",1);le([G],ae.prototype,"pageState",1);le([G],ae.prototype,"selectedIds",1);le([G],ae.prototype,"selectedIdsSet",1);le([G],ae.prototype,"selectedShapes",1);le([G],ae.prototype,"onlySelectedShape",1);le([G],ae.prototype,"selectedPageBounds",1);le([G],ae.prototype,"selectionRotation",1);le([G],ae.prototype,"selectionBounds",1);le([G],ae.prototype,"selectionPageCenter",1);le([G],ae.prototype,"editingShape",1);le([G],ae.prototype,"hoveredId",1);le([G],ae.prototype,"hoveredShape",1);le([G],ae.prototype,"hintingIds",1);le([G],ae.prototype,"erasingIds",1);le([G],ae.prototype,"erasingIdsSet",1);le([G],ae.prototype,"cameraId",1);le([G],ae.prototype,"camera",1);le([G],ae.prototype,"zoomLevel",1);le([G],ae.prototype,"viewportScreenBounds",1);le([G],ae.prototype,"viewportScreenCenter",1);le([G],ae.prototype,"viewportPageBounds",1);le([G],ae.prototype,"viewportPageCenter",1);le([G],ae.prototype,"cameraState",1);le([G],ae.prototype,"renderingShapes",1);le([G],ae.prototype,"renderingBounds",1);le([G],ae.prototype,"renderingBoundsExpanded",1);le([G],ae.prototype,"_pages",1);le([G],ae.prototype,"pages",1);le([G],ae.prototype,"_assets",1);le([G],ae.prototype,"_boundsCache",1);le([G],ae.prototype,"_outlineCache",1);le([G],ae.prototype,"_outlineSegmentsCache",1);le([G],ae.prototype,"handlesCache",1);le([G],ae.prototype,"_pageTransformCache",1);le([G],ae.prototype,"_pageBoundsCache",1);le([G],ae.prototype,"_clipPathCache",1);le([G],ae.prototype,"_pageMaskCache",1);le([G],ae.prototype,"allShapesCommonBounds",1);le([G],ae.prototype,"shapesArray",1);le([G],ae.prototype,"sortedShapesArray",1);le([G],ae.prototype,"_stylesForNextShape",1);le([G({isEqual:(e,n)=>e.equals(n)})],ae.prototype,"sharedStyles",1);le([G],ae.prototype,"sharedOpacity",1);function _d(e,n=e.currentPageId){const t=e.getPageById(n).name;e.emit("max-shapes",{name:t,pageId:n,count:co})}function OV(){const e=U(),n=Yt(),t=J("isDarkMode",()=>e.isDarkMode,[e]),r=J(pt.forceSrgb);oe.useEffect(()=>{t?(n.setAttribute("data-color-mode","dark"),n.classList.remove("tl-theme__light"),n.classList.add("tl-theme__dark"),e.setCursor({color:"white"})):(n.setAttribute("data-color-mode","light"),n.classList.remove("tl-theme__dark"),n.classList.add("tl-theme__light"),e.setCursor({color:"black"})),r?n.classList.add("tl-theme__force-sRGB"):n.classList.remove("tl-theme__force-sRGB")},[e,n,r,t])}function RV(e){const n=w.useRef();return w.useLayoutEffect(()=>{n.current=e}),w.useDebugValue(e),w.useCallback((...t)=>{const r=n.current;return Rc(r,"fn does not exist"),r(...t)},[])}function DV(){const[e,n]=w.useState(0);w.useEffect(()=>n(t=>t+1),[])}const Da="TLDRAW_TAB_ID_v2",Tt=globalThis.window;function LV(){return Tt?["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(Tt.navigator.platform)||Tt.navigator.userAgent.includes("Mac")&&"ontouchend"in document:!1}const _f=(Tt==null?void 0:Tt[Da])??(Tt==null?void 0:Tt.sessionStorage[Da])??"TLDRAW_INSTANCE_STATE_V1_"+nt();Tt&&(Tt[Da]=_f,LV()?Tt.sessionStorage[Da]=_f:delete Tt.sessionStorage[Da]);Tt==null||Tt.addEventListener("beforeunload",()=>{Tt.sessionStorage[Da]=_f});const jV={Initial:0},qc=jV.Initial,D$=be({version:fe,currentPageId:jc,isFocusMode:Me,exportBackground:Me,isDebugMode:Me,isToolLocked:Me,isGridMode:Me,pageStates:Ir(be({pageId:jc,camera:be({x:fe,y:fe,z:fe}),selectedIds:Ir(mr),focusLayerId:mr.nullable()}))}),NV=Pe({currentVersion:qc});function zV(e){if(!e||typeof e!="object")return console.warn("Invalid instance state"),null;if(!("version"in e)||typeof e.version!="number")return console.warn("No version in instance state"),null;const n=C1({value:e,fromVersion:e.version,toVersion:qc,migrations:NV});if(n.type==="error")return console.warn(n.reason),null;const t={...n.value,version:qc};try{D$.validate(t)}catch(r){return console.warn(r),null}return t}function BV(e){const n=e.query.ids("page");return G("sessionStateSnapshot",()=>{const t=e.get(hn);if(!t)return null;const r=[...n.value];return{version:qc,currentPageId:t.currentPageId,exportBackground:t.exportBackground,isFocusMode:t.isFocusMode,isDebugMode:t.isDebugMode,isToolLocked:t.isToolLocked,isGridMode:t.isGridMode,pageStates:r.map(o=>{const s=e.get(Ft.createId(o)),i=e.get(Bt.createId(o));return{pageId:o,camera:{x:(i==null?void 0:i.x)??0,y:(i==null?void 0:i.y)??0,z:(i==null?void 0:i.z)??1},selectedIds:(s==null?void 0:s.selectedIds)??[],focusLayerId:(s==null?void 0:s.focusLayerId)??null}})}})}function FV(e,n){const t=zV(n);if(!t)return;const r=e.allRecords().filter(i=>i.typeName==="instance_page_state"||i.typeName==="camera"),o={added:{},updated:{},removed:{...zI(r.map(i=>[i.id,i]))}};e.has(hn)&&(o.removed[hn]=e.get(hn));const s={removed:{},updated:{},added:{[hn]:e.schema.types.instance.create({id:hn,currentPageId:t.currentPageId,isDebugMode:t.isDebugMode,isFocusMode:t.isFocusMode,isToolLocked:t.isToolLocked,isGridMode:t.isGridMode,exportBackground:t.exportBackground})}};for(const i of t.pageStates){const a=Bt.createId(i.pageId),l=Ft.createId(i.pageId);s.added[a]=Bt.create({id:Bt.createId(i.pageId),x:i.camera.x,y:i.camera.y,z:i.camera.z}),s.added[l]=Ft.create({id:Ft.createId(i.pageId),pageId:i.pageId,selectedIds:i.selectedIds,focusLayerId:i.focusLayerId})}Gn(()=>{e.applyDiff(up([o,s])),e.ensureStoreIsUsable()})}function UV(e){var o;const n=[];for(const s of Object.values(e))(o=s.typeName)!=null&&o.match(/^(instance.*|pointer|camera)$/)&&n.push(s);const t=n.filter(s=>s.typeName==="instance"&&s.id!==hn)[0];if(!t)return null;const r={version:qc,currentPageId:t.currentPageId,exportBackground:!!t.exportBackground,isFocusMode:!!t.isFocusMode,isDebugMode:!!t.isDebugMode,isToolLocked:!!t.isToolLocked,isGridMode:!1,pageStates:n.filter(s=>s.typeName==="instance_page_state"&&s.instanceId===t.id).map(s=>{const i=e[s.cameraId]??{x:0,y:0,z:1};return{pageId:s.pageId,camera:{x:i.x,y:i.y,z:i.z},selectedIds:s.selectedIds,focusLayerId:s.focusLayerId}})};try{return D$.validate(r),r}catch{return null}}function KV(){window.alert(`Oops! We could not save changes to your browser's storage. We now need to reload the page and try again.

Keep seeing this message?
 If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.
 If your hard disk is full, try clearing up some space and then reload the page.`)}function HV(){window.alert(`Oops! We could not access your browser's storageand the app won't work correctly without that. We now need to reload the page and try again.

Keep seeing this message?
 If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.`)}const VV=(e,n)=>n.some(t=>e instanceof t);let tP,nP;function WV(){return tP||(tP=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function YV(){return nP||(nP=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const L$=new WeakMap,R0=new WeakMap,j$=new WeakMap,gm=new WeakMap,aw=new WeakMap;function XV(e){const n=new Promise((t,r)=>{const o=()=>{e.removeEventListener("success",s),e.removeEventListener("error",i)},s=()=>{t(Po(e.result)),o()},i=()=>{r(e.error),o()};e.addEventListener("success",s),e.addEventListener("error",i)});return n.then(t=>{t instanceof IDBCursor&&L$.set(t,e)}).catch(()=>{}),aw.set(n,e),n}function GV(e){if(R0.has(e))return;const n=new Promise((t,r)=>{const o=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",i),e.removeEventListener("abort",i)},s=()=>{t(),o()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",s),e.addEventListener("error",i),e.addEventListener("abort",i)});R0.set(e,n)}let D0={get(e,n,t){if(e instanceof IDBTransaction){if(n==="done")return R0.get(e);if(n==="objectStoreNames")return e.objectStoreNames||j$.get(e);if(n==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Po(e[n])},set(e,n,t){return e[n]=t,!0},has(e,n){return e instanceof IDBTransaction&&(n==="done"||n==="store")?!0:n in e}};function qV(e){D0=e(D0)}function QV(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(n,...t){const r=e.call(mm(this),n,...t);return j$.set(r,n.sort?n.sort():[n]),Po(r)}:YV().includes(e)?function(...n){return e.apply(mm(this),n),Po(L$.get(this))}:function(...n){return Po(e.apply(mm(this),n))}}function ZV(e){return typeof e=="function"?QV(e):(e instanceof IDBTransaction&&GV(e),VV(e,WV())?new Proxy(e,D0):e)}function Po(e){if(e instanceof IDBRequest)return XV(e);if(gm.has(e))return gm.get(e);const n=ZV(e);return n!==e&&(gm.set(e,n),aw.set(n,e)),n}const mm=e=>aw.get(e);function JV(e,n,{blocked:t,upgrade:r,blocking:o,terminated:s}={}){const i=indexedDB.open(e,n),a=Po(i);return r&&i.addEventListener("upgradeneeded",l=>{r(Po(i.result),l.oldVersion,l.newVersion,Po(i.transaction),l)}),t&&i.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),o&&l.addEventListener("versionchange",c=>o(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}function eW(e,{blocked:n}={}){const t=indexedDB.deleteDatabase(e);return n&&t.addEventListener("blocked",r=>n(r.oldVersion,r)),Po(t).then(()=>{})}const tW=["get","getKey","getAll","getAllKeys","count"],nW=["put","add","delete","clear"],ym=new Map;function rP(e,n){if(!(e instanceof IDBDatabase&&!(n in e)&&typeof n=="string"))return;if(ym.get(n))return ym.get(n);const t=n.replace(/FromIndex$/,""),r=n!==t,o=nW.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(o||tW.includes(t)))return;const s=async function(i,...a){const l=this.transaction(i,o?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),o&&l.done]))[0]};return ym.set(n,s),s}qV(e=>({...e,get:(n,t,r)=>rP(n,t)||e.get(n,t,r),has:(n,t)=>!!rP(n,t)||e.has(n,t)}));const bp="TLDRAW_DOCUMENT_v2",N$="TLDRAW_DB_NAME_INDEX_v2",Ce={Records:"records",Schema:"schema",SessionState:"session_state"};async function Pp(e,n){aW(e);const t=await JV(e,3,{upgrade(r){r.objectStoreNames.contains(Ce.Records)||r.createObjectStore(Ce.Records),r.objectStoreNames.contains(Ce.Schema)||r.createObjectStore(Ce.Schema),r.objectStoreNames.contains(Ce.SessionState)||r.createObjectStore(Ce.SessionState)}});try{return await n(t)}finally{t.close()}}async function rW({persistenceKey:e,sessionId:n,didCancel:t}){const r=bp+e;if(lw().includes(r))return await iW({persistenceKey:e,didCancel:t}),await Pp(r,async o=>{var d,h;if(t!=null&&t())return;const s=o.transaction([Ce.Records,Ce.Schema,Ce.SessionState],"readonly"),i=s.objectStore(Ce.Records),a=s.objectStore(Ce.Schema),l=s.objectStore(Ce.SessionState);let c=n?(d=await l.get(n))==null?void 0:d.snapshot:null;c||(c=(h=(await l.getAll()).sort((p,m)=>p.updatedAt-m.updatedAt).pop())==null?void 0:h.snapshot);const u={records:await i.getAll(),schema:await a.get(Ce.Schema),sessionStateSnapshot:c};if(t!=null&&t()){s.abort();return}return await s.done,u})}async function oW({persistenceKey:e,schema:n,changes:t,sessionId:r,sessionStateSnapshot:o,didCancel:s}){const i=bp+e;await Pp(i,async a=>{const l=a.transaction([Ce.Records,Ce.Schema,Ce.SessionState],"readwrite"),c=l.objectStore(Ce.Records),u=l.objectStore(Ce.Schema),d=l.objectStore(Ce.SessionState);for(const[h,f]of Object.entries(t.added))await c.put(f,h);for(const[h,f]of Object.values(t.updated))await c.put(f,f.id);for(const h of Object.keys(t.removed))await c.delete(h);if(u.put(n.serialize(),Ce.Schema),o&&r?d.put({snapshot:o,updatedAt:Date.now(),id:r},r):(o||r)&&console.error("sessionStateSnapshot and instanceId must be provided together"),s!=null&&s())return l.abort();await l.done})}async function sW({persistenceKey:e,schema:n,snapshot:t,sessionId:r,sessionStateSnapshot:o,didCancel:s}){const i=bp+e;await Pp(i,async a=>{const l=a.transaction([Ce.Records,Ce.Schema,Ce.SessionState],"readwrite"),c=l.objectStore(Ce.Records),u=l.objectStore(Ce.Schema),d=l.objectStore(Ce.SessionState);await c.clear();for(const[h,f]of Object.entries(t))await c.put(f,h);if(u.put(n.serialize(),Ce.Schema),o&&r?d.put({snapshot:o,updatedAt:Date.now(),id:r},r):(o||r)&&console.error("sessionStateSnapshot and instanceId must be provided together"),s!=null&&s())return l.abort();await l.done})}async function iW({persistenceKey:e,didCancel:n}){await Pp(bp+e,async t=>{const r=t.transaction([Ce.SessionState],"readwrite"),o=r.objectStore(Ce.SessionState),s=(await o.getAll()).sort((a,l)=>a.updatedAt-l.updatedAt);if(s.length<10){await r.done;return}const i=s.slice(0,s.length-10);for(const{id:a}of i)await o.delete(a);if(n!=null&&n())return r.abort();await r.done})}function lw(){const e=JSON.parse((window==null?void 0:window.localStorage.getItem(N$))||"[]")??[];return Array.isArray(e)?e:[]}function aW(e){const n=new Set(lw());n.add(e),window==null||window.localStorage.setItem(N$,JSON.stringify([...n]))}const lW=350,cW=1e4,oP=Symbol("UPDATE_INSTANCE_STATE"),uW=e=>e;class dW{constructor(n){v(this,"onmessage")}postMessage(n){}close(){}}const hW=typeof BroadcastChannel>"u"?dW:BroadcastChannel;class fW{constructor(n,{persistenceKey:t,sessionId:r=_f,onLoad:o,onLoadError:s},i=new hW(`tldraw-tab-sync-${t}`)){v(this,"disposables",new Set);v(this,"diffQueue",[]);v(this,"didDispose",!1);v(this,"shouldDoFullDBWrite",!0);v(this,"isReloading",!1);v(this,"persistenceKey");v(this,"sessionId");v(this,"serializedSchema");v(this,"isDebugging",!1);v(this,"documentTypes");v(this,"$sessionStateSnapshot");v(this,"initTime",Date.now());v(this,"isPersisting",!1);v(this,"didLastWriteError",!1);v(this,"scheduledPersistTimeout",null);this.store=n,this.channel=i,typeof window<"u"&&(window.tlsync=this),this.persistenceKey=t,this.sessionId=r,this.serializedSchema=this.store.schema.serialize(),this.$sessionStateSnapshot=BV(this.store),this.disposables.add(n.listen(({changes:a})=>{this.diffQueue.push(a),this.channel.postMessage(uW({type:"diff",storeId:this.store.id,changes:a,schema:this.serializedSchema})),this.schedulePersist()},{source:"user",scope:"document"})),this.disposables.add(n.listen(()=>{this.diffQueue.push(oP),this.schedulePersist()},{scope:"session"})),this.connect(o,s),this.documentTypes=new Set(Object.values(this.store.schema.types).filter(a=>a.scope==="document").map(a=>a.typeName))}debug(...n){this.isDebugging&&console.debug(...n)}async connect(n,t){this.debug("connecting");let r;try{r=await rW({persistenceKey:this.persistenceKey,sessionId:this.sessionId,didCancel:()=>this.didDispose})}catch(o){t(o),HV(),typeof window<"u"&&window.location.reload();return}if(this.debug("loaded data from store",r,"didDispose",this.didDispose),!this.didDispose)try{if(r){const o=Object.fromEntries(r.records.map(a=>[a.id,a])),s=r.sessionStateSnapshot??UV(o),i=this.store.schema.migrateStoreSnapshot({store:o,schema:r.schema??this.store.schema.serializeEarliestVersion()});if(i.type==="error"){console.error("failed to migrate store",i),t(new Error(`Failed to migrate store: ${i.reason}`));return}this.store.mergeRemoteChanges(()=>{this.store.put(Object.values(i.value).filter(a=>this.documentTypes.has(a.typeName)),"initialize")}),s&&FV(this.store,s)}this.channel.onmessage=({data:o})=>{var a,l;this.debug("got message",o);const s=o,i=Wj(this.serializedSchema,s.schema??this.store.schema.serializeEarliestVersion());if(i===-1){if(Date.now()-this.initTime<5e3){t(new Error("Schema mismatch, please close other tabs and reload the page"));return}this.debug("reloading"),this.isReloading=!0,(l=(a=window==null?void 0:window.location)==null?void 0:a.reload)==null||l.call(a);return}else if(i===1){this.debug("telling them to reload"),this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.shouldDoFullDBWrite=!0,this.persistIfNeeded();return}s.type==="diff"&&(this.debug("applying diff"),Gn(()=>{this.store.mergeRemoteChanges(()=>{this.store.applyDiff(s.changes),this.store.ensureStoreIsUsable()})}))},this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.disposables.add(()=>{this.channel.close()}),n(this)}catch(o){if(this.debug("error loading data from store",o),this.didDispose)return;t(o);return}}close(){this.debug("closing"),this.didDispose=!0,this.disposables.forEach(n=>n())}schedulePersist(){this.debug("schedulePersist",this.scheduledPersistTimeout),!this.scheduledPersistTimeout&&(this.scheduledPersistTimeout=setTimeout(()=>{this.scheduledPersistTimeout=null,this.persistIfNeeded()},this.didLastWriteError?cW:lW))}persistIfNeeded(){this.debug("persistIfNeeded",{isPersisting:this.isPersisting,isReloading:this.isReloading,shouldDoFullDBWrite:this.shouldDoFullDBWrite,diffQueueLength:this.diffQueue.length,storeIsPossiblyCorrupt:this.store.isPossiblyCorrupted()}),this.scheduledPersistTimeout&&(clearTimeout(this.scheduledPersistTimeout),this.scheduledPersistTimeout=null),!this.isPersisting&&(this.isReloading||this.store.isPossiblyCorrupted()||(this.shouldDoFullDBWrite||this.diffQueue.length>0)&&this.doPersist())}async doPersist(){Rc(!this.isPersisting,"persist already in progress"),this.isPersisting=!0,this.debug("doPersist start");const n=this.diffQueue;this.diffQueue=[];try{if(this.shouldDoFullDBWrite)this.shouldDoFullDBWrite=!1,await sW({persistenceKey:this.persistenceKey,schema:this.store.schema,snapshot:this.store.serialize(),didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.value});else{const t=up(n.filter(r=>r!==oP));await oW({persistenceKey:this.persistenceKey,changes:t,schema:this.store.schema,didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.value})}this.didLastWriteError=!1}catch(t){this.shouldDoFullDBWrite=!0,this.didLastWriteError=!0,console.error("failed to store changes in indexed db",t),KV(),typeof window<"u"&&window.location.reload()}this.isPersisting=!1,this.debug("doPersist end"),this.schedulePersist()}}function sP({initialData:e,defaultName:n="",...t}){const r="schema"in t?t.schema:j9({shapes:pW(d$(t.shapes))});return new FI({schema:r,initialData:e,props:{defaultName:n}})}function pW(e){return Object.fromEntries(e.map(n=>[n.type,n]))}function gW(e){const n=w.useRef(e);return w.useEffect(()=>{n.current=e}),n.current}function mW(e){const[n,t]=w.useState(()=>sP(e)),r=gW(e);if(Object.keys(r).some(o=>r[o]!==e[o])){const o=sP(e);return t(o),o}return n}function yW({persistenceKey:e,sessionId:n,...t}){const[r,o]=w.useState(null),s=mW(t);return w.useEffect(()=>{const i=nt();if(!e){o({id:i,storeWithStatus:{status:"not-synced",store:s}});return}o({id:i,storeWithStatus:{status:"loading"}});const a=c=>{o(u=>(u==null?void 0:u.id)===i?{id:i,storeWithStatus:c}:u)},l=new fW(s,{sessionId:n,persistenceKey:e,onLoad(){a({store:s,status:"synced-local"})},onLoadError(c){a({status:"error",error:c})}});return()=>{o(c=>(c==null?void 0:c.id)===i?null:c),l.close()}},[e,s,n]),(r==null?void 0:r.storeWithStatus)??{status:"loading"}}const Cd=(e,n)=>{const[t,r]=w.useState(2);return w.useEffect(()=>{const{url:o,style:s="normal",weight:i="500",display:a,featureSettings:l,stretch:c,unicodeRange:u,variant:d}=n;let h=!1;r(2);const f={style:s,weight:i,display:a,featureSettings:l,stretch:c,unicodeRange:u,variant:d},p=new FontFace(e,`url(${o})`,f);return p.load().then(()=>{h||(document.fonts.add(p),r(0))}).catch(m=>{h||(console.error(m),r(1))}),p.$$_url=o,p.$$_fontface=`
@font-face {
	font-family: ${p.family};
	font-stretch: ${p.stretch};
	font-weight: ${p.weight};
	font-style: ${p.style};
	src: url("${o}") format("woff2")
}`,()=>{document.fonts.delete(p),h=!0}},[e,n]),t};function vW(e){return{draw:{url:e.fonts.draw},serif:{url:e.fonts.serif},sansSerif:{url:e.fonts.sansSerif},monospace:{url:e.fonts.monospace}}}function wW(e){const n=w.useMemo(()=>vW(e),[e]),t=[Cd("tldraw_draw",n.draw),Cd("tldraw_serif",n.serif),Cd("tldraw_sans",n.sansSerif),Cd("tldraw_mono",n.monospace)];return{error:t.some(r=>r===1),done:!t.some(r=>r===2)}}let z$=!1;if(typeof window<"u"){const e=window.navigator.userAgent,n=!!e.match(/iPad/i)||!!e.match(/iPhone/i),t=!!e.match(/WebKit/i);z$=n&&t&&!e.match(/CriOS/i)}function xW(){const e=U();w.useEffect(()=>{if(!z$)return;function n(t){(t.target instanceof HTMLInputElement&&t.target.type==="text"||t.target instanceof HTMLTextAreaElement)&&e.complete()}return document.addEventListener("focusout",n),()=>document.removeEventListener("focusout",n)},[e])}function SW(){const e=U(),n=Yt();w.useEffect(()=>{const t=s=>n.style.setProperty("--tl-zoom",s.toString()),r=NI(t,100),o=new yu("useZoomCss",()=>{e.currentPageShapeIds.size<300?t(e.zoomLevel):r(e.zoomLevel)});return o.attach(),o.execute(),()=>{o.detach()}},[e,n])}const bW=[],PW=[],EW=w.memo(function({store:n,components:t,...r}){const[o,s]=oe.useState(null),i=w.useMemo(()=>Hk(),[]),a=(t==null?void 0:t.ErrorFallback)===void 0?jk:t==null?void 0:t.ErrorFallback,l={...r,shapes:r.shapes??bW,tools:r.tools??PW};return g.jsx("div",{ref:s,draggable:!1,className:"tl-container tl-theme__light",tabIndex:0,children:g.jsx(Yc,{fallback:a,onError:c=>E1(c,{tags:{origin:"react.tldraw-before-app"}}),children:o&&g.jsx(WN,{container:o,children:g.jsx(kz,{overrides:t,children:n?n instanceof FI?g.jsx(F$,{...l,store:n,user:i}):g.jsx(B$,{...l,store:n,user:i}):g.jsx(_W,{...l,store:n,user:i})})})})})});function _W(e){const{defaultName:n,initialData:t,shapes:r,persistenceKey:o,sessionId:s,user:i}=e,a=yW({shapes:r,initialData:t,persistenceKey:o,sessionId:s,defaultName:n});return g.jsx(B$,{...e,store:a,user:i})}const B$=w.memo(function({store:n,user:t,...r}){const o=Yt();switch(w.useLayoutEffect(()=>{t.userPreferences.value.isDarkMode&&(o.classList.remove("tl-theme__light"),o.classList.add("tl-theme__dark"))},[o,t.userPreferences.value.isDarkMode]),n.status){case"error":throw n.error;case"loading":return g.jsx(U$,{children:"Connecting..."})}return g.jsx(F$,{...r,store:n.store,user:t})});function F$({onMount:e,children:n,store:t,tools:r,shapes:o,autoFocus:s,user:i,assetUrls:a}){const{ErrorFallback:l}=ar(),c=Yt(),[u,d]=w.useState(null);w.useLayoutEffect(()=>{const x=new ae({store:t,shapes:o,tools:r,getContainer:()=>c,user:i});return window.app=x,window.editor=x,d(x),()=>{x.dispose()}},[c,o,r,t,i]),oe.useLayoutEffect(()=>{u&&s&&u.focus()},[u,s]);const h=RV(x=>{const S=e==null?void 0:e(x);return x.emit("mount"),window.tldrawReady=!0,S});oe.useLayoutEffect(()=>{if(u)return h==null?void 0:h(u)},[u,h]);const f=w.useSyncExternalStore(w.useCallback(x=>u?(u.on("crash",x),()=>u.off("crash",x)):()=>{},[u]),()=>(u==null?void 0:u.crashingError)??null),p=yN(a),{done:m,error:y}=wW(p);return y?g.jsx(kW,{children:"Could not load assets. Please refresh the page."}):m?u?g.jsx(Yc,{fallback:l,onError:x=>u.annotateError(x,{origin:"react.tldraw",willCrashApp:!0}),children:f?g.jsx(IW,{crashingError:f}):g.jsx(D1.Provider,{value:u,children:g.jsx(CW,{children:n})})}):null:g.jsx(U$,{children:"Loading assets..."})}function CW({children:e}){return SW(),CU(),OV(),xW(),DV(),e}function IW({crashingError:e}){throw e}function U$({children:e}){const{Spinner:n}=ar();return g.jsxs("div",{className:"tl-loading",children:[n?g.jsx(n,{}):null,e]})}function kW({children:e}){return g.jsx("div",{className:"tl-loading",children:e})}class K$ extends re{constructor(){super(...arguments);v(this,"info",{});v(this,"scribble",{});v(this,"markId","");v(this,"excludedShapeIds",new Set);v(this,"onEnter",t=>{this.markId=this.editor.mark("erase scribble begin"),this.info=t;const{originPagePoint:r}=this.editor.inputs;this.excludedShapeIds=new Set(this.editor.shapesArray.filter(o=>this.editor.isShapeOrAncestorLocked(o)||(this.editor.isShapeOfType(o,Ye)||this.editor.isShapeOfType(o,kt))&&this.editor.isPointInShape(r,o)).map(o=>o.id)),this.startScribble(),this.update()});v(this,"startScribble",()=>{var t;this.scribble.tick&&this.editor.off("tick",(t=this.scribble)==null?void 0:t.tick),this.scribble=new iw({onUpdate:this.onScribbleUpdate,onComplete:this.onScribbleComplete,color:"muted-1",size:12}),this.editor.on("tick",this.scribble.tick)});v(this,"pushPointToScribble",()=>{const{x:t,y:r}=this.editor.inputs.currentPagePoint;this.scribble.addPoint(t,r)});v(this,"onScribbleUpdate",t=>{this.editor.setScribble(t)});v(this,"onScribbleComplete",()=>{this.editor.off("tick",this.scribble.tick),this.editor.setScribble(null)});v(this,"onExit",()=>{this.scribble.stop()});v(this,"onPointerMove",()=>{this.update()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()})}update(){const{shapesArray:t,erasingIdsSet:r,inputs:{currentPagePoint:o,previousPagePoint:s}}=this.editor,{excludedShapeIds:i}=this;this.pushPointToScribble();const a=new Set(r);for(const l of t){if(this.editor.isShapeOfType(l,Ye))continue;const c=this.editor.getPageMaskById(l.id);if(c&&!sr(o,c))continue;const u=this.editor.getShapeUtil(l),d=this.editor.getPointInShapeSpace(l,s),h=this.editor.getPointInShapeSpace(l,o);u.hitTestLineSegment(l,d,h)&&a.add(this.editor.getOutermostSelectableShape(l).id)}this.editor.setErasingIds([...a].filter(l=>!i.has(l)))}complete(){this.editor.deleteShapes(this.editor.pageState.erasingIds),this.editor.setErasingIds([]),this.parent.transition("idle",{})}cancel(){this.editor.setErasingIds([]),this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}}v(K$,"id","erasing");var iy;let $W=(iy=class extends re{constructor(){super(...arguments);v(this,"onPointerDown",t=>{this.parent.transition("pointing",t)})}},v(iy,"id","idle"),iy);var ay;let TW=(ay=class extends re{constructor(){super(...arguments);v(this,"onEnter",()=>{const{inputs:t}=this.editor,r=new Set,o=r.size;for(const s of[...this.editor.sortedShapesArray].reverse())if(this.editor.isPointInShape(t.currentPagePoint,s)){if(this.editor.isShapeOfType(s,Ye))continue;const i=this.editor.getOutermostSelectableShape(s);if(this.editor.isShapeOfType(i,kt)&&r.size>o)break;r.add(i.id)}this.editor.setErasingIds([...r])});v(this,"onPointerMove",t=>{this.editor.inputs.isDragging&&this.parent.transition("erasing",t)});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()});v(this,"onInterrupt",()=>{this.cancel()})}complete(){const{erasingIds:t}=this.editor;t.length&&(this.editor.mark("erase end"),this.editor.deleteShapes(t)),this.editor.setErasingIds([]),this.parent.transition("idle",{})}cancel(){this.editor.setErasingIds([]),this.parent.transition("idle",{})}},v(ay,"id","pointing"),ay);class Sh extends re{constructor(){super(...arguments);v(this,"onEnter",()=>{this.editor.setCursor({type:"cross"})})}}v(Sh,"id","eraser"),v(Sh,"initial","idle"),v(Sh,"children",()=>[$W,TW,K$]);class H$ extends re{constructor(){super(...arguments);v(this,"onEnter",()=>{this.update()});v(this,"onPointerMove",()=>{this.update()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()})}update(){const{currentScreenPoint:t,previousScreenPoint:r}=this.editor.inputs,o=E.Sub(t,r);(Math.abs(o.x)>0||Math.abs(o.y)>0)&&this.editor.pan(o.x,o.y)}complete(){this.editor.slideCamera({speed:Math.min(2,this.editor.inputs.pointerVelocity.len()),direction:this.editor.inputs.pointerVelocity,friction:ih}),this.parent.transition("idle",{})}}v(H$,"id","dragging");var ly;let MW=(ly=class extends re{constructor(){super(...arguments);v(this,"onEnter",()=>{this.editor.setCursor({type:"grab"})});v(this,"onPointerDown",t=>{this.parent.transition("pointing",t)});v(this,"onCancel",()=>{this.editor.setSelectedTool("select")})}},v(ly,"id","idle"),ly);class V$ extends re{constructor(){super(...arguments);v(this,"onEnter",()=>{this.editor.stopCameraAnimation(),this.editor.setCursor({type:"grabbing"})});v(this,"onPointerMove",t=>{this.editor.inputs.isDragging&&this.parent.transition("dragging",t)});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onInterrupt",()=>{this.complete()})}complete(){this.parent.transition("idle",{})}}v(V$,"id","pointing");class bh extends re{constructor(){super(...arguments);v(this,"onDoubleClick",t=>{if(t.phase==="settle"){const{currentScreenPoint:r}=this.editor.inputs;this.editor.zoomIn(r,{duration:220,easing:Kt.easeOutQuint})}});v(this,"onTripleClick",t=>{if(t.phase==="settle"){const{currentScreenPoint:r}=this.editor.inputs;this.editor.zoomOut(r,{duration:320,easing:Kt.easeOutQuint})}});v(this,"onQuadrupleClick",t=>{if(t.phase==="settle"){const{zoomLevel:r,inputs:{currentScreenPoint:o}}=this.editor;r===1?this.editor.zoomToFit({duration:400,easing:Kt.easeOutQuint}):this.editor.resetZoom(o,{duration:320,easing:Kt.easeOutQuint})}})}}v(bh,"id","hand"),v(bh,"initial","idle"),v(bh,"children",()=>[MW,V$,H$]);class W$ extends re{constructor(){super(...arguments);v(this,"onPointerDown",t=>{this.parent.transition("lasering",t)})}}v(W$,"id","idle");class Y$ extends re{constructor(){super(...arguments);v(this,"scribble",{});v(this,"onEnter",()=>{this.startScribble(),this.pushPointToScribble()});v(this,"onExit",()=>{this.editor.setErasingIds([]),this.scribble.stop()});v(this,"onPointerMove",()=>{this.pushPointToScribble()});v(this,"onPointerUp",()=>{this.complete()});v(this,"startScribble",()=>{var t;this.scribble.tick&&this.editor.off("tick",(t=this.scribble)==null?void 0:t.tick),this.scribble=new iw({onUpdate:this.onScribbleUpdate,onComplete:this.onScribbleComplete,color:"laser",opacity:.7,size:4,delay:1200}),this.editor.on("tick",this.scribble.tick)});v(this,"pushPointToScribble",()=>{const{x:t,y:r}=this.editor.inputs.currentPagePoint;this.scribble.addPoint(t,r)});v(this,"onScribbleUpdate",t=>{this.editor.setScribble(t)});v(this,"onScribbleComplete",()=>{this.editor.off("tick",this.scribble.tick),this.editor.setScribble(null)});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()})}complete(){this.parent.transition("idle",{})}cancel(){this.parent.transition("idle",{})}}v(Y$,"id","lasering");class Ph extends re{constructor(){super(...arguments);v(this,"onEnter",()=>{this.editor.setCursor({type:"cross"})})}}v(Ph,"id","laser"),v(Ph,"initial","idle"),v(Ph,"children",()=>[W$,Y$]);const AW=[bh,Sh,Ph];/*!
 * canvas-size
 * v1.2.6
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2023 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function OW(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var r,o,s,i,a=[],l=!0,c=!1;try{if(s=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(r=s.call(t)).done)&&(a.push(r.value),a.length!==n);l=!0);}catch(u){c=!0,o=u}finally{try{if(!l&&t.return!=null&&(i=t.return(),Object(i)!==i))return}finally{if(c)throw o}}return a}}function iP(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),t.push.apply(t,r)}return t}function Cn(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?iP(Object(t),!0).forEach(function(r){RW(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):iP(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function RW(e,n,t){return n=KW(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function DW(e,n){if(e==null)return{};var t={},r=Object.keys(e),o,s;for(s=0;s<r.length;s++)o=r[s],!(n.indexOf(o)>=0)&&(t[o]=e[o]);return t}function LW(e,n){if(e==null)return{};var t=DW(e,n),r,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)r=s[o],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function aP(e,n){return NW(e)||OW(e,n)||X$(e,n)||FW()}function Id(e){return jW(e)||zW(e)||X$(e)||BW()}function jW(e){if(Array.isArray(e))return L0(e)}function NW(e){if(Array.isArray(e))return e}function zW(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function X$(e,n){if(e){if(typeof e=="string")return L0(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return L0(e,n)}}function L0(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function BW(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FW(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UW(e,n){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function KW(e){var n=UW(e,"string");return typeof n=="symbol"?n:String(n)}function fc(e){var n=e.sizes.shift(),t=Math.max(Math.ceil(n[0]),1),r=Math.max(Math.ceil(n[1]),1),o=[t-1,r-1,1,1],s=Date.now(),i=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,a,l;i?(a=new OffscreenCanvas(1,1),l=new OffscreenCanvas(t,r)):(a=document.createElement("canvas"),a.width=1,a.height=1,l=document.createElement("canvas"),l.width=t,l.height=r);var c=a.getContext("2d"),u=l.getContext("2d");u&&(u.fillRect.apply(u,o),c.drawImage(l,t-1,r-1,1,1,0,0,1,1));var d=c&&c.getImageData(0,0,1,1).data[3]!==0,h=Date.now()-s;return[a,l].forEach(function(f){f.height=0,f.width=0}),i?(postMessage({width:t,height:r,benchmark:h,isTestPass:d}),!d&&e.sizes.length&&fc(e)):d?e.onSuccess(t,r,h):(e.onError(t,r,h),e.sizes.length&&fc(e)),d}var vm={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},HW=["onError","onSuccess"],Pa={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},zl={};function wm(e){var n=e.width===e.height,t=e.height===1,r=e.width===1,o=[];if(!e.width||!e.height)e.sizes.forEach(function(u){var d=n||t?u:1,h=n||r?u:1;o.push([d,h])});else for(var s=e.min||Pa.min,i=e.step||Pa.step,a=Math.max(e.width,e.height);a>=s;){var l=n||t?a:1,c=n||r?a:1;o.push([l,c]),a-=i}return o}function kd(e){var n=window&&"HTMLCanvasElement"in window,t=window&&"OffscreenCanvas"in window,r=Date.now(),o=e.onError,s=e.onSuccess,i=LW(e,HW),a=null;if(!n)return!1;if(e.useWorker&&t){var l=`
            var canvasTest = `.concat(fc.toString(),`;
            onmessage = function(e) {
                canvasTest(e.data);
            };
        `),c=new Blob([l],{type:"application/javascript"}),u=URL.createObjectURL(c);a=new Worker(u),URL.revokeObjectURL(u),a.onmessage=function(d){var h=d.data,f=h.width,p=h.height,m=h.benchmark,y=h.isTestPass;y?(zl[r].onSuccess(f,p,m),delete zl[r]):zl[r].onError(f,p,m)}}if(e.usePromise)return new Promise(function(d,h){var f=Cn(Cn({},e),{},{onError:function(x,S,b){var P;if(e.sizes.length===0)P=!0;else{var C=e.sizes.slice(-1),_=aP(C,1),I=aP(_[0],2),k=I[0],T=I[1];P=x===k&&S===T}o(x,S,b),P&&h({width:x,height:S,benchmark:b})},onSuccess:function(x,S,b){s(x,S,b),d({width:x,height:S,benchmark:b})}});if(a){var p=f.onError,m=f.onSuccess;zl[r]={onError:p,onSuccess:m},a.postMessage(i)}else fc(f)});if(a)zl[r]={onError:o,onSuccess:s},a.postMessage(i);else return fc(e)}var xm={maxArea:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=wm({width:n.max,height:n.max,min:n.min,step:n.step,sizes:Id(vm.area)}),r=Cn(Cn(Cn({},Pa),n),{},{sizes:t});return kd(r)},maxHeight:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=wm({width:1,height:n.max,min:n.min,step:n.step,sizes:Id(vm.height)}),r=Cn(Cn(Cn({},Pa),n),{},{sizes:t});return kd(r)},maxWidth:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=wm({width:n.max,height:1,min:n.min,step:n.step,sizes:Id(vm.width)}),r=Cn(Cn(Cn({},Pa),n),{},{sizes:t});return kd(r)},test:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=Cn(Cn({},Pa),n);return t.sizes=Id(t.sizes),t.width&&t.height&&(t.sizes=[[t.width,t.height]]),kd(t)}};let Sm=null;function VW(){return Sm||(Sm=WW()),Sm}async function WW(){const e=await xm.maxWidth({usePromise:!0}),n=await xm.maxHeight({usePromise:!0}),t=await xm.maxArea({usePromise:!0});return{maxWidth:e.width,maxHeight:n.height,maxArea:t.width*t.height}}function G$(e){const n=e.cloneNode(!0);return e.setAttribute("width",+e.getAttribute("width")+""),e.setAttribute("height",+e.getAttribute("height")+""),new XMLSerializer().serializeToString(n).replaceAll("&#10;      ","").replaceAll(/((\s|")[0-9]*\.[0-9]{2})([0-9]*)(\b|"|\))/g,"$1")}async function q$(e,n){const{type:t,quality:r,scale:o}=n,s=+e.getAttribute("width"),i=+e.getAttribute("height");let a=s*o,l=i*o;const c=await Q$(e),u=await VW();if(s>u.maxWidth&&(a=u.maxWidth,l=a/s*i),i>u.maxHeight&&(l=u.maxHeight,a=l/i*s),a*l>u.maxArea){const m=Math.sqrt(u.maxArea/(a*l));a*=m,l*=m}a=Math.floor(a),l=Math.floor(l);const d=a/s,h=await new Promise(m=>{const y=new Image;y.crossOrigin="anonymous",y.onload=async()=>{await new Promise(b=>setTimeout(b,250));const x=document.createElement("canvas"),S=x.getContext("2d");x.width=a,x.height=l,S.imageSmoothingEnabled=!0,S.imageSmoothingQuality="high",S.drawImage(y,0,0,a,l),URL.revokeObjectURL(c),m(x)},y.onerror=()=>{m(null)},y.src=c});if(!h)return null;const f=await new Promise(m=>h.toBlob(y=>{(!y||pt.throwToBlob.value)&&m(null),m(y)},"image/"+t,r));if(!f)return null;const p=new DataView(await f.arrayBuffer());return YH(p,d,{type:"image/"+t})}async function Q$(e){const n=e.cloneNode(!0);n.setAttribute("encoding",'UTF-8"');const t=new FileReader,r=Array.from(n.querySelectorAll("image"));for(const o of r){const s=o.getAttribute("xlink:href");if(s&&!s.startsWith("data:")){const i=await(await fetch(s)).blob(),a=await new Promise((l,c)=>{t.onload=()=>l(t.result),t.onerror=()=>c(t.error),t.readAsDataURL(i)});o.setAttribute("xlink:href",a)}}return YW(n)}function YW(e){const n=new XMLSerializer().serializeToString(e);return`data:image/svg+xml;base64,${window.btoa(unescape(encodeURIComponent(n)))}`}function bm(e,n){const t=document.createElement("a");t.href=e,t.download=n,t.click()}async function XW({shouldReload:e=!0}={}){sessionStorage.clear(),await Promise.all(lw().map(n=>eW(n))),localStorage.clear(),e&&window.location.reload()}typeof window<"u"&&(window.__tldraw__hardReset=XW);function GW(e,n="_blank"){L1.openWindow(e,n)}function W(){return W=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},W.apply(this,arguments)}function ie(e,n,{checkForDefaultPrevented:t=!0}={}){return function(o){if(e==null||e(o),t===!1||!o.defaultPrevented)return n==null?void 0:n(o)}}function qW(e,n){typeof e=="function"?e(n):e!=null&&(e.current=n)}function Ep(...e){return n=>e.forEach(t=>qW(t,n))}function Ze(...e){return w.useCallback(Ep(...e),e)}function zo(e,n=[]){let t=[];function r(s,i){const a=w.createContext(i),l=t.length;t=[...t,i];function c(d){const{scope:h,children:f,...p}=d,m=(h==null?void 0:h[e][l])||a,y=w.useMemo(()=>p,Object.values(p));return w.createElement(m.Provider,{value:y},f)}function u(d,h){const f=(h==null?void 0:h[e][l])||a,p=w.useContext(f);if(p)return p;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${s}\``)}return c.displayName=s+"Provider",[c,u]}const o=()=>{const s=t.map(i=>w.createContext(i));return function(a){const l=(a==null?void 0:a[e])||s;return w.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return o.scopeName=e,[r,QW(o,...n)]}function QW(...e){const n=e[0];if(e.length===1)return n;const t=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(s){const i=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return w.useMemo(()=>({[`__scope${n.scopeName}`]:i}),[i])}};return t.scopeName=n.scopeName,t}const Ii=globalThis!=null&&globalThis.document?w.useLayoutEffect:()=>{},ZW=yE["useId".toString()]||(()=>{});let JW=0;function bs(e){const[n,t]=w.useState(ZW());return Ii(()=>{e||t(r=>r??String(JW++))},[e]),e||(n?`radix-${n}`:"")}function Vt(e){const n=w.useRef(e);return w.useEffect(()=>{n.current=e}),w.useMemo(()=>(...t)=>{var r;return(r=n.current)===null||r===void 0?void 0:r.call(n,...t)},[])}function Li({prop:e,defaultProp:n,onChange:t=()=>{}}){const[r,o]=eY({defaultProp:n,onChange:t}),s=e!==void 0,i=s?e:r,a=Vt(t),l=w.useCallback(c=>{if(s){const d=typeof c=="function"?c(e):c;d!==e&&a(d)}else o(c)},[s,e,o,a]);return[i,l]}function eY({defaultProp:e,onChange:n}){const t=w.useState(e),[r]=t,o=w.useRef(r),s=Vt(n);return w.useEffect(()=>{o.current!==r&&(s(r),o.current=r)},[r,o,s]),t}const Ga=w.forwardRef((e,n)=>{const{children:t,...r}=e,o=w.Children.toArray(t),s=o.find(nY);if(s){const i=s.props.children,a=o.map(l=>l===s?w.Children.count(i)>1?w.Children.only(null):w.isValidElement(i)?i.props.children:null:l);return w.createElement(j0,W({},r,{ref:n}),w.isValidElement(i)?w.cloneElement(i,void 0,a):null)}return w.createElement(j0,W({},r,{ref:n}),t)});Ga.displayName="Slot";const j0=w.forwardRef((e,n)=>{const{children:t,...r}=e;return w.isValidElement(t)?w.cloneElement(t,{...rY(r,t.props),ref:n?Ep(n,t.ref):t.ref}):w.Children.count(t)>1?w.Children.only(null):null});j0.displayName="SlotClone";const tY=({children:e})=>w.createElement(w.Fragment,null,e);function nY(e){return w.isValidElement(e)&&e.type===tY}function rY(e,n){const t={...n};for(const r in n){const o=e[r],s=n[r];/^on[A-Z]/.test(r)?o&&s?t[r]=(...a)=>{s(...a),o(...a)}:o&&(t[r]=o):r==="style"?t[r]={...o,...s}:r==="className"&&(t[r]=[o,s].filter(Boolean).join(" "))}return{...e,...t}}const oY=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Oe=oY.reduce((e,n)=>{const t=w.forwardRef((r,o)=>{const{asChild:s,...i}=r,a=s?Ga:n;return w.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),w.createElement(a,W({},i,{ref:o}))});return t.displayName=`Primitive.${n}`,{...e,[n]:t}},{});function cw(e,n){e&&Do.flushSync(()=>e.dispatchEvent(n))}function sY(e,n=globalThis==null?void 0:globalThis.document){const t=Vt(e);w.useEffect(()=>{const r=o=>{o.key==="Escape"&&t(o)};return n.addEventListener("keydown",r),()=>n.removeEventListener("keydown",r)},[t,n])}const N0="dismissableLayer.update",iY="dismissableLayer.pointerDownOutside",aY="dismissableLayer.focusOutside";let lP;const Z$=w.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),uw=w.forwardRef((e,n)=>{var t;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:o,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:l,...c}=e,u=w.useContext(Z$),[d,h]=w.useState(null),f=(t=d==null?void 0:d.ownerDocument)!==null&&t!==void 0?t:globalThis==null?void 0:globalThis.document,[,p]=w.useState({}),m=Ze(n,k=>h(k)),y=Array.from(u.layers),[x]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),S=y.indexOf(x),b=d?y.indexOf(d):-1,P=u.layersWithOutsidePointerEventsDisabled.size>0,C=b>=S,_=cY(k=>{const T=k.target,M=[...u.branches].some(O=>O.contains(T));!C||M||(s==null||s(k),a==null||a(k),k.defaultPrevented||l==null||l())},f),I=uY(k=>{const T=k.target;[...u.branches].some(O=>O.contains(T))||(i==null||i(k),a==null||a(k),k.defaultPrevented||l==null||l())},f);return sY(k=>{b===u.layers.size-1&&(o==null||o(k),!k.defaultPrevented&&l&&(k.preventDefault(),l()))},f),w.useEffect(()=>{if(d)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(lP=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),cP(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=lP)}},[d,f,r,u]),w.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),cP())},[d,u]),w.useEffect(()=>{const k=()=>p({});return document.addEventListener(N0,k),()=>document.removeEventListener(N0,k)},[]),w.createElement(Oe.div,W({},c,{ref:m,style:{pointerEvents:P?C?"auto":"none":void 0,...e.style},onFocusCapture:ie(e.onFocusCapture,I.onFocusCapture),onBlurCapture:ie(e.onBlurCapture,I.onBlurCapture),onPointerDownCapture:ie(e.onPointerDownCapture,_.onPointerDownCapture)}))}),lY=w.forwardRef((e,n)=>{const t=w.useContext(Z$),r=w.useRef(null),o=Ze(n,r);return w.useEffect(()=>{const s=r.current;if(s)return t.branches.add(s),()=>{t.branches.delete(s)}},[t.branches]),w.createElement(Oe.div,W({},e,{ref:o}))});function cY(e,n=globalThis==null?void 0:globalThis.document){const t=Vt(e),r=w.useRef(!1),o=w.useRef(()=>{});return w.useEffect(()=>{const s=a=>{if(a.target&&!r.current){let u=function(){J$(iY,t,c,{discrete:!0})};var l=u;const c={originalEvent:a};a.pointerType==="touch"?(n.removeEventListener("click",o.current),o.current=u,n.addEventListener("click",o.current,{once:!0})):u()}r.current=!1},i=window.setTimeout(()=>{n.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(i),n.removeEventListener("pointerdown",s),n.removeEventListener("click",o.current)}},[n,t]),{onPointerDownCapture:()=>r.current=!0}}function uY(e,n=globalThis==null?void 0:globalThis.document){const t=Vt(e),r=w.useRef(!1);return w.useEffect(()=>{const o=s=>{s.target&&!r.current&&J$(aY,t,{originalEvent:s},{discrete:!1})};return n.addEventListener("focusin",o),()=>n.removeEventListener("focusin",o)},[n,t]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function cP(){const e=new CustomEvent(N0);document.dispatchEvent(e)}function J$(e,n,t,{discrete:r}){const o=t.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:t});n&&o.addEventListener(e,n,{once:!0}),r?cw(o,s):o.dispatchEvent(s)}const dY=uw,hY=lY,Pm="focusScope.autoFocusOnMount",Em="focusScope.autoFocusOnUnmount",uP={bubbles:!1,cancelable:!0},eT=w.forwardRef((e,n)=>{const{loop:t=!1,trapped:r=!1,onMountAutoFocus:o,onUnmountAutoFocus:s,...i}=e,[a,l]=w.useState(null),c=Vt(o),u=Vt(s),d=w.useRef(null),h=Ze(n,m=>l(m)),f=w.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;w.useEffect(()=>{if(r){let S=function(_){if(f.paused||!a)return;const I=_.target;a.contains(I)?d.current=I:Jo(d.current,{select:!0})},b=function(_){if(f.paused||!a)return;const I=_.relatedTarget;I!==null&&(a.contains(I)||Jo(d.current,{select:!0}))},P=function(_){const I=document.activeElement;for(const k of _)k.removedNodes.length>0&&(a!=null&&a.contains(I)||Jo(a))};var m=S,y=b,x=P;document.addEventListener("focusin",S),document.addEventListener("focusout",b);const C=new MutationObserver(P);return a&&C.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",S),document.removeEventListener("focusout",b),C.disconnect()}}},[r,a,f.paused]),w.useEffect(()=>{if(a){hP.add(f);const m=document.activeElement;if(!a.contains(m)){const x=new CustomEvent(Pm,uP);a.addEventListener(Pm,c),a.dispatchEvent(x),x.defaultPrevented||(fY(vY(tT(a)),{select:!0}),document.activeElement===m&&Jo(a))}return()=>{a.removeEventListener(Pm,c),setTimeout(()=>{const x=new CustomEvent(Em,uP);a.addEventListener(Em,u),a.dispatchEvent(x),x.defaultPrevented||Jo(m??document.body,{select:!0}),a.removeEventListener(Em,u),hP.remove(f)},0)}}},[a,c,u,f]);const p=w.useCallback(m=>{if(!t&&!r||f.paused)return;const y=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,x=document.activeElement;if(y&&x){const S=m.currentTarget,[b,P]=pY(S);b&&P?!m.shiftKey&&x===P?(m.preventDefault(),t&&Jo(b,{select:!0})):m.shiftKey&&x===b&&(m.preventDefault(),t&&Jo(P,{select:!0})):x===S&&m.preventDefault()}},[t,r,f.paused]);return w.createElement(Oe.div,W({tabIndex:-1},i,{ref:h,onKeyDown:p}))});function fY(e,{select:n=!1}={}){const t=document.activeElement;for(const r of e)if(Jo(r,{select:n}),document.activeElement!==t)return}function pY(e){const n=tT(e),t=dP(n,e),r=dP(n.reverse(),e);return[t,r]}function tT(e){const n=[],t=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)n.push(t.currentNode);return n}function dP(e,n){for(const t of e)if(!gY(t,{upTo:n}))return t}function gY(e,{upTo:n}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(n!==void 0&&e===n)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function mY(e){return e instanceof HTMLInputElement&&"select"in e}function Jo(e,{select:n=!1}={}){if(e&&e.focus){const t=document.activeElement;e.focus({preventScroll:!0}),e!==t&&mY(e)&&n&&e.select()}}const hP=yY();function yY(){let e=[];return{add(n){const t=e[0];n!==t&&(t==null||t.pause()),e=fP(e,n),e.unshift(n)},remove(n){var t;e=fP(e,n),(t=e[0])===null||t===void 0||t.resume()}}}function fP(e,n){const t=[...e],r=t.indexOf(n);return r!==-1&&t.splice(r,1),t}function vY(e){return e.filter(n=>n.tagName!=="A")}const dw=w.forwardRef((e,n)=>{var t;const{container:r=globalThis==null||(t=globalThis.document)===null||t===void 0?void 0:t.body,...o}=e;return r?bC.createPortal(w.createElement(Oe.div,W({},o,{ref:n})),r):null});function wY(e,n){return w.useReducer((t,r)=>{const o=n[t][r];return o??t},e)}const Bo=e=>{const{present:n,children:t}=e,r=xY(n),o=typeof t=="function"?t({present:r.isPresent}):w.Children.only(t),s=Ze(r.ref,o.ref);return typeof t=="function"||r.isPresent?w.cloneElement(o,{ref:s}):null};Bo.displayName="Presence";function xY(e){const[n,t]=w.useState(),r=w.useRef({}),o=w.useRef(e),s=w.useRef("none"),i=e?"mounted":"unmounted",[a,l]=wY(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return w.useEffect(()=>{const c=$d(r.current);s.current=a==="mounted"?c:"none"},[a]),Ii(()=>{const c=r.current,u=o.current;if(u!==e){const h=s.current,f=$d(c);e?l("MOUNT"):f==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==f?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,l]),Ii(()=>{if(n){const c=d=>{const f=$d(r.current).includes(d.animationName);d.target===n&&f&&Do.flushSync(()=>l("ANIMATION_END"))},u=d=>{d.target===n&&(s.current=$d(r.current))};return n.addEventListener("animationstart",u),n.addEventListener("animationcancel",c),n.addEventListener("animationend",c),()=>{n.removeEventListener("animationstart",u),n.removeEventListener("animationcancel",c),n.removeEventListener("animationend",c)}}else l("ANIMATION_END")},[n,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:w.useCallback(c=>{c&&(r.current=getComputedStyle(c)),t(c)},[])}}function $d(e){return(e==null?void 0:e.animationName)||"none"}let _m=0;function nT(){w.useEffect(()=>{var e,n;const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(e=t[0])!==null&&e!==void 0?e:pP()),document.body.insertAdjacentElement("beforeend",(n=t[1])!==null&&n!==void 0?n:pP()),_m++,()=>{_m===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),_m--}},[])}function pP(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}var Fr=function(){return Fr=Object.assign||function(n){for(var t,r=1,o=arguments.length;r<o;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Fr.apply(this,arguments)};function rT(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(t[r[o]]=e[r[o]]);return t}function SY(e,n,t){if(t||arguments.length===2)for(var r=0,o=n.length,s;r<o;r++)(s||!(r in n))&&(s||(s=Array.prototype.slice.call(n,0,r)),s[r]=n[r]);return e.concat(s||Array.prototype.slice.call(n))}var Eh="right-scroll-bar-position",_h="width-before-scroll-bar",bY="with-scroll-bars-hidden",PY="--removed-body-scroll-bar-size";function EY(e,n){return typeof e=="function"?e(n):e&&(e.current=n),e}function _Y(e,n){var t=w.useState(function(){return{value:e,callback:n,facade:{get current(){return t.value},set current(r){var o=t.value;o!==r&&(t.value=r,t.callback(r,o))}}}})[0];return t.callback=n,t.facade}function CY(e,n){return _Y(n||null,function(t){return e.forEach(function(r){return EY(r,t)})})}function IY(e){return e}function kY(e,n){n===void 0&&(n=IY);var t=[],r=!1,o={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:e},useMedium:function(s){var i=n(s,r);return t.push(i),function(){t=t.filter(function(a){return a!==i})}},assignSyncMedium:function(s){for(r=!0;t.length;){var i=t;t=[],i.forEach(s)}t={push:function(a){return s(a)},filter:function(){return t}}},assignMedium:function(s){r=!0;var i=[];if(t.length){var a=t;t=[],a.forEach(s),i=t}var l=function(){var u=i;i=[],u.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),t={push:function(u){i.push(u),c()},filter:function(u){return i=i.filter(u),t}}}};return o}function $Y(e){e===void 0&&(e={});var n=kY(null);return n.options=Fr({async:!0,ssr:!1},e),n}var oT=function(e){var n=e.sideCar,t=rT(e,["sideCar"]);if(!n)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=n.read();if(!r)throw new Error("Sidecar medium not found");return w.createElement(r,Fr({},t))};oT.isSideCarExport=!0;function TY(e,n){return e.useMedium(n),oT}var sT=$Y(),Cm=function(){},_p=w.forwardRef(function(e,n){var t=w.useRef(null),r=w.useState({onScrollCapture:Cm,onWheelCapture:Cm,onTouchMoveCapture:Cm}),o=r[0],s=r[1],i=e.forwardProps,a=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,d=e.shards,h=e.sideCar,f=e.noIsolation,p=e.inert,m=e.allowPinchZoom,y=e.as,x=y===void 0?"div":y,S=rT(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),b=h,P=CY([t,n]),C=Fr(Fr({},S),o);return w.createElement(w.Fragment,null,u&&w.createElement(b,{sideCar:sT,removeScrollBar:c,shards:d,noIsolation:f,inert:p,setCallbacks:s,allowPinchZoom:!!m,lockRef:t}),i?w.cloneElement(w.Children.only(a),Fr(Fr({},C),{ref:P})):w.createElement(x,Fr({},C,{className:l,ref:P}),a))});_p.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};_p.classNames={fullWidth:_h,zeroRight:Eh};var gP,MY=function(){if(gP)return gP;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function AY(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var n=MY();return n&&e.setAttribute("nonce",n),e}function OY(e,n){e.styleSheet?e.styleSheet.cssText=n:e.appendChild(document.createTextNode(n))}function RY(e){var n=document.head||document.getElementsByTagName("head")[0];n.appendChild(e)}var DY=function(){var e=0,n=null;return{add:function(t){e==0&&(n=AY())&&(OY(n,t),RY(n)),e++},remove:function(){e--,!e&&n&&(n.parentNode&&n.parentNode.removeChild(n),n=null)}}},LY=function(){var e=DY();return function(n,t){w.useEffect(function(){return e.add(n),function(){e.remove()}},[n&&t])}},iT=function(){var e=LY(),n=function(t){var r=t.styles,o=t.dynamic;return e(r,o),null};return n},jY={left:0,top:0,right:0,gap:0},Im=function(e){return parseInt(e||"",10)||0},NY=function(e){var n=window.getComputedStyle(document.body),t=n[e==="padding"?"paddingLeft":"marginLeft"],r=n[e==="padding"?"paddingTop":"marginTop"],o=n[e==="padding"?"paddingRight":"marginRight"];return[Im(t),Im(r),Im(o)]},zY=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return jY;var n=NY(e),t=document.documentElement.clientWidth,r=window.innerWidth;return{left:n[0],top:n[1],right:n[2],gap:Math.max(0,r-t+n[2]-n[0])}},BY=iT(),FY=function(e,n,t,r){var o=e.left,s=e.top,i=e.right,a=e.gap;return t===void 0&&(t="margin"),`
  .`.concat(bY,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([n&&"position: relative ".concat(r,";"),t==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),t==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Eh,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(_h,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Eh," .").concat(Eh,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(_h," .").concat(_h,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body {
    `).concat(PY,": ").concat(a,`px;
  }
`)},UY=function(e){var n=e.noRelative,t=e.noImportant,r=e.gapMode,o=r===void 0?"margin":r,s=w.useMemo(function(){return zY(o)},[o]);return w.createElement(BY,{styles:FY(s,!n,o,t?"":"!important")})},z0=!1;if(typeof window<"u")try{var Td=Object.defineProperty({},"passive",{get:function(){return z0=!0,!0}});window.addEventListener("test",Td,Td),window.removeEventListener("test",Td,Td)}catch{z0=!1}var ta=z0?{passive:!1}:!1,KY=function(e){return e.tagName==="TEXTAREA"},aT=function(e,n){var t=window.getComputedStyle(e);return t[n]!=="hidden"&&!(t.overflowY===t.overflowX&&!KY(e)&&t[n]==="visible")},HY=function(e){return aT(e,"overflowY")},VY=function(e){return aT(e,"overflowX")},mP=function(e,n){var t=n;do{typeof ShadowRoot<"u"&&t instanceof ShadowRoot&&(t=t.host);var r=lT(e,t);if(r){var o=cT(e,t),s=o[1],i=o[2];if(s>i)return!0}t=t.parentNode}while(t&&t!==document.body);return!1},WY=function(e){var n=e.scrollTop,t=e.scrollHeight,r=e.clientHeight;return[n,t,r]},YY=function(e){var n=e.scrollLeft,t=e.scrollWidth,r=e.clientWidth;return[n,t,r]},lT=function(e,n){return e==="v"?HY(n):VY(n)},cT=function(e,n){return e==="v"?WY(n):YY(n)},XY=function(e,n){return e==="h"&&n==="rtl"?-1:1},GY=function(e,n,t,r,o){var s=XY(e,window.getComputedStyle(n).direction),i=s*r,a=t.target,l=n.contains(a),c=!1,u=i>0,d=0,h=0;do{var f=cT(e,a),p=f[0],m=f[1],y=f[2],x=m-y-s*p;(p||x)&&lT(e,a)&&(d+=x,h+=p),a=a.parentNode}while(!l&&a!==document.body||l&&(n.contains(a)||n===a));return(u&&(o&&d===0||!o&&i>d)||!u&&(o&&h===0||!o&&-i>h))&&(c=!0),c},Md=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},yP=function(e){return[e.deltaX,e.deltaY]},vP=function(e){return e&&"current"in e?e.current:e},qY=function(e,n){return e[0]===n[0]&&e[1]===n[1]},QY=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},ZY=0,na=[];function JY(e){var n=w.useRef([]),t=w.useRef([0,0]),r=w.useRef(),o=w.useState(ZY++)[0],s=w.useState(function(){return iT()})[0],i=w.useRef(e);w.useEffect(function(){i.current=e},[e]),w.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var m=SY([e.lockRef.current],(e.shards||[]).map(vP),!0).filter(Boolean);return m.forEach(function(y){return y.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),m.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(o))})}}},[e.inert,e.lockRef.current,e.shards]);var a=w.useCallback(function(m,y){if("touches"in m&&m.touches.length===2)return!i.current.allowPinchZoom;var x=Md(m),S=t.current,b="deltaX"in m?m.deltaX:S[0]-x[0],P="deltaY"in m?m.deltaY:S[1]-x[1],C,_=m.target,I=Math.abs(b)>Math.abs(P)?"h":"v";if("touches"in m&&I==="h"&&_.type==="range")return!1;var k=mP(I,_);if(!k)return!0;if(k?C=I:(C=I==="v"?"h":"v",k=mP(I,_)),!k)return!1;if(!r.current&&"changedTouches"in m&&(b||P)&&(r.current=C),!C)return!0;var T=r.current||C;return GY(T,y,m,T==="h"?b:P,!0)},[]),l=w.useCallback(function(m){var y=m;if(!(!na.length||na[na.length-1]!==s)){var x="deltaY"in y?yP(y):Md(y),S=n.current.filter(function(C){return C.name===y.type&&C.target===y.target&&qY(C.delta,x)})[0];if(S&&S.should){y.cancelable&&y.preventDefault();return}if(!S){var b=(i.current.shards||[]).map(vP).filter(Boolean).filter(function(C){return C.contains(y.target)}),P=b.length>0?a(y,b[0]):!i.current.noIsolation;P&&y.cancelable&&y.preventDefault()}}},[]),c=w.useCallback(function(m,y,x,S){var b={name:m,delta:y,target:x,should:S};n.current.push(b),setTimeout(function(){n.current=n.current.filter(function(P){return P!==b})},1)},[]),u=w.useCallback(function(m){t.current=Md(m),r.current=void 0},[]),d=w.useCallback(function(m){c(m.type,yP(m),m.target,a(m,e.lockRef.current))},[]),h=w.useCallback(function(m){c(m.type,Md(m),m.target,a(m,e.lockRef.current))},[]);w.useEffect(function(){return na.push(s),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,ta),document.addEventListener("touchmove",l,ta),document.addEventListener("touchstart",u,ta),function(){na=na.filter(function(m){return m!==s}),document.removeEventListener("wheel",l,ta),document.removeEventListener("touchmove",l,ta),document.removeEventListener("touchstart",u,ta)}},[]);var f=e.removeScrollBar,p=e.inert;return w.createElement(w.Fragment,null,p?w.createElement(s,{styles:QY(o)}):null,f?w.createElement(UY,{gapMode:"margin"}):null)}const eX=TY(sT,JY);var uT=w.forwardRef(function(e,n){return w.createElement(_p,Fr({},e,{ref:n,sideCar:eX}))});uT.classNames=_p.classNames;const hw=uT;var tX=function(e){if(typeof document>"u")return null;var n=Array.isArray(e)?e[0]:e;return n.ownerDocument.body},ra=new WeakMap,Ad=new WeakMap,Od={},km=0,dT=function(e){return e&&(e.host||dT(e.parentNode))},nX=function(e,n){return n.map(function(t){if(e.contains(t))return t;var r=dT(t);return r&&e.contains(r)?r:(console.error("aria-hidden",t,"in not contained inside",e,". Doing nothing"),null)}).filter(function(t){return!!t})},rX=function(e,n,t,r){var o=nX(n,Array.isArray(e)?e:[e]);Od[t]||(Od[t]=new WeakMap);var s=Od[t],i=[],a=new Set,l=new Set(o),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};o.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))u(h);else{var f=h.getAttribute(r),p=f!==null&&f!=="false",m=(ra.get(h)||0)+1,y=(s.get(h)||0)+1;ra.set(h,m),s.set(h,y),i.push(h),m===1&&p&&Ad.set(h,!0),y===1&&h.setAttribute(t,"true"),p||h.setAttribute(r,"true")}})};return u(n),a.clear(),km++,function(){i.forEach(function(d){var h=ra.get(d)-1,f=s.get(d)-1;ra.set(d,h),s.set(d,f),h||(Ad.has(d)||d.removeAttribute(r),Ad.delete(d)),f||d.removeAttribute(t)}),km--,km||(ra=new WeakMap,ra=new WeakMap,Ad=new WeakMap,Od={})}},fw=function(e,n,t){t===void 0&&(t="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),o=n||tX(e);return o?(r.push.apply(r,Array.from(o.querySelectorAll("[aria-live]"))),rX(r,o,t,"aria-hidden")):function(){return null}};const hT="Dialog",[fT,nne]=zo(hT),[oX,Fo]=fT(hT),sX=e=>{const{__scopeDialog:n,children:t,open:r,defaultOpen:o,onOpenChange:s,modal:i=!0}=e,a=w.useRef(null),l=w.useRef(null),[c=!1,u]=Li({prop:r,defaultProp:o,onChange:s});return w.createElement(oX,{scope:n,triggerRef:a,contentRef:l,contentId:bs(),titleId:bs(),descriptionId:bs(),open:c,onOpenChange:u,onOpenToggle:w.useCallback(()=>u(d=>!d),[u]),modal:i},t)},pT="DialogPortal",[iX,gT]=fT(pT,{forceMount:void 0}),aX=e=>{const{__scopeDialog:n,forceMount:t,children:r,container:o}=e,s=Fo(pT,n);return w.createElement(iX,{scope:n,forceMount:t},w.Children.map(r,i=>w.createElement(Bo,{present:t||s.open},w.createElement(dw,{asChild:!0,container:o},i))))},B0="DialogOverlay",lX=w.forwardRef((e,n)=>{const t=gT(B0,e.__scopeDialog),{forceMount:r=t.forceMount,...o}=e,s=Fo(B0,e.__scopeDialog);return s.modal?w.createElement(Bo,{present:r||s.open},w.createElement(cX,W({},o,{ref:n}))):null}),cX=w.forwardRef((e,n)=>{const{__scopeDialog:t,...r}=e,o=Fo(B0,t);return w.createElement(hw,{as:Ga,allowPinchZoom:!0,shards:[o.contentRef]},w.createElement(Oe.div,W({"data-state":yT(o.open)},r,{ref:n,style:{pointerEvents:"auto",...r.style}})))}),Qc="DialogContent",uX=w.forwardRef((e,n)=>{const t=gT(Qc,e.__scopeDialog),{forceMount:r=t.forceMount,...o}=e,s=Fo(Qc,e.__scopeDialog);return w.createElement(Bo,{present:r||s.open},s.modal?w.createElement(dX,W({},o,{ref:n})):w.createElement(hX,W({},o,{ref:n})))}),dX=w.forwardRef((e,n)=>{const t=Fo(Qc,e.__scopeDialog),r=w.useRef(null),o=Ze(n,t.contentRef,r);return w.useEffect(()=>{const s=r.current;if(s)return fw(s)},[]),w.createElement(mT,W({},e,{ref:o,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ie(e.onCloseAutoFocus,s=>{var i;s.preventDefault(),(i=t.triggerRef.current)===null||i===void 0||i.focus()}),onPointerDownOutside:ie(e.onPointerDownOutside,s=>{const i=s.detail.originalEvent,a=i.button===0&&i.ctrlKey===!0;(i.button===2||a)&&s.preventDefault()}),onFocusOutside:ie(e.onFocusOutside,s=>s.preventDefault())}))}),hX=w.forwardRef((e,n)=>{const t=Fo(Qc,e.__scopeDialog),r=w.useRef(!1),o=w.useRef(!1);return w.createElement(mT,W({},e,{ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var i;if((i=e.onCloseAutoFocus)===null||i===void 0||i.call(e,s),!s.defaultPrevented){var a;r.current||(a=t.triggerRef.current)===null||a===void 0||a.focus(),s.preventDefault()}r.current=!1,o.current=!1},onInteractOutside:s=>{var i,a;(i=e.onInteractOutside)===null||i===void 0||i.call(e,s),s.defaultPrevented||(r.current=!0,s.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const l=s.target;((a=t.triggerRef.current)===null||a===void 0?void 0:a.contains(l))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&o.current&&s.preventDefault()}}))}),mT=w.forwardRef((e,n)=>{const{__scopeDialog:t,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:s,...i}=e,a=Fo(Qc,t),l=w.useRef(null),c=Ze(n,l);return nT(),w.createElement(w.Fragment,null,w.createElement(eT,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:o,onUnmountAutoFocus:s},w.createElement(uw,W({role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":yT(a.open)},i,{ref:c,onDismiss:()=>a.onOpenChange(!1)}))),!1)}),fX="DialogTitle",pX=w.forwardRef((e,n)=>{const{__scopeDialog:t,...r}=e,o=Fo(fX,t);return w.createElement(Oe.h2,W({id:o.titleId},r,{ref:n}))}),gX="DialogClose",mX=w.forwardRef((e,n)=>{const{__scopeDialog:t,...r}=e,o=Fo(gX,t);return w.createElement(Oe.button,W({type:"button"},r,{ref:n,onClick:ie(e.onClick,()=>o.onOpenChange(!1))}))});function yT(e){return e?"open":"closed"}const yX=sX,vX=aX,wX=lX,xX=uX,vT=w.createContext(null);function SX({assetUrls:e,children:n}){return g.jsx(vT.Provider,{value:e,children:n})}function pw(){const e=w.useContext(vT);if(!e)throw new Error("useAssetUrls must be used within an AssetUrlsProvider");return e}const F0={"action.convert-to-bookmark":"Convert to Bookmark","action.convert-to-embed":"Convert to Embed","action.open-embed-link":"Open link","action.align-bottom":"Align bottom","action.align-center-horizontal":"Align horizontally","action.align-center-vertical":"Align vertically","action.align-center-horizontal.short":"Align H","action.align-center-vertical.short":"Align V","action.align-left":"Align left","action.align-right":"Align right","action.align-top":"Align top","action.back-to-content":"Back to content","action.bring-forward":"Bring forward","action.bring-to-front":"Bring to front","action.copy-as-json.short":"JSON","action.copy-as-json":"Copy as JSON","action.copy-as-png.short":"PNG","action.copy-as-png":"Copy as PNG","action.copy-as-svg.short":"SVG","action.copy-as-svg":"Copy as SVG","action.copy":"Copy","action.cut":"Cut","action.delete":"Delete","action.distribute-horizontal":"Distribute horizontally","action.distribute-vertical":"Distribute vertically","action.distribute-horizontal.short":"Distribute H","action.distribute-vertical.short":"Distribute V","action.duplicate":"Duplicate","action.edit-link":"Edit link","action.exit-pen-mode":"Exit pen mode","action.export-as-json.short":"JSON","action.export-as-json":"Export as JSON","action.export-as-png.short":"PNG","action.export-as-png":"Export as PNG","action.export-as-svg.short":"SVG","action.export-as-svg":"Export as SVG","action.flip-horizontal":"Flip horizontally","action.flip-vertical":"Flip vertically","action.flip-horizontal.short":"Flip H","action.flip-vertical.short":"Flip V","action.fork-project":"Fork this project","action.group":"Group","action.insert-embed":"Insert embed","action.insert-media":"Upload media","action.leave-shared-project":"Leave shared project","action.new-project":"New project","action.new-shared-project":"New shared project","action.open-cursor-chat":"Cursor chat","action.open-file":"Open file","action.pack":"Pack","action.paste":"Paste","action.print":"Print","action.redo":"Redo","action.rotate-ccw":"Rotate counterclockwise","action.rotate-cw":"Rotate clockwise","action.save-copy":"Save a copy","action.select-all":"Select all","action.select-none":"Select none","action.send-backward":"Send backward","action.send-to-back":"Send to back","action.share-project":"Share this project","action.stack-horizontal":"Stack horizontally","action.stack-vertical":"Stack vertically","action.stack-horizontal.short":"Stack H","action.stack-vertical.short":"Stack V","action.stop-following":"Stop following","action.stretch-horizontal":"Stretch horizontally","action.stretch-vertical":"Stretch vertically","action.stretch-horizontal.short":"Stretch H","action.stretch-vertical.short":"Stretch V","action.toggle-auto-size":"Toggle auto size","action.toggle-dark-mode.menu":"Dark mode","action.toggle-dark-mode":"Toggle dark mode","action.toggle-reduce-motion.menu":"Reduce motion","action.toggle-reduce-motion":"Toggle reduce motion","action.toggle-debug-mode.menu":"Debug mode","action.toggle-debug-mode":"Toggle debug mode","action.toggle-focus-mode.menu":"Focus mode","action.toggle-focus-mode":"Toggle focus mode","action.toggle-grid.menu":"Show grid","action.toggle-grid":"Toggle grid","action.toggle-lock":"Toggle locked","action.toggle-snap-mode.menu":"Always snap","action.toggle-snap-mode":"Toggle always snap","action.toggle-tool-lock.menu":"Tool lock","action.toggle-tool-lock":"Toggle tool lock","action.toggle-transparent.context-menu":"Transparent","action.toggle-transparent.menu":"Transparent","action.toggle-transparent":"Toggle transparent background","action.undo":"Undo","action.ungroup":"Ungroup","action.zoom-in":"Zoom in","action.zoom-out":"Zoom out","action.zoom-to-100":"Zoom to 100%","action.zoom-to-fit":"Zoom to fit","action.zoom-to-selection":"Zoom to selection","color-style.black":"Black","color-style.blue":"Blue","color-style.green":"Green","color-style.grey":"Grey","color-style.light-blue":"Light blue","color-style.light-green":"Light green","color-style.light-red":"Light red","color-style.light-violet":"Light violet","color-style.orange":"Orange","color-style.red":"Red","color-style.violet":"Violet","color-style.yellow":"Yellow","fill-style.none":"None","fill-style.semi":"Semi","fill-style.solid":"Solid","fill-style.pattern":"Pattern","dash-style.dashed":"Dashed","dash-style.dotted":"Dotted","dash-style.draw":"Draw","dash-style.solid":"Solid","size-style.s":"Small","size-style.m":"Medium","size-style.l":"Large","size-style.xl":"Extra large","opacity-style.0.1":"10%","opacity-style.0.25":"25%","opacity-style.0.5":"50%","opacity-style.0.75":"75%","opacity-style.1":"100%","font-style.draw":"Draw","font-style.sans":"Sans","font-style.serif":"Serif","font-style.mono":"Mono","align-style.start":"Start","align-style.middle":"Middle","align-style.end":"End","align-style.justify":"Justify","geo-style.arrow-down":"Arrow down","geo-style.arrow-left":"Arrow left","geo-style.arrow-right":"Arrow right","geo-style.arrow-up":"Arrow up","geo-style.diamond":"Diamond","geo-style.ellipse":"Ellipse","geo-style.hexagon":"Hexagon","geo-style.octagon":"Octagon","geo-style.oval":"Oval","geo-style.pentagon":"Pentagon","geo-style.rectangle":"Rectangle","geo-style.rhombus-2":"Rhombus 2","geo-style.rhombus":"Rhombus","geo-style.star":"Star","geo-style.trapezoid":"Trapezoid","geo-style.triangle":"Triangle","geo-style.x-box":"X box","geo-style.check-box":"Check box","arrowheadStart-style.none":"None","arrowheadStart-style.arrow":"Arrow","arrowheadStart-style.bar":"Bar","arrowheadStart-style.diamond":"Diamond","arrowheadStart-style.dot":"Dot","arrowheadStart-style.inverted":"Inverted","arrowheadStart-style.pipe":"Pipe","arrowheadStart-style.square":"Square","arrowheadStart-style.triangle":"Triangle","arrowheadEnd-style.none":"None","arrowheadEnd-style.arrow":"Arrow","arrowheadEnd-style.bar":"Bar","arrowheadEnd-style.diamond":"Diamond","arrowheadEnd-style.dot":"Dot","arrowheadEnd-style.inverted":"Inverted","arrowheadEnd-style.pipe":"Pipe","arrowheadEnd-style.square":"Square","arrowheadEnd-style.triangle":"Triangle","spline-style.line":"Line","spline-style.cubic":"Cubic","tool.select":"Select","tool.hand":"Hand","tool.draw":"Draw","tool.eraser":"Eraser","tool.arrow-down":"Arrow down","tool.arrow-left":"Arrow left","tool.arrow-right":"Arrow right","tool.arrow-up":"Arrow up","tool.arrow":"Arrow","tool.diamond":"Diamond","tool.ellipse":"Ellipse","tool.hexagon":"Hexagon","tool.highlight":"Highlight","tool.line":"Line","tool.octagon":"Octagon","tool.oval":"Oval","tool.pentagon":"Pentagon","tool.rectangle":"Rectangle","tool.rhombus":"Rhombus","tool.star":"Star","tool.trapezoid":"Trapezoid","tool.triangle":"Triangle","tool.x-box":"X box","tool.check-box":"Check box","tool.asset":"Asset","tool.frame":"Frame","tool.note":"Note","tool.laser":"Laser","tool.embed":"Embed","tool.text":"Text","menu.title":"Menu","menu.copy-as":"Copy as","menu.edit":"Edit","menu.export-as":"Export as","menu.file":"File","menu.language":"Language","menu.preferences":"Preferences","menu.view":"View","context-menu.arrange":"Arrange","context-menu.copy-as":"Copy as","context-menu.export-as":"Export as","context-menu.move-to-page":"Move to page","context-menu.reorder":"Reorder","page-menu.title":"Pages","page-menu.create-new-page":"Create new page","page-menu.max-page-count-reached":"Max pages reached","page-menu.new-page-initial-name":"Page 1","page-menu.edit-start":"Edit","page-menu.edit-done":"Done","page-menu.go-to-page":"Go to page","page-menu.submenu.rename":"Rename","page-menu.submenu.duplicate-page":"Duplicate","page-menu.submenu.title":"Menu","page-menu.submenu.move-down":"Move down","page-menu.submenu.move-up":"Move up","page-menu.submenu.delete":"Delete","share-menu.title":"Share","share-menu.save-note":"Download this project to your computer as a .tldr file.","share-menu.fork-note":"Create a new shared project based on this snapshot.","share-menu.share-project":"Share this project","share-menu.default-project-name":"Shared Project","share-menu.copy-link":"Copy share link","share-menu.readonly-link":"Read-only","share-menu.create-snapshot-link":"Copy snapshot link","share-menu.snapshot-link-note":"Capture and share this project as a read-only snapshot link.","share-menu.copy-readonly-link":"Copy read-only link","share-menu.offline-note":"Create a new shared project based on your current project.","share-menu.copy-link-note":"Anyone with the link will be able to view and edit this project.","share-menu.copy-readonly-link-note":"Anyone with the link will be able to view (but not edit) this project.","share-menu.project-too-large":"Sorry, this project can't be shared because it's too large. We're working on it!","share-menu.upload-failed":"Sorry, we couldn't upload your project at the moment. Please try again or let us know if the problem persists.","people-menu.title":"People","people-menu.change-name":"Change name","people-menu.change-color":"Change color","people-menu.follow":"Following","people-menu.following":"Following","people-menu.leading":"Following You","people-menu.user":"(You)","people-menu.invite":"Invite others","help-menu.title":"Help and resources","help-menu.about":"About","help-menu.discord":"Discord","help-menu.github":"GitHub","help-menu.keyboard-shortcuts":"Keyboard shortcuts","help-menu.twitter":"Twitter","actions-menu.title":"Actions","edit-link-dialog.title":"Edit link","edit-link-dialog.invalid-url":"A link must be a valid URL.","edit-link-dialog.detail":"Links will open in a new tab.","edit-link-dialog.url":"URL","edit-link-dialog.clear":"Clear","edit-link-dialog.save":"Continue","edit-link-dialog.cancel":"Cancel","embed-dialog.title":"Insert embed","embed-dialog.back":"Back","embed-dialog.create":"Create","embed-dialog.cancel":"Cancel","embed-dialog.url":"URL","embed-dialog.instruction":"Paste in the site's URL to create the embed.","embed-dialog.invalid-url":"We could not create an embed from that URL.","edit-pages-dialog.move-down":"Move down","edit-pages-dialog.move-up":"Move up","shortcuts-dialog.title":"Keyboard shortcuts","shortcuts-dialog.edit":"Edit","shortcuts-dialog.file":"File","shortcuts-dialog.preferences":"Preferences","shortcuts-dialog.tools":"Tools","shortcuts-dialog.transform":"Transform","shortcuts-dialog.view":"View","shortcuts-dialog.collaboration":"Collaboration","home-project-dialog.title":"Home project","home-project-dialog.description":"This is your local home project. It's just for you!","rename-project-dialog.title":"Rename project","rename-project-dialog.cancel":"Cancel","rename-project-dialog.rename":"Rename","home-project-dialog.ok":"Ok","style-panel.title":"Styles","style-panel.align":"Align","style-panel.vertical-align":"Vertical align","style-panel.position":"Position","style-panel.arrowheads":"Arrowheads","style-panel.arrowhead-start":"Start","style-panel.arrowhead-end":"End","style-panel.color":"Color","style-panel.dash":"Dash","style-panel.fill":"Fill","style-panel.font":"Font","style-panel.geo":"Shape","style-panel.mixed":"Mixed","style-panel.opacity":"Opacity","style-panel.size":"Size","style-panel.spline":"Spline","tool-panel.drawing":"Drawing","tool-panel.shapes":"Shapes","tool-panel.more":"More","debug-panel.more":"More","navigation-zone.toggle-minimap":"Toggle minimap","navigation-zone.zoom":"Zoom","focus-mode.toggle-focus-mode":"Toggle focus mode","toast.close":"Close","file-system.file-open-error.title":"Could not open file","file-system.file-open-error.not-a-tldraw-file":"The file you tried to open doesn't look like a tldraw file.","file-system.file-open-error.file-format-version-too-new":"The file you tried to open is from a newer version of tldraw. Please reload the page and try again.","file-system.file-open-error.generic-corrupted-file":"The file you tried to open is corrupted.","file-system.confirm-open.title":"Overwrite current project?","file-system.confirm-open.description":"Opening a file will replace your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-open.cancel":"Cancel","file-system.confirm-open.open":"Open file","file-system.confirm-open.dont-show-again":"Don't ask again","file-system.confirm-clear.title":"Clear current project?","file-system.confirm-clear.description":"Creating a new project will clear your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-clear.cancel":"Cancel","file-system.confirm-clear.continue":"Continue","file-system.confirm-clear.dont-show-again":"Don't ask again","file-system.shared-document-file-open-error.title":"Could not open file","file-system.shared-document-file-open-error.description":"Opening files from shared projects is not supported.","sharing.confirm-leave.title":"Leave current project?","sharing.confirm-leave.description":"Are you sure you want to leave this shared project? You can return to it by navigating to its URL.","sharing.confirm-leave.cancel":"Cancel","sharing.confirm-leave.leave":"Leave","sharing.confirm-leave.dont-show-again":"Don't ask again","toast.error.export-fail.title":"Failed export","toast.error.export-fail.desc":"Failed to export image","toast.error.copy-fail.title":"Failed copy","toast.error.copy-fail.desc":"Failed to copy image","context.pages.new-page":"New page","vscode.file-open.desc":"We've updated this document to work with the current version of tldraw. If you'd like to keep the original version (which will work on old.tldraw.com), click below to create a backup.","vscode.file-open.open":"Continue","vscode.file-open.backup":"Backup","vscode.file-open.backup-saved":"Backup saved","vscode.file-open.backup-failed":"Backup failed: this is not a .tldr file.","vscode.file-open.dont-show-again":"Don't ask again","cursor-chat.type-to-chat":"Type to chat..."},oa={locale:"en",label:"English",messages:F0};async function bX(e,n){if(!(await fetch(n.translations.en)).ok)return console.warn("No main translations found."),oa;if(e==="en")return oa;const r=zc.find(a=>a.locale===e);if(!r)return console.warn(`No translation found for locale ${e}`),oa;const s=await(await fetch(n.translations[r.locale])).json();if(!s)return console.warn(`No messages found for locale ${e}`),oa;const i=[];for(const a in oa)s[a]||i.push(a);return i.length>0,{locale:e,label:r.label,messages:{...oa.messages,...s}}}const wT=w.createContext({}),PX=()=>w.useContext(wT),EX=me(function({overrides:n,children:t}){const o=U().locale,s=pw(),[i,a]=w.useState(()=>n&&n.en?{locale:"en",label:"English",messages:{...F0,...n.en}}:{locale:"en",label:"English",messages:F0});return w.useEffect(()=>{let l=!1;async function c(){const u=await bX(o,s);u&&!l&&(n&&n[o]?a({...u,messages:{...u.messages,...n[o]}}):a(u))}return c(),()=>{l=!0}},[s,o,n]),g.jsx(wT.Provider,{value:i,children:t})});function we(){const e=PX();return w.useCallback(function(t){return e.messages[t]??t},[e])}function _X(e){return g.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",...e,children:g.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[g.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),g.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:g.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}const vn=w.memo(function({small:n,invertIcon:t,icon:r,color:o,className:s,...i}){const l=pw().icons[r],c=w.useRef(null);return w.useLayoutEffect(()=>{c!=null&&c.current&&(c.current.style.webkitMask=`url(${l}) center 100% / 100% no-repeat`)},[c,l]),g.jsx("div",{...i,ref:c,className:de("tlui-icon",{"tlui-icon__small":n},s),style:{color:o,mask:`url(${l}) center 100% / 100% no-repeat`,transform:t?"scale(-1, 1)":void 0}})}),xT=typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("mac")>-1,ST=xT?"":"Ctrl",bT=xT?"":"Alt";function CX(e){return e.split(",")[0].split("").map(n=>{const t=n.replace(/\$/g,ST).replace(/\?/g,bT).replace(/!/g,"");return t[0].toUpperCase()+t.slice(1)})}function qr(e){return" "+e.split(",")[0].split("").map(n=>{const t=n.replace(/\$/g,ST).replace(/\?/g,bT).replace(/!/g,"");return t[0].toUpperCase()+t.slice(1)}).join("")}function Cp({children:e}){return g.jsx("kbd",{className:"tlui-kbd",children:CX(e).map((n,t)=>g.jsx("span",{children:n},t))})}const se=w.forwardRef(function({label:n,icon:t,invertIcon:r,iconLeft:o,smallIcon:s,kbd:i,isChecked:a=!1,type:l="normal",children:c,spinner:u,...d},h){const f=we(),p=n?f(n):"";return g.jsxs("button",{ref:h,draggable:!1,type:"button",...d,title:d.title??p,className:de("tlui-button",`tlui-button__${l}`,d.className),children:[o&&g.jsx(vn,{icon:o,className:"tlui-icon-left",small:!0}),c,n&&g.jsxs("span",{draggable:!1,children:[p,a&&g.jsx(vn,{icon:"check"})]}),i&&g.jsx(Cp,{children:i}),t&&!u&&g.jsx(vn,{icon:t,small:!!n||s,invertIcon:r}),u&&g.jsx(_X,{})]})});function Ip({className:e,children:n}){return g.jsx("div",{className:de("tlui-dialog__header",e),children:n})}function kp({className:e,children:n}){return g.jsx(pX,{dir:"ltr",className:de("tlui-dialog__header__title",e),children:n})}function $p(){return g.jsx("div",{className:"tlui-dialog__header__close",children:g.jsx(mX,{"data-testid":"dialog.close",dir:"ltr",asChild:!0,children:g.jsx(se,{"aria-label":"Close",onTouchEnd:e=>e.target.click(),children:g.jsx(vn,{small:!0,icon:"cross-2"})})})})}function Zc({className:e,children:n,style:t}){return g.jsx("div",{className:de("tlui-dialog__body",e),style:t,children:n})}function gw({className:e,children:n}){return g.jsx("div",{className:de("tlui-dialog__footer",e),children:n})}function Tp(e){const n=e+"CollectionProvider",[t,r]=zo(n),[o,s]=t(n,{collectionRef:{current:null},itemMap:new Map}),i=f=>{const{scope:p,children:m}=f,y=oe.useRef(null),x=oe.useRef(new Map).current;return oe.createElement(o,{scope:p,itemMap:x,collectionRef:y},m)},a=e+"CollectionSlot",l=oe.forwardRef((f,p)=>{const{scope:m,children:y}=f,x=s(a,m),S=Ze(p,x.collectionRef);return oe.createElement(Ga,{ref:S},y)}),c=e+"CollectionItemSlot",u="data-radix-collection-item",d=oe.forwardRef((f,p)=>{const{scope:m,children:y,...x}=f,S=oe.useRef(null),b=Ze(p,S),P=s(c,m);return oe.useEffect(()=>(P.itemMap.set(S,{ref:S,...x}),()=>void P.itemMap.delete(S))),oe.createElement(Ga,{[u]:"",ref:b},y)});function h(f){const p=s(e+"CollectionConsumer",f);return oe.useCallback(()=>{const y=p.collectionRef.current;if(!y)return[];const x=Array.from(y.querySelectorAll(`[${u}]`));return Array.from(p.itemMap.values()).sort((P,C)=>x.indexOf(P.ref.current)-x.indexOf(C.ref.current))},[p.collectionRef,p.itemMap])}return[{Provider:i,Slot:l,ItemSlot:d},h,r]}const IX=w.createContext(void 0);function mw(e){const n=w.useContext(IX);return e||n||"ltr"}const kX=["top","right","bottom","left"],ks=Math.min,$n=Math.max,Cf=Math.round,Rd=Math.floor,$s=e=>({x:e,y:e}),$X={left:"right",right:"left",bottom:"top",top:"bottom"},TX={start:"end",end:"start"};function U0(e,n,t){return $n(e,ks(n,t))}function Mo(e,n){return typeof e=="function"?e(n):e}function Ao(e){return e.split("-")[0]}function ul(e){return e.split("-")[1]}function yw(e){return e==="x"?"y":"x"}function vw(e){return e==="y"?"height":"width"}function dl(e){return["top","bottom"].includes(Ao(e))?"y":"x"}function ww(e){return yw(dl(e))}function MX(e,n,t){t===void 0&&(t=!1);const r=ul(e),o=ww(e),s=vw(o);let i=o==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return n.reference[s]>n.floating[s]&&(i=If(i)),[i,If(i)]}function AX(e){const n=If(e);return[K0(e),n,K0(n)]}function K0(e){return e.replace(/start|end/g,n=>TX[n])}function OX(e,n,t){const r=["left","right"],o=["right","left"],s=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return t?n?o:r:n?r:o;case"left":case"right":return n?s:i;default:return[]}}function RX(e,n,t,r){const o=ul(e);let s=OX(Ao(e),t==="start",r);return o&&(s=s.map(i=>i+"-"+o),n&&(s=s.concat(s.map(K0)))),s}function If(e){return e.replace(/left|right|bottom|top/g,n=>$X[n])}function DX(e){return{top:0,right:0,bottom:0,left:0,...e}}function PT(e){return typeof e!="number"?DX(e):{top:e,right:e,bottom:e,left:e}}function kf(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function wP(e,n,t){let{reference:r,floating:o}=e;const s=dl(n),i=ww(n),a=vw(i),l=Ao(n),c=s==="y",u=r.x+r.width/2-o.width/2,d=r.y+r.height/2-o.height/2,h=r[a]/2-o[a]/2;let f;switch(l){case"top":f={x:u,y:r.y-o.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-o.width,y:d};break;default:f={x:r.x,y:r.y}}switch(ul(n)){case"start":f[i]-=h*(t&&c?-1:1);break;case"end":f[i]+=h*(t&&c?-1:1);break}return f}const LX=async(e,n,t)=>{const{placement:r="bottom",strategy:o="absolute",middleware:s=[],platform:i}=t,a=s.filter(Boolean),l=await(i.isRTL==null?void 0:i.isRTL(n));let c=await i.getElementRects({reference:e,floating:n,strategy:o}),{x:u,y:d}=wP(c,r,l),h=r,f={},p=0;for(let m=0;m<a.length;m++){const{name:y,fn:x}=a[m],{x:S,y:b,data:P,reset:C}=await x({x:u,y:d,initialPlacement:r,placement:h,strategy:o,middlewareData:f,rects:c,platform:i,elements:{reference:e,floating:n}});if(u=S??u,d=b??d,f={...f,[y]:{...f[y],...P}},C&&p<=50){p++,typeof C=="object"&&(C.placement&&(h=C.placement),C.rects&&(c=C.rects===!0?await i.getElementRects({reference:e,floating:n,strategy:o}):C.rects),{x:u,y:d}=wP(c,h,l)),m=-1;continue}}return{x:u,y:d,placement:h,strategy:o,middlewareData:f}};async function Jc(e,n){var t;n===void 0&&(n={});const{x:r,y:o,platform:s,rects:i,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=Mo(n,e),p=PT(f),y=a[h?d==="floating"?"reference":"floating":d],x=kf(await s.getClippingRect({element:(t=await(s.isElement==null?void 0:s.isElement(y)))==null||t?y:y.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),S=d==="floating"?{...i.floating,x:r,y:o}:i.reference,b=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),P=await(s.isElement==null?void 0:s.isElement(b))?await(s.getScale==null?void 0:s.getScale(b))||{x:1,y:1}:{x:1,y:1},C=kf(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:S,offsetParent:b,strategy:l}):S);return{top:(x.top-C.top+p.top)/P.y,bottom:(C.bottom-x.bottom+p.bottom)/P.y,left:(x.left-C.left+p.left)/P.x,right:(C.right-x.right+p.right)/P.x}}const xP=e=>({name:"arrow",options:e,async fn(n){const{x:t,y:r,placement:o,rects:s,platform:i,elements:a}=n,{element:l,padding:c=0}=Mo(e,n)||{};if(l==null)return{};const u=PT(c),d={x:t,y:r},h=ww(o),f=vw(h),p=await i.getDimensions(l),m=h==="y",y=m?"top":"left",x=m?"bottom":"right",S=m?"clientHeight":"clientWidth",b=s.reference[f]+s.reference[h]-d[h]-s.floating[f],P=d[h]-s.reference[h],C=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l));let _=C?C[S]:0;(!_||!await(i.isElement==null?void 0:i.isElement(C)))&&(_=a.floating[S]||s.floating[f]);const I=b/2-P/2,k=_/2-p[f]/2-1,T=ks(u[y],k),M=ks(u[x],k),O=T,z=_-p[f]-M,B=_/2-p[f]/2+I,D=U0(O,B,z),V=ul(o)!=null&&B!=D&&s.reference[f]/2-(B<O?T:M)-p[f]/2<0?B<O?O-B:z-B:0;return{[h]:d[h]-V,data:{[h]:D,centerOffset:B-D+V}}}}),jX=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(n){var t;const{placement:r,middlewareData:o,rects:s,initialPlacement:i,platform:a,elements:l}=n,{mainAxis:c=!0,crossAxis:u=!0,fallbackPlacements:d,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:p=!0,...m}=Mo(e,n),y=Ao(r),x=Ao(i)===i,S=await(a.isRTL==null?void 0:a.isRTL(l.floating)),b=d||(x||!p?[If(i)]:AX(i));!d&&f!=="none"&&b.push(...RX(i,p,f,S));const P=[i,...b],C=await Jc(n,m),_=[];let I=((t=o.flip)==null?void 0:t.overflows)||[];if(c&&_.push(C[y]),u){const O=MX(r,s,S);_.push(C[O[0]],C[O[1]])}if(I=[...I,{placement:r,overflows:_}],!_.every(O=>O<=0)){var k,T;const O=(((k=o.flip)==null?void 0:k.index)||0)+1,z=P[O];if(z)return{data:{index:O,overflows:I},reset:{placement:z}};let B=(T=I.filter(D=>D.overflows[0]<=0).sort((D,F)=>D.overflows[1]-F.overflows[1])[0])==null?void 0:T.placement;if(!B)switch(h){case"bestFit":{var M;const D=(M=I.map(F=>[F.placement,F.overflows.filter(V=>V>0).reduce((V,q)=>V+q,0)]).sort((F,V)=>F[1]-V[1])[0])==null?void 0:M[0];D&&(B=D);break}case"initialPlacement":B=i;break}if(r!==B)return{reset:{placement:B}}}return{}}}};function SP(e,n){return{top:e.top-n.height,right:e.right-n.width,bottom:e.bottom-n.height,left:e.left-n.width}}function bP(e){return kX.some(n=>e[n]>=0)}const NX=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(n){const{rects:t}=n,{strategy:r="referenceHidden",...o}=Mo(e,n);switch(r){case"referenceHidden":{const s=await Jc(n,{...o,elementContext:"reference"}),i=SP(s,t.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:bP(i)}}}case"escaped":{const s=await Jc(n,{...o,altBoundary:!0}),i=SP(s,t.floating);return{data:{escapedOffsets:i,escaped:bP(i)}}}default:return{}}}}};async function zX(e,n){const{placement:t,platform:r,elements:o}=e,s=await(r.isRTL==null?void 0:r.isRTL(o.floating)),i=Ao(t),a=ul(t),l=dl(t)==="y",c=["left","top"].includes(i)?-1:1,u=s&&l?-1:1,d=Mo(n,e);let{mainAxis:h,crossAxis:f,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),l?{x:f*u,y:h*c}:{x:h*c,y:f*u}}const BX=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(n){const{x:t,y:r}=n,o=await zX(n,e);return{x:t+o.x,y:r+o.y,data:o}}}},FX=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(n){const{x:t,y:r,placement:o}=n,{mainAxis:s=!0,crossAxis:i=!1,limiter:a={fn:y=>{let{x,y:S}=y;return{x,y:S}}},...l}=Mo(e,n),c={x:t,y:r},u=await Jc(n,l),d=dl(Ao(o)),h=yw(d);let f=c[h],p=c[d];if(s){const y=h==="y"?"top":"left",x=h==="y"?"bottom":"right",S=f+u[y],b=f-u[x];f=U0(S,f,b)}if(i){const y=d==="y"?"top":"left",x=d==="y"?"bottom":"right",S=p+u[y],b=p-u[x];p=U0(S,p,b)}const m=a.fn({...n,[h]:f,[d]:p});return{...m,data:{x:m.x-t,y:m.y-r}}}}},UX=function(e){return e===void 0&&(e={}),{options:e,fn(n){const{x:t,y:r,placement:o,rects:s,middlewareData:i}=n,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=Mo(e,n),u={x:t,y:r},d=dl(o),h=yw(d);let f=u[h],p=u[d];const m=Mo(a,n),y=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const b=h==="y"?"height":"width",P=s.reference[h]-s.floating[b]+y.mainAxis,C=s.reference[h]+s.reference[b]-y.mainAxis;f<P?f=P:f>C&&(f=C)}if(c){var x,S;const b=h==="y"?"width":"height",P=["top","left"].includes(Ao(o)),C=s.reference[d]-s.floating[b]+(P&&((x=i.offset)==null?void 0:x[d])||0)+(P?0:y.crossAxis),_=s.reference[d]+s.reference[b]+(P?0:((S=i.offset)==null?void 0:S[d])||0)-(P?y.crossAxis:0);p<C?p=C:p>_&&(p=_)}return{[h]:f,[d]:p}}}},KX=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(n){const{placement:t,rects:r,platform:o,elements:s}=n,{apply:i=()=>{},...a}=Mo(e,n),l=await Jc(n,a),c=Ao(t),u=ul(t),d=dl(t)==="y",{width:h,height:f}=r.floating;let p,m;c==="top"||c==="bottom"?(p=c,m=u===(await(o.isRTL==null?void 0:o.isRTL(s.floating))?"start":"end")?"left":"right"):(m=c,p=u==="end"?"top":"bottom");const y=f-l[p],x=h-l[m],S=!n.middlewareData.shift;let b=y,P=x;if(d){const _=h-l.left-l.right;P=u||S?ks(x,_):_}else{const _=f-l.top-l.bottom;b=u||S?ks(y,_):_}if(S&&!u){const _=$n(l.left,0),I=$n(l.right,0),k=$n(l.top,0),T=$n(l.bottom,0);d?P=h-2*(_!==0||I!==0?_+I:$n(l.left,l.right)):b=f-2*(k!==0||T!==0?k+T:$n(l.top,l.bottom))}await i({...n,availableWidth:P,availableHeight:b});const C=await o.getDimensions(s.floating);return h!==C.width||f!==C.height?{reset:{rects:!0}}:{}}}};function Ts(e){return ET(e)?(e.nodeName||"").toLowerCase():"#document"}function Dn(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function Uo(e){var n;return(n=(ET(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function ET(e){return e instanceof Node||e instanceof Dn(e).Node}function Oo(e){return e instanceof Element||e instanceof Dn(e).Element}function Qr(e){return e instanceof HTMLElement||e instanceof Dn(e).HTMLElement}function PP(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Dn(e).ShadowRoot}function ku(e){const{overflow:n,overflowX:t,overflowY:r,display:o}=ir(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!["inline","contents"].includes(o)}function HX(e){return["table","td","th"].includes(Ts(e))}function xw(e){const n=Sw(),t=ir(e);return t.transform!=="none"||t.perspective!=="none"||(t.containerType?t.containerType!=="normal":!1)||!n&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!n&&(t.filter?t.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function VX(e){let n=qa(e);for(;Qr(n)&&!Mp(n);){if(xw(n))return n;n=qa(n)}return null}function Sw(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Mp(e){return["html","body","#document"].includes(Ts(e))}function ir(e){return Dn(e).getComputedStyle(e)}function Ap(e){return Oo(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function qa(e){if(Ts(e)==="html")return e;const n=e.assignedSlot||e.parentNode||PP(e)&&e.host||Uo(e);return PP(n)?n.host:n}function _T(e){const n=qa(e);return Mp(n)?e.ownerDocument?e.ownerDocument.body:e.body:Qr(n)&&ku(n)?n:_T(n)}function $f(e,n){var t;n===void 0&&(n=[]);const r=_T(e),o=r===((t=e.ownerDocument)==null?void 0:t.body),s=Dn(r);return o?n.concat(s,s.visualViewport||[],ku(r)?r:[]):n.concat(r,$f(r))}function CT(e){const n=ir(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const o=Qr(e),s=o?e.offsetWidth:t,i=o?e.offsetHeight:r,a=Cf(t)!==s||Cf(r)!==i;return a&&(t=s,r=i),{width:t,height:r,$:a}}function bw(e){return Oo(e)?e:e.contextElement}function La(e){const n=bw(e);if(!Qr(n))return $s(1);const t=n.getBoundingClientRect(),{width:r,height:o,$:s}=CT(n);let i=(s?Cf(t.width):t.width)/r,a=(s?Cf(t.height):t.height)/o;return(!i||!Number.isFinite(i))&&(i=1),(!a||!Number.isFinite(a))&&(a=1),{x:i,y:a}}const WX=$s(0);function IT(e){const n=Dn(e);return!Sw()||!n.visualViewport?WX:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function YX(e,n,t){return n===void 0&&(n=!1),!t||n&&t!==Dn(e)?!1:n}function ki(e,n,t,r){n===void 0&&(n=!1),t===void 0&&(t=!1);const o=e.getBoundingClientRect(),s=bw(e);let i=$s(1);n&&(r?Oo(r)&&(i=La(r)):i=La(e));const a=YX(s,t,r)?IT(s):$s(0);let l=(o.left+a.x)/i.x,c=(o.top+a.y)/i.y,u=o.width/i.x,d=o.height/i.y;if(s){const h=Dn(s),f=r&&Oo(r)?Dn(r):r;let p=h.frameElement;for(;p&&r&&f!==h;){const m=La(p),y=p.getBoundingClientRect(),x=ir(p),S=y.left+(p.clientLeft+parseFloat(x.paddingLeft))*m.x,b=y.top+(p.clientTop+parseFloat(x.paddingTop))*m.y;l*=m.x,c*=m.y,u*=m.x,d*=m.y,l+=S,c+=b,p=Dn(p).frameElement}}return kf({width:u,height:d,x:l,y:c})}function XX(e){let{rect:n,offsetParent:t,strategy:r}=e;const o=Qr(t),s=Uo(t);if(t===s)return n;let i={scrollLeft:0,scrollTop:0},a=$s(1);const l=$s(0);if((o||!o&&r!=="fixed")&&((Ts(t)!=="body"||ku(s))&&(i=Ap(t)),Qr(t))){const c=ki(t);a=La(t),l.x=c.x+t.clientLeft,l.y=c.y+t.clientTop}return{width:n.width*a.x,height:n.height*a.y,x:n.x*a.x-i.scrollLeft*a.x+l.x,y:n.y*a.y-i.scrollTop*a.y+l.y}}function GX(e){return Array.from(e.getClientRects())}function kT(e){return ki(Uo(e)).left+Ap(e).scrollLeft}function qX(e){const n=Uo(e),t=Ap(e),r=e.ownerDocument.body,o=$n(n.scrollWidth,n.clientWidth,r.scrollWidth,r.clientWidth),s=$n(n.scrollHeight,n.clientHeight,r.scrollHeight,r.clientHeight);let i=-t.scrollLeft+kT(e);const a=-t.scrollTop;return ir(r).direction==="rtl"&&(i+=$n(n.clientWidth,r.clientWidth)-o),{width:o,height:s,x:i,y:a}}function QX(e,n){const t=Dn(e),r=Uo(e),o=t.visualViewport;let s=r.clientWidth,i=r.clientHeight,a=0,l=0;if(o){s=o.width,i=o.height;const c=Sw();(!c||c&&n==="fixed")&&(a=o.offsetLeft,l=o.offsetTop)}return{width:s,height:i,x:a,y:l}}function ZX(e,n){const t=ki(e,!0,n==="fixed"),r=t.top+e.clientTop,o=t.left+e.clientLeft,s=Qr(e)?La(e):$s(1),i=e.clientWidth*s.x,a=e.clientHeight*s.y,l=o*s.x,c=r*s.y;return{width:i,height:a,x:l,y:c}}function EP(e,n,t){let r;if(n==="viewport")r=QX(e,t);else if(n==="document")r=qX(Uo(e));else if(Oo(n))r=ZX(n,t);else{const o=IT(e);r={...n,x:n.x-o.x,y:n.y-o.y}}return kf(r)}function $T(e,n){const t=qa(e);return t===n||!Oo(t)||Mp(t)?!1:ir(t).position==="fixed"||$T(t,n)}function JX(e,n){const t=n.get(e);if(t)return t;let r=$f(e).filter(a=>Oo(a)&&Ts(a)!=="body"),o=null;const s=ir(e).position==="fixed";let i=s?qa(e):e;for(;Oo(i)&&!Mp(i);){const a=ir(i),l=xw(i);!l&&a.position==="fixed"&&(o=null),(s?!l&&!o:!l&&a.position==="static"&&!!o&&["absolute","fixed"].includes(o.position)||ku(i)&&!l&&$T(e,i))?r=r.filter(u=>u!==i):o=a,i=qa(i)}return n.set(e,r),r}function eG(e){let{element:n,boundary:t,rootBoundary:r,strategy:o}=e;const i=[...t==="clippingAncestors"?JX(n,this._c):[].concat(t),r],a=i[0],l=i.reduce((c,u)=>{const d=EP(n,u,o);return c.top=$n(d.top,c.top),c.right=ks(d.right,c.right),c.bottom=ks(d.bottom,c.bottom),c.left=$n(d.left,c.left),c},EP(n,a,o));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function tG(e){return CT(e)}function nG(e,n,t){const r=Qr(n),o=Uo(n),s=t==="fixed",i=ki(e,!0,s,n);let a={scrollLeft:0,scrollTop:0};const l=$s(0);if(r||!r&&!s)if((Ts(n)!=="body"||ku(o))&&(a=Ap(n)),r){const c=ki(n,!0,s,n);l.x=c.x+n.clientLeft,l.y=c.y+n.clientTop}else o&&(l.x=kT(o));return{x:i.left+a.scrollLeft-l.x,y:i.top+a.scrollTop-l.y,width:i.width,height:i.height}}function _P(e,n){return!Qr(e)||ir(e).position==="fixed"?null:n?n(e):e.offsetParent}function TT(e,n){const t=Dn(e);if(!Qr(e))return t;let r=_P(e,n);for(;r&&HX(r)&&ir(r).position==="static";)r=_P(r,n);return r&&(Ts(r)==="html"||Ts(r)==="body"&&ir(r).position==="static"&&!xw(r))?t:r||VX(e)||t}const rG=async function(e){let{reference:n,floating:t,strategy:r}=e;const o=this.getOffsetParent||TT,s=this.getDimensions;return{reference:nG(n,await o(t),r),floating:{x:0,y:0,...await s(t)}}};function oG(e){return ir(e).direction==="rtl"}const sG={convertOffsetParentRelativeRectToViewportRelativeRect:XX,getDocumentElement:Uo,getClippingRect:eG,getOffsetParent:TT,getElementRects:rG,getClientRects:GX,getDimensions:tG,getScale:La,isElement:Oo,isRTL:oG};function iG(e,n){let t=null,r;const o=Uo(e);function s(){clearTimeout(r),t&&t.disconnect(),t=null}function i(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const{left:c,top:u,width:d,height:h}=e.getBoundingClientRect();if(a||n(),!d||!h)return;const f=Rd(u),p=Rd(o.clientWidth-(c+d)),m=Rd(o.clientHeight-(u+h)),y=Rd(c),S={rootMargin:-f+"px "+-p+"px "+-m+"px "+-y+"px",threshold:$n(0,ks(1,l))||1};let b=!0;function P(C){const _=C[0].intersectionRatio;if(_!==l){if(!b)return i();_?i(!1,_):r=setTimeout(()=>{i(!1,1e-7)},100)}b=!1}try{t=new IntersectionObserver(P,{...S,root:o.ownerDocument})}catch{t=new IntersectionObserver(P,S)}t.observe(e)}return i(!0),s}function aG(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:s=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=bw(e),u=o||s?[...c?$f(c):[],...$f(n)]:[];u.forEach(x=>{o&&x.addEventListener("scroll",t,{passive:!0}),s&&x.addEventListener("resize",t)});const d=c&&a?iG(c,t):null;let h=-1,f=null;i&&(f=new ResizeObserver(x=>{let[S]=x;S&&S.target===c&&f&&(f.unobserve(n),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{f&&f.observe(n)})),t()}),c&&!l&&f.observe(c),f.observe(n));let p,m=l?ki(e):null;l&&y();function y(){const x=ki(e);m&&(x.x!==m.x||x.y!==m.y||x.width!==m.width||x.height!==m.height)&&t(),m=x,p=requestAnimationFrame(y)}return t(),()=>{u.forEach(x=>{o&&x.removeEventListener("scroll",t),s&&x.removeEventListener("resize",t)}),d&&d(),f&&f.disconnect(),f=null,l&&cancelAnimationFrame(p)}}const lG=(e,n,t)=>{const r=new Map,o={platform:sG,...t},s={...o.platform,_c:r};return LX(e,n,{...o,platform:s})},cG=e=>{function n(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:e,fn(t){const{element:r,padding:o}=typeof e=="function"?e(t):e;return r&&n(r)?r.current!=null?xP({element:r.current,padding:o}).fn(t):{}:r?xP({element:r,padding:o}).fn(t):{}}}};var Ch=typeof document<"u"?w.useLayoutEffect:w.useEffect;function Tf(e,n){if(e===n)return!0;if(typeof e!=typeof n)return!1;if(typeof e=="function"&&e.toString()===n.toString())return!0;let t,r,o;if(e&&n&&typeof e=="object"){if(Array.isArray(e)){if(t=e.length,t!=n.length)return!1;for(r=t;r--!==0;)if(!Tf(e[r],n[r]))return!1;return!0}if(o=Object.keys(e),t=o.length,t!==Object.keys(n).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(n,o[r]))return!1;for(r=t;r--!==0;){const s=o[r];if(!(s==="_owner"&&e.$$typeof)&&!Tf(e[s],n[s]))return!1}return!0}return e!==e&&n!==n}function MT(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function CP(e,n){const t=MT(e);return Math.round(n*t)/t}function IP(e){const n=w.useRef(e);return Ch(()=>{n.current=e}),n}function uG(e){e===void 0&&(e={});const{placement:n="bottom",strategy:t="absolute",middleware:r=[],platform:o,elements:{reference:s,floating:i}={},transform:a=!0,whileElementsMounted:l,open:c}=e,[u,d]=w.useState({x:0,y:0,strategy:t,placement:n,middlewareData:{},isPositioned:!1}),[h,f]=w.useState(r);Tf(h,r)||f(r);const[p,m]=w.useState(null),[y,x]=w.useState(null),S=w.useCallback(V=>{V!=_.current&&(_.current=V,m(V))},[m]),b=w.useCallback(V=>{V!==I.current&&(I.current=V,x(V))},[x]),P=s||p,C=i||y,_=w.useRef(null),I=w.useRef(null),k=w.useRef(u),T=IP(l),M=IP(o),O=w.useCallback(()=>{if(!_.current||!I.current)return;const V={placement:n,strategy:t,middleware:h};M.current&&(V.platform=M.current),lG(_.current,I.current,V).then(q=>{const L={...q,isPositioned:!0};z.current&&!Tf(k.current,L)&&(k.current=L,Do.flushSync(()=>{d(L)}))})},[h,n,t,M]);Ch(()=>{c===!1&&k.current.isPositioned&&(k.current.isPositioned=!1,d(V=>({...V,isPositioned:!1})))},[c]);const z=w.useRef(!1);Ch(()=>(z.current=!0,()=>{z.current=!1}),[]),Ch(()=>{if(P&&(_.current=P),C&&(I.current=C),P&&C){if(T.current)return T.current(P,C,O);O()}},[P,C,O,T]);const B=w.useMemo(()=>({reference:_,floating:I,setReference:S,setFloating:b}),[S,b]),D=w.useMemo(()=>({reference:P,floating:C}),[P,C]),F=w.useMemo(()=>{const V={position:t,left:0,top:0};if(!D.floating)return V;const q=CP(D.floating,u.x),L=CP(D.floating,u.y);return a?{...V,transform:"translate("+q+"px, "+L+"px)",...MT(D.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:q,top:L}},[t,a,D.floating,u.x,u.y]);return w.useMemo(()=>({...u,update:O,refs:B,elements:D,floatingStyles:F}),[u,O,B,D,F])}function AT(e){const[n,t]=w.useState(void 0);return Ii(()=>{if(e){t({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const s=o[0];let i,a;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;i=c.inlineSize,a=c.blockSize}else i=e.offsetWidth,a=e.offsetHeight;t({width:i,height:a})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else t(void 0)},[e]),n}const OT="Popper",[RT,DT]=zo(OT),[dG,LT]=RT(OT),hG=e=>{const{__scopePopper:n,children:t}=e,[r,o]=w.useState(null);return w.createElement(dG,{scope:n,anchor:r,onAnchorChange:o},t)},fG="PopperAnchor",pG=w.forwardRef((e,n)=>{const{__scopePopper:t,virtualRef:r,...o}=e,s=LT(fG,t),i=w.useRef(null),a=Ze(n,i);return w.useEffect(()=>{s.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:w.createElement(Oe.div,W({},o,{ref:a}))}),jT="PopperContent",[gG,rne]=RT(jT),mG=w.forwardRef((e,n)=>{var t,r,o,s,i,a,l,c;const{__scopePopper:u,side:d="bottom",sideOffset:h=0,align:f="center",alignOffset:p=0,arrowPadding:m=0,collisionBoundary:y=[],collisionPadding:x=0,sticky:S="partial",hideWhenDetached:b=!1,avoidCollisions:P=!0,onPlaced:C,..._}=e,I=LT(jT,u),[k,T]=w.useState(null),M=Ze(n,cr=>T(cr)),[O,z]=w.useState(null),B=AT(O),D=(t=B==null?void 0:B.width)!==null&&t!==void 0?t:0,F=(r=B==null?void 0:B.height)!==null&&r!==void 0?r:0,V=d+(f!=="center"?"-"+f:""),q=typeof x=="number"?x:{top:0,right:0,bottom:0,left:0,...x},L=Array.isArray(y)?y:[y],N=L.length>0,H={padding:q,boundary:L.filter(yG),altBoundary:N},{refs:Q,floatingStyles:Z,placement:Ee,isPositioned:ke,middlewareData:ue}=uG({strategy:"fixed",placement:V,whileElementsMounted:aG,elements:{reference:I.anchor},middleware:[BX({mainAxis:h+F,alignmentAxis:p}),P&&FX({mainAxis:!0,crossAxis:!1,limiter:S==="partial"?UX():void 0,...H}),P&&jX({...H}),KX({...H,apply:({elements:cr,rects:Vo,availableWidth:io,availableHeight:Bn})=>{const{width:ur,height:Fn}=Vo.reference,qt=cr.floating.style;qt.setProperty("--radix-popper-available-width",`${io}px`),qt.setProperty("--radix-popper-available-height",`${Bn}px`),qt.setProperty("--radix-popper-anchor-width",`${ur}px`),qt.setProperty("--radix-popper-anchor-height",`${Fn}px`)}}),O&&cG({element:O,padding:m}),vG({arrowWidth:D,arrowHeight:F}),b&&NX({strategy:"referenceHidden"})]}),[He,Ve]=NT(Ee),We=Vt(C);Ii(()=>{ke&&(We==null||We())},[ke,We]);const Re=(o=ue.arrow)===null||o===void 0?void 0:o.x,Gt=(s=ue.arrow)===null||s===void 0?void 0:s.y,Ho=((i=ue.arrow)===null||i===void 0?void 0:i.centerOffset)!==0,[Pn,so]=w.useState();return Ii(()=>{k&&so(window.getComputedStyle(k).zIndex)},[k]),w.createElement("div",{ref:Q.setFloating,"data-radix-popper-content-wrapper":"",style:{...Z,transform:ke?Z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Pn,"--radix-popper-transform-origin":[(a=ue.transformOrigin)===null||a===void 0?void 0:a.x,(l=ue.transformOrigin)===null||l===void 0?void 0:l.y].join(" ")},dir:e.dir},w.createElement(gG,{scope:u,placedSide:He,onArrowChange:z,arrowX:Re,arrowY:Gt,shouldHideArrow:Ho},w.createElement(Oe.div,W({"data-side":He,"data-align":Ve},_,{ref:M,style:{..._.style,animation:ke?void 0:"none",opacity:(c=ue.hide)!==null&&c!==void 0&&c.referenceHidden?0:void 0}}))))});function yG(e){return e!==null}const vG=e=>({name:"transformOrigin",options:e,fn(n){var t,r,o,s,i;const{placement:a,rects:l,middlewareData:c}=n,d=((t=c.arrow)===null||t===void 0?void 0:t.centerOffset)!==0,h=d?0:e.arrowWidth,f=d?0:e.arrowHeight,[p,m]=NT(a),y={start:"0%",center:"50%",end:"100%"}[m],x=((r=(o=c.arrow)===null||o===void 0?void 0:o.x)!==null&&r!==void 0?r:0)+h/2,S=((s=(i=c.arrow)===null||i===void 0?void 0:i.y)!==null&&s!==void 0?s:0)+f/2;let b="",P="";return p==="bottom"?(b=d?y:`${x}px`,P=`${-f}px`):p==="top"?(b=d?y:`${x}px`,P=`${l.floating.height+f}px`):p==="right"?(b=`${-f}px`,P=d?y:`${S}px`):p==="left"&&(b=`${l.floating.width+f}px`,P=d?y:`${S}px`),{data:{x:b,y:P}}}});function NT(e){const[n,t="center"]=e.split("-");return[n,t]}const zT=hG,wG=pG,xG=mG,$m="rovingFocusGroup.onEntryFocus",SG={bubbles:!1,cancelable:!0},Pw="RovingFocusGroup",[H0,BT,bG]=Tp(Pw),[PG,FT]=zo(Pw,[bG]),[EG,_G]=PG(Pw),CG=w.forwardRef((e,n)=>w.createElement(H0.Provider,{scope:e.__scopeRovingFocusGroup},w.createElement(H0.Slot,{scope:e.__scopeRovingFocusGroup},w.createElement(IG,W({},e,{ref:n}))))),IG=w.forwardRef((e,n)=>{const{__scopeRovingFocusGroup:t,orientation:r,loop:o=!1,dir:s,currentTabStopId:i,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,...u}=e,d=w.useRef(null),h=Ze(n,d),f=mw(s),[p=null,m]=Li({prop:i,defaultProp:a,onChange:l}),[y,x]=w.useState(!1),S=Vt(c),b=BT(t),P=w.useRef(!1),[C,_]=w.useState(0);return w.useEffect(()=>{const I=d.current;if(I)return I.addEventListener($m,S),()=>I.removeEventListener($m,S)},[S]),w.createElement(EG,{scope:t,orientation:r,dir:f,loop:o,currentTabStopId:p,onItemFocus:w.useCallback(I=>m(I),[m]),onItemShiftTab:w.useCallback(()=>x(!0),[]),onFocusableItemAdd:w.useCallback(()=>_(I=>I+1),[]),onFocusableItemRemove:w.useCallback(()=>_(I=>I-1),[])},w.createElement(Oe.div,W({tabIndex:y||C===0?-1:0,"data-orientation":r},u,{ref:h,style:{outline:"none",...e.style},onMouseDown:ie(e.onMouseDown,()=>{P.current=!0}),onFocus:ie(e.onFocus,I=>{const k=!P.current;if(I.target===I.currentTarget&&k&&!y){const T=new CustomEvent($m,SG);if(I.currentTarget.dispatchEvent(T),!T.defaultPrevented){const M=b().filter(F=>F.focusable),O=M.find(F=>F.active),z=M.find(F=>F.id===p),D=[O,z,...M].filter(Boolean).map(F=>F.ref.current);UT(D)}}P.current=!1}),onBlur:ie(e.onBlur,()=>x(!1))})))}),kG="RovingFocusGroupItem",$G=w.forwardRef((e,n)=>{const{__scopeRovingFocusGroup:t,focusable:r=!0,active:o=!1,tabStopId:s,...i}=e,a=bs(),l=s||a,c=_G(kG,t),u=c.currentTabStopId===l,d=BT(t),{onFocusableItemAdd:h,onFocusableItemRemove:f}=c;return w.useEffect(()=>{if(r)return h(),()=>f()},[r,h,f]),w.createElement(H0.ItemSlot,{scope:t,id:l,focusable:r,active:o},w.createElement(Oe.span,W({tabIndex:u?0:-1,"data-orientation":c.orientation},i,{ref:n,onMouseDown:ie(e.onMouseDown,p=>{r?c.onItemFocus(l):p.preventDefault()}),onFocus:ie(e.onFocus,()=>c.onItemFocus(l)),onKeyDown:ie(e.onKeyDown,p=>{if(p.key==="Tab"&&p.shiftKey){c.onItemShiftTab();return}if(p.target!==p.currentTarget)return;const m=AG(p,c.orientation,c.dir);if(m!==void 0){p.preventDefault();let x=d().filter(S=>S.focusable).map(S=>S.ref.current);if(m==="last")x.reverse();else if(m==="prev"||m==="next"){m==="prev"&&x.reverse();const S=x.indexOf(p.currentTarget);x=c.loop?OG(x,S+1):x.slice(S+1)}setTimeout(()=>UT(x))}})})))}),TG={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function MG(e,n){return n!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function AG(e,n,t){const r=MG(e.key,t);if(!(n==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(n==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return TG[r]}function UT(e){const n=document.activeElement;for(const t of e)if(t===n||(t.focus(),document.activeElement!==n))return}function OG(e,n){return e.map((t,r)=>e[(n+r)%e.length])}const RG=CG,DG=$G,V0=["Enter"," "],LG=["ArrowDown","PageUp","Home"],KT=["ArrowUp","PageDown","End"],jG=[...LG,...KT],NG={ltr:[...V0,"ArrowRight"],rtl:[...V0,"ArrowLeft"]},zG={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Op="Menu",[eu,BG,FG]=Tp(Op),[ji,Rp]=zo(Op,[FG,DT,FT]),Dp=DT(),HT=FT(),[VT,Ks]=ji(Op),[UG,$u]=ji(Op),KG=e=>{const{__scopeMenu:n,open:t=!1,children:r,dir:o,onOpenChange:s,modal:i=!0}=e,a=Dp(n),[l,c]=w.useState(null),u=w.useRef(!1),d=Vt(s),h=mw(o);return w.useEffect(()=>{const f=()=>{u.current=!0,document.addEventListener("pointerdown",p,{capture:!0,once:!0}),document.addEventListener("pointermove",p,{capture:!0,once:!0})},p=()=>u.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",p,{capture:!0}),document.removeEventListener("pointermove",p,{capture:!0})}},[]),w.createElement(zT,a,w.createElement(VT,{scope:n,open:t,onOpenChange:d,content:l,onContentChange:c},w.createElement(UG,{scope:n,onClose:w.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:i},r)))},WT=w.forwardRef((e,n)=>{const{__scopeMenu:t,...r}=e,o=Dp(t);return w.createElement(wG,W({},o,r,{ref:n}))}),YT="MenuPortal",[HG,XT]=ji(YT,{forceMount:void 0}),VG=e=>{const{__scopeMenu:n,forceMount:t,children:r,container:o}=e,s=Ks(YT,n);return w.createElement(HG,{scope:n,forceMount:t},w.createElement(Bo,{present:t||s.open},w.createElement(dw,{asChild:!0,container:o},r)))},$r="MenuContent",[WG,Ew]=ji($r),YG=w.forwardRef((e,n)=>{const t=XT($r,e.__scopeMenu),{forceMount:r=t.forceMount,...o}=e,s=Ks($r,e.__scopeMenu),i=$u($r,e.__scopeMenu);return w.createElement(eu.Provider,{scope:e.__scopeMenu},w.createElement(Bo,{present:r||s.open},w.createElement(eu.Slot,{scope:e.__scopeMenu},i.modal?w.createElement(XG,W({},o,{ref:n})):w.createElement(GG,W({},o,{ref:n})))))}),XG=w.forwardRef((e,n)=>{const t=Ks($r,e.__scopeMenu),r=w.useRef(null),o=Ze(n,r);return w.useEffect(()=>{const s=r.current;if(s)return fw(s)},[]),w.createElement(_w,W({},e,{ref:o,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:ie(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)}))}),GG=w.forwardRef((e,n)=>{const t=Ks($r,e.__scopeMenu);return w.createElement(_w,W({},e,{ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)}))}),_w=w.forwardRef((e,n)=>{const{__scopeMenu:t,loop:r=!1,trapFocus:o,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:f,disableOutsideScroll:p,...m}=e,y=Ks($r,t),x=$u($r,t),S=Dp(t),b=HT(t),P=BG(t),[C,_]=w.useState(null),I=w.useRef(null),k=Ze(n,I,y.onContentChange),T=w.useRef(0),M=w.useRef(""),O=w.useRef(0),z=w.useRef(null),B=w.useRef("right"),D=w.useRef(0),F=p?hw:w.Fragment,V=p?{as:Ga,allowPinchZoom:!0}:void 0,q=N=>{var H,Q;const Z=M.current+N,Ee=P().filter(Re=>!Re.disabled),ke=document.activeElement,ue=(H=Ee.find(Re=>Re.ref.current===ke))===null||H===void 0?void 0:H.textValue,He=Ee.map(Re=>Re.textValue),Ve=cq(He,Z,ue),We=(Q=Ee.find(Re=>Re.textValue===Ve))===null||Q===void 0?void 0:Q.ref.current;(function Re(Gt){M.current=Gt,window.clearTimeout(T.current),Gt!==""&&(T.current=window.setTimeout(()=>Re(""),1e3))})(Z),We&&setTimeout(()=>We.focus())};w.useEffect(()=>()=>window.clearTimeout(T.current),[]),nT();const L=w.useCallback(N=>{var H,Q;return B.current===((H=z.current)===null||H===void 0?void 0:H.side)&&dq(N,(Q=z.current)===null||Q===void 0?void 0:Q.area)},[]);return w.createElement(WG,{scope:t,searchRef:M,onItemEnter:w.useCallback(N=>{L(N)&&N.preventDefault()},[L]),onItemLeave:w.useCallback(N=>{var H;L(N)||((H=I.current)===null||H===void 0||H.focus(),_(null))},[L]),onTriggerLeave:w.useCallback(N=>{L(N)&&N.preventDefault()},[L]),pointerGraceTimerRef:O,onPointerGraceIntentChange:w.useCallback(N=>{z.current=N},[])},w.createElement(F,V,w.createElement(eT,{asChild:!0,trapped:o,onMountAutoFocus:ie(s,N=>{var H;N.preventDefault(),(H=I.current)===null||H===void 0||H.focus()}),onUnmountAutoFocus:i},w.createElement(uw,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:f},w.createElement(RG,W({asChild:!0},b,{dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:C,onCurrentTabStopIdChange:_,onEntryFocus:ie(l,N=>{x.isUsingKeyboardRef.current||N.preventDefault()})}),w.createElement(xG,W({role:"menu","aria-orientation":"vertical","data-state":e3(y.open),"data-radix-menu-content":"",dir:x.dir},S,m,{ref:k,style:{outline:"none",...m.style},onKeyDown:ie(m.onKeyDown,N=>{const Q=N.target.closest("[data-radix-menu-content]")===N.currentTarget,Z=N.ctrlKey||N.altKey||N.metaKey,Ee=N.key.length===1;Q&&(N.key==="Tab"&&N.preventDefault(),!Z&&Ee&&q(N.key));const ke=I.current;if(N.target!==ke||!jG.includes(N.key))return;N.preventDefault();const He=P().filter(Ve=>!Ve.disabled).map(Ve=>Ve.ref.current);KT.includes(N.key)&&He.reverse(),aq(He)}),onBlur:ie(e.onBlur,N=>{N.currentTarget.contains(N.target)||(window.clearTimeout(T.current),M.current="")}),onPointerMove:ie(e.onPointerMove,tu(N=>{const H=N.target,Q=D.current!==N.clientX;if(N.currentTarget.contains(H)&&Q){const Z=N.clientX>D.current?"right":"left";B.current=Z,D.current=N.clientX}}))})))))))}),qG=w.forwardRef((e,n)=>{const{__scopeMenu:t,...r}=e;return w.createElement(Oe.div,W({role:"group"},r,{ref:n}))}),W0="MenuItem",kP="menu.itemSelect",GT=w.forwardRef((e,n)=>{const{disabled:t=!1,onSelect:r,...o}=e,s=w.useRef(null),i=$u(W0,e.__scopeMenu),a=Ew(W0,e.__scopeMenu),l=Ze(n,s),c=w.useRef(!1),u=()=>{const d=s.current;if(!t&&d){const h=new CustomEvent(kP,{bubbles:!0,cancelable:!0});d.addEventListener(kP,f=>r==null?void 0:r(f),{once:!0}),cw(d,h),h.defaultPrevented?c.current=!1:i.onClose()}};return w.createElement(qT,W({},o,{ref:l,disabled:t,onClick:ie(e.onClick,u),onPointerDown:d=>{var h;(h=e.onPointerDown)===null||h===void 0||h.call(e,d),c.current=!0},onPointerUp:ie(e.onPointerUp,d=>{var h;c.current||(h=d.currentTarget)===null||h===void 0||h.click()}),onKeyDown:ie(e.onKeyDown,d=>{const h=a.searchRef.current!=="";t||h&&d.key===" "||V0.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})}))}),qT=w.forwardRef((e,n)=>{const{__scopeMenu:t,disabled:r=!1,textValue:o,...s}=e,i=Ew(W0,t),a=HT(t),l=w.useRef(null),c=Ze(n,l),[u,d]=w.useState(!1),[h,f]=w.useState("");return w.useEffect(()=>{const p=l.current;if(p){var m;f(((m=p.textContent)!==null&&m!==void 0?m:"").trim())}},[s.children]),w.createElement(eu.ItemSlot,{scope:t,disabled:r,textValue:o??h},w.createElement(DG,W({asChild:!0},a,{focusable:!r}),w.createElement(Oe.div,W({role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0},s,{ref:c,onPointerMove:ie(e.onPointerMove,tu(p=>{r?i.onItemLeave(p):(i.onItemEnter(p),p.defaultPrevented||p.currentTarget.focus())})),onPointerLeave:ie(e.onPointerLeave,tu(p=>i.onItemLeave(p))),onFocus:ie(e.onFocus,()=>d(!0)),onBlur:ie(e.onBlur,()=>d(!1))}))))}),QG=w.forwardRef((e,n)=>{const{checked:t=!1,onCheckedChange:r,...o}=e;return w.createElement(JG,{scope:e.__scopeMenu,checked:t},w.createElement(GT,W({role:"menuitemcheckbox","aria-checked":Mf(t)?"mixed":t},o,{ref:n,"data-state":t3(t),onSelect:ie(o.onSelect,()=>r==null?void 0:r(Mf(t)?!0:!t),{checkForDefaultPrevented:!1})})))}),ZG="MenuRadioGroup";ji(ZG,{value:void 0,onValueChange:()=>{}});const QT="MenuItemIndicator",[JG,eq]=ji(QT,{checked:!1}),tq=w.forwardRef((e,n)=>{const{__scopeMenu:t,forceMount:r,...o}=e,s=eq(QT,t);return w.createElement(Bo,{present:r||Mf(s.checked)||s.checked===!0},w.createElement(Oe.span,W({},o,{ref:n,"data-state":t3(s.checked)})))}),ZT="MenuSub",[nq,JT]=ji(ZT),rq=e=>{const{__scopeMenu:n,children:t,open:r=!1,onOpenChange:o}=e,s=Ks(ZT,n),i=Dp(n),[a,l]=w.useState(null),[c,u]=w.useState(null),d=Vt(o);return w.useEffect(()=>(s.open===!1&&d(!1),()=>d(!1)),[s.open,d]),w.createElement(zT,i,w.createElement(VT,{scope:n,open:r,onOpenChange:d,content:c,onContentChange:u},w.createElement(nq,{scope:n,contentId:bs(),triggerId:bs(),trigger:a,onTriggerChange:l},t)))},Dd="MenuSubTrigger",oq=w.forwardRef((e,n)=>{const t=Ks(Dd,e.__scopeMenu),r=$u(Dd,e.__scopeMenu),o=JT(Dd,e.__scopeMenu),s=Ew(Dd,e.__scopeMenu),i=w.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=s,c={__scopeMenu:e.__scopeMenu},u=w.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return w.useEffect(()=>u,[u]),w.useEffect(()=>{const d=a.current;return()=>{window.clearTimeout(d),l(null)}},[a,l]),w.createElement(WT,W({asChild:!0},c),w.createElement(qT,W({id:o.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":o.contentId,"data-state":e3(t.open)},e,{ref:Ep(n,o.onTriggerChange),onClick:d=>{var h;(h=e.onClick)===null||h===void 0||h.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:ie(e.onPointerMove,tu(d=>{s.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!t.open&&!i.current&&(s.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{t.onOpenChange(!0),u()},100))})),onPointerLeave:ie(e.onPointerLeave,tu(d=>{var h;u();const f=(h=t.content)===null||h===void 0?void 0:h.getBoundingClientRect();if(f){var p;const m=(p=t.content)===null||p===void 0?void 0:p.dataset.side,y=m==="right",x=y?-5:5,S=f[y?"left":"right"],b=f[y?"right":"left"];s.onPointerGraceIntentChange({area:[{x:d.clientX+x,y:d.clientY},{x:S,y:f.top},{x:b,y:f.top},{x:b,y:f.bottom},{x:S,y:f.bottom}],side:m}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(d),d.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:ie(e.onKeyDown,d=>{const h=s.searchRef.current!=="";if(!(e.disabled||h&&d.key===" ")&&NG[r.dir].includes(d.key)){var f;t.onOpenChange(!0),(f=t.content)===null||f===void 0||f.focus(),d.preventDefault()}})})))}),sq="MenuSubContent",iq=w.forwardRef((e,n)=>{const t=XT($r,e.__scopeMenu),{forceMount:r=t.forceMount,...o}=e,s=Ks($r,e.__scopeMenu),i=$u($r,e.__scopeMenu),a=JT(sq,e.__scopeMenu),l=w.useRef(null),c=Ze(n,l);return w.createElement(eu.Provider,{scope:e.__scopeMenu},w.createElement(Bo,{present:r||s.open},w.createElement(eu.Slot,{scope:e.__scopeMenu},w.createElement(_w,W({id:a.contentId,"aria-labelledby":a.triggerId},o,{ref:c,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;i.isUsingKeyboardRef.current&&((d=l.current)===null||d===void 0||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:ie(e.onFocusOutside,u=>{u.target!==a.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:ie(e.onEscapeKeyDown,u=>{i.onClose(),u.preventDefault()}),onKeyDown:ie(e.onKeyDown,u=>{const d=u.currentTarget.contains(u.target),h=zG[i.dir].includes(u.key);if(d&&h){var f;s.onOpenChange(!1),(f=a.trigger)===null||f===void 0||f.focus(),u.preventDefault()}})})))))});function e3(e){return e?"open":"closed"}function Mf(e){return e==="indeterminate"}function t3(e){return Mf(e)?"indeterminate":e?"checked":"unchecked"}function aq(e){const n=document.activeElement;for(const t of e)if(t===n||(t.focus(),document.activeElement!==n))return}function lq(e,n){return e.map((t,r)=>e[(n+r)%e.length])}function cq(e,n,t){const o=n.length>1&&Array.from(n).every(c=>c===n[0])?n[0]:n,s=t?e.indexOf(t):-1;let i=lq(e,Math.max(s,0));o.length===1&&(i=i.filter(c=>c!==t));const l=i.find(c=>c.toLowerCase().startsWith(o.toLowerCase()));return l!==t?l:void 0}function uq(e,n){const{x:t,y:r}=e;let o=!1;for(let s=0,i=n.length-1;s<n.length;i=s++){const a=n[s].x,l=n[s].y,c=n[i].x,u=n[i].y;l>r!=u>r&&t<(c-a)*(r-l)/(u-l)+a&&(o=!o)}return o}function dq(e,n){if(!n)return!1;const t={x:e.clientX,y:e.clientY};return uq(t,n)}function tu(e){return n=>n.pointerType==="mouse"?e(n):void 0}const n3=KG,r3=WT,o3=VG,s3=YG,i3=qG,a3=GT,l3=QG,hq=tq,c3=rq,u3=oq,d3=iq,h3="DropdownMenu",[fq,one]=zo(h3,[Rp]),Ar=Rp(),[pq,f3]=fq(h3),gq=e=>{const{__scopeDropdownMenu:n,children:t,dir:r,open:o,defaultOpen:s,onOpenChange:i,modal:a=!0}=e,l=Ar(n),c=w.useRef(null),[u=!1,d]=Li({prop:o,defaultProp:s,onChange:i});return w.createElement(pq,{scope:n,triggerId:bs(),triggerRef:c,contentId:bs(),open:u,onOpenChange:d,onOpenToggle:w.useCallback(()=>d(h=>!h),[d]),modal:a},w.createElement(n3,W({},l,{open:u,onOpenChange:d,dir:r,modal:a}),t))},mq="DropdownMenuTrigger",yq=w.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,disabled:r=!1,...o}=e,s=f3(mq,t),i=Ar(t);return w.createElement(r3,W({asChild:!0},i),w.createElement(Oe.button,W({type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":r?"":void 0,disabled:r},o,{ref:Ep(n,s.triggerRef),onPointerDown:ie(e.onPointerDown,a=>{!r&&a.button===0&&a.ctrlKey===!1&&(s.onOpenToggle(),s.open||a.preventDefault())}),onKeyDown:ie(e.onKeyDown,a=>{r||(["Enter"," "].includes(a.key)&&s.onOpenToggle(),a.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})))}),vq=e=>{const{__scopeDropdownMenu:n,...t}=e,r=Ar(n);return w.createElement(o3,W({},r,t))},wq="DropdownMenuContent",xq=w.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=f3(wq,t),s=Ar(t),i=w.useRef(!1);return w.createElement(s3,W({id:o.contentId,"aria-labelledby":o.triggerId},s,r,{ref:n,onCloseAutoFocus:ie(e.onCloseAutoFocus,a=>{var l;i.current||(l=o.triggerRef.current)===null||l===void 0||l.focus(),i.current=!1,a.preventDefault()}),onInteractOutside:ie(e.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!o.modal||u)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),Sq=w.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=Ar(t);return w.createElement(i3,W({},o,r,{ref:n}))}),bq=w.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=Ar(t);return w.createElement(a3,W({},o,r,{ref:n}))}),Pq=w.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=Ar(t);return w.createElement(l3,W({},o,r,{ref:n}))}),Eq=w.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=Ar(t);return w.createElement(hq,W({},o,r,{ref:n}))}),_q=e=>{const{__scopeDropdownMenu:n,children:t,open:r,onOpenChange:o,defaultOpen:s}=e,i=Ar(n),[a=!1,l]=Li({prop:r,defaultProp:s,onChange:o});return w.createElement(c3,W({},i,{open:a,onOpenChange:l}),t)},Cq=w.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=Ar(t);return w.createElement(u3,W({},o,r,{ref:n}))}),Iq=w.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=Ar(t);return w.createElement(d3,W({},o,r,{ref:n,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),p3=gq,nu=yq,Cw=vq,g3=xq,kq=Sq,ia=bq,m3=Pq,$q=Eq,Tq=_q,Mq=Cq,Aq=Iq,Oq=()=>{},y3=w.createContext({});function Rq({onEvent:e,children:n}){return g.jsx(y3.Provider,{value:e??Oq,children:n})}function hl(){return w.useContext(y3)}function Ni(e,n){const t=U(),r=w.useRef(!1),o=hl(),s=w.useCallback(a=>{r.current=a,t.batch(()=>{a?(t.complete(),t.addOpenMenu(e)):(t.deleteOpenMenu(e),t.openMenus.forEach(l=>{l.startsWith(e)&&t.deleteOpenMenu(l)})),n==null||n(a)})},[t,e,n]);return w.useEffect(()=>(r.current&&(o("open-menu",{source:"unknown",id:e}),t.addOpenMenu(e)),()=>{r.current&&(t.deleteOpenMenu(e),t.openMenus.forEach(a=>{a.startsWith(e)&&(o("close-menu",{source:"unknown",id:e}),t.deleteOpenMenu(a))}),r.current=!1)}),[t,e,o]),[J("is menu open",()=>t.openMenus.includes(e),[t,e]),s]}function Ms({id:e,children:n,modal:t=!1}){const[r,o]=Ni(e);return g.jsx(p3,{open:r,dir:"ltr",modal:t,onOpenChange:o,children:n})}function Tu({children:e,"data-testid":n}){return g.jsx(nu,{dir:"ltr","data-testid":n,asChild:!0,children:e})}function As({side:e="bottom",align:n="start",sideOffset:t=8,alignOffset:r=8,children:o}){const s=Yt();return g.jsx(Cw,{dir:"ltr",container:s,children:g.jsx(g3,{className:"tlui-menu",align:n,sideOffset:t,side:e,alignOffset:r,collisionPadding:4,children:o})})}function Iw({id:e,children:n}){const[t,r]=Ni(e);return g.jsx(Tq,{open:t,onOpenChange:r,children:n})}function kw({label:e,"data-testid":n,"data-direction":t}){return g.jsx(Mq,{dir:"ltr","data-direction":t,"data-testid":n,asChild:!0,children:g.jsx(se,{className:"tlui-menu__button tlui-menu__submenu__trigger",label:e,icon:"chevron-right"})})}function $w({alignOffset:e=0,sideOffset:n=5,children:t}){const r=Yt();return g.jsx(Cw,{container:r,dir:"ltr",children:g.jsx(Aq,{className:"tlui-menu tlui-menu__submenu__content",alignOffset:e,sideOffset:n,collisionPadding:4,children:t})})}function Eo({children:e,size:n="medium"}){return g.jsx(kq,{dir:"ltr",className:"tlui-menu__group","data-size":n,children:e})}function Tn({noClose:e,...n}){return g.jsx(ia,{dir:"ltr",asChild:!0,onClick:e||n.isChecked!==void 0?Se:void 0,children:g.jsx(se,{className:"tlui-menu__button",...n})})}function v3({children:e,onSelect:n,...t}){return g.jsxs(m3,{dir:"ltr",className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",onSelect:r=>{n==null||n(r),Se(r)},...t,children:[g.jsx("div",{className:"tlui-menu__checkbox-item__check",style:{transformOrigin:"75% center",transform:`scale(${t.checked?1:.5})`,opacity:t.checked?1:.5},children:g.jsx(vn,{small:!0,icon:t.checked?"check":"checkbox-empty"})}),e]})}function Dq({children:e,onSelect:n,...t}){return g.jsxs(m3,{dir:"ltr",className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",onSelect:r=>{n==null||n(r),Se(r)},...t,children:[g.jsx($q,{dir:"ltr",className:"tlui-menu__checkbox-item__check",children:g.jsx(vn,{icon:"check"})}),e]})}const w3=w.forwardRef((e,n)=>w.createElement(Oe.span,W({},e,{ref:n,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}))),x3="ToastProvider",[Tw,Lq,jq]=Tp("Toast"),[S3,sne]=zo("Toast",[jq]),[Nq,Lp]=S3(x3),b3=e=>{const{__scopeToast:n,label:t="Notification",duration:r=5e3,swipeDirection:o="right",swipeThreshold:s=50,children:i}=e,[a,l]=w.useState(null),[c,u]=w.useState(0),d=w.useRef(!1),h=w.useRef(!1);return w.createElement(Tw.Provider,{scope:n},w.createElement(Nq,{scope:n,label:t,duration:r,swipeDirection:o,swipeThreshold:s,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:w.useCallback(()=>u(f=>f+1),[]),onToastRemove:w.useCallback(()=>u(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h},i))};b3.propTypes={label(e){if(e.label&&typeof e.label=="string"&&!e.label.trim()){const n=`Invalid prop \`label\` supplied to \`${x3}\`. Expected non-empty \`string\`.`;return new Error(n)}return null}};const zq="ToastViewport",Bq=["F8"],Y0="toast.viewportPause",X0="toast.viewportResume",Fq=w.forwardRef((e,n)=>{const{__scopeToast:t,hotkey:r=Bq,label:o="Notifications ({hotkey})",...s}=e,i=Lp(zq,t),a=Lq(t),l=w.useRef(null),c=w.useRef(null),u=w.useRef(null),d=w.useRef(null),h=Ze(n,d,i.onViewportChange),f=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=i.toastCount>0;w.useEffect(()=>{const y=x=>{var S;r.every(P=>x[P]||x.code===P)&&((S=d.current)===null||S===void 0||S.focus())};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[r]),w.useEffect(()=>{const y=l.current,x=d.current;if(p&&y&&x){const S=()=>{if(!i.isClosePausedRef.current){const _=new CustomEvent(Y0);x.dispatchEvent(_),i.isClosePausedRef.current=!0}},b=()=>{if(i.isClosePausedRef.current){const _=new CustomEvent(X0);x.dispatchEvent(_),i.isClosePausedRef.current=!1}},P=_=>{!y.contains(_.relatedTarget)&&b()},C=()=>{y.contains(document.activeElement)||b()};return y.addEventListener("focusin",S),y.addEventListener("focusout",P),y.addEventListener("pointermove",S),y.addEventListener("pointerleave",C),window.addEventListener("blur",S),window.addEventListener("focus",b),()=>{y.removeEventListener("focusin",S),y.removeEventListener("focusout",P),y.removeEventListener("pointermove",S),y.removeEventListener("pointerleave",C),window.removeEventListener("blur",S),window.removeEventListener("focus",b)}}},[p,i.isClosePausedRef]);const m=w.useCallback(({tabbingDirection:y})=>{const S=a().map(b=>{const P=b.ref.current,C=[P,...rQ(P)];return y==="forwards"?C:C.reverse()});return(y==="forwards"?S.reverse():S).flat()},[a]);return w.useEffect(()=>{const y=d.current;if(y){const x=S=>{const b=S.altKey||S.ctrlKey||S.metaKey;if(S.key==="Tab"&&!b){const k=document.activeElement,T=S.shiftKey;if(S.target===y&&T){var C;(C=c.current)===null||C===void 0||C.focus();return}const z=m({tabbingDirection:T?"backwards":"forwards"}),B=z.findIndex(D=>D===k);if(Tm(z.slice(B+1)))S.preventDefault();else{var _,I;T?(_=c.current)===null||_===void 0||_.focus():(I=u.current)===null||I===void 0||I.focus()}}};return y.addEventListener("keydown",x),()=>y.removeEventListener("keydown",x)}},[a,m]),w.createElement(hY,{ref:l,role:"region","aria-label":o.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:p?void 0:"none"}},p&&w.createElement($P,{ref:c,onFocusFromOutsideViewport:()=>{const y=m({tabbingDirection:"forwards"});Tm(y)}}),w.createElement(Tw.Slot,{scope:t},w.createElement(Oe.ol,W({tabIndex:-1},s,{ref:h}))),p&&w.createElement($P,{ref:u,onFocusFromOutsideViewport:()=>{const y=m({tabbingDirection:"backwards"});Tm(y)}}))}),Uq="ToastFocusProxy",$P=w.forwardRef((e,n)=>{const{__scopeToast:t,onFocusFromOutsideViewport:r,...o}=e,s=Lp(Uq,t);return w.createElement(w3,W({"aria-hidden":!0,tabIndex:0},o,{ref:n,style:{position:"fixed"},onFocus:i=>{var a;const l=i.relatedTarget;!((a=s.viewport)!==null&&a!==void 0&&a.contains(l))&&r()}}))}),jp="Toast",Kq="toast.swipeStart",Hq="toast.swipeMove",Vq="toast.swipeCancel",Wq="toast.swipeEnd",Yq=w.forwardRef((e,n)=>{const{forceMount:t,open:r,defaultOpen:o,onOpenChange:s,...i}=e,[a=!0,l]=Li({prop:r,defaultProp:o,onChange:s});return w.createElement(Bo,{present:t||a},w.createElement(P3,W({open:a},i,{ref:n,onClose:()=>l(!1),onPause:Vt(e.onPause),onResume:Vt(e.onResume),onSwipeStart:ie(e.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ie(e.onSwipeMove,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:ie(e.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ie(e.onSwipeEnd,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})))}),[Xq,Gq]=S3(jp,{onClose(){}}),P3=w.forwardRef((e,n)=>{const{__scopeToast:t,type:r="foreground",duration:o,open:s,onClose:i,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:f,...p}=e,m=Lp(jp,t),[y,x]=w.useState(null),S=Ze(n,D=>x(D)),b=w.useRef(null),P=w.useRef(null),C=o||m.duration,_=w.useRef(0),I=w.useRef(C),k=w.useRef(0),{onToastAdd:T,onToastRemove:M}=m,O=Vt(()=>{var D;(y==null?void 0:y.contains(document.activeElement))&&((D=m.viewport)===null||D===void 0||D.focus()),i()}),z=w.useCallback(D=>{!D||D===1/0||(window.clearTimeout(k.current),_.current=new Date().getTime(),k.current=window.setTimeout(O,D))},[O]);w.useEffect(()=>{const D=m.viewport;if(D){const F=()=>{z(I.current),c==null||c()},V=()=>{const q=new Date().getTime()-_.current;I.current=I.current-q,window.clearTimeout(k.current),l==null||l()};return D.addEventListener(Y0,V),D.addEventListener(X0,F),()=>{D.removeEventListener(Y0,V),D.removeEventListener(X0,F)}}},[m.viewport,C,l,c,z]),w.useEffect(()=>{s&&!m.isClosePausedRef.current&&z(C)},[s,C,m.isClosePausedRef,z]),w.useEffect(()=>(T(),()=>M()),[T,M]);const B=w.useMemo(()=>y?I3(y):null,[y]);return m.viewport?w.createElement(w.Fragment,null,B&&w.createElement(qq,{__scopeToast:t,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0},B),w.createElement(Xq,{scope:t,onClose:O},Do.createPortal(w.createElement(Tw.ItemSlot,{scope:t},w.createElement(dY,{asChild:!0,onEscapeKeyDown:ie(a,()=>{m.isFocusedToastEscapeKeyDownRef.current||O(),m.isFocusedToastEscapeKeyDownRef.current=!1})},w.createElement(Oe.li,W({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":m.swipeDirection},p,{ref:S,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:ie(e.onKeyDown,D=>{D.key==="Escape"&&(a==null||a(D.nativeEvent),D.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,O()))}),onPointerDown:ie(e.onPointerDown,D=>{D.button===0&&(b.current={x:D.clientX,y:D.clientY})}),onPointerMove:ie(e.onPointerMove,D=>{if(!b.current)return;const F=D.clientX-b.current.x,V=D.clientY-b.current.y,q=!!P.current,L=["left","right"].includes(m.swipeDirection),N=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,H=L?N(0,F):0,Q=L?0:N(0,V),Z=D.pointerType==="touch"?10:2,Ee={x:H,y:Q},ke={originalEvent:D,delta:Ee};q?(P.current=Ee,Ld(Hq,d,ke,{discrete:!1})):TP(Ee,m.swipeDirection,Z)?(P.current=Ee,Ld(Kq,u,ke,{discrete:!1}),D.target.setPointerCapture(D.pointerId)):(Math.abs(F)>Z||Math.abs(V)>Z)&&(b.current=null)}),onPointerUp:ie(e.onPointerUp,D=>{const F=P.current,V=D.target;if(V.hasPointerCapture(D.pointerId)&&V.releasePointerCapture(D.pointerId),P.current=null,b.current=null,F){const q=D.currentTarget,L={originalEvent:D,delta:F};TP(F,m.swipeDirection,m.swipeThreshold)?Ld(Wq,f,L,{discrete:!0}):Ld(Vq,h,L,{discrete:!0}),q.addEventListener("click",N=>N.preventDefault(),{once:!0})}})})))),m.viewport))):null});P3.propTypes={type(e){if(e.type&&!["foreground","background"].includes(e.type)){const n=`Invalid prop \`type\` supplied to \`${jp}\`. Expected \`foreground | background\`.`;return new Error(n)}return null}};const qq=e=>{const{__scopeToast:n,children:t,...r}=e,o=Lp(jp,n),[s,i]=w.useState(!1),[a,l]=w.useState(!1);return tQ(()=>i(!0)),w.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:w.createElement(dw,{asChild:!0},w.createElement(w3,r,s&&w.createElement(w.Fragment,null,o.label," ",t)))},Qq=w.forwardRef((e,n)=>{const{__scopeToast:t,...r}=e;return w.createElement(Oe.div,W({},r,{ref:n}))}),Zq=w.forwardRef((e,n)=>{const{__scopeToast:t,...r}=e;return w.createElement(Oe.div,W({},r,{ref:n}))}),Jq="ToastAction",E3=w.forwardRef((e,n)=>{const{altText:t,...r}=e;return t?w.createElement(C3,{altText:t,asChild:!0},w.createElement(_3,W({},r,{ref:n}))):null});E3.propTypes={altText(e){return e.altText?null:new Error(`Missing prop \`altText\` expected on \`${Jq}\``)}};const eQ="ToastClose",_3=w.forwardRef((e,n)=>{const{__scopeToast:t,...r}=e,o=Gq(eQ,t);return w.createElement(C3,{asChild:!0},w.createElement(Oe.button,W({type:"button"},r,{ref:n,onClick:ie(e.onClick,o.onClose)})))}),C3=w.forwardRef((e,n)=>{const{__scopeToast:t,altText:r,...o}=e;return w.createElement(Oe.div,W({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0},o,{ref:n}))});function I3(e){const n=[];return Array.from(e.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&n.push(r.textContent),nQ(r)){const o=r.ariaHidden||r.hidden||r.style.display==="none",s=r.dataset.radixToastAnnounceExclude==="";if(!o)if(s){const i=r.dataset.radixToastAnnounceAlt;i&&n.push(i)}else n.push(...I3(r))}}),n}function Ld(e,n,t,{discrete:r}){const o=t.originalEvent.currentTarget,s=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:t});n&&o.addEventListener(e,n,{once:!0}),r?cw(o,s):o.dispatchEvent(s)}const TP=(e,n,t=0)=>{const r=Math.abs(e.x),o=Math.abs(e.y),s=r>o;return n==="left"||n==="right"?s&&r>t:!s&&o>t};function tQ(e=()=>{}){const n=Vt(e);Ii(()=>{let t=0,r=0;return t=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(n)),()=>{window.cancelAnimationFrame(t),window.cancelAnimationFrame(r)}},[n])}function nQ(e){return e.nodeType===e.ELEMENT_NODE}function rQ(e){const n=[],t=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)n.push(t.currentNode);return n}function Tm(e){const n=document.activeElement;return e.some(t=>t===n?!0:(t.focus(),document.activeElement!==n))}const oQ=Yq,sQ=Qq,iQ=Zq,aQ=E3,MP=_3,Mm="2.0.0-alpha.14",lQ=["align-bottom-center","align-bottom-left","align-bottom-right","align-bottom","align-center-center","align-center-horizontal","align-center-left","align-center-right","align-center-vertical","align-left","align-right","align-top-center","align-top-left","align-top-right","align-top","arrow-left","arrowhead-arrow","arrowhead-bar","arrowhead-diamond","arrowhead-dot","arrowhead-none","arrowhead-square","arrowhead-triangle-inverted","arrowhead-triangle","aspect-ratio","avatar","blob","bring-forward","bring-to-front","check","checkbox-checked","checkbox-empty","chevron-down","chevron-left","chevron-right","chevron-up","chevrons-ne","chevrons-sw","clipboard-copied","clipboard-copy","code","collab","color","comment","cross-2","cross","dash-dashed","dash-dotted","dash-draw","dash-solid","discord","distribute-horizontal","distribute-vertical","dot","dots-horizontal","dots-vertical","drag-handle-dots","duplicate","edit","external-link","file","fill-none","fill-pattern","fill-semi","fill-solid","follow","following","font-draw","font-mono","font-sans","font-serif","geo-arrow-down","geo-arrow-left","geo-arrow-right","geo-arrow-up","geo-check-box","geo-diamond","geo-ellipse","geo-hexagon","geo-octagon","geo-oval","geo-pentagon","geo-rectangle","geo-rhombus-2","geo-rhombus","geo-star","geo-trapezoid","geo-triangle","geo-x-box","github","group","hidden","image","info-circle","leading","link","lock-small","lock","menu","minus","mixed","pack","page","plus","question-mark-circle","question-mark","redo","reset-zoom","rotate-ccw","rotate-cw","ruler","search","send-backward","send-to-back","settings-horizontal","settings-vertical-1","settings-vertical","share-1","share-2","size-extra-large","size-large","size-medium","size-small","spline-cubic","spline-line","stack-horizontal","stack-vertical","stretch-horizontal","stretch-vertical","text-align-center","text-align-justify","text-align-left","text-align-right","tool-arrow","tool-embed","tool-eraser","tool-frame","tool-hand","tool-highlight","tool-laser","tool-line","tool-media","tool-note","tool-pencil","tool-pointer","tool-text","trash","triangle-down","triangle-up","twitter","undo","ungroup","unlock-small","unlock","vertical-align-center","vertical-align-end","vertical-align-start","visible","warning-triangle","zoom-in","zoom-out"];let Bl={...P0,icons:Object.fromEntries(lQ.map(e=>[e,`https://unpkg.com/@tldraw/assets@${Mm}/icons/icon/${e}.svg`])),translations:Object.fromEntries(zc.map(e=>[e.locale,`https://unpkg.com/@tldraw/assets@${Mm}/translations/${e.locale}.json`])),embedIcons:Object.fromEntries(Wa.map(e=>[e.type,`https://unpkg.com/@tldraw/assets@${Mm}/embed-icons/${e.type}.png`]))};function cQ(e){return e?{fonts:Object.assign({...Bl.fonts},{...e==null?void 0:e.fonts}),icons:Object.assign({...Bl.icons},{...e==null?void 0:e.icons}),embedIcons:Object.assign({...Bl.embedIcons},{...e==null?void 0:e.embedIcons}),translations:Object.assign({...Bl.translations},{...e==null?void 0:e.translations})}:Bl}const Mw=w.forwardRef(function({className:n,label:t,icon:r,iconLeft:o,autoselect:s=!1,autofocus:i=!1,defaultValue:a,placeholder:l,onComplete:c,onValueChange:u,onCancel:d,onBlur:h,shouldManuallyMaintainScrollPositionWhenFocused:f=!1,children:p,value:m},y){const x=w.useRef(null);w.useImperativeHandle(y,()=>x.current);const S=we(),b=w.useRef(a??""),P=w.useRef(a??""),[C,_]=w.useState(!1),I=w.useCallback(O=>{_(!0);const z=O.currentTarget;P.current=z.value,requestAnimationFrame(()=>{s&&z.select()})},[s]),k=w.useCallback(O=>{const z=O.currentTarget.value;P.current=z,u==null||u(z)},[u]),T=w.useCallback(O=>{switch(O.key){case"Enter":{O.currentTarget.blur(),O.stopPropagation(),c==null||c(O.currentTarget.value);break}case"Escape":{O.currentTarget.value=b.current,O.currentTarget.blur(),O.stopPropagation(),d==null||d(O.currentTarget.value);break}}},[c,d]),M=w.useCallback(O=>{_(!1);const z=O.currentTarget.value;h==null||h(z)},[h]);return w.useEffect(()=>{const O=window.visualViewport;if(C&&f&&O){const z=()=>{var B;(B=x.current)==null||B.scrollIntoView({block:"center"})};return O.addEventListener("resize",z),O.addEventListener("scroll",z),requestAnimationFrame(()=>{var B;(B=x.current)==null||B.scrollIntoView({block:"center"})}),()=>{O.removeEventListener("resize",z),O.removeEventListener("scroll",z)}}},[C,f]),g.jsxs("div",{draggable:!1,className:"tlui-input__wrapper",children:[p,t&&g.jsx("label",{children:S(t)}),o&&g.jsx(vn,{icon:o,className:"tlui-icon-left",small:!0}),g.jsx("input",{ref:x,className:de("tlui-input",n),type:"text",defaultValue:a,onKeyUp:T,onChange:k,onFocus:I,onBlur:M,autoFocus:i,placeholder:l,value:m}),r&&g.jsx(vn,{icon:r,small:!!t})]})});function AP(e){return k0(e)?{isValid:!0,hasProtocol:!0}:k0("https://"+e)?{isValid:!0,hasProtocol:!1}:{isValid:!1,hasProtocol:!1}}const uQ=me(function({onClose:n}){const r=U().onlySelectedShape;return r&&"url"in r.props&&typeof r.props.url=="string"?g.jsx(dQ,{onClose:n,selectedShape:r}):null}),dQ=me(function({onClose:n,selectedShape:t}){const r=U(),o=we(),s=w.useRef(null);w.useEffect(()=>{requestAnimationFrame(()=>{var p;return(p=s.current)==null?void 0:p.focus()})},[]);const i=w.useRef(t.props.url),[a,l]=w.useState(()=>{const p=AP(t.props.url),m=p.isValid===!0?p.hasProtocol?t.props.url:"https://"+t.props.url:"https://";return{actual:m,safe:m,valid:!0}}),c=w.useCallback(p=>{const m=p.replace(/https?:\/\/(https?:\/\/)/,(S,b)=>b),y=AP(m),x=y.isValid===!0?y.hasProtocol?m:"https://"+m:"https://";l({actual:m,safe:x,valid:y.isValid})},[]),u=w.useCallback(()=>{const{onlySelectedShape:p}=r;p&&(r.updateShapes([{id:p.id,type:p.type,props:{url:""}}]),n())},[r,n]),d=w.useCallback(()=>{const{onlySelectedShape:p}=r;p&&(p&&"url"in p.props&&p.props.url!==a.safe&&r.updateShapes([{id:p.id,type:p.type,props:{url:a.safe}}]),n())},[r,n,a]),h=w.useCallback(()=>{n()},[n]);if(!t)return n(),null;const f=i.current&&!a.valid;return g.jsxs(g.Fragment,{children:[g.jsxs(Ip,{children:[g.jsx(kp,{children:o("edit-link-dialog.title")}),g.jsx($p,{})]}),g.jsx(Zc,{children:g.jsxs("div",{className:"tlui-edit-link-dialog",children:[g.jsx(Mw,{ref:s,className:"tlui-edit-link-dialog__input",label:"edit-link-dialog.url",autofocus:!0,value:a.actual,onValueChange:c,onComplete:d,onCancel:h}),g.jsx("div",{children:a.valid?o("edit-link-dialog.detail"):o("edit-link-dialog.invalid-url")})]})}),g.jsxs(gw,{className:"tlui-dialog__footer__actions",children:[g.jsx(se,{onClick:h,onTouchEnd:h,children:o("edit-link-dialog.cancel")}),f?g.jsx(se,{type:"danger",onTouchEnd:u,onClick:u,children:o("edit-link-dialog.clear")}):g.jsx(se,{type:"primary",disabled:!a.valid,onTouchEnd:d,onClick:d,children:o("edit-link-dialog.save")})]})]})}),k3=me(function({onClose:n}){const t=U(),r=we(),o=pw(),[s,i]=w.useState(null),[a,l]=w.useState(""),[c,u]=w.useState(null),[d,h]=w.useState(!1),f=w.useRef(-1);return g.jsxs(g.Fragment,{children:[g.jsxs(Ip,{children:[g.jsx(kp,{children:s?`${r("embed-dialog.title")}  ${s.title}`:r("embed-dialog.title")}),g.jsx($p,{})]}),s?g.jsxs(g.Fragment,{children:[g.jsxs(Zc,{className:"tlui-embed-dialog__enter",children:[g.jsx(Mw,{className:"tlui-embed-dialog__input",label:"embed-dialog.url",placeholder:"http://example.com",autofocus:!0,onValueChange:p=>{l(p);const m=mo(p);u(m&&m.definition.type===s.type?m:null),h(!1),clearTimeout(f.current),f.current=setTimeout(()=>h(!m),320)}}),a===""?g.jsxs("div",{className:"tlui-embed-dialog__instruction",children:[g.jsx("span",{children:r("embed-dialog.instruction")})," ",s.instructionLink&&g.jsxs("a",{target:"_blank",rel:"noopener noreferrer",href:s.instructionLink,className:"tlui-embed-dialog__instruction__link",children:["Learn more.",g.jsx(vn,{icon:"external-link",small:!0})]})]}):g.jsx("div",{className:"tlui-embed-dialog__warning",children:d?r("embed-dialog.invalid-url"):""})]}),g.jsxs(gw,{className:"tlui-dialog__footer__actions",children:[g.jsx(se,{onClick:()=>{i(null),u(null),l("")},label:"embed-dialog.back"}),g.jsx("div",{className:"tlui-embed__spacer"}),g.jsx(se,{label:"embed-dialog.cancel",onClick:n}),g.jsx(se,{type:"primary",disabled:!c,label:"embed-dialog.create",onClick:()=>{c&&(t.putExternalContent({type:"embed",url:a,point:t.viewportPageCenter,embed:c.definition}),n())}})]})]}):g.jsxs(g.Fragment,{children:[g.jsx(Zc,{className:"tlui-embed-dialog__list",children:Wa.map(p=>g.jsxs("button",{className:"tlui-embed-dialog__item",onClick:()=>i(p),children:[g.jsx("div",{className:"tlui-embed-dialog__item__image",children:g.jsx("div",{className:"tlui-embed-dialog__item__image__img",style:{backgroundImage:`url(${o.embedIcons[p.type]})`}})}),g.jsx("div",{className:"tlui-embed-dialog__item__title",children:p.title})]},p.type))}),g.jsx("div",{className:"tlui-dialog__scrim"})]})]})});var Aw={exports:{}};Aw.exports;(function(e){var n=function(){var t=String.fromCharCode,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",s={};function i(l,c){if(!s[l]){s[l]={};for(var u=0;u<l.length;u++)s[l][l.charAt(u)]=u}return s[l][c]}var a={compressToBase64:function(l){if(l==null)return"";var c=a._compress(l,6,function(u){return r.charAt(u)});switch(c.length%4){default:case 0:return c;case 1:return c+"===";case 2:return c+"==";case 3:return c+"="}},decompressFromBase64:function(l){return l==null?"":l==""?null:a._decompress(l.length,32,function(c){return i(r,l.charAt(c))})},compressToUTF16:function(l){return l==null?"":a._compress(l,15,function(c){return t(c+32)})+" "},decompressFromUTF16:function(l){return l==null?"":l==""?null:a._decompress(l.length,16384,function(c){return l.charCodeAt(c)-32})},compressToUint8Array:function(l){for(var c=a.compress(l),u=new Uint8Array(c.length*2),d=0,h=c.length;d<h;d++){var f=c.charCodeAt(d);u[d*2]=f>>>8,u[d*2+1]=f%256}return u},decompressFromUint8Array:function(l){if(l==null)return a.decompress(l);for(var c=new Array(l.length/2),u=0,d=c.length;u<d;u++)c[u]=l[u*2]*256+l[u*2+1];var h=[];return c.forEach(function(f){h.push(t(f))}),a.decompress(h.join(""))},compressToEncodedURIComponent:function(l){return l==null?"":a._compress(l,6,function(c){return o.charAt(c)})},decompressFromEncodedURIComponent:function(l){return l==null?"":l==""?null:(l=l.replace(/ /g,"+"),a._decompress(l.length,32,function(c){return i(o,l.charAt(c))}))},compress:function(l){return a._compress(l,16,function(c){return t(c)})},_compress:function(l,c,u){if(l==null)return"";var d,h,f={},p={},m="",y="",x="",S=2,b=3,P=2,C=[],_=0,I=0,k;for(k=0;k<l.length;k+=1)if(m=l.charAt(k),Object.prototype.hasOwnProperty.call(f,m)||(f[m]=b++,p[m]=!0),y=x+m,Object.prototype.hasOwnProperty.call(f,y))x=y;else{if(Object.prototype.hasOwnProperty.call(p,x)){if(x.charCodeAt(0)<256){for(d=0;d<P;d++)_=_<<1,I==c-1?(I=0,C.push(u(_)),_=0):I++;for(h=x.charCodeAt(0),d=0;d<8;d++)_=_<<1|h&1,I==c-1?(I=0,C.push(u(_)),_=0):I++,h=h>>1}else{for(h=1,d=0;d<P;d++)_=_<<1|h,I==c-1?(I=0,C.push(u(_)),_=0):I++,h=0;for(h=x.charCodeAt(0),d=0;d<16;d++)_=_<<1|h&1,I==c-1?(I=0,C.push(u(_)),_=0):I++,h=h>>1}S--,S==0&&(S=Math.pow(2,P),P++),delete p[x]}else for(h=f[x],d=0;d<P;d++)_=_<<1|h&1,I==c-1?(I=0,C.push(u(_)),_=0):I++,h=h>>1;S--,S==0&&(S=Math.pow(2,P),P++),f[y]=b++,x=String(m)}if(x!==""){if(Object.prototype.hasOwnProperty.call(p,x)){if(x.charCodeAt(0)<256){for(d=0;d<P;d++)_=_<<1,I==c-1?(I=0,C.push(u(_)),_=0):I++;for(h=x.charCodeAt(0),d=0;d<8;d++)_=_<<1|h&1,I==c-1?(I=0,C.push(u(_)),_=0):I++,h=h>>1}else{for(h=1,d=0;d<P;d++)_=_<<1|h,I==c-1?(I=0,C.push(u(_)),_=0):I++,h=0;for(h=x.charCodeAt(0),d=0;d<16;d++)_=_<<1|h&1,I==c-1?(I=0,C.push(u(_)),_=0):I++,h=h>>1}S--,S==0&&(S=Math.pow(2,P),P++),delete p[x]}else for(h=f[x],d=0;d<P;d++)_=_<<1|h&1,I==c-1?(I=0,C.push(u(_)),_=0):I++,h=h>>1;S--,S==0&&(S=Math.pow(2,P),P++)}for(h=2,d=0;d<P;d++)_=_<<1|h&1,I==c-1?(I=0,C.push(u(_)),_=0):I++,h=h>>1;for(;;)if(_=_<<1,I==c-1){C.push(u(_));break}else I++;return C.join("")},decompress:function(l){return l==null?"":l==""?null:a._decompress(l.length,32768,function(c){return l.charCodeAt(c)})},_decompress:function(l,c,u){var d=[],h=4,f=4,p=3,m="",y=[],x,S,b,P,C,_,I,k={val:u(0),position:c,index:1};for(x=0;x<3;x+=1)d[x]=x;for(b=0,C=Math.pow(2,2),_=1;_!=C;)P=k.val&k.position,k.position>>=1,k.position==0&&(k.position=c,k.val=u(k.index++)),b|=(P>0?1:0)*_,_<<=1;switch(b){case 0:for(b=0,C=Math.pow(2,8),_=1;_!=C;)P=k.val&k.position,k.position>>=1,k.position==0&&(k.position=c,k.val=u(k.index++)),b|=(P>0?1:0)*_,_<<=1;I=t(b);break;case 1:for(b=0,C=Math.pow(2,16),_=1;_!=C;)P=k.val&k.position,k.position>>=1,k.position==0&&(k.position=c,k.val=u(k.index++)),b|=(P>0?1:0)*_,_<<=1;I=t(b);break;case 2:return""}for(d[3]=I,S=I,y.push(I);;){if(k.index>l)return"";for(b=0,C=Math.pow(2,p),_=1;_!=C;)P=k.val&k.position,k.position>>=1,k.position==0&&(k.position=c,k.val=u(k.index++)),b|=(P>0?1:0)*_,_<<=1;switch(I=b){case 0:for(b=0,C=Math.pow(2,8),_=1;_!=C;)P=k.val&k.position,k.position>>=1,k.position==0&&(k.position=c,k.val=u(k.index++)),b|=(P>0?1:0)*_,_<<=1;d[f++]=t(b),I=f-1,h--;break;case 1:for(b=0,C=Math.pow(2,16),_=1;_!=C;)P=k.val&k.position,k.position>>=1,k.position==0&&(k.position=c,k.val=u(k.index++)),b|=(P>0?1:0)*_,_<<=1;d[f++]=t(b),I=f-1,h--;break;case 2:return y.join("")}if(h==0&&(h=Math.pow(2,p),p++),d[I])m=d[I];else if(I===f)m=S+S.charAt(0);else return null;y.push(m),d[f++]=S+m.charAt(0),h--,S=m,h==0&&(h=Math.pow(2,p),p++)}}};return a}();e!=null?e.exports=n:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return n})})(Aw);var $3=Aw.exports;async function hQ(e,n,t){var x,S,b;const{elements:r,files:o}=n,s={shapes:[],rootShapeIds:[],assets:[],schema:e.store.schema.serialize()},i=new Map,a=new Map,{currentPageId:l}=e,c=new Map,u=[],d=new Set;r.forEach(P=>{if(c.set(P.id,Ue()),P.boundElements!==null)for(const C of P.boundElements)C.type==="text"&&d.add(C.id)});let h="a1";for(const P of r){if(d.has(P.id))continue;const C=c.get(P.id),_={id:C,typeName:"shape",parentId:l,index:h,x:P.x,y:P.y,rotation:0,isLocked:P.locked,opacity:fQ(P.opacity),meta:{}};switch(P.angle!==0&&a.set(C,P.angle),P.groupIds&&P.groupIds.length>0?i.has(P.groupIds[0])?(x=i.get(P.groupIds[0]))==null||x.push(C):i.set(P.groupIds[0],[C]):u.push(C),P.type){case"rectangle":case"ellipse":case"diamond":{let I="",k="middle";if(P.boundElements!==null){for(const M of P.boundElements)if(M.type==="text"){const O=r.find(z=>z.id===M.id);O&&(I=O.text,k=OP[O.textAlign])}}const T=P.backgroundColor==="transparent"?P.strokeColor:P.backgroundColor;s.shapes.push({..._,type:"geo",props:{geo:P.type,url:P.link??"",w:P.width,h:P.height,size:jd[P.strokeWidth]??"draw",color:Fl[T]??"black",text:I,align:k,dash:Nd(P),fill:xQ(P)}});break}case"freedraw":{s.shapes.push({..._,type:"draw",props:{dash:Nd(P),size:jd[P.strokeWidth],color:Fl[P.strokeColor]??"black",segments:[{type:"free",points:P.points.map(([I,k,T=.5])=>({x:I,y:k,z:T}))}]}});break}case"line":{const I=P.points[0],k=P.points[P.points.length-1],T=CI(P.points.length);s.shapes.push({..._,type:"line",props:{dash:Nd(P),size:jd[P.strokeWidth],color:Fl[P.strokeColor]??"black",spline:P.roundness?"cubic":"line",handles:{start:{id:"start",type:"vertex",index:T[0],x:I[0],y:I[1]},end:{id:"end",type:"vertex",index:T[T.length-1],x:k[0],y:k[1]},...Object.fromEntries(P.points.slice(1,-1).map(([M,O],z)=>{const B=nt();return[B,{id:B,type:"vertex",index:T[z+1],x:M,y:O}]}))}}});break}case"arrow":{let I="";if(P.boundElements!==null){for(const z of P.boundElements)if(z.type==="text"){const B=r.find(D=>D.id===z.id);B&&(I=B.text)}}const k=P.points[0],T=P.points[P.points.length-1],M=c.get((S=P.startBinding)==null?void 0:S.elementId),O=c.get((b=P.endBinding)==null?void 0:b.elementId);s.shapes.push({..._,type:"arrow",props:{text:I,bend:wQ(P,k,T),dash:Nd(P),size:jd[P.strokeWidth]??"m",color:Fl[P.strokeColor]??"black",start:M?{type:"binding",boundShapeId:M,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:k[0],y:k[1]},end:O?{type:"binding",boundShapeId:O,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:T[0],y:T[1]},arrowheadEnd:RP[P.endArrowhead]??"none",arrowheadStart:RP[P.startArrowhead]??"none"}});break}case"text":{const{size:I,scale:k}=gQ(P.fontSize);s.shapes.push({..._,type:"text",props:{size:I,scale:k,font:mQ[P.fontFamily]??"draw",color:Fl[P.strokeColor]??"black",text:P.text,align:OP[P.textAlign]}});break}case"image":{const I=o[P.fileId];if(!I)break;const k=Oa.createId();s.assets.push({id:k,typeName:"asset",type:"image",props:{w:P.width,h:P.height,name:P.id??"Untitled",isAnimated:!1,mimeType:I.mimeType,src:I.dataURL},meta:{}}),s.shapes.push({..._,type:"image",props:{w:P.width,h:P.height,assetId:k}})}}h=po(h)}const f=t??(e.inputs.shiftKey?e.inputs.currentPagePoint:void 0);e.mark("paste"),e.putContent(s,{point:f,select:!1,preserveIds:!0});for(const P of i.values())if(P.length>1){e.groupShapes(P);const C=e.getShapeById(P[0]);C!=null&&C.parentId&&Wn(C.parentId)&&u.push(C.parentId)}for(const[P,C]of a)e.select(P),e.rotateShapesBy([P],C);const p=he(u.map(P=>e.getShapeById(P))),m=ne.Common(p.map(P=>e.getPageBounds(P))),y=e.viewportPageBounds.center;e.updateShapes(p.map(P=>{const C={x:(P.x??0)-(m.x+m.w/2),y:(P.y??0)-(m.y+m.h/2)};return{id:P.id,type:P.type,x:y.x+C.x,y:y.y+C.y}})),e.setSelectedIds(u)}const fQ=e=>{const n=e/100;return n<.2?.1:n<.4?.25:n<.6?.5:n<.8?.75:1},jd={1:"s",2:"m",3:"l",4:"xl"},pQ={16:"s",20:"m",28:"l",36:"xl"};function gQ(e){const n=pQ[e];return n?{size:n,scale:1}:e<16?{size:"s",scale:e/16}:e>36?{size:"xl",scale:e/36}:{size:"m",scale:1}}const mQ={1:"draw",2:"sans",3:"mono"},Fl={"#ffffff":"grey","#000000":"black","#343a40":"black","#495057":"grey","#c92a2a":"red","#a61e4d":"light-red","#862e9c":"violet","#5f3dc4":"light-violet","#364fc7":"blue","#1864ab":"light-blue","#0b7285":"light-green","#087f5b":"light-green","#2b8a3e":"green","#5c940d":"light-green","#e67700":"yellow","#d9480f":"orange","#ced4da":"grey","#868e96":"grey","#fa5252":"light-red","#e64980":"red","#be4bdb":"light-violet","#7950f2":"violet","#4c6ef5":"blue","#228be6":"light-blue","#15aabf":"light-green","#12b886":"green","#40c057":"green","#82c91e":"light-green","#fab005":"yellow","#fd7e14":"orange","#212529":"grey"},yQ={solid:"draw",dashed:"dashed",dotted:"dotted"},vQ={"cross-hatch":"pattern",hachure:"pattern",solid:"solid"},OP={left:"start",center:"middle",right:"end"},RP={arrow:"arrow",dot:"dot",triangle:"triangle",bar:"pipe"};function wQ(e,n,t){let r=0;if(e.points.length>2){const o=new E(n[0],n[1]),s=new E(t[0],t[1]),i=new E(e.points[1][0],e.points[1][1]),a=E.Sub(s,o),l=E.Per(a),c=E.Med(s,o),u=E.Sub(c,l),d=E.Add(c,l),h=E.NearestPointOnLineSegment(u,d,i,!1);r=E.Dist(h,c),E.Clockwise(h,s,c)&&(r*=-1)}return r}const Nd=e=>{let n=yQ[e.strokeStyle]??"draw";return n==="draw"&&e.roughness===0&&(n="solid"),n},xQ=e=>e.backgroundColor==="transparent"?"none":vQ[e.fillStyle]??"solid";async function T3(e,n,t){const o=(await Promise.all(n.map(async s=>await(await fetch(s)).blob()))).map(s=>new File([s],"tldrawFile",{type:s.type}));e.mark("paste"),await e.putExternalContent({type:"files",files:o,point:t,ignoreParent:!1}),n.forEach(s=>URL.revokeObjectURL(s))}function SQ(e,n,t){const r=t??(e.inputs.shiftKey?e.inputs.currentPagePoint:void 0);e.mark("paste"),e.putContent(n,{point:r,select:!0})}async function G0(e,n,t){var r;try{if((r=(await fetch(n)).headers.get("content-type"))!=null&&r.match(/^image\//)){e.mark("paste"),T3(e,[n]);return}}catch(o){o.message!=="Failed to fetch"&&console.error(o)}return e.mark("paste"),await e.putExternalContent({type:"url",point:t,url:n})}function M3(){const e=U();return J("editor.isFocused",()=>e.isFocused,[e])}const bQ=["input","select","textarea"];function Ih(e){const{activeElement:n}=document;return e.isMenuOpen||n&&(n.getAttribute("contenteditable")||bQ.indexOf(n.tagName.toLowerCase())>-1)}async function Am(e){return new Promise((n,t)=>{const r=new FileReader;r.addEventListener("loadend",()=>{const o=r.result;n(o)}),r.addEventListener("error",()=>{t(r.error)}),r.readAsText(e)})}function PQ(e){const n=document.implementation.createHTMLDocument("");return n.documentElement.innerHTML=e.trim(),n.body.textContent||n.body.innerText||""}const EQ=e=>e.types.find(n=>n.match(/^image\//)),Om=(e,n,t)=>{const r=nV(n);if(r)for(const o of r)G0(e,o,t);else tV(n)?G0(e,n,t):rV(n)?(e.mark("paste"),e.putExternalContent({type:"svg-text",text:n,point:t})):(e.mark("paste"),e.putExternalContent({type:"text",text:n,point:t}))},_Q=async(e,n,t)=>{if(e.editingId!==null)return;if(!n)throw Error("No clipboard data");const r=[];for(const o of Object.values(n.items))switch(o.kind){case"file":{r.push({type:"file",source:new Promise(s=>s(o.getAsFile()))});break}case"string":{o.type==="text/html"?r.push({type:"html",source:new Promise(s=>o.getAsString(s))}):o.type==="text/plain"?r.push({type:"text",source:new Promise(s=>o.getAsString(s))}):r.push({type:o.type,source:new Promise(s=>o.getAsString(s))});break}}O3(e,r,t)},A3=async(e,n,t)=>{const r=[];for(const o of n){if(EQ(o))for(const s of o.types)s.match(/^image\//)&&r.push({type:"blob",source:o.getType(s)});o.types.includes("text/html")&&r.push({type:"html",source:new Promise(s=>o.getType("text/html").then(i=>Am(i).then(s)))}),o.types.includes("text/uri-list")&&r.push({type:"url",source:new Promise(s=>o.getType("text/uri-list").then(i=>Am(i).then(s)))}),o.types.includes("text/plain")&&r.push({type:"text",source:new Promise(s=>o.getType("text/plain").then(i=>Am(i).then(s)))})}return await O3(e,r,t)};async function O3(e,n,t){const r=n.filter(s=>(s.type==="file"||s.type==="blob")&&s.source!==null);if(r.length){const i=(await Promise.all(r.map(a=>a.source))).filter(Boolean).map(a=>URL.createObjectURL(a));return await T3(e,i,t)}const o=await Promise.all(n.filter(s=>s.type!=="file").map(s=>new Promise(i=>{const a=s;if(a.type==="file"){i({type:"error",data:null,reason:"unexpected file"});return}a.source.then(l=>{var u;const c=(u=l.match(/<tldraw[^>]*>(.*)<\/tldraw>/))==null?void 0:u[1];if(c)try{const d=$3.decompressFromBase64(c);if(d===null){i({type:"error",data:d,reason:"found tldraw data comment but could not parse base64"});return}else{const h=JSON.parse(d);if(h.type!=="application/tldraw"&&i({type:"error",data:h,reason:`found tldraw data comment but JSON was of a different type: ${h.type}`}),typeof h.data=="string"){i({type:"error",data:h,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}i({type:"tldraw",data:h.data});return}}catch{i({type:"error",data:c,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}else{if(a.type==="html"){i({type:"text",data:l,subtype:"html"});return}if(a.type==="url"){i({type:"text",data:l,subtype:"url"});return}try{const d=JSON.parse(l);if(d.type==="excalidraw/clipboard"){i({type:"excalidraw",data:d});return}else{i({type:"text",data:l,subtype:"json"});return}}catch{i({type:"text",data:l,subtype:"text"});return}}i({type:"error",data:l,reason:"unhandled case"})})})));for(const s of o)if(s.type==="tldraw"){SQ(e,s.data,t);return}for(const s of o)if(s.type==="excalidraw"){hQ(e,s.data,t);return}for(const s of o)if(s.type==="text"&&s.subtype==="html"){const a=new DOMParser().parseFromString(s.data,"text/html").querySelector("body");if(a&&Array.from(a.children).filter(c=>c.nodeType===1).length===1&&a.firstElementChild&&a.firstElementChild.tagName==="A"&&a.firstElementChild.hasAttribute("href")&&a.firstElementChild.getAttribute("href")!==""){const c=a.firstElementChild.getAttribute("href");Om(e,c,t);return}if(!o.some(c=>c.type==="text"&&c.subtype!=="html")&&s.data.trim()){Om(e,PQ(s.data),t);return}}for(const s of o)if(s.type==="text"&&s.subtype==="url"){G0(e,s.data,t);return}for(const s of o)if(s.type==="text"&&s.subtype==="text"&&s.data.trim()){Om(e,s.data,t);return}}const Af=e=>{var r;const n=e.getContent();if(!n){navigator&&navigator.clipboard&&navigator.clipboard.writeText("");return}const t=$3.compressToBase64(JSON.stringify({type:"application/tldraw",kind:"content",data:n}));if(!(typeof navigator>"u")){const o=n.shapes.map(s=>e.isShapeOfType(s,Mr)||e.isShapeOfType(s,cl)||e.isShapeOfType(s,Fe)?s.props.text:e.isShapeOfType(s,Cu)||e.isShapeOfType(s,Is)?s.props.url:null).filter(jj);if((r=navigator.clipboard)!=null&&r.write){const s=new Blob([`<tldraw>${t}</tldraw>`],{type:"text/html"});let i=o.join(" ");i===""&&(i=" "),navigator.clipboard.write([new ClipboardItem({"text/html":s,"text/plain":new Blob([i],{type:"text/plain"})})])}else navigator.clipboard.writeText&&navigator.clipboard.writeText(`<tldraw>${t}</tldraw>`)}};function CQ(){const e=U(),n=hl(),t=w.useCallback(function(i){e.selectedIds.length!==0&&(Af(e),n("copy",{source:i}))},[e,n]),r=w.useCallback(function(i){e.selectedIds.length!==0&&(Af(e),e.deleteShapes(),n("cut",{source:i}))},[e,n]),o=w.useCallback(async function(i,a,l){e.editingId!==null||Ih(e)||(Array.isArray(i)&&i[0]instanceof ClipboardItem?(A3(e,i,l),n("paste",{source:"menu"})):navigator.clipboard.read().then(c=>{o(c,a,l)}))},[e,n]);return{copy:t,cut:r,paste:o}}function IQ(){const e=U(),n=hl(),t=M3();w.useEffect(()=>{if(!t)return;const r=()=>{e.selectedIds.length===0||e.editingId!==null||Ih(e)||(Af(e),n("copy",{source:"kbd"}))};function o(){e.selectedIds.length===0||e.editingId!==null||Ih(e)||(Af(e),e.deleteShapes(),n("cut",{source:"kbd"}))}let s=!1;const i=l=>{l.button===1&&(s=!0,requestAnimationFrame(()=>{s=!1}))},a=l=>{if(s){l.stopPropagation();return}e.editingId!==null||Ih(e)||(l.clipboardData&&!e.inputs.shiftKey?_Q(e,l.clipboardData):navigator.clipboard.read().then(c=>{Array.isArray(c)&&c[0]instanceof ClipboardItem&&A3(e,c,e.inputs.currentPagePoint)}),n("paste",{source:"kbd"}))};return document.addEventListener("copy",r),document.addEventListener("cut",o),document.addEventListener("paste",a),document.addEventListener("pointerup",i),()=>{document.removeEventListener("copy",r),document.removeEventListener("cut",o),document.removeEventListener("paste",a),document.removeEventListener("pointerup",i)}},[e,n,t])}const R3=w.createContext({});function kQ({children:e}){const[n,t]=w.useState([]),r=w.useCallback(i=>{const a=i.id??nt();return t(l=>[...l.filter(c=>c.id!==i.id),{...i,id:a}]),a},[]),o=w.useCallback(i=>(t(a=>a.filter(l=>l.id!==i)),i),[]),s=w.useCallback(()=>{t(()=>[])},[]);return g.jsx(R3.Provider,{value:{toasts:n,addToast:r,removeToast:o,clearToasts:s},children:e})}function no(){const e=w.useContext(R3);if(!e)throw new Error("useToasts must be used within a ToastsProvider");return e}function $Q(){const e=U(),{addToast:n}=no(),t=we();return w.useCallback(function(o=e.selectedIds,s="svg"){if(o.length===0&&(o=[...e.currentPageShapeIds]),o.length!==0)switch(s){case"svg":{window.navigator.clipboard&&(window.navigator.clipboard.write?window.navigator.clipboard.write([new ClipboardItem({"text/plain":TQ(e,o)})]):DP(async()=>G$(await Ow(e,o))));break}case"jpeg":case"png":{const i=s==="jpeg"?"image/jpeg":"image/png",a=MQ(e,o,s).then(l=>{if(l){if(window.navigator.clipboard)return l;throw new Error("Copy not supported")}else throw n({id:"copy-fail",icon:"warning-triangle",title:t("toast.error.copy-fail.title"),description:t("toast.error.copy-fail.desc")}),new Error("Copy not possible")});window.navigator.clipboard.write([new ClipboardItem({[i]:a})]).catch(l=>{l.toString().match(/^TypeError: DOMString not supported/)||console.error(l),a.then(c=>{window.navigator.clipboard.write([new ClipboardItem({[i]:c})])})});break}case"json":{const i=e.getContent(o);if(window.navigator.clipboard){const a=JSON.stringify(i);window.navigator.clipboard.write?window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"})})]):DP(async()=>a)}break}default:throw new Error(`Copy type ${s} not supported.`)}},[e,n,t])}async function Ow(e,n){const t=await e.getSvg(n,{scale:1,background:e.instanceState.exportBackground});if(!t)throw new Error("Could not construct SVG.");return t}async function TQ(e,n){return new Blob([G$(await Ow(e,n))],{type:"text/plain"})}async function MQ(e,n,t){return await q$(await Ow(e,n),{type:t,quality:1,scale:2})}async function DP(e){navigator&&navigator.clipboard&&navigator.clipboard.writeText(await e())}const D3=w.createContext({});function AQ({children:e}){const n=U(),t=hl(),[r,o]=w.useState([]),s=w.useCallback(c=>{const u=c.id??nt();return o(d=>[...d.filter(h=>h.id!==c.id),{...c,id:u}]),t("open-menu",{source:"dialog",id:u}),n.addOpenMenu(u),u},[n,t]),i=w.useCallback((c,u)=>(o(d=>d.map(h=>h.id===c?{...h,...u}:h)),t("open-menu",{source:"dialog",id:c}),n.addOpenMenu(c),c),[n,t]),a=w.useCallback(c=>(o(u=>u.filter(d=>{var h;return d.id===c?((h=d.onClose)==null||h.call(d),!1):!0})),t("close-menu",{source:"dialog",id:c}),n.deleteOpenMenu(c),c),[n,t]),l=w.useCallback(()=>{o(c=>(c.forEach(u=>{var d;(d=u.onClose)==null||d.call(u),t("close-menu",{source:"dialog",id:u.id}),n.deleteOpenMenu(u.id)}),[]))},[n,t]);return g.jsx(D3.Provider,{value:{dialogs:r,addDialog:s,removeDialog:a,clearDialogs:l,updateDialog:i},children:e})}function zi(){const e=w.useContext(D3);if(!e)throw new Error("useDialogs must be used within a DialogsProvider");return e}function OQ(){const e=U(),{addToast:n}=no(),t=we();return w.useCallback(async function(o=e.selectedIds,s="png"){if(o.length===0&&(o=[...e.currentPageShapeIds]),o.length===0)return;const i=await e.getSvg(o,{scale:1,background:e.instanceState.exportBackground});if(!i)throw new Error("Could not construct SVG.");let a="shapes";if(o.length===1){const l=e.getShapeById(o[0]);e.isShapeOfType(l,kt)?a=l.props.name??"frame":a=l.id.replace(/:/,"_")}switch(s){case"svg":{const l=await Q$(i);bm(l,`${a||"shapes"}.svg`);return}case"webp":case"png":{const l=await q$(i,{type:s,quality:1,scale:2});if(!l){n({id:"export-fail",title:t("toast.error.export-fail.title"),description:t("toast.error.export-fail.desc")});return}const c=URL.createObjectURL(l);bm(c,`${a||"shapes"}.${s}`),URL.revokeObjectURL(c);return}case"json":{const l=e.getContent(o),c=URL.createObjectURL(new Blob([JSON.stringify(l,null,4)],{type:"application/json"}));bm(c,`${a||"shapes"}.json`),URL.revokeObjectURL(c);return}default:throw new Error(`Export type ${s} not supported.`)}},[e,n,t])}function L3(){const e=U(),n=w.useRef();return w.useEffect(()=>{const t=window.document.createElement("input");t.type="file",t.accept=XH,t.multiple=!0,n.current=t;async function r(o){const s=o.target.files;!s||s.length===0||(await e.putExternalContent({type:"files",files:Array.from(s),point:e.viewportPageBounds.center,ignoreParent:!1}),t.value="")}return t.addEventListener("change",r),()=>{n.current=void 0,t.removeEventListener("change",r)}},[e]),w.useCallback(()=>{var t;(t=n.current)==null||t.click()},[n])}function RQ(){const e=U(),n=w.useRef(null),t=w.useRef(null);return w.useCallback(async function(){const o=document.createElement("div"),s=document.createElement("style"),i=(x,S)=>{x&&(x.innerHTML=""),S&&document.head.contains(S)&&document.head.removeChild(S),x&&document.body.contains(x)&&document.body.removeChild(x)};i(n.current,t.current),n.current=o,t.current=s;const a=`tl-print-surface-${nt()}`;o.className=a,s.innerHTML=`
			.${a} {
				display: none;
			}

			.${a} svg {
				max-width: 100%;
				height: 100%;
				display: block;
			}

			@media print {				  
				html, body {
					min-height: 100%;
					height: 100%;
					margin: 0;
				}

				body {
					position: relative;
				}

				body > * {
					display: none;
				}

				.${a} {
					display: block !important;
					background: white;
					min-height: 100%;
					height: 100%;
					max-width: 100%;
				}

				.${a}__item {
					padding: 10mm;
					display: flex;
					min-height: 100%;
					flex-direction: column;
					page-break-after: always;
					position: relative;
					overflow: hidden;
					height: 100%;
				}

				.${a}__item__main {
					flex: 1;
					display: flex;
					align-items: center;
					justify-content: center;
					max-height: 100%;
				}

				.${a}__item__header {
					display: none;
				}

				.${a}__item__footer {
					display: none;
					text-align: right;
				}

				.${a}__item__footer__hide {
					display: none;
				}

				
			}

		`;const l=()=>{document.head.appendChild(s),document.body.appendChild(o)},c=()=>{e.once("change-history",()=>{i(o,s)})};window.addEventListener("beforeprint",l),window.addEventListener("afterprint",c);function u(x,S,b){try{o.innerHTML+=`<div class="${a}__item">
        <div class="${a}__item__header">
          ${x.replace(/</g,"&lt;").replace(/>/g,"&gt;")}
        </div>
        <div class="${a}__item__main">
          ${b.outerHTML}
        </div>
        <div class="${a}__item__footer ${a}__item__footer__${S?"":"hide"}">
          ${S??""}
        </div>
      </div>`}catch(P){console.error(P)}}function d(){e.isChromeForIos?(l(),window.print()):e.isSafari?(l(),document.execCommand("print",!1)):window.print()}const{pages:h,currentPageId:f,selectedIds:p}=e,y={scale:1,background:!1,darkMode:!1,preserveAspectRatio:"xMidYMid meet"};if(e.selectedIds.length>0){const x=await e.getSvg(p,y);if(x){const S=h.find(b=>b.id===f);u(`tldraw  ${S==null?void 0:S.name}`,null,x),d()}}else{const x=e.currentPage,S=await e.getSvg(e.getSortedChildIds(x.id),y);S&&(u(`tldraw  ${x.name}`,null,S),d())}window.removeEventListener("beforeprint",l),window.removeEventListener("afterprint",c)},[e])}const j3=w.createContext({});function DQ(e){return Object.fromEntries(e.map(n=>[n.id,n]))}function LQ({overrides:e,children:n}){const t=U(),{addDialog:r,clearDialogs:o}=zi(),{clearToasts:s}=no(),i=L3(),a=RQ(),{cut:l,copy:c,paste:u}=CQ(),d=$Q(),h=OQ(),f=hl(),p=w.useMemo(()=>{const m=DQ([{id:"edit-link",label:"action.edit-link",icon:"link",readonlyOk:!1,onSelect(y){f("edit-link",{source:y}),t.mark("edit-link"),r({component:uQ})}},{id:"insert-embed",label:"action.insert-embed",readonlyOk:!1,kbd:"$i",onSelect(y){f("insert-embed",{source:y}),r({component:k3})}},{id:"insert-media",label:"action.insert-media",kbd:"$u",readonlyOk:!1,onSelect(y){f("insert-media",{source:y}),i()}},{id:"undo",label:"action.undo",icon:"undo",kbd:"$z",readonlyOk:!1,onSelect(y){f("undo",{source:y}),t.undo()}},{id:"redo",label:"action.redo",icon:"redo",kbd:"$!z",readonlyOk:!1,onSelect(y){f("redo",{source:y}),t.redo()}},{id:"export-as-svg",label:"action.export-as-svg",menuLabel:"action.export-as-svg.short",contextMenuLabel:"action.export-as-svg.short",readonlyOk:!0,onSelect(y){f("export-as",{format:"svg",source:y}),h(t.selectedIds,"svg")}},{id:"export-as-png",label:"action.export-as-png",menuLabel:"action.export-as-png.short",contextMenuLabel:"action.export-as-png.short",readonlyOk:!0,onSelect(y){f("export-as",{format:"png",source:y}),h(t.selectedIds,"png")}},{id:"export-as-json",label:"action.export-as-json",menuLabel:"action.export-as-json.short",contextMenuLabel:"action.export-as-json.short",readonlyOk:!0,onSelect(y){f("export-as",{format:"json",source:y}),h(t.selectedIds,"json")}},{id:"copy-as-svg",label:"action.copy-as-svg",menuLabel:"action.copy-as-svg.short",contextMenuLabel:"action.copy-as-svg.short",kbd:"$!c",readonlyOk:!0,onSelect(y){f("copy-as",{format:"svg",source:y}),d(t.selectedIds,"svg")}},{id:"copy-as-png",label:"action.copy-as-png",menuLabel:"action.copy-as-png.short",contextMenuLabel:"action.copy-as-png.short",readonlyOk:!0,onSelect(y){f("copy-as",{format:"png",source:y}),d(t.selectedIds,"png")}},{id:"copy-as-json",label:"action.copy-as-json",menuLabel:"action.copy-as-json.short",contextMenuLabel:"action.copy-as-json.short",readonlyOk:!0,onSelect(y){f("copy-as",{format:"json",source:y}),d(t.selectedIds,"json")}},{id:"toggle-auto-size",label:"action.toggle-auto-size",readonlyOk:!1,onSelect(y){f("toggle-auto-size",{source:y}),t.mark(),t.updateShapes(t.selectedShapes.filter(x=>t.isShapeOfType(x,Mr)&&x.props.autoSize===!1).map(x=>({id:x.id,type:x.type,props:{...x.props,w:8,autoSize:!0}})))}},{id:"open-embed-link",label:"action.open-embed-link",readonlyOk:!0,onSelect(y){f("open-embed-link",{source:y});const x=t.selectedIds,S="No embed shapes selected";if(x.length!==1){console.error(S);return}const b=t.getShapeById(x[0]);if(!b||!t.isShapeOfType(b,Is)){console.error(S);return}GW(b.props.url,"_blank")}},{id:"convert-to-bookmark",label:"action.convert-to-bookmark",readonlyOk:!1,onSelect(y){f("convert-to-bookmark",{source:y});const x=t.selectedShapes,S=[],b=[];for(const P of x){if(!P||!t.isShapeOfType(P,Is)||!P.props.url)continue;const C=new E(P.x,P.y);C.rot(-P.rotation),C.add(new E(P.props.w/2-150,P.props.h/2-160)),C.rot(P.rotation),S.push({id:Ue(),type:"bookmark",rotation:P.rotation,x:C.x,y:C.y,props:{url:P.props.url,opacity:"1"}}),b.push(P.id)}t.mark("convert shapes to bookmark"),t.deleteShapes(b),t.createShapes(S)}},{id:"convert-to-embed",label:"action.convert-to-embed",readonlyOk:!1,onSelect(y){f("convert-to-embed",{source:y});const x=t.selectedIds,S=he(x.map(C=>t.getShapeById(C))),b=[],P=[];for(const C of S){if(!t.isShapeOfType(C,Cu))continue;const{url:_}=C.props,I=mo(C.props.url);if(!I||!I.definition)continue;const{width:k,height:T}=I.definition,M=new E(C.x,C.y);M.rot(-C.rotation),M.add(new E(C.props.w/2-k/2,C.props.h/2-T/2)),M.rot(C.rotation);const O={id:Ue(),type:"embed",x:M.x,y:M.y,rotation:C.rotation,props:{url:_,w:k,h:T}};b.push(O),P.push(C.id)}t.mark("convert shapes to embed"),t.deleteShapes(P),t.createShapes(b)}},{id:"duplicate",kbd:"$d",label:"action.duplicate",icon:"duplicate",readonlyOk:!1,onSelect(y){if(t.currentToolId!=="select")return;f("duplicate-shapes",{source:y});const x=t.selectedIds,S=ne.Common(he(x.map(P=>t.getPageBoundsById(P)))),b=t.canMoveCamera?{x:S.width+10,y:0}:{x:16/t.zoomLevel,y:16/t.zoomLevel};t.mark("duplicate shapes"),t.duplicateShapes(x,b)}},{id:"ungroup",label:"action.ungroup",kbd:"$!g",icon:"ungroup",readonlyOk:!1,onSelect(y){f("ungroup-shapes",{source:y}),t.mark("ungroup"),t.ungroupShapes(t.selectedIds)}},{id:"group",label:"action.group",kbd:"$g",icon:"group",readonlyOk:!1,onSelect(y){f("group-shapes",{source:y});const{onlySelectedShape:x}=t;x&&t.isShapeOfType(x,Ye)?(t.mark("ungroup"),t.ungroupShapes(t.selectedIds)):(t.mark("group"),t.groupShapes(t.selectedIds))}},{id:"align-left",label:"action.align-left",kbd:"?A",icon:"align-left",readonlyOk:!1,onSelect(y){f("align-shapes",{operation:"left",source:y}),t.mark("align left"),t.alignShapes("left",t.selectedIds)}},{id:"align-center-horizontal",label:"action.align-center-horizontal",contextMenuLabel:"action.align-center-horizontal.short",kbd:"?H",icon:"align-center-horizontal",readonlyOk:!1,onSelect(y){f("align-shapes",{operation:"center-horizontal",source:y}),t.mark("align center horizontal"),t.alignShapes("center-horizontal",t.selectedIds)}},{id:"align-right",label:"action.align-right",kbd:"?D",icon:"align-right",readonlyOk:!1,onSelect(y){f("align-shapes",{operation:"right",source:y}),t.mark("align right"),t.alignShapes("right",t.selectedIds)}},{id:"align-center-vertical",label:"action.align-center-vertical",contextMenuLabel:"action.align-center-vertical.short",kbd:"?V",icon:"align-center-vertical",readonlyOk:!1,onSelect(y){f("align-shapes",{operation:"center-vertical",source:y}),t.mark("align center vertical"),t.alignShapes("center-vertical",t.selectedIds)}},{id:"align-top",label:"action.align-top",icon:"align-top",kbd:"?W",readonlyOk:!1,onSelect(y){f("align-shapes",{operation:"top",source:y}),t.mark("align top"),t.alignShapes("top",t.selectedIds)}},{id:"align-bottom",label:"action.align-bottom",icon:"align-bottom",kbd:"?S",readonlyOk:!1,onSelect(y){f("align-shapes",{operation:"bottom",source:y}),t.mark("align bottom"),t.alignShapes("bottom",t.selectedIds)}},{id:"distribute-horizontal",label:"action.distribute-horizontal",contextMenuLabel:"action.distribute-horizontal.short",icon:"distribute-horizontal",kbd:"?!h",readonlyOk:!1,onSelect(y){f("distribute-shapes",{operation:"horizontal",source:y}),t.mark("distribute horizontal"),t.distributeShapes("horizontal",t.selectedIds)}},{id:"distribute-vertical",label:"action.distribute-vertical",contextMenuLabel:"action.distribute-vertical.short",icon:"distribute-vertical",kbd:"?!V",readonlyOk:!1,onSelect(y){f("distribute-shapes",{operation:"vertical",source:y}),t.mark("distribute vertical"),t.distributeShapes("vertical",t.selectedIds)}},{id:"stretch-horizontal",label:"action.stretch-horizontal",contextMenuLabel:"action.stretch-horizontal.short",icon:"stretch-horizontal",readonlyOk:!1,onSelect(y){f("stretch-shapes",{operation:"horizontal",source:y}),t.mark("stretch horizontal"),t.stretchShapes("horizontal",t.selectedIds)}},{id:"stretch-vertical",label:"action.stretch-vertical",contextMenuLabel:"action.stretch-vertical.short",icon:"stretch-vertical",readonlyOk:!1,onSelect(y){f("stretch-shapes",{operation:"vertical",source:y}),t.mark("stretch vertical"),t.stretchShapes("vertical",t.selectedIds)}},{id:"flip-horizontal",label:"action.flip-horizontal",contextMenuLabel:"action.flip-horizontal.short",kbd:"!h",readonlyOk:!1,onSelect(y){f("flip-shapes",{operation:"horizontal",source:y}),t.mark("flip horizontal"),t.flipShapes("horizontal",t.selectedIds)}},{id:"flip-vertical",label:"action.flip-vertical",contextMenuLabel:"action.flip-vertical.short",kbd:"!v",readonlyOk:!1,onSelect(y){f("flip-shapes",{operation:"vertical",source:y}),t.mark("flip vertical"),t.flipShapes("vertical",t.selectedIds)}},{id:"pack",label:"action.pack",icon:"pack",readonlyOk:!1,onSelect(y){f("pack-shapes",{source:y}),t.mark("pack"),t.packShapes(t.selectedIds)}},{id:"stack-vertical",label:"action.stack-vertical",contextMenuLabel:"action.stack-vertical.short",icon:"stack-vertical",readonlyOk:!1,onSelect(y){f("stack-shapes",{operation:"vertical",source:y}),t.mark("stack-vertical"),t.stackShapes("vertical",t.selectedIds)}},{id:"stack-horizontal",label:"action.stack-horizontal",contextMenuLabel:"action.stack-horizontal.short",icon:"stack-horizontal",readonlyOk:!1,onSelect(y){f("stack-shapes",{operation:"horizontal",source:y}),t.mark("stack-horizontal"),t.stackShapes("horizontal",t.selectedIds)}},{id:"bring-to-front",label:"action.bring-to-front",kbd:"]",icon:"bring-to-front",readonlyOk:!1,onSelect(y){f("reorder-shapes",{operation:"toFront",source:y}),t.mark("bring to front"),t.bringToFront()}},{id:"bring-forward",label:"action.bring-forward",icon:"bring-forward",kbd:"?]",readonlyOk:!1,onSelect(y){f("reorder-shapes",{operation:"forward",source:y}),t.mark("bring forward"),t.bringForward()}},{id:"send-backward",label:"action.send-backward",icon:"send-backward",kbd:"?[",readonlyOk:!1,onSelect(y){f("reorder-shapes",{operation:"backward",source:y}),t.mark("send backward"),t.sendBackward()}},{id:"send-to-back",label:"action.send-to-back",icon:"send-to-back",kbd:"[",readonlyOk:!1,onSelect(y){f("reorder-shapes",{operation:"toBack",source:y}),t.mark("send to back"),t.sendToBack()}},{id:"cut",label:"action.cut",kbd:"$x",readonlyOk:!1,onSelect(y){t.mark("cut"),l(y)}},{id:"copy",label:"action.copy",kbd:"$c",readonlyOk:!0,onSelect(y){c(y)}},{id:"paste",label:"action.paste",kbd:"$v",readonlyOk:!1,onSelect(y){var x;(x=navigator.clipboard)==null||x.read().then(S=>{u(S,y,y==="context-menu"?t.inputs.currentPagePoint:void 0)})}},{id:"select-all",label:"action.select-all",kbd:"$a",readonlyOk:!0,onSelect(y){f("select-all-shapes",{source:y}),t.currentToolId!=="select"&&(t.cancel(),t.setSelectedTool("select")),t.mark("select all kbd"),t.selectAll()}},{id:"select-none",label:"action.select-none",readonlyOk:!0,onSelect(y){f("select-none-shapes",{source:y}),t.mark("select none"),t.selectNone()}},{id:"delete",label:"action.delete",kbd:",del,backspace",icon:"trash",readonlyOk:!1,onSelect(y){t.currentToolId==="select"&&(f("delete-shapes",{source:y}),t.mark("delete"),t.deleteShapes())}},{id:"rotate-cw",label:"action.rotate-cw",icon:"rotate-cw",readonlyOk:!1,onSelect(y){if(t.selectedIds.length===0)return;f("rotate-cw",{source:y}),t.mark("rotate-cw");const x=t.selectionRotation%(_e/2),S=dc(x,0)||dc(x,_e/2);t.rotateShapesBy(t.selectedIds,_e/2-(S?0:x))}},{id:"rotate-ccw",label:"action.rotate-ccw",icon:"rotate-ccw",readonlyOk:!1,onSelect(y){if(t.selectedIds.length===0)return;f("rotate-ccw",{source:y}),t.mark("rotate-ccw");const x=t.selectionRotation%(_e/2),S=dc(x,0);t.rotateShapesBy(t.selectedIds,S?-(_e/2):-x)}},{id:"zoom-in",label:"action.zoom-in",kbd:"$=,=",readonlyOk:!0,onSelect(y){f("zoom-in",{source:y}),t.zoomIn(t.viewportScreenCenter,{duration:go})}},{id:"zoom-out",label:"action.zoom-out",kbd:"$-,-",readonlyOk:!0,onSelect(y){f("zoom-out",{source:y}),t.zoomOut(t.viewportScreenCenter,{duration:go})}},{id:"zoom-to-100",label:"action.zoom-to-100",icon:"reset-zoom",kbd:"!0",readonlyOk:!0,onSelect(y){f("reset-zoom",{source:y}),t.resetZoom(t.viewportScreenCenter,{duration:go})}},{id:"zoom-to-fit",label:"action.zoom-to-fit",kbd:"!1",readonlyOk:!0,onSelect(y){f("zoom-to-fit",{source:y}),t.zoomToFit({duration:go})}},{id:"zoom-to-selection",label:"action.zoom-to-selection",kbd:"!2",readonlyOk:!0,onSelect(y){f("zoom-to-selection",{source:y}),t.zoomToSelection({duration:go})}},{id:"toggle-snap-mode",label:"action.toggle-snap-mode",menuLabel:"action.toggle-snap-mode.menu",readonlyOk:!1,onSelect(y){f("toggle-snap-mode",{source:y}),t.setSnapMode(!t.isSnapMode)},checkbox:!0},{id:"toggle-dark-mode",label:"action.toggle-dark-mode",menuLabel:"action.toggle-dark-mode.menu",kbd:"$/",readonlyOk:!0,onSelect(y){f("toggle-dark-mode",{source:y}),t.setDarkMode(!t.isDarkMode)},checkbox:!0},{id:"toggle-reduce-motion",label:"action.toggle-reduce-motion",menuLabel:"action.toggle-reduce-motion.menu",readonlyOk:!0,onSelect(y){f("toggle-reduce-motion",{source:y}),t.setAnimationSpeed(t.animationSpeed===0?1:0)},checkbox:!0},{id:"toggle-transparent",label:"action.toggle-transparent",menuLabel:"action.toggle-transparent.menu",contextMenuLabel:"action.toggle-transparent.context-menu",readonlyOk:!0,onSelect(y){f("toggle-transparent",{source:y}),t.updateInstanceState({exportBackground:!t.instanceState.exportBackground},!0)},checkbox:!0},{id:"toggle-tool-lock",label:"action.toggle-tool-lock",menuLabel:"action.toggle-tool-lock.menu",readonlyOk:!1,kbd:"q",onSelect(y){f("toggle-tool-lock",{source:y}),t.setToolLocked(!t.isToolLocked)},checkbox:!0},{id:"toggle-focus-mode",label:"action.toggle-focus-mode",menuLabel:"action.toggle-focus-mode.menu",readonlyOk:!0,kbd:"$.",checkbox:!0,onSelect(y){requestAnimationFrame(()=>{t.batch(()=>{f("toggle-focus-mode",{source:y}),o(),s(),t.setFocusMode(!t.isFocusMode)})})}},{id:"toggle-grid",label:"action.toggle-grid",menuLabel:"action.toggle-grid.menu",readonlyOk:!0,kbd:"$'",onSelect(y){f("toggle-grid-mode",{source:y}),t.setGridMode(!t.isGridMode)},checkbox:!0},{id:"toggle-debug-mode",label:"action.toggle-debug-mode",menuLabel:"action.toggle-debug-mode.menu",readonlyOk:!0,onSelect(y){f("toggle-debug-mode",{source:y}),t.updateInstanceState({isDebugMode:!t.instanceState.isDebugMode},!0)},checkbox:!0},{id:"print",label:"action.print",kbd:"$p",readonlyOk:!0,onSelect(y){f("print",{source:y}),a()}},{id:"exit-pen-mode",label:"action.exit-pen-mode",icon:"cross-2",readonlyOk:!0,onSelect(y){f("exit-pen-mode",{source:y}),t.setPenMode(!1)}},{id:"stop-following",label:"action.stop-following",icon:"cross-2",readonlyOk:!0,onSelect(y){f("stop-following",{source:y}),t.stopFollowingUser()}},{id:"back-to-content",label:"action.back-to-content",icon:"arrow-left",readonlyOk:!0,onSelect(y){f("zoom-to-content",{source:y}),t.zoomToContent()}},{id:"toggle-lock",label:"action.toggle-lock",readonlyOk:!1,kbd:"!l",onSelect(y){f("toggle-lock",{source:y}),t.toggleLock()}}]);return e?e(t,m,void 0):m},[f,e,t,r,i,h,d,l,c,u,o,s,a]);return g.jsx(j3.Provider,{value:p,children:n})}function Xt(){const e=w.useContext(j3);if(!e)throw new Error("useTools must be used within a ToolProvider");return e}function Rw(e){return e.filter(n=>n!=null&&n!==!1)}function ye(e,...n){const t=Rw(n);return t.length===0?null:{id:e,type:"group",checkbox:t.every(r=>r.type==="item"&&r.actionItem.checkbox),disabled:t.every(r=>r.disabled),readonlyOk:t.some(r=>r.readonlyOk),children:t}}function zr(e,n,...t){const r=Rw(t);return r.length===0?null:{id:e,type:"submenu",label:n,children:r,disabled:r.every(o=>o.disabled),readonlyOk:r.some(o=>o.readonlyOk)}}function Dw(e,n={}){const{readonlyOk:t=!0,disabled:r=!1}=n;return{id:e,type:"custom",disabled:r,readonlyOk:t}}function j(e,n={}){if(!e)throw Error("No action item provided to menuItem");if(!e.label)throw Error("Trying to create menu item for action item that doesn't have a label");const{checked:t=!1,disabled:r=!1}=n;return{id:e.id,type:"item",actionItem:e,disabled:r,checked:t,readonlyOk:e.readonlyOk}}function N3(e){const{selectedIds:n}=e;return n.map(r=>e.getShapeById(r)).filter(r=>!(!r||e.isShapeOfType(r,Fe)&&r.props.start.type==="binding"||e.isShapeOfType(r,Fe)&&r.props.end.type==="binding"))}const z3=()=>{const e=U();return J("threeStackableItems",()=>N3(e).length>2,[e])},Lw=()=>{const e=U();return J("allowGroup",()=>N3(e).length>1,[e])},jw=()=>{const e=U();return J("allowUngroup",()=>e.selectedIds.some(n=>{var t;return((t=e.getShapeById(n))==null?void 0:t.type)==="group"}),[])},B3=typeof window<"u"&&"navigator"in window&&!!navigator.clipboard&&!!navigator.clipboard.read,jQ=[0,380,420,460,580,640,840,1023],F3=oe.createContext(0);function NQ({children:e}){const n=U(),t=J("breakpoint",()=>{const{width:r}=n.viewportScreenBounds,o=jQ;for(let s=0;s<o.length-1;s++)if(r>o[s]&&r<=o[s+1])return s;return o.length},[n]);return g.jsx(F3.Provider,{value:t,children:e})}function lr(){let e=w.useContext(F3);const n=new URL(window.location.href).searchParams.get("layout");return n==="desktop"?e=7:n==="mobile"&&(e=1),e}function Nw(){const e=U();return J("hasLinkShapeSelected",()=>{const{selectedShapes:n}=e;return n.length===1&&"url"in n[0].props&&n[0].type!=="embed"},[e])}const U3=oe.createContext({}),zQ=me(function({overrides:n,children:t}){const r=U(),o=Xt(),s=r.selectedIds.length,i=s>0,a=s>1,l=s>2,c=z3(),u=Lw(),d=jw(),h=Nw(),f=lr(),p=r.zoomLevel===1,m=w.useMemo(()=>{const y=[j(o["align-left"],{disabled:!a}),j(o["align-center-horizontal"],{disabled:!a}),j(o["align-right"],{disabled:!a}),j(o["stretch-horizontal"],{disabled:!a}),j(o["align-top"],{disabled:!a}),j(o["align-center-vertical"],{disabled:!a}),j(o["align-bottom"],{disabled:!a}),j(o["stretch-vertical"],{disabled:!a}),j(o["distribute-horizontal"],{disabled:!l}),j(o["distribute-vertical"],{disabled:!l}),j(o["stack-horizontal"],{disabled:!c}),j(o["stack-vertical"],{disabled:!c}),j(o["send-to-back"],{disabled:!i}),j(o["send-backward"],{disabled:!i}),j(o["bring-forward"],{disabled:!i}),j(o["bring-to-front"],{disabled:!i}),f<5?j(o["zoom-to-100"],{disabled:!!p}):j(o["rotate-ccw"],{disabled:!i}),j(o["rotate-cw"],{disabled:!i}),j(o["edit-link"],{disabled:!h}),u?j(o.group,{disabled:!a}):d?j(o.ungroup):j(o.group,{disabled:!a})];return n?n(r,y,{actions:o,oneSelected:i,twoSelected:a,threeSelected:l}):y},[r,p,u,n,o,i,a,l,c,d,h,f]);return g.jsx(U3.Provider,{value:m,children:t})});function BQ(){const e=oe.useContext(U3);if(!e)throw new Error("useActionsMenuSchema must be used inside of a ActionsMenuSchemaProvider.");return e}function FQ(){const e=U();return J("onlyFlippableShape",()=>{const{selectedShapes:n}=e;return n.length===1&&n.every(t=>e.isShapeOfType(t,Ye)||e.isShapeOfType(t,Fe)||e.isShapeOfType(t,Sp)||e.isShapeOfType(t,Iu))},[e])}function K3(){const e=U();return J("showAutoSizeToggle",()=>{const{selectedShapes:n}=e;return n.length===1&&e.isShapeOfType(n[0],Mr)&&n[0].props.autoSize===!1},[e])}const H3=oe.createContext({}),UQ=me(function({overrides:n,children:t}){var I;const r=U(),o=Xt(),s=K3(),i=FQ(),a=r.selectedIds.length,l=a>0,c=J("oneEmbedSelected",()=>r.selectedIds.length!==1?!1:r.selectedIds.some(k=>{const T=r.getShapeById(k);return T&&r.isShapeOfType(T,Is)&&T.props.url}),[]),u=J("oneEmbeddableBookmarkSelected",()=>r.selectedIds.length!==1?!1:r.selectedIds.some(k=>{const T=r.getShapeById(k);return T&&r.isShapeOfType(T,Cu)&&T.props.url&&mo(T.props.url)}),[]),d=a>1,h=a>2,f=z3(),p=J("atLeastOneShapeOnPage",()=>r.currentPageShapeIds.size>0,[]),m=J("isTransparentBg",()=>r.instanceState.exportBackground,[]),y=Lw(),x=jw(),S=!!((I=window.navigator.clipboard)!=null&&I.write),b=Nw(),{onlySelectedShape:P}=r,C=P&&r.isShapeOrAncestorLocked(P),_=w.useMemo(()=>{let k=Rw([ye("selection",c&&j(o["open-embed-link"]),c&&!C&&j(o["convert-to-bookmark"]),u&&j(o["convert-to-embed"]),s&&j(o["toggle-auto-size"]),b&&!C&&j(o["edit-link"]),l&&!C&&j(o.duplicate),y&&!C&&j(o.group),x&&!C&&j(o.ungroup),l&&j(o["toggle-lock"])),ye("modify",(d||i)&&zr("arrange","context-menu.arrange",d&&ye("align",j(o["align-left"]),j(o["align-center-horizontal"]),j(o["align-right"]),j(o["align-top"]),j(o["align-center-vertical"]),j(o["align-bottom"])),h&&ye("distribute",j(o["distribute-horizontal"]),j(o["distribute-vertical"])),d&&ye("stretch",j(o["stretch-horizontal"]),j(o["stretch-vertical"])),i&&!C&&ye("flip",j(o["flip-horizontal"]),j(o["flip-vertical"])),d&&ye("order",j(o.pack,{disabled:!d}),f&&j(o["stack-vertical"]),f&&j(o["stack-horizontal"]))),l&&!C&&zr("reorder","context-menu.reorder",ye("reorder",j(o["bring-to-front"]),j(o["bring-forward"]),j(o["send-backward"]),j(o["send-to-back"]))),l&&!C&&Dw("MOVE_TO_PAGE_MENU",{readonlyOk:!1})),ye("clipboard-group",l&&!C&&j(o.cut),l&&j(o.copy),B3&&j(o.paste)),p&&ye("conversions",zr("copy-as","context-menu.copy-as",ye("copy-as-group",j(o["copy-as-svg"]),S&&j(o["copy-as-png"]),j(o["copy-as-json"])),ye("export-bg",j(o["toggle-transparent"],{checked:!m}))),zr("export-as","context-menu.export-as",ye("export-as-group",j(o["export-as-svg"]),j(o["export-as-png"]),j(o["export-as-json"])),ye("export-bg,",j(o["toggle-transparent"],{checked:!m})))),p&&ye("set-selection-group",j(o["select-all"]),l&&j(o["select-none"])),l&&!C&&ye("delete-group",j(o.delete))]);return n&&(k=n(r,k,{actions:o,oneSelected:l,twoSelected:d,threeSelected:h,showAutoSizeToggle:s,showUngroup:x,onlyFlippableShapeSelected:i})),k},[r,n,o,l,d,h,s,i,p,f,y,x,S,b,c,u,m,C]);return g.jsx(H3.Provider,{value:_,children:t})});function V3(){const e=oe.useContext(H3);if(!e)throw new Error("useContextMenuSchema must be used inside of a TLUiContextMenuSchemaProvider.");return e}const W3=w.createContext({});function KQ({overrides:e,children:n}){const t=U(),r=hl(),{addDialog:o}=zi(),s=L3(),i=J(U1.highlighterTool),a=w.useMemo(()=>{const l=[{id:"select",label:"tool.select",icon:"tool-pointer",kbd:"v",readonlyOk:!0,onSelect(u){t.setSelectedTool("select"),r("select-tool",{source:u,id:"select"})}},{id:"hand",label:"tool.hand",icon:"tool-hand",kbd:"h",readonlyOk:!0,onSelect(u){t.setSelectedTool("hand"),r("select-tool",{source:u,id:"hand"})}},{id:"eraser",label:"tool.eraser",icon:"tool-eraser",kbd:"e",readonlyOk:!1,onSelect(u){t.setSelectedTool("eraser"),r("select-tool",{source:u,id:"eraser"})}},{id:"draw",label:"tool.draw",readonlyOk:!1,icon:"tool-pencil",kbd:"d,b,x",onSelect(u){t.setSelectedTool("draw"),r("select-tool",{source:u,id:"draw"})}},...[...Hr.values].map(u=>({id:u,label:`tool.${u}`,readonlyOk:!1,meta:{geo:u},kbd:u==="rectangle"?"r":u==="ellipse"?"o":void 0,icon:"geo-"+u,onSelect(d){t.batch(()=>{t.updateInstanceState({stylesForNextShape:{...t.instanceState.stylesForNextShape,[Hr.id]:u}},!0),t.setSelectedTool("geo"),r("select-tool",{source:d,id:`geo-${u}`})})}})),{id:"arrow",label:"tool.arrow",readonlyOk:!1,icon:"tool-arrow",kbd:"a",onSelect(u){t.setSelectedTool("arrow"),r("select-tool",{source:u,id:"arrow"})}},{id:"line",label:"tool.line",readonlyOk:!1,icon:"tool-line",kbd:"l",onSelect(u){t.setSelectedTool("line"),r("select-tool",{source:u,id:"line"})}},{id:"frame",label:"tool.frame",readonlyOk:!1,icon:"tool-frame",kbd:"f",onSelect(u){t.setSelectedTool("frame"),r("select-tool",{source:u,id:"frame"})}},{id:"text",label:"tool.text",readonlyOk:!1,icon:"tool-text",kbd:"t",onSelect(u){t.setSelectedTool("text"),r("select-tool",{source:u,id:"text"})}},{id:"asset",label:"tool.asset",readonlyOk:!1,icon:"tool-media",kbd:"$u",onSelect(u){s(),r("select-tool",{source:u,id:"media"})}},{id:"note",label:"tool.note",readonlyOk:!1,icon:"tool-note",kbd:"n",onSelect(u){t.setSelectedTool("note"),r("select-tool",{source:u,id:"note"})}},{id:"laser",label:"tool.laser",readonlyOk:!0,icon:"tool-laser",kbd:"k",onSelect(u){t.setSelectedTool("laser"),r("select-tool",{source:u,id:"laser"})}},{id:"embed",label:"tool.embed",readonlyOk:!1,icon:"tool-embed",onSelect(u){o({component:k3}),r("select-tool",{source:u,id:"embed"})}}];i&&l.push({id:"highlight",label:"tool.highlight",readonlyOk:!0,icon:"tool-highlight",kbd:"!d",onSelect(u){t.setSelectedTool("highlight"),r("select-tool",{source:u,id:"highlight"})}});const c=Object.fromEntries(l.map(u=>[u.id,u]));return e?e(t,c,{insertMedia:s}):c},[i,e,t,r,s,o]);return g.jsx(W3.Provider,{value:a,children:n})}function zw(){const e=w.useContext(W3);if(!e)throw new Error("useTools must be used within a ToolProvider");return e}const Y3=oe.createContext({}),HQ=me(function({overrides:n,children:t}){const r=U(),o=zw(),s=Xt(),i=w.useMemo(()=>{const a=he([ye("shortcuts-dialog.tools",j(s["toggle-tool-lock"]),j(o.select),j(o.draw),j(o.eraser),j(o.hand),j(o.rectangle),j(o.ellipse),j(o.arrow),j(o.line),j(o.text),j(o.frame),j(o.note),j(o.laser)),ye("shortcuts-dialog.file",j(s["insert-media"]),j(s.print)),ye("shortcuts-dialog.preferences",j(s["toggle-dark-mode"]),j(s["toggle-focus-mode"]),j(s["toggle-grid"])),ye("shortcuts-dialog.edit",j(s.undo),j(s.redo),j(s.cut),j(s.copy),j(s.paste),j(s["select-all"]),j(s.delete),j(s.duplicate),j(s["export-as-svg"]),j(s["export-as-png"])),ye("shortcuts-dialog.view",j(s["zoom-in"]),j(s["zoom-out"]),j(s["zoom-to-100"]),j(s["zoom-to-fit"]),j(s["zoom-to-selection"])),ye("shortcuts-dialog.transform",j(s["bring-to-front"]),j(s["bring-forward"]),j(s["send-backward"]),j(s["send-to-back"]),j(s.group),j(s.ungroup),j(s["flip-horizontal"]),j(s["flip-vertical"]),j(s["align-top"]),j(s["align-center-vertical"]),j(s["align-bottom"]),j(s["align-left"]),j(s["align-center-horizontal"]),j(s["align-right"]))]);return n?n(r,a,{tools:o,actions:s}):a},[r,n,s,o]);return g.jsx(Y3.Provider,{value:i,children:t})});function VQ(){const e=oe.useContext(Y3);if(!e)throw new Error("Shortcuts must be used inside of a ShortcutsProvider.");return e}function ro(){const e=U();return J("isReadOnlyMode",()=>e.isReadOnly,[e])}const WQ=()=>{const e=we(),n=ro(),t=VQ();function r(o){if(n&&!o.readonlyOk)return null;switch(o.type){case"group":return g.jsxs("div",{className:"tlui-shortcuts-dialog__group",children:[g.jsx("h2",{className:"tlui-shortcuts-dialog__group__title",children:e(o.id)}),g.jsx("div",{className:"tlui-shortcuts-dialog__group__content",children:o.children.filter(s=>s.type==="item"&&s.actionItem.kbd).map(r)})]},o.id);case"item":{const{id:s,label:i,shortcutsLabel:a,kbd:l}=o.actionItem;return g.jsxs("div",{className:"tlui-shortcuts-dialog__key-pair",children:[g.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__key",children:e(a??i)}),g.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__value",children:g.jsx(Cp,{children:l})})]},s)}}}return g.jsxs(g.Fragment,{children:[g.jsxs(Ip,{className:"tlui-shortcuts-dialog__header",children:[g.jsx(kp,{children:e("shortcuts-dialog.title")}),g.jsx($p,{})]}),g.jsx(Zc,{className:"tlui-shortcuts-dialog__body",children:t.map(r)}),g.jsx("div",{className:"tlui-dialog__scrim"})]})};function X3(){const e=U();return{languages:zc,currentLanguage:e.locale}}const G3=oe.createContext({}),YQ=me(function({overrides:n,children:t}){const r=U(),o=Xt(),s=r.selectedIds.length,i=s>0,a=s>1,l=s>2,{languages:c,currentLanguage:u}=X3(),{addDialog:d}=zi(),h=w.useMemo(()=>{const f=he([ye("top",Dw("LANGUAGE_MENU",{readonlyOk:!0}),j({id:"keyboard-shortcuts",label:"help-menu.keyboard-shortcuts",readonlyOk:!0,onSelect(){d({component:WQ})}}))]);return n?n(r,f,{actions:o,currentLanguage:u,languages:c,oneSelected:i,twoSelected:a,threeSelected:l}):f},[r,n,c,o,i,a,l,u,d]);return g.jsx(G3.Provider,{value:h,children:t})});function XQ(){const e=oe.useContext(G3);if(!e)throw new Error("useHelpMenuSchema must be used inside of a helpTLUiMenuSchemaProvider.");return e}function q3(){const e=U();return J("useCanRedo",()=>e.canRedo,[e])}function Q3(){const e=U();return J("useCanUndo",()=>e.canUndo,[e])}const Z3=oe.createContext({});function GQ({overrides:e,children:n}){var B;const t=U(),r=Xt(),s=lr()<5,i=J("isDarkMode",()=>t.isDarkMode,[t]),a=J("animationSpeed",()=>t.animationSpeed,[t]),l=J("isGridMode",()=>t.isGridMode,[t]),c=J("isSnapMode",()=>t.isSnapMode,[t]),u=J("isToolLock",()=>t.instanceState.isToolLocked,[t]),d=J("isFocusMode",()=>t.instanceState.isFocusMode,[t]),h=J("isDebugMode",()=>t.instanceState.isDebugMode,[t]),f=J("exportBackground",()=>t.instanceState.exportBackground,[t]),p=J("emptyPage",()=>t.currentPageShapeIds.size===0,[t]),m=J("selectedCount",()=>t.selectedIds.length,[t]),y=m===0,x=m>0,S=m>1,b=m>2,P=!!((B=window.navigator.clipboard)!=null&&B.write),C=Nw(),_=K3(),I=Lw(),k=jw(),T=Q3(),M=q3(),O=J("isZoomedTo100",()=>t.zoomLevel===1,[t]),z=w.useMemo(()=>{const D=he([ye("menu",zr("file","menu.file",ye("print",j(r.print,{disabled:p}))),zr("edit","menu.edit",ye("undo-actions",j(r.undo,{disabled:!T}),j(r.redo,{disabled:!M})),ye("clipboard-actions",j(r.cut,{disabled:y}),j(r.copy,{disabled:y}),j(r.paste,{disabled:!B3})),ye("conversions",zr("copy-as","menu.copy-as",ye("copy-as-group",j(r["copy-as-svg"],{disabled:p}),j(r["copy-as-png"],{disabled:p||!P}),j(r["copy-as-json"],{disabled:p})),ye("export-bg",j(r["toggle-transparent"],{checked:!f}))),zr("export-as","menu.export-as",ye("export-as-group",j(r["export-as-svg"],{disabled:p}),j(r["export-as-png"],{disabled:p}),j(r["export-as-json"],{disabled:p})),ye("export-bg",j(r["toggle-transparent"],{checked:!f})))),ye("set-selection-group",j(r["select-all"],{disabled:p}),j(r["select-none"],{disabled:!x})),ye("selection",_&&j(r["toggle-auto-size"]),C&&j(r["edit-link"]),j(r.duplicate,{disabled:!x}),I&&j(r.group),k&&j(r.ungroup)),ye("delete-group",j(r.delete,{disabled:!x}))),zr("view","menu.view",ye("view-actions",j(r["zoom-in"]),j(r["zoom-out"]),j(r["zoom-to-100"],{disabled:O}),j(r["zoom-to-fit"],{disabled:p}),j(r["zoom-to-selection"],{disabled:p||!x})))),ye("extras",j(r["insert-embed"]),j(r["insert-media"])),ye("preferences",zr("preferences","menu.preferences",ye("preferences-actions",j(r["toggle-snap-mode"],{checked:c}),j(r["toggle-tool-lock"],{checked:u}),j(r["toggle-grid"],{checked:l}),j(r["toggle-dark-mode"],{checked:i}),j(r["toggle-focus-mode"],{checked:d}),j(r["toggle-reduce-motion"],{checked:a===0}),j(r["toggle-debug-mode"],{checked:h}))),s&&Dw("LANGUAGE_MENU",{readonlyOk:!0}))]);return e?e(t,D,{actions:r,noneSelected:y,oneSelected:x,twoSelected:S,threeSelected:b}):D},[t,e,r,x,S,b,p,s,I,k,C,P,_,y,T,M,a,i,l,c,u,d,f,h,O]);return g.jsx(Z3.Provider,{value:z,children:n})}function qQ(){const e=oe.useContext(Z3);if(!e)throw new Error("useMenuSchema must be used inside of a TLUiMenuSchemaProvider.");return e}function $e(e){return{id:e.id,type:"item",readonlyOk:e.readonlyOk,toolItem:e}}const J3=oe.createContext([]);function QQ({overrides:e,children:n}){const t=U(),r=zw(),o=J(U1.highlighterTool),s=oe.useMemo(()=>{const i=he([$e(r.select),$e(r.hand),$e(r.draw),$e(r.eraser),$e(r.arrow),$e(r.text),$e(r.note),$e(r.asset),$e(r.rectangle),$e(r.ellipse),$e(r.diamond),$e(r.triangle),$e(r.trapezoid),$e(r.rhombus),$e(r.pentagon),$e(r.hexagon),$e(r.star),$e(r.oval),$e(r["x-box"]),$e(r["check-box"]),$e(r["arrow-left"]),$e(r["arrow-up"]),$e(r["arrow-down"]),$e(r["arrow-right"]),$e(r.frame),$e(r.line),o?$e(r.highlight):null,$e(r.laser)]);return e?e(t,i,{tools:r}):i},[t,o,e,r]);return g.jsx(J3.Provider,{value:s,children:n})}function ZQ(){const e=oe.useContext(J3);if(!e)throw new Error("useToolbarSchema must be used within a ToolbarSchemaProvider");return e}function JQ(){const{addToast:e,removeToast:n,clearToasts:t}=no(),{addDialog:r,clearDialogs:o,removeDialog:s,updateDialog:i}=zi(),l=lr()<5,c=we();return w.useMemo(()=>({addToast:e,removeToast:n,clearToasts:t,addDialog:r,clearDialogs:o,removeDialog:s,updateDialog:i,msg:c,isMobile:l}),[r,e,o,t,c,s,n,i,l])}function eZ(e,n){const t={};for(const r of e)if(r.translations)for(const[o,s]of xo(r.translations)){let i=t[o];i||(i=t[o]={}),Object.assign(i,s)}return{actionsMenu:(r,o,s)=>{for(const i of e)i.actionsMenu&&(o=i.actionsMenu(r,o,{...n,...s}));return o},actions:(r,o)=>{for(const s of e)s.actions&&(o=s.actions(r,o,n));return o},contextMenu:(r,o,s)=>{for(const i of e)i.contextMenu&&(o=i.contextMenu(r,o,{...n,...s}));return o},helpMenu:(r,o,s)=>{for(const i of e)i.helpMenu&&(o=i.helpMenu(r,o,{...n,...s}));return o},menu:(r,o,s)=>{for(const i of e)i.menu&&(o=i.menu(r,o,{...n,...s}));return o},toolbar:(r,o,s)=>{for(const i of e)i.toolbar&&(o=i.toolbar(r,o,{...n,...s}));return o},keyboardShortcutsMenu:(r,o,s)=>{for(const i of e)i.keyboardShortcutsMenu&&(o=i.keyboardShortcutsMenu(r,o,{...n,...s}));return o},tools:(r,o,s)=>{for(const i of e)i.tools&&(o=i.tools(r,o,{...n,...s}));return o},translations:t}}function eM(e){return w.useMemo(()=>e,e)}function tZ(e){const n=eM(e==null?[]:Array.isArray(e)?e:[e]);return w.useMemo(()=>{const t={};for(const r of n)if(r.translations)for(const[o,s]of xo(r.translations)){let i=t[o];i||(i=t[o]={}),Object.assign(i,s)}return t},[n])}function nZ(e){const n=JQ(),t=eM(e==null?[]:Array.isArray(e)?e:[e]);return w.useMemo(()=>eZ(t,n),[t,n])}function rZ({overrides:e,assetUrls:n,onUiEvent:t,children:r}){return g.jsx(SX,{assetUrls:cQ(n),children:g.jsx(EX,{overrides:tZ(e),children:g.jsx(Rq,{onEvent:t,children:g.jsx(kQ,{children:g.jsx(AQ,{children:g.jsx(NQ,{children:g.jsx(oZ,{overrides:e,children:r})})})})})})})}function oZ({overrides:e,children:n}){const t=nZ(e);return g.jsx(LQ,{overrides:t.actions,children:g.jsx(KQ,{overrides:t.tools,children:g.jsx(QQ,{overrides:t.toolbar,children:g.jsx(zQ,{overrides:t.actionsMenu,children:g.jsx(HQ,{overrides:t.keyboardShortcutsMenu,children:g.jsx(UQ,{overrides:t.contextMenu,children:g.jsx(YQ,{overrides:t.helpMenu,children:g.jsx(GQ,{overrides:t.menu,children:n})})})})})})})})}function sZ(){const e=U(),t=Xt()["back-to-content"],[r,o]=w.useState(!1);return w.useEffect(()=>{let s=!1;const i=setInterval(()=>{const{renderingShapes:a}=e,c=a.filter(u=>u.isInViewport).length===0&&e.shapesArray.length>0;s!==c&&(o(c),s=c)},1e3);return()=>{clearInterval(i)}},[e]),r?g.jsx(se,{iconLeft:t.icon,label:t.label,onClick:()=>{t.onSelect("helper-buttons"),o(!1)}}):null}let LP=0;function iZ(e,n){const t=Array(n),r=Math.floor(Math.sqrt(n));for(let o=0;o<n;o++)LP++,t[o]={id:Ue("box"+LP),type:"geo",x:o%r*132,y:Math.floor(o/r)*132};e.batch(()=>{e.createShapes(t).setSelectedIds(t.map(o=>o.id))})}const aZ=w.memo(function({renderDebugMenuItems:n}){const t=we();return g.jsxs("div",{className:"tlui-debug-panel",children:[g.jsx(lZ,{}),g.jsx(cZ,{}),g.jsxs(Ms,{id:"debug",children:[g.jsx(Tu,{children:g.jsx(se,{icon:"dots-horizontal",title:t("debug-panel.more")})}),g.jsx(As,{side:"top",align:"end",alignOffset:0,children:g.jsx(uZ,{renderDebugMenuItems:n})})]})]})}),lZ=me(function(){const n=U();return g.jsx("div",{className:"tlui-debug-panel__current-state",children:n.root.path.value})}),cZ=function(){const n=U(),t=J("rendering shapes count",()=>n.renderingShapes.length,[n]);return g.jsxs("div",{children:[t," Shapes"]})},uZ=me(function({renderDebugMenuItems:n}){const t=U(),{addToast:r}=no(),{addDialog:o}=zi(),[s,i]=w.useState(!1);return g.jsxs(g.Fragment,{children:[g.jsxs(Eo,{children:[g.jsx(Tn,{onClick:()=>{r({id:nt(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!"})},children:g.jsx("span",{children:"Show toast"})}),g.jsx(Tn,{onClick:()=>{o({component:({onClose:a})=>g.jsx(hZ,{displayDontShowAgain:!0,onCancel:()=>{a()},onContinue:()=>{a()}}),onClose:()=>{}})},children:g.jsx("span",{children:"Show dialog"})}),g.jsx(Tn,{onClick:()=>iZ(t,100),children:g.jsx("span",{children:"Create 100 shapes"})}),g.jsx(Tn,{onClick:()=>{function a({children:h}){let f=0;if(!h.length)return 0;for(const p of[...h])f++,f+=a(p);return f}const{selectedShapes:l}=t,c=l.length===0?t.renderingShapes:l,u=c.map(h=>document.getElementById(h.id).parentElement);let d=u.length;for(const h of u)d+=a(h);window.alert(`Shapes ${c.length}, DOM nodes:${d}`)},children:g.jsx("span",{children:"Count shapes and nodes"})}),(()=>{if(s)throw Error("oh no!")})(),g.jsx(Tn,{onClick:()=>{i(!0)},children:g.jsx("span",{children:"Throw error"})}),g.jsx(Tn,{onClick:()=>{tk()},children:g.jsx("span",{children:"Hard reset"})})]}),g.jsxs(Eo,{children:[g.jsx(tM,{label:"Read-only",value:t.isReadOnly,onChange:a=>t.setReadOnly(a)}),g.jsx(zd,{flag:pt.debugSvg}),g.jsx(zd,{flag:pt.forceSrgb}),g.jsx(zd,{flag:pt.debugCursors,onChange:a=>{if(a){const c=dZ.map((u,d)=>({id:Ue(),type:"geo",x:d%5*175,y:Math.floor(d/5)*175,props:{text:u,w:150,h:150,fill:"semi"}}));t.createShapes(c)}}})]}),g.jsx(Eo,{children:Object.values(U1).map(a=>g.jsx(zd,{flag:a},a.name))}),n==null?void 0:n()]})});function tM({label:e,value:n,onChange:t}){return g.jsx(v3,{title:e,checked:n,onSelect:()=>t(!n),children:e})}const zd=me(function({flag:n,onChange:t}){return g.jsx(tM,{label:n.name.replace(/([a-z0-9])([A-Z])/g,r=>`${r[0]} ${r[1].toLowerCase()}`).replace(/^[a-z]/,r=>r.toUpperCase()),value:n.value,onChange:r=>{n.set(r),t==null||t(r)}})}),dZ=["none","default","pointer","cross","move","grab","grabbing","text","ew-resize","ns-resize","nesw-resize","nwse-resize","nwse-rotate","nesw-rotate","senw-rotate","swne-rotate","zoom-in","zoom-out"];function hZ({title:e="title",body:n="hello hello hello",cancel:t="Cancel",confirm:r="Continue",displayDontShowAgain:o=!1,onCancel:s,onContinue:i}){const[a,l]=w.useState(!1);return g.jsxs(g.Fragment,{children:[g.jsxs(Ip,{children:[g.jsx(kp,{children:e}),g.jsx($p,{})]}),g.jsx(Zc,{style:{maxWidth:350},children:n}),g.jsxs(gw,{className:"tlui-dialog__footer__actions",children:[o&&g.jsx(se,{onClick:()=>l(!a),iconLeft:a?"checkbox-checked":"checkbox-empty",style:{marginRight:"auto"},children:"Don't show again"}),g.jsx(se,{onClick:s,children:t}),g.jsx(se,{type:"primary",onClick:async()=>i(),children:r})]})]})}const fZ=({id:e,component:n,onClose:t})=>{const{removeDialog:r}=zi(),o=Yt(),s=w.useCallback(i=>{if(!i){if(t)try{t()}catch(a){console.warn(a)}r(e)}},[e,t,r]);return g.jsx(yX,{onOpenChange:s,defaultOpen:!0,children:g.jsx(vX,{container:o,children:g.jsx(wX,{dir:"ltr",className:"tlui-dialog__overlay",children:g.jsx(xX,{dir:"ltr",className:"tlui-dialog__content",children:g.jsx(n,{onClose:()=>s(!1)})})})})})};function pZ(){const{dialogs:e}=zi();return g.jsx(g.Fragment,{children:e.map(n=>g.jsx(fZ,{...n},n.id))})}const gZ=oe.memo(pZ);function mZ(){const e=U(),n=J("follow",()=>e.instanceState.followingUserId,[e]);return n?g.jsx(yZ,{userId:n}):null}function yZ({userId:e}){const n=Tk(e);return n?g.jsx("div",{className:"tlui-following",style:{borderColor:n.color}}):null}function nM(){const e=U(),{languages:n,currentLanguage:t}=X3(),r=w.useCallback(o=>e.setLocale(o),[e]);return g.jsxs(Iw,{id:"help menu language",children:[g.jsx(kw,{label:"menu.language","data-direction":"left"}),g.jsx($w,{sideOffset:-4,children:g.jsx(Eo,{children:n.map(({locale:o,label:s})=>g.jsx(Dq,{title:o,checked:o===t,onSelect:()=>r(o),children:g.jsx("span",{children:s})},o))})})]})}const vZ=w.memo(function(){const n=Yt(),t=we(),[r,o]=Ni("help menu");return g.jsx("div",{className:"tlui-help-menu",children:g.jsxs(p3,{dir:"ltr",open:r,onOpenChange:o,modal:!1,children:[g.jsx(nu,{className:"tlui-button tlui-help-menu__button",dir:"ltr",title:t("help-menu.title"),children:g.jsx(vn,{icon:"question-mark"})}),g.jsx(Cw,{container:n,dir:"ltr",children:g.jsx(g3,{className:"tlui-menu",side:"top",sideOffset:8,align:"end",alignOffset:0,collisionPadding:4,children:g.jsx(wZ,{})})})]})})});function wZ(){const e=XQ(),n=ro();function t(r){if(n&&!r.readonlyOk)return null;switch(r.type){case"custom":{if(r.id==="LANGUAGE_MENU")return g.jsx(nM,{},"item");break}case"group":return g.jsx(Eo,{size:"small",children:r.children.map(t)},r.id);case"submenu":return g.jsxs(Iw,{id:`help menu ${r.id}`,children:[g.jsx(kw,{label:r.label}),g.jsx($w,{children:r.children.map(t)})]},r.id);case"item":{const{id:o,kbd:s,label:i,onSelect:a,icon:l}=r.actionItem;return g.jsx(Tn,{kbd:s,label:i,onClick:()=>a("help-menu"),iconLeft:l},o)}}}return g.jsx(g.Fragment,{children:e.map(t)})}function vi(e,n,{checkForDefaultPrevented:t=!0}={}){return function(o){if(e==null||e(o),t===!1||!o.defaultPrevented)return n==null?void 0:n(o)}}function xZ(e,n){typeof e=="function"?e(n):e!=null&&(e.current=n)}function rM(...e){return n=>e.forEach(t=>xZ(t,n))}function Bi(...e){return w.useCallback(rM(...e),e)}function oM(e,n=[]){let t=[];function r(s,i){const a=w.createContext(i),l=t.length;t=[...t,i];function c(d){const{scope:h,children:f,...p}=d,m=(h==null?void 0:h[e][l])||a,y=w.useMemo(()=>p,Object.values(p));return w.createElement(m.Provider,{value:y},f)}function u(d,h){const f=(h==null?void 0:h[e][l])||a,p=w.useContext(f);if(p)return p;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${s}\``)}return c.displayName=s+"Provider",[c,u]}const o=()=>{const s=t.map(i=>w.createContext(i));return function(a){const l=(a==null?void 0:a[e])||s;return w.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return o.scopeName=e,[r,SZ(o,...n)]}function SZ(...e){const n=e[0];if(e.length===1)return n;const t=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(s){const i=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return w.useMemo(()=>({[`__scope${n.scopeName}`]:i}),[i])}};return t.scopeName=n.scopeName,t}const Bw=w.forwardRef((e,n)=>{const{children:t,...r}=e,o=w.Children.toArray(t),s=o.find(PZ);if(s){const i=s.props.children,a=o.map(l=>l===s?w.Children.count(i)>1?w.Children.only(null):w.isValidElement(i)?i.props.children:null:l);return w.createElement(q0,W({},r,{ref:n}),w.isValidElement(i)?w.cloneElement(i,void 0,a):null)}return w.createElement(q0,W({},r,{ref:n}),t)});Bw.displayName="Slot";const q0=w.forwardRef((e,n)=>{const{children:t,...r}=e;return w.isValidElement(t)?w.cloneElement(t,{...EZ(r,t.props),ref:rM(n,t.ref)}):w.Children.count(t)>1?w.Children.only(null):null});q0.displayName="SlotClone";const bZ=({children:e})=>w.createElement(w.Fragment,null,e);function PZ(e){return w.isValidElement(e)&&e.type===bZ}function EZ(e,n){const t={...n};for(const r in n){const o=e[r],s=n[r];/^on[A-Z]/.test(r)?o&&s?t[r]=(...a)=>{s(...a),o(...a)}:o&&(t[r]=o):r==="style"?t[r]={...o,...s}:r==="className"&&(t[r]=[o,s].filter(Boolean).join(" "))}return{...e,...t}}const _Z=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],$i=_Z.reduce((e,n)=>{const t=w.forwardRef((r,o)=>{const{asChild:s,...i}=r,a=s?Bw:n;return w.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),w.createElement(a,W({},i,{ref:o}))});return t.displayName=`Primitive.${n}`,{...e,[n]:t}},{});function CZ(e,n){e&&Do.flushSync(()=>e.dispatchEvent(n))}function Os(e){const n=w.useRef(e);return w.useEffect(()=>{n.current=e}),w.useMemo(()=>(...t)=>{var r;return(r=n.current)===null||r===void 0?void 0:r.call(n,...t)},[])}function IZ(e,n=globalThis==null?void 0:globalThis.document){const t=Os(e);w.useEffect(()=>{const r=o=>{o.key==="Escape"&&t(o)};return n.addEventListener("keydown",r),()=>n.removeEventListener("keydown",r)},[t,n])}const Q0="dismissableLayer.update",kZ="dismissableLayer.pointerDownOutside",$Z="dismissableLayer.focusOutside";let jP;const TZ=w.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),MZ=w.forwardRef((e,n)=>{var t;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:o,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:l,...c}=e,u=w.useContext(TZ),[d,h]=w.useState(null),f=(t=d==null?void 0:d.ownerDocument)!==null&&t!==void 0?t:globalThis==null?void 0:globalThis.document,[,p]=w.useState({}),m=Bi(n,k=>h(k)),y=Array.from(u.layers),[x]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),S=y.indexOf(x),b=d?y.indexOf(d):-1,P=u.layersWithOutsidePointerEventsDisabled.size>0,C=b>=S,_=AZ(k=>{const T=k.target,M=[...u.branches].some(O=>O.contains(T));!C||M||(s==null||s(k),a==null||a(k),k.defaultPrevented||l==null||l())},f),I=OZ(k=>{const T=k.target;[...u.branches].some(O=>O.contains(T))||(i==null||i(k),a==null||a(k),k.defaultPrevented||l==null||l())},f);return IZ(k=>{b===u.layers.size-1&&(o==null||o(k),!k.defaultPrevented&&l&&(k.preventDefault(),l()))},f),w.useEffect(()=>{if(d)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(jP=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),NP(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=jP)}},[d,f,r,u]),w.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),NP())},[d,u]),w.useEffect(()=>{const k=()=>p({});return document.addEventListener(Q0,k),()=>document.removeEventListener(Q0,k)},[]),w.createElement($i.div,W({},c,{ref:m,style:{pointerEvents:P?C?"auto":"none":void 0,...e.style},onFocusCapture:vi(e.onFocusCapture,I.onFocusCapture),onBlurCapture:vi(e.onBlurCapture,I.onBlurCapture),onPointerDownCapture:vi(e.onPointerDownCapture,_.onPointerDownCapture)}))});function AZ(e,n=globalThis==null?void 0:globalThis.document){const t=Os(e),r=w.useRef(!1),o=w.useRef(()=>{});return w.useEffect(()=>{const s=a=>{if(a.target&&!r.current){let u=function(){sM(kZ,t,c,{discrete:!0})};var l=u;const c={originalEvent:a};a.pointerType==="touch"?(n.removeEventListener("click",o.current),o.current=u,n.addEventListener("click",o.current,{once:!0})):u()}r.current=!1},i=window.setTimeout(()=>{n.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(i),n.removeEventListener("pointerdown",s),n.removeEventListener("click",o.current)}},[n,t]),{onPointerDownCapture:()=>r.current=!0}}function OZ(e,n=globalThis==null?void 0:globalThis.document){const t=Os(e),r=w.useRef(!1);return w.useEffect(()=>{const o=s=>{s.target&&!r.current&&sM($Z,t,{originalEvent:s},{discrete:!1})};return n.addEventListener("focusin",o),()=>n.removeEventListener("focusin",o)},[n,t]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function NP(){const e=new CustomEvent(Q0);document.dispatchEvent(e)}function sM(e,n,t,{discrete:r}){const o=t.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:t});n&&o.addEventListener(e,n,{once:!0}),r?CZ(o,s):o.dispatchEvent(s)}let Rm=0;function RZ(){w.useEffect(()=>{var e,n;const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(e=t[0])!==null&&e!==void 0?e:zP()),document.body.insertAdjacentElement("beforeend",(n=t[1])!==null&&n!==void 0?n:zP()),Rm++,()=>{Rm===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),Rm--}},[])}function zP(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}const Dm="focusScope.autoFocusOnMount",Lm="focusScope.autoFocusOnUnmount",BP={bubbles:!1,cancelable:!0},DZ=w.forwardRef((e,n)=>{const{loop:t=!1,trapped:r=!1,onMountAutoFocus:o,onUnmountAutoFocus:s,...i}=e,[a,l]=w.useState(null),c=Os(o),u=Os(s),d=w.useRef(null),h=Bi(n,m=>l(m)),f=w.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;w.useEffect(()=>{if(r){let x=function(b){if(f.paused||!a)return;const P=b.target;a.contains(P)?d.current=P:ri(d.current,{select:!0})},S=function(b){f.paused||!a||a.contains(b.relatedTarget)||ri(d.current,{select:!0})};var m=x,y=S;return document.addEventListener("focusin",x),document.addEventListener("focusout",S),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",S)}}},[r,a,f.paused]),w.useEffect(()=>{if(a){UP.add(f);const m=document.activeElement;if(!a.contains(m)){const x=new CustomEvent(Dm,BP);a.addEventListener(Dm,c),a.dispatchEvent(x),x.defaultPrevented||(LZ(FZ(iM(a)),{select:!0}),document.activeElement===m&&ri(a))}return()=>{a.removeEventListener(Dm,c),setTimeout(()=>{const x=new CustomEvent(Lm,BP);a.addEventListener(Lm,u),a.dispatchEvent(x),x.defaultPrevented||ri(m??document.body,{select:!0}),a.removeEventListener(Lm,u),UP.remove(f)},0)}}},[a,c,u,f]);const p=w.useCallback(m=>{if(!t&&!r||f.paused)return;const y=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,x=document.activeElement;if(y&&x){const S=m.currentTarget,[b,P]=jZ(S);b&&P?!m.shiftKey&&x===P?(m.preventDefault(),t&&ri(b,{select:!0})):m.shiftKey&&x===b&&(m.preventDefault(),t&&ri(P,{select:!0})):x===S&&m.preventDefault()}},[t,r,f.paused]);return w.createElement($i.div,W({tabIndex:-1},i,{ref:h,onKeyDown:p}))});function LZ(e,{select:n=!1}={}){const t=document.activeElement;for(const r of e)if(ri(r,{select:n}),document.activeElement!==t)return}function jZ(e){const n=iM(e),t=FP(n,e),r=FP(n.reverse(),e);return[t,r]}function iM(e){const n=[],t=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)n.push(t.currentNode);return n}function FP(e,n){for(const t of e)if(!NZ(t,{upTo:n}))return t}function NZ(e,{upTo:n}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(n!==void 0&&e===n)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function zZ(e){return e instanceof HTMLInputElement&&"select"in e}function ri(e,{select:n=!1}={}){if(e&&e.focus){const t=document.activeElement;e.focus({preventScroll:!0}),e!==t&&zZ(e)&&n&&e.select()}}const UP=BZ();function BZ(){let e=[];return{add(n){const t=e[0];n!==t&&(t==null||t.pause()),e=KP(e,n),e.unshift(n)},remove(n){var t;e=KP(e,n),(t=e[0])===null||t===void 0||t.resume()}}}function KP(e,n){const t=[...e],r=t.indexOf(n);return r!==-1&&t.splice(r,1),t}function FZ(e){return e.filter(n=>n.tagName!=="A")}const ds=globalThis!=null&&globalThis.document?w.useLayoutEffect:()=>{},UZ=yE["useId".toString()]||(()=>{});let KZ=0;function HZ(e){const[n,t]=w.useState(UZ());return ds(()=>{e||t(r=>r??String(KZ++))},[e]),e||(n?`radix-${n}`:"")}function Fi(e){return e.split("-")[0]}function Mu(e){return e.split("-")[1]}function fl(e){return["top","bottom"].includes(Fi(e))?"x":"y"}function Fw(e){return e==="y"?"height":"width"}function HP(e,n,t){let{reference:r,floating:o}=e;const s=r.x+r.width/2-o.width/2,i=r.y+r.height/2-o.height/2,a=fl(n),l=Fw(a),c=r[l]/2-o[l]/2,u=a==="x";let d;switch(Fi(n)){case"top":d={x:s,y:r.y-o.height};break;case"bottom":d={x:s,y:r.y+r.height};break;case"right":d={x:r.x+r.width,y:i};break;case"left":d={x:r.x-o.width,y:i};break;default:d={x:r.x,y:r.y}}switch(Mu(n)){case"start":d[a]-=c*(t&&u?-1:1);break;case"end":d[a]+=c*(t&&u?-1:1)}return d}const VZ=async(e,n,t)=>{const{placement:r="bottom",strategy:o="absolute",middleware:s=[],platform:i}=t,a=await(i.isRTL==null?void 0:i.isRTL(n));let l=await i.getElementRects({reference:e,floating:n,strategy:o}),{x:c,y:u}=HP(l,r,a),d=r,h={},f=0;for(let p=0;p<s.length;p++){const{name:m,fn:y}=s[p],{x,y:S,data:b,reset:P}=await y({x:c,y:u,initialPlacement:r,placement:d,strategy:o,middlewareData:h,rects:l,platform:i,elements:{reference:e,floating:n}});c=x??c,u=S??u,h={...h,[m]:{...h[m],...b}},P&&f<=50&&(f++,typeof P=="object"&&(P.placement&&(d=P.placement),P.rects&&(l=P.rects===!0?await i.getElementRects({reference:e,floating:n,strategy:o}):P.rects),{x:c,y:u}=HP(l,d,a)),p=-1)}return{x:c,y:u,placement:d,strategy:o,middlewareData:h}};function aM(e){return typeof e!="number"?function(n){return{top:0,right:0,bottom:0,left:0,...n}}(e):{top:e,right:e,bottom:e,left:e}}function Of(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function ru(e,n){var t;n===void 0&&(n={});const{x:r,y:o,platform:s,rects:i,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=n,p=aM(f),m=a[h?d==="floating"?"reference":"floating":d],y=Of(await s.getClippingRect({element:(t=await(s.isElement==null?void 0:s.isElement(m)))==null||t?m:m.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),x=Of(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:d==="floating"?{...i.floating,x:r,y:o}:i.reference,offsetParent:await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),strategy:l}):i[d]);return{top:y.top-x.top+p.top,bottom:x.bottom-y.bottom+p.bottom,left:y.left-x.left+p.left,right:x.right-y.right+p.right}}const WZ=Math.min,oi=Math.max;function Z0(e,n,t){return oi(e,WZ(n,t))}const VP=e=>({name:"arrow",options:e,async fn(n){const{element:t,padding:r=0}=e??{},{x:o,y:s,placement:i,rects:a,platform:l}=n;if(t==null)return{};const c=aM(r),u={x:o,y:s},d=fl(i),h=Mu(i),f=Fw(d),p=await l.getDimensions(t),m=d==="y"?"top":"left",y=d==="y"?"bottom":"right",x=a.reference[f]+a.reference[d]-u[d]-a.floating[f],S=u[d]-a.reference[d],b=await(l.getOffsetParent==null?void 0:l.getOffsetParent(t));let P=b?d==="y"?b.clientHeight||0:b.clientWidth||0:0;P===0&&(P=a.floating[f]);const C=x/2-S/2,_=c[m],I=P-p[f]-c[y],k=P/2-p[f]/2+C,T=Z0(_,k,I),M=(h==="start"?c[m]:c[y])>0&&k!==T&&a.reference[f]<=a.floating[f];return{[d]:u[d]-(M?k<_?_-k:I-k:0),data:{[d]:T,centerOffset:k-T}}}}),YZ={left:"right",right:"left",bottom:"top",top:"bottom"};function Rf(e){return e.replace(/left|right|bottom|top/g,n=>YZ[n])}function XZ(e,n,t){t===void 0&&(t=!1);const r=Mu(e),o=fl(e),s=Fw(o);let i=o==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return n.reference[s]>n.floating[s]&&(i=Rf(i)),{main:i,cross:Rf(i)}}const GZ={start:"end",end:"start"};function WP(e){return e.replace(/start|end/g,n=>GZ[n])}const lM=["top","right","bottom","left"];lM.reduce((e,n)=>e.concat(n,n+"-start",n+"-end"),[]);const qZ=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(n){var t;const{placement:r,middlewareData:o,rects:s,initialPlacement:i,platform:a,elements:l}=n,{mainAxis:c=!0,crossAxis:u=!0,fallbackPlacements:d,fallbackStrategy:h="bestFit",flipAlignment:f=!0,...p}=e,m=Fi(r),y=d||(m===i||!f?[Rf(i)]:function(k){const T=Rf(k);return[WP(k),T,WP(T)]}(i)),x=[i,...y],S=await ru(n,p),b=[];let P=((t=o.flip)==null?void 0:t.overflows)||[];if(c&&b.push(S[m]),u){const{main:k,cross:T}=XZ(r,s,await(a.isRTL==null?void 0:a.isRTL(l.floating)));b.push(S[k],S[T])}if(P=[...P,{placement:r,overflows:b}],!b.every(k=>k<=0)){var C,_;const k=((C=(_=o.flip)==null?void 0:_.index)!=null?C:0)+1,T=x[k];if(T)return{data:{index:k,overflows:P},reset:{placement:T}};let M="bottom";switch(h){case"bestFit":{var I;const O=(I=P.map(z=>[z,z.overflows.filter(B=>B>0).reduce((B,D)=>B+D,0)]).sort((z,B)=>z[1]-B[1])[0])==null?void 0:I[0].placement;O&&(M=O);break}case"initialPlacement":M=i}if(r!==M)return{reset:{placement:M}}}return{}}}};function YP(e,n){return{top:e.top-n.height,right:e.right-n.width,bottom:e.bottom-n.height,left:e.left-n.width}}function XP(e){return lM.some(n=>e[n]>=0)}const QZ=function(e){let{strategy:n="referenceHidden",...t}=e===void 0?{}:e;return{name:"hide",async fn(r){const{rects:o}=r;switch(n){case"referenceHidden":{const s=YP(await ru(r,{...t,elementContext:"reference"}),o.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:XP(s)}}}case"escaped":{const s=YP(await ru(r,{...t,altBoundary:!0}),o.floating);return{data:{escapedOffsets:s,escaped:XP(s)}}}default:return{}}}}},ZZ=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(n){const{x:t,y:r}=n,o=await async function(s,i){const{placement:a,platform:l,elements:c}=s,u=await(l.isRTL==null?void 0:l.isRTL(c.floating)),d=Fi(a),h=Mu(a),f=fl(a)==="x",p=["left","top"].includes(d)?-1:1,m=u&&f?-1:1,y=typeof i=="function"?i(s):i;let{mainAxis:x,crossAxis:S,alignmentAxis:b}=typeof y=="number"?{mainAxis:y,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...y};return h&&typeof b=="number"&&(S=h==="end"?-1*b:b),f?{x:S*m,y:x*p}:{x:x*p,y:S*m}}(n,e);return{x:t+o.x,y:r+o.y,data:o}}}};function cM(e){return e==="x"?"y":"x"}const JZ=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(n){const{x:t,y:r,placement:o}=n,{mainAxis:s=!0,crossAxis:i=!1,limiter:a={fn:y=>{let{x,y:S}=y;return{x,y:S}}},...l}=e,c={x:t,y:r},u=await ru(n,l),d=fl(Fi(o)),h=cM(d);let f=c[d],p=c[h];if(s){const y=d==="y"?"bottom":"right";f=Z0(f+u[d==="y"?"top":"left"],f,f-u[y])}if(i){const y=h==="y"?"bottom":"right";p=Z0(p+u[h==="y"?"top":"left"],p,p-u[y])}const m=a.fn({...n,[d]:f,[h]:p});return{...m,data:{x:m.x-t,y:m.y-r}}}}},eJ=function(e){return e===void 0&&(e={}),{options:e,fn(n){const{x:t,y:r,placement:o,rects:s,middlewareData:i}=n,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=e,u={x:t,y:r},d=fl(o),h=cM(d);let f=u[d],p=u[h];const m=typeof a=="function"?a({...s,placement:o}):a,y=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const C=d==="y"?"height":"width",_=s.reference[d]-s.floating[C]+y.mainAxis,I=s.reference[d]+s.reference[C]-y.mainAxis;f<_?f=_:f>I&&(f=I)}if(c){var x,S,b,P;const C=d==="y"?"width":"height",_=["top","left"].includes(Fi(o)),I=s.reference[h]-s.floating[C]+(_&&(x=(S=i.offset)==null?void 0:S[h])!=null?x:0)+(_?0:y.crossAxis),k=s.reference[h]+s.reference[C]+(_?0:(b=(P=i.offset)==null?void 0:P[h])!=null?b:0)-(_?y.crossAxis:0);p<I?p=I:p>k&&(p=k)}return{[d]:f,[h]:p}}}},tJ=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(n){const{placement:t,rects:r,platform:o,elements:s}=n,{apply:i,...a}=e,l=await ru(n,a),c=Fi(t),u=Mu(t);let d,h;c==="top"||c==="bottom"?(d=c,h=u===(await(o.isRTL==null?void 0:o.isRTL(s.floating))?"start":"end")?"left":"right"):(h=c,d=u==="end"?"top":"bottom");const f=oi(l.left,0),p=oi(l.right,0),m=oi(l.top,0),y=oi(l.bottom,0),x={availableHeight:r.floating.height-(["left","right"].includes(t)?2*(m!==0||y!==0?m+y:oi(l.top,l.bottom)):l[d]),availableWidth:r.floating.width-(["top","bottom"].includes(t)?2*(f!==0||p!==0?f+p:oi(l.left,l.right)):l[h])},S=await o.getDimensions(s.floating);i==null||i({...n,...x});const b=await o.getDimensions(s.floating);return S.width!==b.width||S.height!==b.height?{reset:{rects:!0}}:{}}}};function uM(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function Ko(e){if(e==null)return window;if(!uM(e)){const n=e.ownerDocument;return n&&n.defaultView||window}return e}function Au(e){return Ko(e).getComputedStyle(e)}function _o(e){return uM(e)?"":e?(e.nodeName||"").toLowerCase():""}function dM(){const e=navigator.userAgentData;return e!=null&&e.brands?e.brands.map(n=>n.brand+"/"+n.version).join(" "):navigator.userAgent}function Zr(e){return e instanceof Ko(e).HTMLElement}function Rs(e){return e instanceof Ko(e).Element}function Uw(e){return typeof ShadowRoot>"u"?!1:e instanceof Ko(e).ShadowRoot||e instanceof ShadowRoot}function Np(e){const{overflow:n,overflowX:t,overflowY:r}=Au(e);return/auto|scroll|overlay|hidden/.test(n+r+t)}function nJ(e){return["table","td","th"].includes(_o(e))}function GP(e){const n=/firefox/i.test(dM()),t=Au(e);return t.transform!=="none"||t.perspective!=="none"||t.contain==="paint"||["transform","perspective"].includes(t.willChange)||n&&t.willChange==="filter"||n&&!!t.filter&&t.filter!=="none"}function hM(){return!/^((?!chrome|android).)*safari/i.test(dM())}const qP=Math.min,pc=Math.max,Df=Math.round;function Co(e,n,t){var r,o,s,i;n===void 0&&(n=!1),t===void 0&&(t=!1);const a=e.getBoundingClientRect();let l=1,c=1;n&&Zr(e)&&(l=e.offsetWidth>0&&Df(a.width)/e.offsetWidth||1,c=e.offsetHeight>0&&Df(a.height)/e.offsetHeight||1);const u=Rs(e)?Ko(e):window,d=!hM()&&t,h=(a.left+(d&&(r=(o=u.visualViewport)==null?void 0:o.offsetLeft)!=null?r:0))/l,f=(a.top+(d&&(s=(i=u.visualViewport)==null?void 0:i.offsetTop)!=null?s:0))/c,p=a.width/l,m=a.height/c;return{width:p,height:m,top:f,right:h+p,bottom:f+m,left:h,x:h,y:f}}function Ps(e){return(n=e,(n instanceof Ko(n).Node?e.ownerDocument:e.document)||window.document).documentElement;var n}function zp(e){return Rs(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function fM(e){return Co(Ps(e)).left+zp(e).scrollLeft}function rJ(e,n,t){const r=Zr(n),o=Ps(n),s=Co(e,r&&function(l){const c=Co(l);return Df(c.width)!==l.offsetWidth||Df(c.height)!==l.offsetHeight}(n),t==="fixed");let i={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if(r||!r&&t!=="fixed")if((_o(n)!=="body"||Np(o))&&(i=zp(n)),Zr(n)){const l=Co(n,!0);a.x=l.x+n.clientLeft,a.y=l.y+n.clientTop}else o&&(a.x=fM(o));return{x:s.left+i.scrollLeft-a.x,y:s.top+i.scrollTop-a.y,width:s.width,height:s.height}}function pM(e){return _o(e)==="html"?e:e.assignedSlot||e.parentNode||(Uw(e)?e.host:null)||Ps(e)}function QP(e){return Zr(e)&&getComputedStyle(e).position!=="fixed"?e.offsetParent:null}function J0(e){const n=Ko(e);let t=QP(e);for(;t&&nJ(t)&&getComputedStyle(t).position==="static";)t=QP(t);return t&&(_o(t)==="html"||_o(t)==="body"&&getComputedStyle(t).position==="static"&&!GP(t))?n:t||function(r){let o=pM(r);for(Uw(o)&&(o=o.host);Zr(o)&&!["html","body"].includes(_o(o));){if(GP(o))return o;o=o.parentNode}return null}(e)||n}function ZP(e){if(Zr(e))return{width:e.offsetWidth,height:e.offsetHeight};const n=Co(e);return{width:n.width,height:n.height}}function gM(e){const n=pM(e);return["html","body","#document"].includes(_o(n))?e.ownerDocument.body:Zr(n)&&Np(n)?n:gM(n)}function Lf(e,n){var t;n===void 0&&(n=[]);const r=gM(e),o=r===((t=e.ownerDocument)==null?void 0:t.body),s=Ko(r),i=o?[s].concat(s.visualViewport||[],Np(r)?r:[]):r,a=n.concat(i);return o?a:a.concat(Lf(i))}function JP(e,n,t){return n==="viewport"?Of(function(r,o){const s=Ko(r),i=Ps(r),a=s.visualViewport;let l=i.clientWidth,c=i.clientHeight,u=0,d=0;if(a){l=a.width,c=a.height;const h=hM();(h||!h&&o==="fixed")&&(u=a.offsetLeft,d=a.offsetTop)}return{width:l,height:c,x:u,y:d}}(e,t)):Rs(n)?function(r,o){const s=Co(r,!1,o==="fixed"),i=s.top+r.clientTop,a=s.left+r.clientLeft;return{top:i,left:a,x:a,y:i,right:a+r.clientWidth,bottom:i+r.clientHeight,width:r.clientWidth,height:r.clientHeight}}(n,t):Of(function(r){var o;const s=Ps(r),i=zp(r),a=(o=r.ownerDocument)==null?void 0:o.body,l=pc(s.scrollWidth,s.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),c=pc(s.scrollHeight,s.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0);let u=-i.scrollLeft+fM(r);const d=-i.scrollTop;return Au(a||s).direction==="rtl"&&(u+=pc(s.clientWidth,a?a.clientWidth:0)-l),{width:l,height:c,x:u,y:d}}(Ps(e)))}function oJ(e){const n=Lf(e),t=["absolute","fixed"].includes(Au(e).position)&&Zr(e)?J0(e):e;return Rs(t)?n.filter(r=>Rs(r)&&function(o,s){const i=s.getRootNode==null?void 0:s.getRootNode();if(o.contains(s))return!0;if(i&&Uw(i)){let a=s;do{if(a&&o===a)return!0;a=a.parentNode||a.host}while(a)}return!1}(r,t)&&_o(r)!=="body"):[]}const sJ={getClippingRect:function(e){let{element:n,boundary:t,rootBoundary:r,strategy:o}=e;const s=[...t==="clippingAncestors"?oJ(n):[].concat(t),r],i=s[0],a=s.reduce((l,c)=>{const u=JP(n,c,o);return l.top=pc(u.top,l.top),l.right=qP(u.right,l.right),l.bottom=qP(u.bottom,l.bottom),l.left=pc(u.left,l.left),l},JP(n,i,o));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:n,offsetParent:t,strategy:r}=e;const o=Zr(t),s=Ps(t);if(t===s)return n;let i={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if((o||!o&&r!=="fixed")&&((_o(t)!=="body"||Np(s))&&(i=zp(t)),Zr(t))){const l=Co(t,!0);a.x=l.x+t.clientLeft,a.y=l.y+t.clientTop}return{...n,x:n.x-i.scrollLeft+a.x,y:n.y-i.scrollTop+a.y}},isElement:Rs,getDimensions:ZP,getOffsetParent:J0,getDocumentElement:Ps,getElementRects:e=>{let{reference:n,floating:t,strategy:r}=e;return{reference:rJ(n,J0(t),r),floating:{...ZP(t),x:0,y:0}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>Au(e).direction==="rtl"};function iJ(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:s=!0,elementResize:i=!0,animationFrame:a=!1}=r,l=o&&!a,c=s&&!a,u=l||c?[...Rs(e)?Lf(e):[],...Lf(n)]:[];u.forEach(p=>{l&&p.addEventListener("scroll",t,{passive:!0}),c&&p.addEventListener("resize",t)});let d,h=null;if(i){let p=!0;h=new ResizeObserver(()=>{p||t(),p=!1}),Rs(e)&&!a&&h.observe(e),h.observe(n)}let f=a?Co(e):null;return a&&function p(){const m=Co(e);!f||m.x===f.x&&m.y===f.y&&m.width===f.width&&m.height===f.height||t(),f=m,d=requestAnimationFrame(p)}(),t(),()=>{var p;u.forEach(m=>{l&&m.removeEventListener("scroll",t),c&&m.removeEventListener("resize",t)}),(p=h)==null||p.disconnect(),h=null,a&&cancelAnimationFrame(d)}}const aJ=(e,n,t)=>VZ(e,n,{platform:sJ,...t});var ev=typeof document<"u"?w.useLayoutEffect:w.useEffect;function tv(e,n){if(e===n)return!0;if(typeof e!=typeof n)return!1;if(typeof e=="function"&&e.toString()===n.toString())return!0;let t,r,o;if(e&&n&&typeof e=="object"){if(Array.isArray(e)){if(t=e.length,t!=n.length)return!1;for(r=t;r--!==0;)if(!tv(e[r],n[r]))return!1;return!0}if(o=Object.keys(e),t=o.length,t!==Object.keys(n).length)return!1;for(r=t;r--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[r]))return!1;for(r=t;r--!==0;){const s=o[r];if(!(s==="_owner"&&e.$$typeof)&&!tv(e[s],n[s]))return!1}return!0}return e!==e&&n!==n}function lJ(e){const n=w.useRef(e);return ev(()=>{n.current=e}),n}function cJ(e){let{middleware:n,placement:t="bottom",strategy:r="absolute",whileElementsMounted:o}=e===void 0?{}:e;const s=w.useRef(null),i=w.useRef(null),a=lJ(o),l=w.useRef(null),[c,u]=w.useState({x:null,y:null,strategy:r,placement:t,middlewareData:{}}),[d,h]=w.useState(n);tv(d==null?void 0:d.map(b=>{let{options:P}=b;return P}),n==null?void 0:n.map(b=>{let{options:P}=b;return P}))||h(n);const f=w.useCallback(()=>{!s.current||!i.current||aJ(s.current,i.current,{middleware:d,placement:t,strategy:r}).then(b=>{p.current&&Do.flushSync(()=>{u(b)})})},[d,t,r]);ev(()=>{p.current&&f()},[f]);const p=w.useRef(!1);ev(()=>(p.current=!0,()=>{p.current=!1}),[]);const m=w.useCallback(()=>{if(typeof l.current=="function"&&(l.current(),l.current=null),s.current&&i.current)if(a.current){const b=a.current(s.current,i.current,f);l.current=b}else f()},[f,a]),y=w.useCallback(b=>{s.current=b,m()},[m]),x=w.useCallback(b=>{i.current=b,m()},[m]),S=w.useMemo(()=>({reference:s,floating:i}),[]);return w.useMemo(()=>({...c,update:f,refs:S,reference:y,floating:x}),[c,f,S,y,x])}const uJ=e=>{const{element:n,padding:t}=e;function r(o){return Object.prototype.hasOwnProperty.call(o,"current")}return{name:"arrow",options:e,fn(o){return r(n)?n.current!=null?VP({element:n.current,padding:t}).fn(o):{}:n?VP({element:n,padding:t}).fn(o):{}}}};function dJ(e){const[n,t]=w.useState(void 0);return ds(()=>{if(e){t({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const s=o[0];let i,a;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;i=c.inlineSize,a=c.blockSize}else i=e.offsetWidth,a=e.offsetHeight;t({width:i,height:a})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else t(void 0)},[e]),n}const mM="Popper",[Kw,yM]=oM(mM),[hJ,vM]=Kw(mM),fJ=e=>{const{__scopePopper:n,children:t}=e,[r,o]=w.useState(null);return w.createElement(hJ,{scope:n,anchor:r,onAnchorChange:o},t)},pJ="PopperAnchor",gJ=w.forwardRef((e,n)=>{const{__scopePopper:t,virtualRef:r,...o}=e,s=vM(pJ,t),i=w.useRef(null),a=Bi(n,i);return w.useEffect(()=>{s.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:w.createElement($i.div,W({},o,{ref:a}))}),jf="PopperContent",[mJ,ine]=Kw(jf),[yJ,vJ]=Kw(jf,{hasParent:!1,positionUpdateFns:new Set}),wJ=w.forwardRef((e,n)=>{var t,r,o,s,i,a,l,c;const{__scopePopper:u,side:d="bottom",sideOffset:h=0,align:f="center",alignOffset:p=0,arrowPadding:m=0,collisionBoundary:y=[],collisionPadding:x=0,sticky:S="partial",hideWhenDetached:b=!1,avoidCollisions:P=!0,onPlaced:C,..._}=e,I=vM(jf,u),[k,T]=w.useState(null),M=Bi(n,Hs=>T(Hs)),[O,z]=w.useState(null),B=dJ(O),D=(t=B==null?void 0:B.width)!==null&&t!==void 0?t:0,F=(r=B==null?void 0:B.height)!==null&&r!==void 0?r:0,V=d+(f!=="center"?"-"+f:""),q=typeof x=="number"?x:{top:0,right:0,bottom:0,left:0,...x},L=Array.isArray(y)?y:[y],N=L.length>0,H={padding:q,boundary:L.filter(SJ),altBoundary:N},{reference:Q,floating:Z,strategy:Ee,x:ke,y:ue,placement:He,middlewareData:Ve,update:We}=cJ({strategy:"fixed",placement:V,whileElementsMounted:iJ,middleware:[ZZ({mainAxis:h+F,alignmentAxis:p}),P?JZ({mainAxis:!0,crossAxis:!1,limiter:S==="partial"?eJ():void 0,...H}):void 0,P?qZ({...H}):void 0,tJ({...H,apply:({elements:Hs,rects:Fp,availableWidth:Up,availableHeight:Kp})=>{const{width:Hp,height:Ui}=Fp.reference,Wo=Hs.floating.style;Wo.setProperty("--radix-popper-available-width",`${Up}px`),Wo.setProperty("--radix-popper-available-height",`${Kp}px`),Wo.setProperty("--radix-popper-anchor-width",`${Hp}px`),Wo.setProperty("--radix-popper-anchor-height",`${Ui}px`)}}),O?uJ({element:O,padding:m}):void 0,bJ({arrowWidth:D,arrowHeight:F}),b?QZ({strategy:"referenceHidden"}):void 0].filter(xJ)});ds(()=>{Q(I.anchor)},[Q,I.anchor]);const Re=ke!==null&&ue!==null,[Gt,Ho]=wM(He),Pn=Os(C);ds(()=>{Re&&(Pn==null||Pn())},[Re,Pn]);const so=(o=Ve.arrow)===null||o===void 0?void 0:o.x,cr=(s=Ve.arrow)===null||s===void 0?void 0:s.y,Vo=((i=Ve.arrow)===null||i===void 0?void 0:i.centerOffset)!==0,[io,Bn]=w.useState();ds(()=>{k&&Bn(window.getComputedStyle(k).zIndex)},[k]);const{hasParent:ur,positionUpdateFns:Fn}=vJ(jf,u),qt=!ur;w.useLayoutEffect(()=>{if(!qt)return Fn.add(We),()=>{Fn.delete(We)}},[qt,Fn,We]),ds(()=>{qt&&Re&&Array.from(Fn).reverse().forEach(Hs=>requestAnimationFrame(Hs))},[qt,Re,Fn]);const Lu={"data-side":Gt,"data-align":Ho,..._,ref:M,style:{..._.style,animation:Re?void 0:"none",opacity:(a=Ve.hide)!==null&&a!==void 0&&a.referenceHidden?0:void 0}};return w.createElement("div",{ref:Z,"data-radix-popper-content-wrapper":"",style:{position:Ee,left:0,top:0,transform:Re?`translate3d(${Math.round(ke)}px, ${Math.round(ue)}px, 0)`:"translate3d(0, -200%, 0)",minWidth:"max-content",zIndex:io,"--radix-popper-transform-origin":[(l=Ve.transformOrigin)===null||l===void 0?void 0:l.x,(c=Ve.transformOrigin)===null||c===void 0?void 0:c.y].join(" ")},dir:e.dir},w.createElement(mJ,{scope:u,placedSide:Gt,onArrowChange:z,arrowX:so,arrowY:cr,shouldHideArrow:Vo},qt?w.createElement(yJ,{scope:u,hasParent:!0,positionUpdateFns:Fn},w.createElement($i.div,Lu)):w.createElement($i.div,Lu)))});function xJ(e){return e!==void 0}function SJ(e){return e!==null}const bJ=e=>({name:"transformOrigin",options:e,fn(n){var t,r,o,s,i;const{placement:a,rects:l,middlewareData:c}=n,d=((t=c.arrow)===null||t===void 0?void 0:t.centerOffset)!==0,h=d?0:e.arrowWidth,f=d?0:e.arrowHeight,[p,m]=wM(a),y={start:"0%",center:"50%",end:"100%"}[m],x=((r=(o=c.arrow)===null||o===void 0?void 0:o.x)!==null&&r!==void 0?r:0)+h/2,S=((s=(i=c.arrow)===null||i===void 0?void 0:i.y)!==null&&s!==void 0?s:0)+f/2;let b="",P="";return p==="bottom"?(b=d?y:`${x}px`,P=`${-f}px`):p==="top"?(b=d?y:`${x}px`,P=`${l.floating.height+f}px`):p==="right"?(b=`${-f}px`,P=d?y:`${S}px`):p==="left"&&(b=`${l.floating.width+f}px`,P=d?y:`${S}px`),{data:{x:b,y:P}}}});function wM(e){const[n,t="center"]=e.split("-");return[n,t]}const PJ=fJ,EJ=gJ,_J=wJ,CJ=w.forwardRef((e,n)=>{var t;const{container:r=globalThis==null||(t=globalThis.document)===null||t===void 0?void 0:t.body,...o}=e;return r?bC.createPortal(w.createElement($i.div,W({},o,{ref:n})),r):null});function IJ(e,n){return w.useReducer((t,r)=>{const o=n[t][r];return o??t},e)}const Hw=e=>{const{present:n,children:t}=e,r=kJ(n),o=typeof t=="function"?t({present:r.isPresent}):w.Children.only(t),s=Bi(r.ref,o.ref);return typeof t=="function"||r.isPresent?w.cloneElement(o,{ref:s}):null};Hw.displayName="Presence";function kJ(e){const[n,t]=w.useState(),r=w.useRef({}),o=w.useRef(e),s=w.useRef("none"),i=e?"mounted":"unmounted",[a,l]=IJ(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return w.useEffect(()=>{const c=Bd(r.current);s.current=a==="mounted"?c:"none"},[a]),ds(()=>{const c=r.current,u=o.current;if(u!==e){const h=s.current,f=Bd(c);e?l("MOUNT"):f==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==f?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,l]),ds(()=>{if(n){const c=d=>{const f=Bd(r.current).includes(d.animationName);d.target===n&&f&&Do.flushSync(()=>l("ANIMATION_END"))},u=d=>{d.target===n&&(s.current=Bd(r.current))};return n.addEventListener("animationstart",u),n.addEventListener("animationcancel",c),n.addEventListener("animationend",c),()=>{n.removeEventListener("animationstart",u),n.removeEventListener("animationcancel",c),n.removeEventListener("animationend",c)}}else l("ANIMATION_END")},[n,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:w.useCallback(c=>{c&&(r.current=getComputedStyle(c)),t(c)},[])}}function Bd(e){return(e==null?void 0:e.animationName)||"none"}function $J({prop:e,defaultProp:n,onChange:t=()=>{}}){const[r,o]=TJ({defaultProp:n,onChange:t}),s=e!==void 0,i=s?e:r,a=Os(t),l=w.useCallback(c=>{if(s){const d=typeof c=="function"?c(e):c;d!==e&&a(d)}else o(c)},[s,e,o,a]);return[i,l]}function TJ({defaultProp:e,onChange:n}){const t=w.useState(e),[r]=t,o=w.useRef(r),s=Os(n);return w.useEffect(()=>{o.current!==r&&(s(r),o.current=r)},[r,o,s]),t}const xM="Popover",[SM,ane]=oM(xM,[yM]),Vw=yM(),[MJ,pl]=SM(xM),AJ=e=>{const{__scopePopover:n,children:t,open:r,defaultOpen:o,onOpenChange:s,modal:i=!1}=e,a=Vw(n),l=w.useRef(null),[c,u]=w.useState(!1),[d=!1,h]=$J({prop:r,defaultProp:o,onChange:s});return w.createElement(PJ,a,w.createElement(MJ,{scope:n,contentId:HZ(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:w.useCallback(()=>h(f=>!f),[h]),hasCustomAnchor:c,onCustomAnchorAdd:w.useCallback(()=>u(!0),[]),onCustomAnchorRemove:w.useCallback(()=>u(!1),[]),modal:i},t))},OJ="PopoverTrigger",RJ=w.forwardRef((e,n)=>{const{__scopePopover:t,...r}=e,o=pl(OJ,t),s=Vw(t),i=Bi(n,o.triggerRef),a=w.createElement($i.button,W({type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":EM(o.open)},r,{ref:i,onClick:vi(e.onClick,o.onOpenToggle)}));return o.hasCustomAnchor?a:w.createElement(EJ,W({asChild:!0},s),a)}),bM="PopoverPortal",[DJ,LJ]=SM(bM,{forceMount:void 0}),jJ=e=>{const{__scopePopover:n,forceMount:t,children:r,container:o}=e,s=pl(bM,n);return w.createElement(DJ,{scope:n,forceMount:t},w.createElement(Hw,{present:t||s.open},w.createElement(CJ,{asChild:!0,container:o},r)))},ou="PopoverContent",NJ=w.forwardRef((e,n)=>{const t=LJ(ou,e.__scopePopover),{forceMount:r=t.forceMount,...o}=e,s=pl(ou,e.__scopePopover);return w.createElement(Hw,{present:r||s.open},s.modal?w.createElement(zJ,W({},o,{ref:n})):w.createElement(BJ,W({},o,{ref:n})))}),zJ=w.forwardRef((e,n)=>{const t=pl(ou,e.__scopePopover),r=w.useRef(null),o=Bi(n,r),s=w.useRef(!1);return w.useEffect(()=>{const i=r.current;if(i)return fw(i)},[]),w.createElement(hw,{as:Bw,allowPinchZoom:!0},w.createElement(PM,W({},e,{ref:o,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:vi(e.onCloseAutoFocus,i=>{var a;i.preventDefault(),s.current||(a=t.triggerRef.current)===null||a===void 0||a.focus()}),onPointerDownOutside:vi(e.onPointerDownOutside,i=>{const a=i.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;s.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:vi(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})))}),BJ=w.forwardRef((e,n)=>{const t=pl(ou,e.__scopePopover),r=w.useRef(!1),o=w.useRef(!1);return w.createElement(PM,W({},e,{ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var i;if((i=e.onCloseAutoFocus)===null||i===void 0||i.call(e,s),!s.defaultPrevented){var a;r.current||(a=t.triggerRef.current)===null||a===void 0||a.focus(),s.preventDefault()}r.current=!1,o.current=!1},onInteractOutside:s=>{var i,a;(i=e.onInteractOutside)===null||i===void 0||i.call(e,s),s.defaultPrevented||(r.current=!0,s.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const l=s.target;((a=t.triggerRef.current)===null||a===void 0?void 0:a.contains(l))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&o.current&&s.preventDefault()}}))}),PM=w.forwardRef((e,n)=>{const{__scopePopover:t,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:s,disableOutsidePointerEvents:i,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=e,h=pl(ou,t),f=Vw(t);return RZ(),w.createElement(DZ,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:o,onUnmountAutoFocus:s},w.createElement(MZ,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1)},w.createElement(_J,W({"data-state":EM(h.open),role:"dialog",id:h.contentId},f,d,{ref:n,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}}))))});function EM(e){return e?"open":"closed"}const FJ=AJ,UJ=RJ,_M=jJ,CM=NJ,Ww=({id:e,children:n,onOpenChange:t})=>{const[r,o]=Ni(e,t);return g.jsx(FJ,{onOpenChange:o,open:r,children:g.jsx("div",{className:"tlui-popover",children:n})})},Yw=({children:e,disabled:n,"data-testid":t})=>g.jsx(UJ,{"data-testid":t,disabled:n,asChild:!0,dir:"ltr",children:e}),IM=({side:e,children:n,align:t="center",sideOffset:r=8,alignOffset:o=0})=>{const s=Yt();return g.jsx(_M,{dir:"ltr",container:s,children:g.jsx(CM,{className:"tlui-popover__content",side:e,sideOffset:r,align:t,alignOffset:o,dir:"ltr",children:n})})},kM=w.memo(function(){const n=we(),t=Yt(),r=BQ(),o=ro();function s(i){if(o&&!i.readonlyOk)return null;switch(i.type){case"item":{const{id:a,icon:l,label:c,kbd:u,onSelect:d}=i.actionItem;return g.jsx(se,{className:"tlui-button-grid__button","data-testid":`menu-item.${i.id}`,icon:l,title:c?u?`${n(c)} ${qr(u)}`:`${n(c)}`:u?`${qr(u)}`:"",onClick:()=>d("actions-menu"),disabled:i.disabled},a)}}}return g.jsxs(Ww,{id:"actions menu",children:[g.jsx(Yw,{children:g.jsx(se,{className:"tlui-menu__trigger","data-testid":"main.action-menu",icon:"dots-vertical",title:n("actions-menu.title"),smallIcon:!0})}),g.jsx(_M,{dir:"ltr",container:t,children:g.jsx(CM,{className:"tlui-popover__content",side:"bottom",dir:"ltr",sideOffset:6,children:g.jsx("div",{className:"tlui-actions-menu tlui-button-grid__four",children:r.map(s)})})})]})}),$M=me(function(){const n=U(),t=Xt(),r=we(),o=t.duplicate,s=n.selectedIds.length<=0;return g.jsx(se,{icon:o.icon,onClick:()=>o.onSelect("quick-actions"),disabled:s,title:`${r(o.label)} ${qr(o.kbd)}`,smallIcon:!0})}),KJ=w.memo(function(){const n=we();return g.jsxs(Ms,{id:"main menu",children:[g.jsx(Tu,{children:g.jsx(se,{className:"tlui-menu__trigger","data-testid":"main.menu",title:n("menu.title"),icon:"menu"})}),g.jsx(As,{alignOffset:0,sideOffset:6,children:g.jsx(HJ,{})})]})});function HJ(){const e=U(),n=we(),t=qQ(),r=lr(),o=ro();function s(i,a,l,c){switch(a.type){case"custom":return o&&!a.readonlyOk?null:a.id==="LANGUAGE_MENU"?g.jsx(nM,{},"item"):null;case"group":return o&&!a.readonlyOk?null:g.jsx(Eo,{size:c<=1?"medium":r<3||(l==null?void 0:l.type)==="submenu"&&c>2?"tiny":"medium",children:a.children.map(u=>s(i,u,a,c+1))},a.id);case"submenu":return o&&!a.readonlyOk?null:g.jsxs(Iw,{id:`main menu ${l?l.id+" ":""}${a.id}`,children:[g.jsx(kw,{label:a.label,"data-testid":`menu-item.${a.id}`}),g.jsx($w,{sideOffset:-4,alignOffset:-1,children:a.children.map(u=>s(i,u,a,c+1))})]},a.id);case"item":{if(o&&!a.readonlyOk)return null;const{id:u,checkbox:d,menuLabel:h,label:f,onSelect:p,kbd:m}=a.actionItem,y=h??f,x=y?n(y):void 0;return d?g.jsxs(v3,{onSelect:()=>p("menu"),title:x||"",checked:a.checked,disabled:a.disabled,children:[x&&g.jsx("span",{children:x}),m&&g.jsx(Cp,{children:m})]},u):g.jsx(Tn,{"data-testid":`menu-item.${a.id}`,kbd:m,label:y,onClick:()=>p("menu"),disabled:a.disabled},u)}}}return g.jsx(g.Fragment,{children:t.map(i=>s(e,i,null,0))})}const VJ=function({name:n,id:t,isCurrentPage:r}){const o=U(),s=w.useRef(null),i=w.useCallback(l=>{o.renamePage(t,l||"New Page",!0)},[o,t]),a=w.useCallback(l=>{o.mark("rename page"),o.renamePage(t,l||"New Page",!1)},[o,t]);return g.jsx(Mw,{className:"tlui-page-menu__item__input",ref:l=>s.current=l,defaultValue:n,onValueChange:i,onComplete:a,onCancel:a,shouldManuallyMaintainScrollPositionWhenFocused:!0,autofocus:r,autoselect:!0})},nv=(e,n,t,r)=>{let o;const s=e.pages,i=t>r?s[r-1]:s[r],a=t>r?s[r]:s[r+1];i&&!a?o=po(i.index):!i&&a?o=wj(s[0].index):o=cc(i.index,a.index),o!==s[t].index&&(e.mark("moving page"),e.updatePage({id:n,index:o}))},eE=me(function({index:n,listSize:t,item:r,onRename:o}){const s=U(),i=we(),a=s.pages,l=w.useCallback(()=>{s.mark("creating page");const h=Jn.createId();s.duplicatePage(r.id,h)},[s,r]),c=w.useCallback(()=>{nv(s,r.id,n,n-1)},[s,r,n]),u=w.useCallback(()=>{nv(s,r.id,n,n+1)},[s,r,n]),d=w.useCallback(()=>{s.mark("deleting page"),s.deletePage(r.id)},[s,r]);return g.jsxs(Ms,{id:`page item submenu ${n}`,children:[g.jsx(Tu,{children:g.jsx(se,{title:i("page-menu.submenu.title"),icon:"dots-vertical"})}),g.jsxs(As,{alignOffset:0,children:[g.jsxs(Eo,{children:[o&&g.jsx(ia,{dir:"ltr",onSelect:o,asChild:!0,children:g.jsx(se,{className:"tlui-menu__button",label:"page-menu.submenu.rename"})}),g.jsx(ia,{dir:"ltr",onSelect:l,disabled:a.length>=yf,asChild:!0,children:g.jsx(se,{className:"tlui-menu__button",label:"page-menu.submenu.duplicate-page"})}),n>0&&g.jsx(ia,{dir:"ltr",onSelect:c,asChild:!0,children:g.jsx(se,{className:"tlui-menu__button",label:"page-menu.submenu.move-up"})}),n<t-1&&g.jsx(ia,{dir:"ltr",onSelect:u,asChild:!0,children:g.jsx(se,{className:"tlui-menu__button",label:"page-menu.submenu.move-down"})})]}),t>1&&g.jsx(Eo,{children:g.jsx(ia,{dir:"ltr",onSelect:d,asChild:!0,children:g.jsx(se,{className:"tlui-menu__button",label:"page-menu.submenu.delete"})})})]})]})}),WJ=function(){const n=U(),t=we(),r=lr(),o=w.useCallback(()=>m(!1),[]),[s,i]=Ni("page-menu",o),a=r<5?36:40,l=w.useRef(null),c=J("pages",()=>n.pages,[n]),u=J("currentPage",()=>n.currentPage,[n]),d=J("isReadonlyMode",()=>n.isReadOnly,[n]),h=J("maxPageCountReached",()=>n.pages.length>=yf,[n]),f=J("isCoarsePointer",()=>n.isCoarsePointer,[n]),[p,m]=w.useState(!1),y=w.useCallback(()=>{d||m(T=>!T)},[d]),x=w.useRef({isPointing:!1,status:"idle",pointing:null,startY:0,startIndex:0,dragIndex:0}),[S,b]=w.useState(Object.fromEntries(c.map((T,M)=>[T.id,{y:M*a,offsetY:0,isSelected:!1}])));w.useLayoutEffect(()=>{b(Object.fromEntries(c.map((T,M)=>[T.id,{y:M*a,offsetY:0,isSelected:!1}])))},[a,c]),w.useEffect(()=>{s&&requestAnimationFrame(()=>{const T=document.querySelector(`[data-testid="page-menu-item-${u.id}"]`);if(T){const M=l.current;if(!M)return;const O=T.offsetTop,z=M.scrollTop;O<z&&M.scrollTo({top:O});const B=O+a,D=M.scrollTop+M.offsetHeight;B>D&&M.scrollTo({top:B-M.offsetHeight})}})},[a,u,s]);const P=w.useCallback(T=>{const{clientY:M,currentTarget:O}=T,{dataset:{id:z,index:B}}=O;if(!z||!B)return;const D=x.current;T.currentTarget.setPointerCapture(T.pointerId),D.status="pointing",D.pointing={id:z,index:+B};const V=S[z].y;D.startY=M,D.startIndex=Math.max(0,Math.min(Math.round(V/a),c.length-1))},[a,c.length,S]),C=w.useCallback(T=>{const M=x.current;if(M.status==="pointing"){const{clientY:O}=T,z=O-M.startY;Math.abs(z)>5&&(M.status="dragging")}if(M.status==="dragging"){const{clientY:O}=T,z=O-M.startY,B=S[M.pointing.id],{startIndex:D,pointing:F}=M,V=B.y+z,q=Math.max(0,Math.min(Math.round(V/a),c.length-1)),L={...S};if(L[F.id]={y:B.y,offsetY:z,isSelected:!0},q!==M.dragIndex){M.dragIndex=q;for(let N=0;N<c.length;N++){const H=c[N];if(H.id===M.pointing.id)continue;let{y:Q}=L[H.id];q===D?Q=N*a:q<D?q<=N&&N<D?Q=(N+1)*a:Q=N*a:q>D&&(q>=N&&N>D?Q=(N-1)*a:Q=N*a),Q!==L[H.id].y&&(L[H.id]={y:Q,offsetY:0,isSelected:!0})}}b(L)}},[a,c,S]),_=w.useCallback(T=>{const M=x.current;if(M.status==="dragging"){const{id:O,index:z}=M.pointing;nv(n,O,z,M.dragIndex)}T.currentTarget.releasePointerCapture(T.pointerId),M.status="idle"},[n]),I=w.useCallback(T=>{const M=x.current;T.key==="Escape"&&(M.status==="dragging"&&b(Object.fromEntries(c.map((O,z)=>[O.id,{y:z*a,offsetY:0,isSelected:!1}]))),M.status="idle")},[a,c]),k=w.useCallback(()=>{if(d)return;n.mark("creating page");const T=Jn.createId();n.createPage(t("page-menu.new-page-initial-name"),T),m(!0)},[n,t,d]);return g.jsxs(Ww,{id:"page menu",onOpenChange:i,open:s,children:[g.jsx(Yw,{children:g.jsx(se,{className:"tlui-page-menu__trigger tlui-menu__trigger","data-testid":"main.page-menu",icon:"chevron-down",title:u.name,children:g.jsx("div",{className:"tlui-page-menu__name",children:u.name})})}),g.jsx(IM,{side:"bottom",align:"start",sideOffset:6,children:g.jsxs("div",{className:"tlui-page-menu__wrapper",children:[g.jsxs("div",{className:"tlui-page-menu__header",children:[g.jsx("div",{className:"tlui-page-menu__header__title",children:t("page-menu.title")}),!d&&g.jsxs(g.Fragment,{children:[g.jsx(se,{"data-testid":"page-menu.edit",title:t(p?"page-menu.edit-done":"page-menu.edit-start"),icon:p?"check":"edit",onClick:y}),g.jsx(se,{"data-testid":"page-menu.create",icon:"plus",title:t(h?"page-menu.max-page-count-reached":"page-menu.create-new-page"),disabled:h,onClick:k})]})]}),g.jsx("div",{className:"tlui-page-menu__list tlui-menu__group",style:{height:a*c.length+4},ref:l,children:c.map((T,M)=>{const O=S[T.id]??{position:M*40,offsetY:0};return p?g.jsxs("div",{"data-testid":`page-menu-item-${T.id}`,className:"tlui-page_menu__item__sortable",style:{zIndex:T.id===u.id?888:M,transform:`translate(0px, ${O.y+O.offsetY}px)`},children:[g.jsx(se,{tabIndex:-1,className:"tlui-page_menu__item__sortable__handle",icon:"drag-handle-dots",onPointerDown:P,onPointerUp:_,onPointerMove:C,onKeyDown:I,"data-id":T.id,"data-index":M}),r<5&&f?g.jsx(se,{className:"tlui-page-menu__item__button",onClick:()=>{const z=window.prompt("Rename page",T.name);z&&z!==T.name&&n.renamePage(T.id,z)},onDoubleClick:y,isChecked:T.id===u.id,children:g.jsx("span",{children:T.name})}):g.jsx("div",{id:`page-menu-item-${T.id}`,"data-testid":`page-menu-item-${T.id}`,className:"tlui-page_menu__item__sortable__title",style:{height:a},children:g.jsx(VJ,{id:T.id,name:T.name,isCurrentPage:T.id===u.id})}),!d&&g.jsx("div",{className:"tlui-page_menu__item__submenu","data-isediting":p,children:g.jsx(eE,{index:M,item:T,listSize:c.length})})]},T.id+"_editing"):g.jsxs("div",{"data-testid":`page-menu-item-${T.id}`,className:"tlui-page-menu__item",children:[g.jsxs(se,{className:"tlui-page-menu__item__button tlui-page-menu__item__button__checkbox",onClick:()=>n.setCurrentPageId(T.id),onDoubleClick:y,isChecked:T.id===u.id,title:t("page-menu.go-to-page"),children:[g.jsx("div",{className:"tlui-page-menu__item__button__check",children:T.id===u.id&&g.jsx(vn,{icon:"check"})}),g.jsx("span",{children:T.name})]}),!d&&g.jsx("div",{className:"tlui-page_menu__item__submenu",children:g.jsx(eE,{index:M,item:T,listSize:c.length,onRename:()=>{if(n.isIos){const z=window.prompt("Rename page",T.name);z&&z!==T.name&&n.renamePage(T.id,z)}else m(!0),n.setCurrentPageId(T.id)}})})]},T.id)})})]})})]})},TM=w.memo(function(){const n=we(),t=q3(),o=Xt().redo;return g.jsx(se,{"data-testid":"main.redo",icon:o.icon,title:`${n(o.label)} ${qr(o.kbd)}`,disabled:!t,onClick:()=>o.onSelect("quick-actions"),smallIcon:!0})}),MM=me(function(){const n=U(),t=Xt(),r=we(),o=t.delete;if(ro())return null;const i=n.selectedIds.length<=0;return g.jsx(se,{icon:o.icon,onClick:()=>o.onSelect("quick-actions"),disabled:i,title:`${r(o.label)} ${qr(o.kbd)}`,smallIcon:!0})}),AM=w.memo(function(){const n=we(),t=Q3(),o=Xt().undo;return g.jsx(se,{"data-testid":"main.undo",icon:o.icon,title:`${n(o.label)} ${qr(o.kbd)}`,disabled:!t,onClick:()=>o.onSelect("quick-actions"),smallIcon:!0})}),YJ=me(function(){const n=U(),t=lr(),o=!ro()&&!n.isInAny("hand","zoom","eraser");return g.jsx("div",{className:"tlui-menu-zone",children:g.jsxs("div",{className:"tlui-menu-zone__controls",children:[g.jsx(KJ,{}),g.jsx("div",{className:"tlui-menu-zone__divider"}),g.jsx(WJ,{}),t>=6&&o&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"tlui-menu-zone__divider"}),g.jsx(AM,{}),g.jsx(TM,{}),g.jsx(MM,{}),g.jsx($M,{}),g.jsx(kM,{})]})]})})});function XJ(e,n){const[t,r]=oe.useState(n);oe.useLayoutEffect(()=>{const s=localStorage.getItem(e);if(s)try{r(JSON.parse(s))}catch{console.error(`Could not restore value ${e} from local storage.`)}},[e]);const o=oe.useCallback(s=>{r(i=>{const a=typeof s=="function"?s(i):s;return localStorage.setItem(e,JSON.stringify(a)),a})},[e]);return[t,o]}class gc{constructor(n,t){v(this,"colors",{shapeFill:"rgba(144, 144, 144, .1)",selectFill:"#2f80ed",viewportFill:"rgba(144, 144, 144, .1)"});v(this,"id",nt());v(this,"cvs",null);v(this,"pageBounds",[]);v(this,"collaborators",[]);v(this,"canvasScreenBounds",new ne);v(this,"canvasPageBounds",new ne);v(this,"contentPageBounds",new ne);v(this,"contentScreenBounds",new ne);v(this,"originPagePoint",new E);v(this,"originPageCenter",new E);v(this,"isInViewport",!1);v(this,"debug",!1);v(this,"updateContentScreenBounds",()=>{const{contentScreenBounds:n,contentPageBounds:t,canvasScreenBounds:r}=this;let{x:o,y:s,w:i,h:a}=n;if(t.w>t.h){const l=r.w/(t.w/t.h);l>r.h?(o=(r.w-r.w*(r.h/l))/2,s=0,i=r.w*(r.h/l),a=r.h):(o=0,s=(r.h-l)/2,i=r.w,a=l)}else if(t.w<t.h){const l=r.h/(t.h/t.w);o=(r.w-l)/2,s=0,i=l,a=r.h}else o=r.h/2,s=0,i=r.h,a=r.h;n.set(o,s,i,a)});v(this,"updateCanvasPageBounds",()=>{const{canvasPageBounds:n,canvasScreenBounds:t,contentPageBounds:r,contentScreenBounds:o}=this;n.set(0,0,r.width/(o.width/t.width),r.height/(o.height/t.height)),n.center=r.center});v(this,"getScreenPoint",(n,t)=>{const{canvasScreenBounds:r}=this,o=(n-r.minX)*this.dpr,s=(t-r.minY)*this.dpr;return{x:o,y:s}});v(this,"getPagePoint",(n,t)=>{const{contentPageBounds:r,contentScreenBounds:o,canvasPageBounds:s}=this,{x:i,y:a}=this.getScreenPoint(n,t);return{x:s.minX+i*r.width/o.width,y:s.minY+a*r.height/o.height,z:1}});v(this,"minimapScreenPointToPagePoint",(n,t,r=!1,o=!1)=>{const{editor:s}=this,{viewportPageBounds:i}=s;let{x:a,y:l}=this.getPagePoint(n,t);if(o){const c=this.editor.allShapesCommonBounds,u=i,d=((c==null?void 0:c.minX)??0)-u.width/2,h=((c==null?void 0:c.maxX)??0)+u.width/2,f=((c==null?void 0:c.minY)??0)-u.height/2,p=((c==null?void 0:c.maxY)??0)+u.height/2,m=Math.max(0,d+u.width-a),y=Math.max(0,-(h-u.width-a)),x=Math.max(0,f+u.height-l),S=Math.max(0,-(p-u.height-l)),b=Math.max(0,m-y),P=Math.max(0,y-m),C=Math.max(0,x-S),_=Math.max(0,S-x);b&&b>P?a+=b/2:P&&(a-=P/2),C&&C>_?l+=C/2:_&&(l-=_/2),a=xr(a,d,h),l=xr(l,f,p)}if(r){const{originPagePoint:c}=this,u=Math.abs(a-c.x),d=Math.abs(l-c.y);u>d?l=c.y:a=c.x}return{x:a,y:l}});v(this,"render",()=>{const{cvs:n,pageBounds:t}=this;this.updateCanvasPageBounds();const{editor:r,canvasScreenBounds:o,canvasPageBounds:s,contentPageBounds:i,contentScreenBounds:a}=this,{width:l,height:c}=o,{viewportPageBounds:u,selectedIds:d}=r;if(!n||!t)return;const h=n.getContext("2d");if(!h)throw new Error("Minimap (shapes): Could not get context");h.resetTransform(),h.globalAlpha=1,h.clearRect(0,0,l,c);const f=a.width/i.width,p=a.height/i.height;h.translate((l-a.width)/2,(c-a.height)/2),h.scale(f,p),h.translate(-i.minX,-i.minY);const m=8/f,y=8/f,x=1/f,S=1/f,b=m/4,P=y/4,C=new Path2D,_=new Path2D,{shapeFill:I,selectFill:k,viewportFill:T}=this.colors;let M;for(let F=0,V=t.length;F<V;F++)M=t[F],gc.roundedRect(d.includes(M.id)?_:C,M.minX,M.minY,M.width,M.height,xr(m,x,M.width/b),xr(y,S,M.height/P));if(h.fillStyle=I,h.fill(C),h.fillStyle=k,h.fill(_),this.debug){const F=ne.Common(t),{minX:V,minY:q,width:L,height:N}=F;h.strokeStyle="green",h.lineWidth=2/f,h.strokeRect(V+1/f,q+1/p,L-2/f,N-2/p)}{const{brush:F}=r;if(F){const{x:V,y:q,w:L,h:N}=F;h.beginPath(),gc.sharpRect(h,V,q,L,N),h.closePath(),h.fillStyle=T,h.fill()}}{const{minX:F,minY:V,width:q,height:L}=u;h.beginPath();const N=12/f,H=12/f;gc.roundedRect(h,F,V,q,L,Math.min(q/4,N),Math.min(L/4,H)),h.closePath(),h.fillStyle=T,h.fill(),this.debug&&(h.strokeStyle="orange",h.strokeRect(F+1/f,V+1/p,q-2/f,L-2/p))}const O=2.5/f,z=2.5/p,{currentPageId:B}=r;let D;for(let F=0;F<this.collaborators.length;F++)D=this.collaborators[F],D.currentPageId===B&&(h.beginPath(),h.ellipse(xr(D.cursor.x,s.minX+O,s.maxX-O),xr(D.cursor.y,s.minY+z,s.maxY-z),5/f,5/p,0,0,qe),h.fillStyle=D.color,h.fill());if(this.debug){h.lineWidth=2/f;{const{minX:F,minY:V,width:q,height:L}=i;h.strokeStyle="red",h.strokeRect(F+1/f,V+1/p,q-2/f,L-2/p)}{const{minX:F,minY:V,width:q,height:L}=s;h.strokeStyle="blue",h.strokeRect(F+1/f,V+1/p,q-2/f,L-2/p)}}});this.editor=n,this.dpr=t}setDpr(n){this.dpr=+n.toFixed(2)}static roundedRect(n,t,r,o,s,i,a){if(i<1&&a<1){n.rect(t,r,o,s);return}n.moveTo(t+i,r),n.lineTo(t+o-i,r),n.quadraticCurveTo(t+o,r,t+o,r+a),n.lineTo(t+o,r+s-a),n.quadraticCurveTo(t+o,r+s,t+o-i,r+s),n.lineTo(t+i,r+s),n.quadraticCurveTo(t,r+s,t,r+s-a),n.lineTo(t,r+a),n.quadraticCurveTo(t,r,t+i,r)}static sharpRect(n,t,r,o,s,i,a){n.rect(t,r,o,s)}}const GJ=me(function({shapeFill:n,selectFill:t,viewportFill:r}){const o=U(),s=w.useRef(null),i=Yt(),a=w.useRef(!1),l=w.useMemo(()=>new gc(o,o.devicePixelRatio),[o]),c=o.isDarkMode;w.useEffect(()=>{const y=requestAnimationFrame(()=>{const x=getComputedStyle(i);l.colors={shapeFill:x.getPropertyValue(n).trim(),selectFill:x.getPropertyValue(t).trim(),viewportFill:x.getPropertyValue(r).trim()},l.render()});return()=>{cancelAnimationFrame(y)}},[i,t,n,r,l,c]);const u=w.useCallback(y=>{if(!o.currentPageShapeIds.size)return;const{x,y:S}=l.minimapScreenPointToPagePoint(y.clientX,y.clientY,!1,!1),b=l.minimapScreenPointToPagePoint(y.clientX,y.clientY,!1,!0);l.originPagePoint.setTo(b),l.originPageCenter.setTo(o.viewportPageBounds.center),o.centerOnPoint(x,S,{duration:go})},[o,l]),d=w.useCallback(y=>{if(y.currentTarget.setPointerCapture(y.pointerId),!o.currentPageShapeIds.size)return;a.current=!0,l.isInViewport=!1;const{x,y:S}=l.minimapScreenPointToPagePoint(y.clientX,y.clientY,!1,!1),b=l.minimapScreenPointToPagePoint(y.clientX,y.clientY,!1,!0),P=o.viewportPageBounds;l.originPagePoint.setTo(b),l.originPageCenter.setTo(P.center),l.isInViewport=P.containsPoint(b),l.isInViewport||o.centerOnPoint(x,S,{duration:go})},[o,l]),h=w.useCallback(y=>{if(a.current){const{x:P,y:C}=l.minimapScreenPointToPagePoint(y.clientX,y.clientY,y.shiftKey,!0);if(l.isInViewport){const _=E.Sub({x:P,y:C},l.originPagePoint),I=E.Add(l.originPageCenter,_);o.centerOnPoint(I.x,I.y);return}o.centerOnPoint(P,C)}const x=l.getPagePoint(y.clientX,y.clientY),S=o.pageToScreen(x.x,x.y),b={type:"pointer",target:"canvas",name:"pointer_move",...qJ(y),point:S,isPen:o.isPenMode};o.dispatch(b)},[o,l]),f=w.useCallback(y=>{a.current=!1},[]),p=w.useCallback(y=>{const x=Ek(y);o.dispatch({type:"wheel",name:"wheel",delta:x,shiftKey:y.shiftKey,altKey:y.altKey,ctrlKey:y.metaKey||y.ctrlKey})},[o]);pi("update dpr",()=>{const{devicePixelRatio:y}=o;l.setDpr(y);const x=s.current,S=x.getBoundingClientRect(),b=S.width*y,P=S.height*y;x.width=b,x.height=P,l.canvasScreenBounds.set(S.x,S.y,b,P),l.cvs=s.current},[o,l]);const m=w.useMemo(()=>o.store.query.records("instance_presence"),[o]);return pi("minimap render when pagebounds or collaborators changes",()=>{const{devicePixelRatio:y,viewportPageBounds:x,allShapesCommonBounds:S}=o;l.contentPageBounds=S?ne.Expand(S,x):x,l.updateContentScreenBounds();const b=[];o.currentPageShapeIds.forEach(P=>{let C=o.getPageBoundsById(P);const _=o.getPageMaskById(P);if(_){const I=E0(_,C.corners);if(!I)return;C=ne.FromPoints(I)}C&&(C.id=P,b.push(C))}),l.pageBounds=b,l.collaborators=m.value,l.render()},[o,l]),g.jsx("div",{className:"tlui-minimap",children:g.jsx("canvas",{ref:s,className:"tlui-minimap__canvas",onDoubleClick:u,onPointerMove:h,onPointerDown:d,onPointerUp:f,onWheel:p})})});function qJ(e){return e.isKilled=!0,{point:{x:e.clientX,y:e.clientY,z:e.pressure},shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey,pointerId:e.pointerId,button:e.button,isPen:e.pointerType==="pen"}}const jm=me(function(){const n=U(),t=we(),r=lr(),o=n.zoomLevel,s=n.currentPageShapeIds.size>0,i=n.selectedIds.length>0,a=n.zoomLevel===1,l=w.useCallback(()=>{n.resetZoom(n.viewportScreenCenter,{duration:go})},[n]);return g.jsxs(Ms,{id:"zoom",children:[g.jsx(Tu,{children:g.jsx(se,{title:`${t("navigation-zone.zoom")}`,"data-testid":"minimap.zoom-menu",className:r<5?"tlui-zoom-menu__button":"tlui-zoom-menu__button__pct",onDoubleClick:l,icon:r<4?"zoom-in":void 0,children:r<4?null:g.jsxs("span",{style:{flexGrow:0,textAlign:"center"},children:[Math.floor(o*100),"%"]})})}),g.jsx(As,{side:"top",align:"start",alignOffset:0,children:g.jsxs(Eo,{children:[g.jsx(Ul,{action:"zoom-in","data-testid":"minimap.zoom-menu.zoom-in",noClose:!0}),g.jsx(Ul,{action:"zoom-out","data-testid":"minimap.zoom-menu.zoom-out",noClose:!0}),g.jsx(Ul,{action:"zoom-to-100","data-testid":"minimap.zoom-menu.zoom-to-100",noClose:!0,disabled:a}),g.jsx(Ul,{action:"zoom-to-fit",disabled:!s,"data-testid":"minimap.zoom-menu.zoom-to-fit",noClose:!0}),g.jsx(Ul,{action:"zoom-to-selection",disabled:!i,"data-testid":"minimap.zoom-menu.zoom-to-selection",noClose:!0})]})})]})});function Ul(e){const{action:n,disabled:t=!1,noClose:r=!1}=e,o=Xt();return g.jsx(Tn,{label:o[n].label,kbd:o[n].kbd,"data-testid":e["data-testid"],onClick:()=>o[n].onSelect("zoom-menu"),noClose:r,disabled:t})}const QJ=w.memo(function(){const n=Xt(),t=we(),r=lr(),[o,s]=XJ("minimap",!0),i=w.useCallback(()=>{s(a=>!a)},[s]);return r<4?null:g.jsxs("div",{className:"tlui-navigation-zone",children:[g.jsx("div",{className:"tlui-navigation-zone__controls",children:r<6?g.jsx(jm,{}):o?g.jsxs(g.Fragment,{children:[g.jsx(jm,{}),g.jsx(se,{title:t("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle","data-testid":"minimap.toggle",onClick:i,icon:o?"chevrons-ne":"chevrons-sw"})]}):g.jsxs(g.Fragment,{children:[g.jsx(se,{icon:"minus","data-testid":"minimap.zoom-out",title:`${t(n["zoom-out"].label)} ${qr(n["zoom-out"].kbd)}`,onClick:()=>n["zoom-out"].onSelect("navigation-zone")}),g.jsx(jm,{}),g.jsx(se,{icon:"plus","data-testid":"minimap.zoom-in",title:`${t(n["zoom-in"].label)} ${qr(n["zoom-in"].kbd)}`,onClick:()=>n["zoom-in"].onSelect("navigation-zone")}),g.jsx(se,{title:t("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle",onClick:i,icon:o?"chevrons-ne":"chevrons-sw"})]})}),r>=6&&!o&&g.jsx(GJ,{viewportFill:"--color-muted-1",selectFill:"--color-selected",shapeFill:"--color-text-3"})]})}),ZJ=me(function(){const t=U().isPenMode,r=Xt();if(!t)return null;const o=r["exit-pen-mode"];return g.jsx(se,{label:o.label,iconLeft:o.icon,onClick:()=>o.onSelect("helper-buttons")})}),JJ=me(function(){const n=U(),t=Xt();if(!n.instanceState.followingUserId)return null;const r=t["stop-following"];return g.jsx(se,{label:r.label,iconLeft:r.icon,onClick:()=>r.onSelect("people-menu")})});function eee(e){const{uiType:n,items:t,title:r,style:o,value:s,columns:i=xr(t.length,2,4),onValueChange:a}=e,l=U(),c=we(),u=w.useRef(!1),{handleButtonClick:d,handleButtonPointerDown:h,handleButtonPointerEnter:f,handleButtonPointerUp:p}=w.useMemo(()=>{const y=()=>{u.current=!1,window.removeEventListener("pointerup",y)};return{handleButtonClick:C=>{const{id:_}=C.currentTarget.dataset;s.type==="shared"&&s.value===_||(l.mark("point picker item"),a(o,_,!1))},handleButtonPointerDown:C=>{const{id:_}=C.currentTarget.dataset;l.mark("point picker item"),a(o,_,!0),u.current=!0,window.addEventListener("pointerup",y)},handleButtonPointerEnter:C=>{if(!u.current)return;const{id:_}=C.currentTarget.dataset;a(o,_,!0)},handleButtonPointerUp:C=>{const{id:_}=C.currentTarget.dataset;a(o,_,!1)}}},[s,l,a,o]),m=J("theme",()=>Sn(l),[l]);return g.jsx("div",{className:de("tlui-button-grid",{"tlui-button-grid__two":i===2,"tlui-button-grid__three":i===3,"tlui-button-grid__four":i===4}),children:t.map(y=>g.jsx(se,{"data-id":y.value,"data-testid":`style.${n}.${y.value}`,"aria-label":y.value,"data-state":s.type==="shared"&&s.value===y.value?"hinted":void 0,title:r+"  "+c(`${n}-style.${y.value}`),className:de("tlui-button-grid__button"),style:o===or?{color:m[y.value].solid}:void 0,onPointerEnter:f,onPointerDown:h,onPointerUp:p,onClick:d,icon:y.icon},y.value))})}const Ea=w.memo(eee);function OM(e,[n,t]){return Math.min(t,Math.max(n,e))}function tee(e){const n=w.useRef({value:e,previous:e});return w.useMemo(()=>(n.current.value!==e&&(n.current.previous=n.current.value,n.current.value=e),n.current.previous),[e])}const RM=["PageUp","PageDown"],DM=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],LM={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Ou="Slider",[rv,nee,ree]=Tp(Ou),[jM,lne]=zo(Ou,[ree]),[oee,Bp]=jM(Ou),see=w.forwardRef((e,n)=>{const{name:t,min:r=0,max:o=100,step:s=1,orientation:i="horizontal",disabled:a=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:u,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:f=!1,...p}=e,[m,y]=w.useState(null),x=Ze(n,D=>y(D)),S=w.useRef(new Set),b=w.useRef(0),P=i==="horizontal",C=m?!!m.closest("form"):!0,_=P?iee:aee,[I=[],k]=Li({prop:u,defaultProp:c,onChange:D=>{var F;(F=[...S.current][b.current])===null||F===void 0||F.focus(),d(D)}}),T=w.useRef(I);function M(D){const F=mee(I,D);B(D,F)}function O(D){B(D,b.current)}function z(){const D=T.current[b.current];I[b.current]!==D&&h(I)}function B(D,F,{commit:V}={commit:!1}){const q=xee(s),L=See(Math.round((D-r)/s)*s+r,q),N=OM(L,[r,o]);k((H=[])=>{const Q=pee(H,N,F);if(wee(Q,l*s)){b.current=Q.indexOf(N);const Z=String(Q)!==String(H);return Z&&V&&h(Q),Z?Q:H}else return H})}return w.createElement(oee,{scope:e.__scopeSlider,disabled:a,min:r,max:o,valueIndexToChangeRef:b,thumbs:S.current,values:I,orientation:i},w.createElement(rv.Provider,{scope:e.__scopeSlider},w.createElement(rv.Slot,{scope:e.__scopeSlider},w.createElement(_,W({"aria-disabled":a,"data-disabled":a?"":void 0},p,{ref:x,onPointerDown:ie(p.onPointerDown,()=>{a||(T.current=I)}),min:r,max:o,inverted:f,onSlideStart:a?void 0:M,onSlideMove:a?void 0:O,onSlideEnd:a?void 0:z,onHomeKeyDown:()=>!a&&B(r,0,{commit:!0}),onEndKeyDown:()=>!a&&B(o,I.length-1,{commit:!0}),onStepKeyDown:({event:D,direction:F})=>{if(!a){const L=RM.includes(D.key)||D.shiftKey&&DM.includes(D.key)?10:1,N=b.current,H=I[N],Q=s*L*F;B(H+Q,N,{commit:!0})}}})))),C&&I.map((D,F)=>w.createElement(fee,{key:F,name:t?t+(I.length>1?"[]":""):void 0,value:D})))}),[NM,zM]=jM(Ou,{startEdge:"left",endEdge:"right",size:"width",direction:1}),iee=w.forwardRef((e,n)=>{const{min:t,max:r,dir:o,inverted:s,onSlideStart:i,onSlideMove:a,onSlideEnd:l,onStepKeyDown:c,...u}=e,[d,h]=w.useState(null),f=Ze(n,b=>h(b)),p=w.useRef(),m=mw(o),y=m==="ltr",x=y&&!s||!y&&s;function S(b){const P=p.current||d.getBoundingClientRect(),C=[0,P.width],I=Xw(C,x?[t,r]:[r,t]);return p.current=P,I(b-P.left)}return w.createElement(NM,{scope:e.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width"},w.createElement(BM,W({dir:m,"data-orientation":"horizontal"},u,{ref:f,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:b=>{const P=S(b.clientX);i==null||i(P)},onSlideMove:b=>{const P=S(b.clientX);a==null||a(P)},onSlideEnd:()=>{p.current=void 0,l==null||l()},onStepKeyDown:b=>{const C=LM[x?"from-left":"from-right"].includes(b.key);c==null||c({event:b,direction:C?-1:1})}})))}),aee=w.forwardRef((e,n)=>{const{min:t,max:r,inverted:o,onSlideStart:s,onSlideMove:i,onSlideEnd:a,onStepKeyDown:l,...c}=e,u=w.useRef(null),d=Ze(n,u),h=w.useRef(),f=!o;function p(m){const y=h.current||u.current.getBoundingClientRect(),x=[0,y.height],b=Xw(x,f?[r,t]:[t,r]);return h.current=y,b(m-y.top)}return w.createElement(NM,{scope:e.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1},w.createElement(BM,W({"data-orientation":"vertical"},c,{ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:m=>{const y=p(m.clientY);s==null||s(y)},onSlideMove:m=>{const y=p(m.clientY);i==null||i(y)},onSlideEnd:()=>{h.current=void 0,a==null||a()},onStepKeyDown:m=>{const x=LM[f?"from-bottom":"from-top"].includes(m.key);l==null||l({event:m,direction:x?-1:1})}})))}),BM=w.forwardRef((e,n)=>{const{__scopeSlider:t,onSlideStart:r,onSlideMove:o,onSlideEnd:s,onHomeKeyDown:i,onEndKeyDown:a,onStepKeyDown:l,...c}=e,u=Bp(Ou,t);return w.createElement(Oe.span,W({},c,{ref:n,onKeyDown:ie(e.onKeyDown,d=>{d.key==="Home"?(i(d),d.preventDefault()):d.key==="End"?(a(d),d.preventDefault()):RM.concat(DM).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:ie(e.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(h)?h.focus():r(d)}),onPointerMove:ie(e.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&o(d)}),onPointerUp:ie(e.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),s(d))})}))}),lee="SliderTrack",cee=w.forwardRef((e,n)=>{const{__scopeSlider:t,...r}=e,o=Bp(lee,t);return w.createElement(Oe.span,W({"data-disabled":o.disabled?"":void 0,"data-orientation":o.orientation},r,{ref:n}))}),tE="SliderRange",uee=w.forwardRef((e,n)=>{const{__scopeSlider:t,...r}=e,o=Bp(tE,t),s=zM(tE,t),i=w.useRef(null),a=Ze(n,i),l=o.values.length,c=o.values.map(h=>FM(h,o.min,o.max)),u=l>1?Math.min(...c):0,d=100-Math.max(...c);return w.createElement(Oe.span,W({"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0},r,{ref:a,style:{...e.style,[s.startEdge]:u+"%",[s.endEdge]:d+"%"}}))}),nE="SliderThumb",dee=w.forwardRef((e,n)=>{const t=nee(e.__scopeSlider),[r,o]=w.useState(null),s=Ze(n,a=>o(a)),i=w.useMemo(()=>r?t().findIndex(a=>a.ref.current===r):-1,[t,r]);return w.createElement(hee,W({},e,{ref:s,index:i}))}),hee=w.forwardRef((e,n)=>{const{__scopeSlider:t,index:r,...o}=e,s=Bp(nE,t),i=zM(nE,t),[a,l]=w.useState(null),c=Ze(n,y=>l(y)),u=AT(a),d=s.values[r],h=d===void 0?0:FM(d,s.min,s.max),f=gee(r,s.values.length),p=u==null?void 0:u[i.size],m=p?yee(p,h,i.direction):0;return w.useEffect(()=>{if(a)return s.thumbs.add(a),()=>{s.thumbs.delete(a)}},[a,s.thumbs]),w.createElement("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[i.startEdge]:`calc(${h}% + ${m}px)`}},w.createElement(rv.ItemSlot,{scope:e.__scopeSlider},w.createElement(Oe.span,W({role:"slider","aria-label":e["aria-label"]||f,"aria-valuemin":s.min,"aria-valuenow":d,"aria-valuemax":s.max,"aria-orientation":s.orientation,"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,tabIndex:s.disabled?void 0:0},o,{ref:c,style:d===void 0?{display:"none"}:e.style,onFocus:ie(e.onFocus,()=>{s.valueIndexToChangeRef.current=r})}))))}),fee=e=>{const{value:n,...t}=e,r=w.useRef(null),o=tee(n);return w.useEffect(()=>{const s=r.current,i=window.HTMLInputElement.prototype,l=Object.getOwnPropertyDescriptor(i,"value").set;if(o!==n&&l){const c=new Event("input",{bubbles:!0});l.call(s,n),s.dispatchEvent(c)}},[o,n]),w.createElement("input",W({style:{display:"none"}},t,{ref:r,defaultValue:n}))};function pee(e=[],n,t){const r=[...e];return r[t]=n,r.sort((o,s)=>o-s)}function FM(e,n,t){const s=100/(t-n)*(e-n);return OM(s,[0,100])}function gee(e,n){return n>2?`Value ${e+1} of ${n}`:n===2?["Minimum","Maximum"][e]:void 0}function mee(e,n){if(e.length===1)return 0;const t=e.map(o=>Math.abs(o-n)),r=Math.min(...t);return t.indexOf(r)}function yee(e,n,t){const r=e/2,s=Xw([0,50],[0,r]);return(r-s(n)*t)*t}function vee(e){return e.slice(0,-1).map((n,t)=>e[t+1]-n)}function wee(e,n){if(n>0){const t=vee(e);return Math.min(...t)>=n}return!0}function Xw(e,n){return t=>{if(e[0]===e[1]||n[0]===n[1])return n[0];const r=(n[1]-n[0])/(e[1]-e[0]);return n[0]+r*(t-e[0])}}function xee(e){return(String(e).split(".")[1]||"").length}function See(e,n){const t=Math.pow(10,n);return Math.round(e*t)/t}const bee=see,Pee=cee,Eee=uee,_ee=dee,Cee=w.memo(function(n){const{title:t,steps:r,value:o,label:s,onValueChange:i}=n,a=U(),l=we(),c=w.useCallback(h=>{i(h[0],!0)},[i]),u=w.useCallback(()=>{a.mark("click slider")},[a]),d=w.useCallback(()=>{o&&i(o,!1)},[o,i]);return g.jsx("div",{className:"tlui-slider__container",children:g.jsxs(bee,{"data-testid":n["data-testid"],className:"tlui-slider","area-label":"Opacity",dir:"ltr",min:0,max:r,step:1,value:o?[o]:void 0,onPointerDown:u,onValueChange:c,onPointerUp:d,title:t+"  "+l(s),children:[g.jsx(Pee,{className:"tlui-slider__track",dir:"ltr",children:o!==null&&g.jsx(Eee,{className:"tlui-slider__range",dir:"ltr"})}),o!==null&&g.jsx(_ee,{className:"tlui-slider__thumb",dir:"ltr"})]})})}),Iee=w.memo(function({label:n,uiTypeA:t,uiTypeB:r,labelA:o,labelB:s,itemsA:i,itemsB:a,styleA:l,styleB:c,valueA:u,valueB:d,onValueChange:h}){const f=we(),p=w.useMemo(()=>{var y;return((y=i.find(x=>u.type==="shared"&&u.value===x.value))==null?void 0:y.icon)??"mixed"},[i,u]),m=w.useMemo(()=>{var y;return((y=a.find(x=>d.type==="shared"&&d.value===x.value))==null?void 0:y.icon)??"mixed"},[a,d]);return u===void 0&&d===void 0?null:g.jsxs("div",{className:"tlui-style-panel__double-select-picker",children:[g.jsx("div",{title:f(n),className:"tlui-style-panel__double-select-picker-label",children:f(n)}),g.jsxs(Ms,{id:`style panel ${t} A`,children:[g.jsx(nu,{asChild:!0,children:g.jsx(se,{"data-testid":`style.${t}`,title:f(o)+"  "+f(u===null?"style-panel.mixed":`${t}-style.${u}`),icon:p,invertIcon:!0,smallIcon:!0})}),g.jsx(As,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:g.jsx("div",{className:de("tlui-button-grid",{"tlui-button-grid__two":i.length<4,"tlui-button-grid__four":i.length>=4}),children:i.map(y=>g.jsx(Tn,{className:"tlui-button-grid__button",title:f(o)+"  "+f(`${t}-style.${y.value}`),"data-testid":`style.${t}.${y.value}`,icon:y.icon,onClick:()=>h(l,y.value,!1),invertIcon:!0},y.value))})})]}),g.jsxs(Ms,{id:`style panel ${r}`,children:[g.jsx(nu,{asChild:!0,children:g.jsx(se,{"data-testid":`style.${r}`,title:f(s)+"  "+f(d===null?"style-panel.mixed":`${r}-style.${d}`),icon:m,smallIcon:!0})}),g.jsx(As,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:g.jsx("div",{className:de("tlui-button-grid",{"tlui-button-grid__two":i.length<4,"tlui-button-grid__four":i.length>=4}),children:a.map(y=>g.jsx(Tn,{className:"tlui-button-grid__button",title:f(s)+"  "+f(`${r}-style.${y.value}`),"data-testid":`style.${r}.${y.value}`,icon:y.icon,onClick:()=>h(c,y.value,!1)},y.value))})})]})]})}),Gw=w.memo(function({id:n,label:t,uiType:r,style:o,items:s,value:i,onValueChange:a}){const l=we(),c=w.useMemo(()=>{var u;return(u=s.find(d=>i.type==="shared"&&d.value===i.value))==null?void 0:u.icon},[s,i]);return g.jsxs(Ms,{id:`style panel ${n}`,children:[g.jsx(nu,{asChild:!0,children:g.jsx(se,{"data-testid":`style.${r}`,title:i.type==="mixed"?l("style-panel.mixed"):l(`${r}-style.${i.value}`),label:t,icon:c??"mixed"})}),g.jsx(As,{side:"left",align:"center",alignOffset:0,children:g.jsx("div",{className:de("tlui-button-grid",{"tlui-button-grid__two":s.length<3,"tlui-button-grid__three":s.length==3,"tlui-button-grid__four":s.length>=4}),children:s.map(u=>g.jsx(Tn,{className:"tlui-button-grid__button","data-testid":`style.${r}.${u.value}`,title:l(`${r}-style.${u.value}`),icon:u.icon,onClick:()=>a(o,u.value,!1)},u.value))})})]})}),Pr={color:[{value:"black",icon:"color"},{value:"grey",icon:"color"},{value:"light-violet",icon:"color"},{value:"violet",icon:"color"},{value:"blue",icon:"color"},{value:"light-blue",icon:"color"},{value:"yellow",icon:"color"},{value:"orange",icon:"color"},{value:"green",icon:"color"},{value:"light-green",icon:"color"},{value:"light-red",icon:"color"},{value:"red",icon:"color"}],fill:[{value:"none",icon:"fill-none"},{value:"semi",icon:"fill-semi"},{value:"solid",icon:"fill-solid"},{value:"pattern",icon:"fill-pattern"}],dash:[{value:"draw",icon:"dash-draw"},{value:"dashed",icon:"dash-dashed"},{value:"dotted",icon:"dash-dotted"},{value:"solid",icon:"dash-solid"}],size:[{value:"s",icon:"size-small"},{value:"m",icon:"size-medium"},{value:"l",icon:"size-large"},{value:"xl",icon:"size-extra-large"}],font:[{value:"draw",icon:"font-draw"},{value:"sans",icon:"font-sans"},{value:"serif",icon:"font-serif"},{value:"mono",icon:"font-mono"}],horizontalAlign:[{value:"start",icon:"text-align-left"},{value:"middle",icon:"text-align-center"},{value:"end",icon:"text-align-right"}],verticalAlign:[{value:"start",icon:"vertical-align-start"},{value:"middle",icon:"vertical-align-center"},{value:"end",icon:"vertical-align-end"}],geo:[{value:"rectangle",icon:"geo-rectangle"},{value:"ellipse",icon:"geo-ellipse"},{value:"triangle",icon:"geo-triangle"},{value:"diamond",icon:"geo-diamond"},{value:"pentagon",icon:"geo-pentagon"},{value:"hexagon",icon:"geo-hexagon"},{value:"octagon",icon:"geo-octagon"},{value:"star",icon:"geo-star"},{value:"rhombus",icon:"geo-rhombus"},{value:"rhombus-2",icon:"geo-rhombus-2"},{value:"oval",icon:"geo-oval"},{value:"trapezoid",icon:"geo-trapezoid"},{value:"arrow-right",icon:"geo-arrow-right"},{value:"arrow-left",icon:"geo-arrow-left"},{value:"arrow-up",icon:"geo-arrow-up"},{value:"arrow-down",icon:"geo-arrow-down"},{value:"x-box",icon:"geo-x-box"},{value:"check-box",icon:"geo-check-box"}],arrowheadStart:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],arrowheadEnd:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],spline:[{value:"line",icon:"spline-line"},{value:"cubic",icon:"spline-cubic"}]},kee=[or,Ei,Va,Xr];function $ee(e){var r;const n=new M0(e.sharedStyles),t=e.selectedIds.length>0||!!((r=e.root.current.value)!=null&&r.shapeType);if(n.size===0&&e.isIn("select")&&e.selectedIds.length===0)for(const o of kee)n.applyValue(o,e.getStyleForNextShape(o));return n.size===0&&!t?null:{styles:n,opacity:e.sharedOpacity}}const UM=function({isMobile:n}){const t=U(),r=J("getRelevantStyles",()=>$ee(t),[t]),o=w.useCallback(()=>{n||(t.isChangingStyle=!1)},[t,n]);if(!r)return null;const{styles:s,opacity:i}=r,a=s.get(Hr),l=s.get(df),c=s.get(uf),u=s.get(ff),d=s.get(Yr),h=a===void 0,f=l===void 0&&c===void 0,p=u===void 0,m=d===void 0;return g.jsxs("div",{className:"tlui-style-panel","data-ismobile":n,onPointerLeave:o,children:[g.jsx(Tee,{styles:s,opacity:i}),!m&&g.jsx(Mee,{styles:s}),!(h&&f&&p)&&g.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[g.jsx(Aee,{styles:s}),g.jsx(Ree,{styles:s}),g.jsx(Oee,{styles:s})]})]})};function Ru(){const e=U();return oe.useMemo(()=>function(n,t,r){e.setStyle(n,t,r),e.isChangingStyle=!0},[e])}const Kl=[.1,.25,.5,.75,1];function Tee({styles:e,opacity:n}){const t=U(),r=we(),o=Ru(),s=oe.useCallback((h,f)=>{const p=Kl[h];t.setOpacity(p,f),t.isChangingStyle=!0},[t]),i=e.get(or),a=e.get(Va),l=e.get(Ei),c=e.get(Xr),u=a!==void 0||l!==void 0||c!==void 0,d=n.type==="mixed"?-1:Kl.indexOf(LI(Kl,h=>Math.abs(h-n.value)));return g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"tlui-style-panel__section__common","aria-label":"style panel styles",children:[i===void 0?null:g.jsx(Ea,{title:r("style-panel.color"),uiType:"color",style:or,items:Pr.color,value:i,onValueChange:o}),n===void 0?null:g.jsx(Cee,{"data-testid":"style.opacity",value:d>=0?d:Kl.length-1,label:n.type==="mixed"?"style-panel.mixed":`opacity-style.${n}`,onValueChange:s,steps:Kl.length-1,title:r("style-panel.opacity")})]}),u&&g.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[a===void 0?null:g.jsx(Ea,{title:r("style-panel.fill"),uiType:"fill",style:Va,items:Pr.fill,value:a,onValueChange:o}),l===void 0?null:g.jsx(Ea,{title:r("style-panel.dash"),uiType:"dash",style:Ei,items:Pr.dash,value:l,onValueChange:o}),c===void 0?null:g.jsx(Ea,{title:r("style-panel.size"),uiType:"size",style:Xr,items:Pr.size,value:c,onValueChange:o})]})]})}function Mee({styles:e}){const n=we(),t=Ru(),r=e.get(Yr),o=e.get(Nc),s=e.get(hf);return r===void 0&&o===void 0?null:g.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel text",children:[r===void 0?null:g.jsx(Ea,{title:n("style-panel.font"),uiType:"font",style:Yr,items:Pr.font,value:r,onValueChange:t}),o===void 0?null:g.jsxs("div",{className:"tlui-style-panel__row",children:[g.jsx(Ea,{title:n("style-panel.align"),uiType:"align",style:Nc,items:Pr.horizontalAlign,value:o,onValueChange:t}),s===void 0?g.jsx(se,{title:n("style-panel.vertical-align"),"data-testid":"vertical-align",icon:"vertical-align-center",disabled:!0}):g.jsx(Gw,{id:"geo-vertical-alignment",uiType:"verticalAlign",style:hf,items:Pr.verticalAlign,value:s,onValueChange:t})]})]})}function Aee({styles:e}){const n=Ru(),t=e.get(Hr);return t===void 0?null:g.jsx(Gw,{id:"geo",label:"style-panel.geo",uiType:"geo",style:Hr,items:Pr.geo,value:t,onValueChange:n})}function Oee({styles:e}){const n=Ru(),t=e.get(ff);return t===void 0?null:g.jsx(Gw,{id:"spline",label:"style-panel.spline",uiType:"spline",style:ff,items:Pr.spline,value:t,onValueChange:n})}function Ree({styles:e}){const n=Ru(),t=e.get(df),r=e.get(uf);return!t||!r?null:g.jsx(Iee,{label:"style-panel.arrowheads",uiTypeA:"arrowheadStart",styleA:uf,itemsA:Pr.arrowheadStart,valueA:r,uiTypeB:"arrowheadEnd",styleB:df,itemsB:Pr.arrowheadEnd,valueB:t,onValueChange:n,labelA:"style-panel.arrowhead-start",labelB:"style-panel.arrowhead-end"})}function Dee({toast:e}){const{removeToast:n}=no(),t=we(),r=s=>{s||n(e.id)},o=e.actions&&e.actions.length>0;return g.jsxs(oQ,{onOpenChange:r,className:"tlui-toast__container",duration:e.keepOpen?1/0:5e3,children:[e.icon&&g.jsx("div",{className:"tlui-toast__icon",children:g.jsx(vn,{icon:e.icon})}),g.jsxs("div",{className:"tlui-toast__main",children:[g.jsxs("div",{className:"tlui-toast__content",children:[g.jsx(sQ,{className:"tlui-toast__title",children:e.title}),g.jsx(iQ,{className:"tlui-toast__description",children:e.description})]}),e.actions&&g.jsxs("div",{className:"tlui-toast__actions",children:[e.actions.map((s,i)=>g.jsx(aQ,{altText:s.label,asChild:!0,onClick:s.onClick,children:g.jsx(se,{className:s.type==="warn"?"tlui-button__warning":"tlui-button__primary",children:s.label})},i)),o&&g.jsx(MP,{asChild:!0,children:g.jsx(se,{className:"tlui-toast__close",style:{marginLeft:"auto"},children:e.closeLabel??t("toast.close")})})]})]}),!o&&g.jsx(MP,{asChild:!0,children:g.jsx(se,{className:"tlui-toast__close",children:e.closeLabel??t("toast.close")})})]})}function Lee(){const{toasts:e}=no();return g.jsx(g.Fragment,{children:e.map(n=>g.jsx(Dee,{toast:n},n.id))})}const jee=w.memo(Lee);function Nee(){const{toasts:e}=no(),[n,t]=w.useState(!1);return w.useEffect(()=>{let r=!1;return e.length?t(!0):setTimeout(()=>{r||t(!1)},1e3),()=>{r=!0}},[e.length,t]),n?g.jsx(Fq,{className:"tlui-toast__viewport"}):null}function zee(){const e=U(),n=we(),t=J("current color",()=>{const s=e.sharedStyles.get(or);return s?s.type==="mixed"?null:Sn(e)[s.value].solid:"var(--color-muted-1)"},[e]),r=J("isHandOrEraserToolActive",()=>e.isInAny("hand","zoom","eraser","laser"),[e]),o=w.useCallback(s=>{s||(e.isChangingStyle=!1)},[e]);return g.jsxs(Ww,{id:"style menu",onOpenChange:o,children:[g.jsx(Yw,{disabled:r,children:g.jsx(se,{className:"tlui-toolbar__tools__button tlui-toolbar__styles__button","data-testid":"mobile.styles",style:{color:t??"var(--color-text)"},title:n("style-panel.title"),children:g.jsx(vn,{icon:t?"blob":"mixed"})})}),g.jsx(IM,{side:"top",align:"end",children:g.jsx(UM,{isMobile:!0})})]})}const Bee=["select","hand","draw","eraser","text","zoom","laser","highlight"];function Fee({activeToolId:e}){const n=U(),t=lr(),r=we(),o=J("is tool locked",()=>n.instanceState.isToolLocked,[n]);return!e||Bee.includes(e)?null:g.jsx(se,{title:r("action.toggle-tool-lock"),className:de("tlui-toolbar__lock-button",{"tlui-toolbar__lock-button__mobile":t<5}),icon:o?"lock":"unlock",onClick:()=>n.updateInstanceState({isToolLocked:!o}),smallIcon:!0})}const Uee=w.memo(function(){const n=U(),t=we(),r=lr(),o=oe.useRef(void 0),s=ro(),i=ZQ(),a=i.find(S=>S.toolItem.id==="laser"),l=J("current tool id",()=>n.currentToolId,[n]),c=l==="hand",u=J("geo",()=>n.sharedStyles.getAsKnownValue(Hr),[n]),d=!s,h=!(s||c),f=S=>S.label?`${t(S.label)} ${S.kbd?qr(S.kbd):""}`:"",p=i.find(S=>sa(S.toolItem,l,u)),{itemsInPanel:m,itemsInDropdown:y,dropdownFirstItem:x}=oe.useMemo(()=>{const S=[],b=[];let P;const C=Math.min(8,5+r);for(let _=4;_<i.length;_++){const I=i[_];_<C?S.push(I):(I===p&&(P=I),b.push(I))}return P||(o.current||(o.current=b[0]),P=o.current,b.includes(P)||(P=b[0])),o.current=P,b.length<=2&&(S.push(...b),b.length=0),{itemsInPanel:S,itemsInDropdown:b,dropdownFirstItem:P}},[i,p,r]);return g.jsx("div",{className:"tlui-toolbar",children:g.jsxs("div",{className:"tlui-toolbar__inner",children:[g.jsxs("div",{className:"tlui-toolbar__left",children:[!s&&g.jsxs("div",{className:de("tlui-toolbar__extras",{"tlui-toolbar__extras__hidden":!h}),children:[r<6&&g.jsxs("div",{className:"tlui-toolbar__extras__controls",children:[g.jsx(AM,{}),g.jsx(TM,{}),g.jsx(MM,{}),g.jsx($M,{}),g.jsx(kM,{})]}),g.jsx(Fee,{activeToolId:l})]}),g.jsxs("div",{className:de("tlui-toolbar__tools",{"tlui-toolbar__tools__mobile":r<5}),children:[i.slice(0,2).map(({toolItem:S})=>g.jsx(Hl,{item:S,title:f(S),isSelected:sa(S,l,u)},S.id)),s&&a&&g.jsx(Hl,{item:a.toolItem,title:f(a.toolItem),isSelected:sa(a.toolItem,l,u)},a.toolItem.id),d&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"tlui-toolbar__divider"}),i.slice(2,4).map(({toolItem:S})=>g.jsx(Hl,{item:S,title:f(S),isSelected:sa(S,l,u)},S.id)),g.jsx("div",{className:"tlui-toolbar__divider"}),m.map(({toolItem:S})=>g.jsx(Hl,{item:S,title:f(S),isSelected:sa(S,l,u)},S.id)),y.length?g.jsxs(g.Fragment,{children:[g.jsx(Hl,{item:x.toolItem,title:f(x.toolItem),isSelected:sa(x.toolItem,l,u)},x.toolItem.id),g.jsxs(Ms,{id:"toolbar overflow",modal:!1,children:[g.jsx(Tu,{children:g.jsx(se,{className:"tlui-toolbar__tools__button tlui-toolbar__overflow",icon:"chevron-up","data-testid":"tools.more",title:t("tool-panel.more")})}),g.jsx(As,{side:"top",align:"center",children:g.jsx(Kee,{toolbarItems:y})})]})]}):null]})]})]}),r<5&&!s&&g.jsx("div",{className:"tlui-toolbar__tools",children:g.jsx(zee,{})})]})})}),Kee=me(function({toolbarItems:n}){const t=we();return g.jsx("div",{className:"tlui-button-grid__four tlui-button-grid__reverse",children:n.map(({toolItem:{id:r,meta:o,kbd:s,label:i,onSelect:a,icon:l}})=>g.jsx(Tn,{className:"tlui-button-grid__button","data-testid":`tools.${r}`,"data-tool":r,"data-geo":(o==null?void 0:o.geo)??"","aria-label":i,onClick:()=>a("toolbar"),title:i?`${t(i)} ${s?qr(s):""}`:"",icon:l},r))})});function Hl({item:e,title:n,isSelected:t}){var r;return g.jsx(se,{className:"tlui-toolbar__tools__button","data-testid":`tools.${e.id}`,"data-tool":e.id,"data-geo":((r=e.meta)==null?void 0:r.geo)??"","aria-label":e.label,title:n,icon:e.icon,"data-state":t?"selected":void 0,onClick:()=>e.onSelect("toolbar"),onTouchStart:o=>{Se(o),e.onSelect("toolbar")}})}const sa=(e,n,t)=>{var r,o;return(r=e.meta)!=null&&r.geo?n==="geo"&&t===((o=e.meta)==null?void 0:o.geo):n===e.id};function Hee(){const e=U(),{addToast:n}=no();w.useEffect(()=>{function t({name:r,count:o}){n({title:"Maximum Shapes Reached",description:`You've reached the maximum number of shapes allowed on ${r} (${o}). Please delete some shapes or move to a different page to continue.`})}return e.addListener("max-shapes",t),()=>{e.removeListener("max-shapes",t)}},[e,n])}var Nm=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function zm(e,n,t,r){e.addEventListener?e.addEventListener(n,t,r):e.attachEvent&&e.attachEvent("on".concat(n),function(){t(window.event)})}function KM(e,n){for(var t=n.slice(0,n.length-1),r=0;r<t.length;r++)t[r]=e[t[r].toLowerCase()];return t}function HM(e){typeof e!="string"&&(e=""),e=e.replace(/\s/g,"");for(var n=e.split(","),t=n.lastIndexOf("");t>=0;)n[t-1]+=",",n.splice(t,1),t=n.lastIndexOf("");return n}function Vee(e,n){for(var t=e.length>=n.length?e:n,r=e.length>=n.length?n:e,o=!0,s=0;s<t.length;s++)r.indexOf(t[s])===-1&&(o=!1);return o}var su={backspace:8,"":8,tab:9,clear:12,enter:13,"":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"":20,",":188,".":190,"/":191,"`":192,"-":Nm?173:189,"=":Nm?61:187,";":Nm?59:186,"'":222,"[":219,"]":221,"\\":220},Jr={"":16,shift:16,"":18,alt:18,option:18,"":17,ctrl:17,control:17,"":91,cmd:91,command:91},ov={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},It={16:!1,18:!1,17:!1,91:!1},ut={};for(var Fd=1;Fd<20;Fd++)su["f".concat(Fd)]=111+Fd;var je=[],rE=!1,VM="all",WM=[],Du=function(n){return su[n.toLowerCase()]||Jr[n.toLowerCase()]||n.toUpperCase().charCodeAt(0)},Wee=function(n){return Object.keys(su).find(function(t){return su[t]===n})},Yee=function(n){return Object.keys(Jr).find(function(t){return Jr[t]===n})};function YM(e){VM=e||"all"}function iu(){return VM||"all"}function Xee(){return je.slice(0)}function Gee(){return je.map(function(e){return Wee(e)||Yee(e)||String.fromCharCode(e)})}function qee(){var e=[];return Object.keys(ut).forEach(function(n){ut[n].forEach(function(t){var r=t.key,o=t.scope,s=t.mods,i=t.shortcut;e.push({scope:o,shortcut:i,mods:s,keys:r.split("+").map(function(a){return Du(a)})})})}),e}function Qee(e){var n=e.target||e.srcElement,t=n.tagName,r=!0;return(n.isContentEditable||(t==="INPUT"||t==="TEXTAREA"||t==="SELECT")&&!n.readOnly)&&(r=!1),r}function Zee(e){return typeof e=="string"&&(e=Du(e)),je.indexOf(e)!==-1}function Jee(e,n){var t,r;e||(e=iu());for(var o in ut)if(Object.prototype.hasOwnProperty.call(ut,o))for(t=ut[o],r=0;r<t.length;)t[r].scope===e?t.splice(r,1):r++;iu()===e&&YM(n||"all")}function ete(e){var n=e.keyCode||e.which||e.charCode,t=je.indexOf(n);if(t>=0&&je.splice(t,1),e.key&&e.key.toLowerCase()==="meta"&&je.splice(0,je.length),(n===93||n===224)&&(n=91),n in It){It[n]=!1;for(var r in Jr)Jr[r]===n&&(Er[r]=!1)}}function tte(e){if(typeof e>"u")Object.keys(ut).forEach(function(i){return delete ut[i]});else if(Array.isArray(e))e.forEach(function(i){i.key&&Bm(i)});else if(typeof e=="object")e.key&&Bm(e);else if(typeof e=="string"){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];var o=t[0],s=t[1];typeof o=="function"&&(s=o,o=""),Bm({key:e,scope:o,method:s,splitKey:"+"})}}var Bm=function(n){var t=n.key,r=n.scope,o=n.method,s=n.splitKey,i=s===void 0?"+":s,a=HM(t);a.forEach(function(l){var c=l.split(i),u=c.length,d=c[u-1],h=d==="*"?"*":Du(d);if(ut[h]){r||(r=iu());var f=u>1?KM(Jr,c):[];ut[h]=ut[h].filter(function(p){var m=o?p.method===o:!0;return!(m&&p.scope===r&&Vee(p.mods,f))})}})};function oE(e,n,t,r){if(n.element===r){var o;if(n.scope===t||n.scope==="all"){o=n.mods.length>0;for(var s in It)Object.prototype.hasOwnProperty.call(It,s)&&(!It[s]&&n.mods.indexOf(+s)>-1||It[s]&&n.mods.indexOf(+s)===-1)&&(o=!1);(n.mods.length===0&&!It[16]&&!It[18]&&!It[17]&&!It[91]||o||n.shortcut==="*")&&(n.keys=[],n.keys=n.keys.concat(je),n.method(e,n)===!1&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0)))}}}function sE(e,n){var t=ut["*"],r=e.keyCode||e.which||e.charCode;if(Er.filter.call(this,e)){if((r===93||r===224)&&(r=91),je.indexOf(r)===-1&&r!==229&&je.push(r),["ctrlKey","altKey","shiftKey","metaKey"].forEach(function(p){var m=ov[p];e[p]&&je.indexOf(m)===-1?je.push(m):!e[p]&&je.indexOf(m)>-1?je.splice(je.indexOf(m),1):p==="metaKey"&&e[p]&&je.length===3&&(e.ctrlKey||e.shiftKey||e.altKey||(je=je.slice(je.indexOf(m))))}),r in It){It[r]=!0;for(var o in Jr)Jr[o]===r&&(Er[o]=!0);if(!t)return}for(var s in It)Object.prototype.hasOwnProperty.call(It,s)&&(It[s]=e[ov[s]]);e.getModifierState&&!(e.altKey&&!e.ctrlKey)&&e.getModifierState("AltGraph")&&(je.indexOf(17)===-1&&je.push(17),je.indexOf(18)===-1&&je.push(18),It[17]=!0,It[18]=!0);var i=iu();if(t)for(var a=0;a<t.length;a++)t[a].scope===i&&(e.type==="keydown"&&t[a].keydown||e.type==="keyup"&&t[a].keyup)&&oE(e,t[a],i,n);if(r in ut){for(var l=0;l<ut[r].length;l++)if((e.type==="keydown"&&ut[r][l].keydown||e.type==="keyup"&&ut[r][l].keyup)&&ut[r][l].key){for(var c=ut[r][l],u=c.splitKey,d=c.key.split(u),h=[],f=0;f<d.length;f++)h.push(Du(d[f]));h.sort().join("")===je.sort().join("")&&oE(e,c,i,n)}}}}function nte(e){return WM.indexOf(e)>-1}function Er(e,n,t){je=[];var r=HM(e),o=[],s="all",i=document,a=0,l=!1,c=!0,u="+",d=!1;for(t===void 0&&typeof n=="function"&&(t=n),Object.prototype.toString.call(n)==="[object Object]"&&(n.scope&&(s=n.scope),n.element&&(i=n.element),n.keyup&&(l=n.keyup),n.keydown!==void 0&&(c=n.keydown),n.capture!==void 0&&(d=n.capture),typeof n.splitKey=="string"&&(u=n.splitKey)),typeof n=="string"&&(s=n);a<r.length;a++)e=r[a].split(u),o=[],e.length>1&&(o=KM(Jr,e)),e=e[e.length-1],e=e==="*"?"*":Du(e),e in ut||(ut[e]=[]),ut[e].push({keyup:l,keydown:c,scope:s,mods:o,shortcut:r[a],method:t,key:r[a],splitKey:u,element:i});typeof i<"u"&&!nte(i)&&window&&(WM.push(i),zm(i,"keydown",function(h){sE(h,i)},d),rE||(rE=!0,zm(window,"focus",function(){je=[]},d)),zm(i,"keyup",function(h){sE(h,i),ete(h)},d))}function rte(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(ut).forEach(function(t){var r=ut[t].filter(function(o){return o.scope===n&&o.shortcut===e});r.forEach(function(o){o&&o.method&&o.method()})})}var Fm={getPressedKeyString:Gee,setScope:YM,getScope:iu,deleteScope:Jee,getPressedKeyCodes:Xee,getAllKeyCodes:qee,isPressed:Zee,filter:Qee,trigger:rte,unbind:tte,keyMap:su,modifier:Jr,modifierMap:ov};for(var Um in Fm)Object.prototype.hasOwnProperty.call(Fm,Um)&&(Er[Um]=Fm[Um]);if(typeof window<"u"){var ote=window.hotkeys;Er.noConflict=function(e){return e&&window.hotkeys===Er&&(window.hotkeys=ote),Er},window.hotkeys=Er}const iE=["copy","cut","paste","asset"];function ste(){const e=U(),n=M3(),t=ro(),r=Xt(),o=zw();w.useEffect(()=>{if(!n)return;const s=e.getContainer(),i=(l,c)=>{Er(l,{element:s,scope:e.store.id},c)},a=()=>e.isMenuOpen||e.editingId!==null||e.crashingError;for(const l of Object.values(r))l.kbd&&(t&&!l.readonlyOk||iE.includes(l.id)||i(aE(l.kbd),c=>{a()||(Se(c),l.onSelect("kbd"))}));for(const l of Object.values(o))!l.kbd||!l.readonlyOk&&e.isReadOnly||iE.includes(l.id)||i(aE(l.kbd),c=>{a()||(Se(c),l.onSelect("kbd"))});return Er.setScope(e.store.id),()=>{Er.deleteScope(e.store.id)}},[r,o,t,e,n])}function aE(e){return ite(e).map(n=>{let t="";const r=n.split("");return r.length===1?t=r[0]:r[0]==="!"?t=`shift+${r[1]}`:r[0]==="?"?t=`alt+${r[1]}`:r[0]==="$"?r[1]==="!"?t=`cmd+shift+${r[2]},ctrl+shift+${r[2]}`:r[1]==="?"?t=`cmd++${r[2]},ctrl+alt+${r[2]}`:t=`cmd+${r[1]},ctrl+${r[1]}`:t=n,t}).join(",")}function ite(e){typeof e!="string"&&(e=""),e=e.replace(/\s/g,"");const n=e.split(",");let t=n.lastIndexOf("");for(;t>=0;)n[t-1]+=",",n.splice(t,1),t=n.lastIndexOf("");return n}const ate=oe.memo(function({shareZone:n,topZone:t,renderDebugMenuItems:r,children:o,hideUi:s,...i}){return g.jsx(rZ,{...i,children:g.jsx(lte,{hideUi:s,shareZone:n,topZone:t,renderDebugMenuItems:r,children:o})})}),lte=oe.memo(function({children:n,hideUi:t,...r}){return g.jsxs(g.Fragment,{children:[n,t?null:g.jsx(cte,{...r})]})}),cte=oe.memo(function({shareZone:n,topZone:t,renderDebugMenuItems:r}){const o=U(),s=we(),i=lr(),a=J("isReadOnlyMode",()=>o.isReadOnly,[o]),l=J("focus",()=>o.instanceState.isFocusMode,[o]),c=J("debug",()=>o.instanceState.isDebugMode,[o]);ste(),IQ(),Hee();const{"toggle-focus-mode":u}=Xt();return g.jsx(b3,{children:g.jsxs("main",{className:de("tlui-layout",{"tlui-layout__mobile":i<5}),children:[l?g.jsx("div",{className:"tlui-layout__top",children:g.jsx(se,{className:"tlui-focus-button",title:`${s("focus-mode.toggle-focus-mode")}`,icon:"dot",onClick:()=>u.onSelect("menu")})}):g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"tlui-layout__top",children:[g.jsxs("div",{className:"tlui-layout__top__left",children:[g.jsx(YJ,{}),g.jsxs("div",{className:"tlui-helper-buttons",children:[g.jsx(ZJ,{}),g.jsx(sZ,{}),g.jsx(JJ,{})]})]}),g.jsx("div",{className:"tlui-layout__top__center",children:t}),g.jsxs("div",{className:"tlui-layout__top__right",children:[n,i>=5&&!a&&g.jsx("div",{className:"tlui-style-panel__wrapper",children:g.jsx(UM,{})})]})]}),g.jsxs("div",{className:"tlui-layout__bottom",children:[g.jsxs("div",{className:"tlui-layout__bottom__main",children:[g.jsx(QJ,{}),g.jsx(Uee,{}),i>=4&&g.jsx(vZ,{})]}),c&&g.jsx(aZ,{renderDebugMenuItems:r??null})]})]}),g.jsx(jee,{}),g.jsx(gZ,{}),g.jsx(Nee,{}),g.jsx(mZ,{})]})})}),XM="ContextMenu",[ute,cne]=zo(XM,[Rp]),oo=Rp(),[dte,GM]=ute(XM),hte=e=>{const{__scopeContextMenu:n,children:t,onOpenChange:r,dir:o,modal:s=!0}=e,[i,a]=w.useState(!1),l=oo(n),c=Vt(r),u=w.useCallback(d=>{a(d),c(d)},[c]);return w.createElement(dte,{scope:n,open:i,onOpenChange:u,modal:s},w.createElement(n3,W({},l,{dir:o,open:i,onOpenChange:u,modal:s}),t))},fte="ContextMenuTrigger",pte=w.forwardRef((e,n)=>{const{__scopeContextMenu:t,disabled:r=!1,...o}=e,s=GM(fte,t),i=oo(t),a=w.useRef({x:0,y:0}),l=w.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...a.current})}),c=w.useRef(0),u=w.useCallback(()=>window.clearTimeout(c.current),[]),d=h=>{a.current={x:h.clientX,y:h.clientY},s.onOpenChange(!0)};return w.useEffect(()=>u,[u]),w.useEffect(()=>void(r&&u()),[r,u]),w.createElement(w.Fragment,null,w.createElement(r3,W({},i,{virtualRef:l})),w.createElement(Oe.span,W({"data-state":s.open?"open":"closed","data-disabled":r?"":void 0},o,{ref:n,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:r?e.onContextMenu:ie(e.onContextMenu,h=>{u(),d(h),h.preventDefault()}),onPointerDown:r?e.onPointerDown:ie(e.onPointerDown,Ud(h=>{u(),c.current=window.setTimeout(()=>d(h),700)})),onPointerMove:r?e.onPointerMove:ie(e.onPointerMove,Ud(u)),onPointerCancel:r?e.onPointerCancel:ie(e.onPointerCancel,Ud(u)),onPointerUp:r?e.onPointerUp:ie(e.onPointerUp,Ud(u))})))}),gte=e=>{const{__scopeContextMenu:n,...t}=e,r=oo(n);return w.createElement(o3,W({},r,t))},mte="ContextMenuContent",yte=w.forwardRef((e,n)=>{const{__scopeContextMenu:t,...r}=e,o=GM(mte,t),s=oo(t),i=w.useRef(!1);return w.createElement(s3,W({},s,r,{ref:n,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:a=>{var l;(l=e.onCloseAutoFocus)===null||l===void 0||l.call(e,a),!a.defaultPrevented&&i.current&&a.preventDefault(),i.current=!1},onInteractOutside:a=>{var l;(l=e.onInteractOutside)===null||l===void 0||l.call(e,a),!a.defaultPrevented&&!o.modal&&(i.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),vte=w.forwardRef((e,n)=>{const{__scopeContextMenu:t,...r}=e,o=oo(t);return w.createElement(i3,W({},o,r,{ref:n}))}),wte=w.forwardRef((e,n)=>{const{__scopeContextMenu:t,...r}=e,o=oo(t);return w.createElement(a3,W({},o,r,{ref:n}))}),xte=w.forwardRef((e,n)=>{const{__scopeContextMenu:t,...r}=e,o=oo(t);return w.createElement(l3,W({},o,r,{ref:n}))}),Ste=e=>{const{__scopeContextMenu:n,children:t,onOpenChange:r,open:o,defaultOpen:s}=e,i=oo(n),[a,l]=Li({prop:o,defaultProp:s,onChange:r});return w.createElement(c3,W({},i,{open:a,onOpenChange:l}),t)},bte=w.forwardRef((e,n)=>{const{__scopeContextMenu:t,...r}=e,o=oo(t);return w.createElement(u3,W({},o,r,{ref:n}))}),Pte=w.forwardRef((e,n)=>{const{__scopeContextMenu:t,...r}=e,o=oo(t);return w.createElement(d3,W({},o,r,{ref:n,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))});function Ud(e){return n=>n.pointerType!=="mouse"?e(n):void 0}const Ete=hte,_te=pte,sv=gte,Cte=yte,iv=vte,av=wte,Ite=xte,qM=Ste,QM=bte,ZM=Pte,kte=me(function(){const n=U(),t=Yt(),r=n.pages,o=n.currentPageId,s=we(),{addToast:i}=no();return g.jsxs(qM,{children:[g.jsx(QM,{dir:"ltr",asChild:!0,children:g.jsx(se,{className:"tlui-menu__button",label:"context-menu.move-to-page","data-testid":"menu-item.move-to-page",icon:"chevron-right"})}),g.jsx(sv,{container:t,dir:"ltr",children:g.jsxs(ZM,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:[g.jsx(iv,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.pages",children:r.map(a=>g.jsx(av,{disabled:o===a.id,onSelect:()=>{n.mark("move_shapes_to_page"),n.moveShapesToPage(n.selectedIds,a.id);const l=n.getPageById(a.id);l&&i({title:"Changed Page",description:`Moved to ${l.name}.`,actions:[{label:"Go Back",type:"primary",onClick:()=>{n.mark("change-page"),n.setCurrentPageId(o)}}]})},asChild:!0,children:g.jsx(se,{title:a.name,className:"tlui-menu__button tlui-context-menu__move-to-page__name",children:g.jsx("span",{children:a.name})})},a.id))},"pages"),g.jsx(iv,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.new-page",children:g.jsx(av,{onSelect:()=>{n.mark("move_shapes_to_page");const a=Jn.createId(),l=n.selectedIds,c=n.currentPageId;n.batch(()=>{n.createPage("Page 1",a),n.setCurrentPageId(c),n.moveShapesToPage(l,a)})},asChild:!0,children:g.jsx(se,{title:s("context.pages.new-page"),className:"tlui-menu__button tlui-context-menu__move-to-page__name",children:s("context.pages.new-page")})},"new-page")},"new-page")]})})]})}),$te=function({children:n}){const t=U(),r=V3(),o=w.useCallback(d=>{if(d){if(t.isCoarsePointer){const{selectedShapes:h,inputs:{currentPagePoint:f}}=t,p=t.getShapesAtPoint(f);if(!t.selectedShapes.length||!p.some(m=>h.includes(m))){const m=p.filter(y=>t.isShapeOrAncestorLocked(y));m.length&&t.select(...m.map(y=>y.id))}}}else{const{onlySelectedShape:h}=t;h&&t.isShapeOrAncestorLocked(h)&&t.setSelectedIds([])}},[t]),[s,i]=Ni("context menu",o),a=ro(),l=r.length===0||a&&r.every(d=>!d.readonlyOk),u=!J("isSelectToolActive",()=>t.currentToolId==="select",[t])||l;return g.jsxs(Ete,{dir:"ltr",onOpenChange:i,children:[g.jsx(_te,{onContextMenu:u?Se:void 0,dir:"ltr",disabled:u,children:n}),g.jsx(Tte,{})]})};function Tte(){const e=U(),n=we(),t=V3(),[r,o]=Ni("context menu sub"),s=ro(),i=lr(),a=Yt(),[l,c]=w.useState(!1);function u(d,h,f,p){if(s&&!h.readonlyOk)return null;switch(h.type){case"custom":{switch(h.id){case"MOVE_TO_PAGE_MENU":return g.jsx(kte,{},h.id)}break}case"group":return g.jsx(iv,{dir:"ltr",className:de("tlui-menu__group",{"tlui-menu__group__small":(f==null?void 0:f.type)==="submenu"}),"data-testid":`menu-item.${h.id}`,children:h.children.map(m=>u(d,m,h,p+1))},h.id);case"submenu":return g.jsxs(qM,{onOpenChange:o,children:[g.jsx(QM,{dir:"ltr",disabled:h.disabled,asChild:!0,children:g.jsx(se,{className:"tlui-menu__button",label:h.label,"data-testid":`menu-item.${h.id}`,icon:"chevron-right"})}),g.jsx(sv,{container:a,dir:"ltr",children:g.jsx(ZM,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:h.children.map(m=>u(d,m,h,p+1))})})]},h.id);case"item":{if(s&&!h.readonlyOk)return null;const{id:m,checkbox:y,contextMenuLabel:x,label:S,onSelect:b,kbd:P,icon:C}=h.actionItem,_=x??S,I=_?n(_):void 0;return y?g.jsxs(Ite,{className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",dir:"ltr",disabled:h.disabled,onSelect:k=>{b("context-menu"),Se(k)},title:I||void 0,checked:h.checked,children:[g.jsx("div",{className:"tlui-menu__checkbox-item__check",style:{transformOrigin:"75% center",transform:`scale(${h.checked?1:.5})`,opacity:h.checked?1:.5},children:g.jsx(vn,{small:!0,icon:h.checked?"check":"checkbox-empty"})}),I&&g.jsx("span",{children:I}),P&&g.jsx(Cp,{children:P})]},m):g.jsx(av,{dir:"ltr",asChild:!0,children:g.jsx(se,{className:"tlui-menu__button","data-testid":`menu-item.${m}`,kbd:P,label:_,disabled:h.disabled,iconLeft:i<3&&p>2?C:void 0,onClick:()=>{l?c(!1):b("context-menu")}})},m)}}}return g.jsx(sv,{dir:"ltr",container:a,children:g.jsx(Cte,{className:"tlui-menu scrollable",alignOffset:-4,collisionPadding:4,onContextMenu:Se,children:t.map(d=>u(e,d,null,0))})})}function Mte(e){const{children:n,...t}=e,r={...t,shapes:w.useMemo(()=>[...NH,...t.shapes??[]],[t.shapes]),tools:w.useMemo(()=>[...AW,...t.tools??[]],[t.tools])};return g.jsx(EW,{...r,children:g.jsxs(ate,{...r,children:[g.jsx($te,{children:g.jsx(Lk,{})}),n]})})}const Ate=()=>{const e=U();return w.useEffect(()=>{const n=window.matchMedia("(prefers-color-scheme: dark)").matches;e.user.updateUserPreferences({isDarkMode:n});const t=r=>{const o=r.matches;console.log(o),e.user.updateUserPreferences({isDarkMode:o})};return window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t),()=>{window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",t)}},[]),null};function Ote(){return g.jsx("div",{className:"tldraw__editor",children:g.jsx(Mte,{persistenceKey:"tldraw-board",autoFocus:!0,children:g.jsx(Ate,{})})})}cy.createRoot(document.getElementById("root")).render(g.jsx(oe.StrictMode,{children:g.jsx(Ote,{})}));

</script>
    <style>
.tl-container{font-size:12px;--space-1: 2px;--space-2: 4px;--space-3: 8px;--space-4: 12px;--space-5: 16px;--space-6: 20px;--space-7: 28px;--space-8: 32px;--space-9: 64px;--space-10: 72px;--radius-0: 2px;--radius-1: 4px;--radius-2: 7px;--radius-3: 9px;--radius-4: 12px;--radius-5: 16px;--layer-grid: 150;--layer-canvas: 200;--tl-zoom: 1;--tl-cursor-none: none;--tl-cursor-default: url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: black;'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='1' dy='1' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(0 16 16)' filter='url(%23shadow)'><path d='m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z' fill='white'/><path d='m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z' fill='white'/><path d='m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z' fill='black'/><path d='m13 10.814v11.188l2.969-2.866.428-.139h4.768z' fill='black'/></g></svg>") 12 8, default;--tl-cursor-pointer: url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: black;'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='1' dy='1' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(0 16 16)' filter='url(%23shadow)'><path d='m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z' fill='white'/><g stroke='black' stroke-linecap='round' stroke-width='.75'><path d='m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z' stroke-linejoin='round'/><path d='m21.5664 21.7344v-3.459'/><path d='m19.5508 21.7461-.016-3.473'/><path d='m17.5547 18.3047.021 3.426'/></g></g></svg>") 14 10, pointer;--tl-cursor-cross: url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: black;'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='1' dy='1' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(0 16 16)' filter='url(%23shadow)'><path d='m25 16h-6.01v-6h-2.98v6h-6.01v3h6.01v6h2.98v-6h6.01z' fill='white'/><path d='m23.9902 17.0103h-6v-6.01h-.98v6.01h-6v.98h6v6.01h.98v-6.01h6z' fill='%23231f1f'/></g></svg>") 16 16, crosshair;--tl-cursor-move: url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: black;'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='1' dy='1' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(0 16 16)' filter='url(%23shadow)'><path d='m19 14h1v1h-1zm1 6h-1v-1h1zm-5-5h-1v-1h1zm0 5h-1v-1h1zm2-10.987-7.985 7.988 5.222 5.221 2.763 2.763 7.984-7.985z' fill='white'/><g fill='black'><path d='m23.5664 16.9971-2.557-2.809v1.829h-4.009-4.001v-1.829l-2.571 2.809 2.572 2.808-.001-1.808h4.001 4.009l-.001 1.808z'/><path d='m17.9873 17h.013v-4.001l1.807.001-2.807-2.571-2.809 2.57h1.809v4.001h.008v4.002l-1.828-.001 2.807 2.577 2.805-2.576h-1.805z'/></g></g></svg>") 16 16, move;--tl-cursor-grab: url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: black;'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='1' dy='1' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(0 16 16)' filter='url(%23shadow)'><path d='m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121' fill='white'/><g stroke='black' stroke-linecap='round' stroke-width='.75'><path d='m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121' stroke-linejoin='round'/><path d='m20.5664 21.7344v-3.459'/><path d='m18.5508 21.7461-.016-3.473'/><path d='m16.5547 18.3047.021 3.426'/></g></g></svg>") 16 16, grab;--tl-cursor-grabbing: url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: black;'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='1' dy='1' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(0 16 16)' filter='url(%23shadow)'><path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042' fill='white'/><g stroke='black' stroke-width='.75'><path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042z' stroke-linejoin='round'/><path d='m20.5664 19.7344v-3.459' stroke-linecap='round'/><path d='m18.5508 19.7461-.016-3.473' stroke-linecap='round'/><path d='m16.5547 16.3047.021 3.426' stroke-linecap='round'/></g></g></svg>") 16 16, grabbing;--tl-cursor-text: url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: black;'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='1' dy='1' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(0 16 16)' filter='url(%23shadow)'><path fill='white' d='M7.94 0a5.25 5.25 0 0 0-3.47 1.17A5.27 5.27 0 0 0 1 0H0v3h1c1.41 0 1.85.7 2 1v3.94H2v3h1v3c-.13.3-.57 1-2 1H0v3h1a5.27 5.27 0 0 0 3.47-1.17c.98.8 2.21 1.21 3.47 1.17h1v-3h-1c-1.41 0-1.85-.7-2-1v-3H7v-3H6V4c.13-.3.57-1 2-1h1V0H7.94z'/><path fill='black' d='M7.94 2V1a4 4 0 0 0-3.47 1.64A4 4 0 0 0 1 1v1c1.3-.17 2.56.6 3 1.84v5.1H3v1h1v4.16c-.45 1.24-1.7 2-3 1.84v1a4.05 4.05 0 0 0 3.47-1.63 4.05 4.05 0 0 0 3.47 1.63v-1A2.82 2.82 0 0 1 5 14.1V9.93h1v-1H5V3.85A2.81 2.81 0 0 1 7.94 2z'/></g></svg>") 4 10, text;--tl-cursor-zoom-in: url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: black;'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='1' dy='1' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(0 16 16)' filter='url(%23shadow)'><path d='m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5' fill='white'/><path d='m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z' stroke='black'/><g fill='black'><path d='m18 14h-2v-2h-2v2h-2v1.98h2v2.02h2v-2.02h2z'/><path d='m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z'/></g></g></svg>") 16 16, zoom-in;--tl-cursor-zoom-out: url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: black;'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='1' dy='1' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(0 16 16)' filter='url(%23shadow)'><path d='m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5' fill='white'/><path d='m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z' stroke='black'/><g fill='black'><path d='m18 16h-5.98v-1.98h5.98z'/><path d='m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z'/></g></g></svg>") 16 16, zoom-out;--tl-cursor: var(--tl-cursor-default);--tl-cursor-resize-edge: ew-resize;--tl-cursor-resize-corner: nesw-resize;--tl-cursor-ew-resize: ew-resize;--tl-cursor-ns-resize: ns-resize;--tl-cursor-nesw-resize: nesw-resize;--tl-cursor-nwse-resize: nwse-resize;--tl-cursor-rotate: pointer;--tl-cursor-nwse-rotate: pointer;--tl-cursor-nesw-rotate: pointer;--tl-cursor-senw-rotate: pointer;--tl-cursor-swne-rotate: pointer;--tl-scale: calc(1 / var(--tl-zoom));--tl-font-draw: "tldraw_draw", sans-serif;--tl-font-sans: "tldraw_sans", sans-serif;--tl-font-serif: "tldraw_serif", serif;--tl-font-mono: "tldraw_mono", monospace;--a:calc(min(.5, 1 / var(--tl-zoom))*2px);--b:calc(min(.5, 1 / var(--tl-zoom))*-2px);--tl-text-outline: 0 var(--b) 0 var(--color-background), 0 var(--a) 0 var(--color-background), var(--b) var(--b) 0 var(--color-background), var(--a) var(--b) 0 var(--color-background), var(--a) var(--a) 0 var(--color-background), var(--b) var(--a) 0 var(--color-background);position:relative;top:0;left:0;width:100%;height:100%;overflow:clip}.tl-theme__light{--color-accent: #e64a4a;--color-background: rgb(249, 250, 251);--color-brush-fill: rgba(144, 144, 144, .102);--color-brush-stroke: rgba(144, 144, 144, .251);--color-grid: rgba(144, 144, 144, .902);--color-low: rgb(237, 240, 242);--color-culled: rgb(235, 238, 240);--color-muted-0: rgba(0, 0, 0, .02);--color-muted-1: rgba(0, 0, 0, .1);--color-muted-2: rgba(0, 0, 0, .035);--color-hint: rgba(0, 0, 0, .055);--color-overlay: rgba(0, 0, 0, .2);--color-divider: #e8e8e8;--color-panel-contrast: #ffffff;--color-panel-overlay: rgba(255, 255, 255, .82);--color-panel: #fdfdfd;--color-focus: #004094;--color-selected: #2f80ed;--color-selected-contrast: #ffffff;--color-selection-fill: #1e90ff06;--color-selection-stroke: #2f80ed;--color-text-0: #1d1d1d;--color-text-1: #2d2d2d;--color-text-2: #5f6369;--color-text-3: #b6b7ba;--color-primary: #2f80ed;--color-warn: #d10b0b;--color-text: #000000;--color-laser: #ff0000;--shadow-1: 0px 1px 2px rgba(0, 0, 0, .22), 0px 1px 3px rgba(0, 0, 0, .09);--shadow-2: 0px 0px 2px rgba(0, 0, 0, .12), 0px 2px 3px rgba(0, 0, 0, .24), 0px 2px 6px rgba(0, 0, 0, .1), inset 0px 0px 0px 1px var(--color-panel-contrast);--shadow-3: 0px 1px 2px rgba(0, 0, 0, .25), 0px 2px 6px rgba(0, 0, 0, .14), inset 0px 0px 0px 1px var(--color-panel-contrast);--shadow-4: 0px 0px 3px rgba(0, 0, 0, .16), 0px 5px 4px rgba(0, 0, 0, .16), 0px 2px 16px rgba(0, 0, 0, .06), inset 0px 0px 0px 1px var(--color-panel-contrast)}.tl-theme__dark{--color-accent: #e64a4a;--color-background: #212529;--color-brush-fill: rgba(180, 180, 180, .05);--color-brush-stroke: rgba(180, 180, 180, .25);--color-grid: #909090e6;--color-low: #2c3136;--color-culled: rgb(47, 52, 57);--color-muted-0: rgba(255, 255, 255, .02);--color-muted-1: rgba(255, 255, 255, .1);--color-muted-2: rgba(255, 255, 255, .05);--color-hint: rgba(255, 255, 255, .1);--color-overlay: rgba(0, 0, 0, .35);--color-divider: #49555f;--color-panel-contrast: #49555f;--color-panel: #363d44;--color-panel-overlay: rgba(54, 61, 68, .82);--color-focus: #a5c3f3;--color-selected: #4285f4;--color-selected-contrast: #ffffff;--color-selection-fill: rgba(38, 150, 255, .05);--color-selection-stroke: #2f80ed;--color-text-0: #f0eded;--color-text-1: #d9d9d9;--color-text-2: #8e9094;--color-text-3: #515a62;--color-primary: #2f80ed;--color-warn: #d10b0b;--color-text: #f8f9fa;--color-laser: #ff0000;--shadow-1: 0px 1px 2px #00000029, 0px 1px 3px #00000038, inset 0px 0px 0px 1px var(--color-panel-contrast);--shadow-2: 0px 1px 3px #00000077, 0px 2px 6px #00000055, inset 0px 0px 0px 1px var(--color-panel-contrast);--shadow-3: 0px 1px 3px #00000077, 0px 2px 12px rgba(0, 0, 0, .22), inset 0px 0px 0px 1px var(--color-panel-contrast)}.tl-counter-scaled{transform:scale(var(--tl-scale));transform-origin:top left;width:calc(100% * var(--tl-zoom));height:calc(100% * var(--tl-zoom))}.tl-container,.tl-container *{-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent;scrollbar-highlight-color:transparent;-webkit-user-select:none;user-select:none;box-sizing:border-box;outline:none}.tl-container a{-webkit-touch-callout:initial}input,*[contenteditable],*[contenteditable] *{-webkit-user-select:text}.tl-canvas{position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--color-background);color:var(--color-text);z-index:var(--layer-canvas);cursor:var(--tl-cursor);overflow:clip;content-visibility:auto;touch-action:none;contain:strict}.tl-shapes{position:relative;z-index:1}.tl-overlays{position:relative;z-index:2}.tl-overlays__item{position:absolute;top:0;left:0;overflow:visible;pointer-events:none;transform-origin:top left}.tl-svg-context{position:absolute;top:0;left:0;height:1px;width:1px;pointer-events:none}.tlui-following{display:block;position:absolute;top:0;right:0;bottom:0;left:0;border-width:2px;border-style:solid;z-index:9999999;pointer-events:none}.tl-background{position:absolute;top:0;right:0;bottom:0;left:0;background-color:var(--color-background)}.tl-grid{position:absolute;top:0;left:0;width:100%;height:100%;touch-action:none;pointer-events:none;z-index:2}.tl-grid-dot{fill:var(--color-grid)}.tl-html-layer{position:absolute;top:0;left:0;width:1px;height:1px;contain:layout style size;z-index:3}.tl-brush{stroke-width:calc(var(--tl-scale) * 1px)}.tl-brush__default{stroke:var(--color-brush-stroke);fill:var(--color-brush-fill)}.tl-scribble{stroke-linejoin:round;stroke-linecap:round;pointer-events:none}.tl-shape{position:absolute;pointer-events:none;overflow:visible;transform-origin:top left}.tl-shape__culled{position:relative;background-color:var(--color-culled)}.tl-hitarea-stroke{fill:none;stroke:transparent;pointer-events:stroke;stroke-width:min(100px,calc(24px * var(--tl-scale)))}.tl-hitarea-fill{fill:var(--color-background);stroke:transparent;pointer-events:all;stroke-width:min(100px,calc(24px * var(--tl-scale)))}.tl-hitarea-fill-solid{stroke:transparent;pointer-events:all;stroke-width:min(100px,calc(24px * var(--tl-scale)))}.tl-svg-container{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;stroke-linecap:round;stroke-linejoin:round;transform-origin:top left;overflow:visible}.tl-html-container{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;stroke-linecap:round;stroke-linejoin:round;transform-origin:top left;color:inherit}.tl-collaborator__scribble{z-index:10}.tl-collaborator__brush{z-index:20}.tl-collaborator__shape-indicator{z-index:30}.tl-user-scribble{z-index:40}.tl-user-brush{z-index:50}.tl-user-indicator__selected{z-index:60}.tl-user-indicator__hovered{z-index:70}.tl-user-handles{z-index:80}.tl-user-snapline{z-index:90}.tl-selection__fg{pointer-events:none;z-index:100}.tl-user-indicator__hint{z-index:110;stroke-width:calc(2.5px * var(--tl-scale))}.tl-collaborator__cursor-hint{z-index:120}.tl-collaborator__cursor{z-index:130}.tl-cursor{overflow:visible}.tl-shape-indicator{transform-origin:top left;fill:none;stroke-width:calc(1.5px * var(--tl-scale))}.tl-selection__bg{position:absolute;top:0;left:0;transform-origin:top left;background-color:transparent;pointer-events:all}.tl-selection__fg__outline{fill:none;pointer-events:none;stroke:var(--color-selection-stroke);stroke-width:calc(1.5px * var(--tl-scale))}.tl-corner-handle{pointer-events:none;stroke:var(--color-selection-stroke);fill:var(--color-background);stroke-width:calc(1.5px * var(--tl-scale))}.tl-text-handle{pointer-events:none;fill:var(--color-selection-stroke)}.tl-corner-crop-handle,.tl-corner-crop-edge-handle{pointer-events:none;fill:none;stroke:var(--color-selection-stroke)}.tl-rotate-handle{stroke:var(--color-selection-stroke);fill:var(--color-background);stroke-width:calc(1.5px * var(--tl-scale));pointer-events:all}.tl-mobile-rotate__bg{pointer-events:all;r:max(calc(14px * var(--tl-scale)),20px / max(1,var(--tl-zoom)));cursor:var(--tl-cursor-grab)}.tl-mobile-rotate__fg{pointer-events:none;stroke:var(--color-selection-stroke);fill:var(--color-background);stroke-width:calc(1.5px * var(--tl-scale))}.tl-transparent{fill:transparent;stroke:transparent}.tl-handle{pointer-events:all}.tl-handle__bg{fill:transparent;stroke:transparent;pointer-events:all;cursor:var(--tl-cursor-grabbing);r:calc(12px / var(--tl-zoom))}.tl-handle__fg{fill:var(--color-background);stroke:var(--color-selection-stroke);stroke-width:calc(1.5px * var(--tl-scale));r:calc(4px * var(--tl-scale));pointer-events:none}.tl-handle__bg:active{fill:none}.tl-handle__bg:hover{cursor:var(--tl-cursor-grab);fill:var(--color-selection-fill)}.tl-handle__hint{opacity:0}.tl-handle__hint:hover{opacity:1}@media (pointer: coarse){.tl-handle__bg:active{fill:var(--color-selection-fill)}.tl-handle__hint{opacity:1}.tl-handle__hint>.tl-handle__fg{r:calc(3px * var(--tl-scale))}}.tl-image,.tl-video{object-fit:cover;background-size:cover;width:100%;height:100%}.tl-image-container,.tl-video-container,.tl-embed-container{width:100%;height:100%;pointer-events:all;display:flex;justify-content:center;align-items:center}.tl-image__tg{--scale:min(2, var(--tl-scale));position:absolute;top:calc(var(--scale) * 8px);right:calc(var(--scale) * 8px);font-size:10px;scale:var(--scale);transform-origin:top right;background-color:var(--color-background);padding:2px 4px;border-radius:4px}.tl-collaborator-cursor{position:absolute}.tl-nametag{top:16px;left:13px;width:fit-content;height:fit-content;max-width:120px;padding:3px 6px;white-space:nowrap;position:absolute;overflow:hidden;text-overflow:ellipsis;font-size:12px;font-family:var(--font-body);border-radius:var(--radius-2);color:var(--color-selected-contrast)}.tl-nametag-title{top:-2px;left:13px;width:fit-content;height:fit-content;padding:0 6px;max-width:120px;white-space:nowrap;position:absolute;overflow:hidden;text-overflow:ellipsis;font-size:12px;font-family:var(--font-body);text-shadow:var(--tl-text-outline);color:var(--color-selected-contrast)}.tl-nametag-chat{top:16px;left:13px;width:fit-content;height:fit-content;color:var(--color-selected-contrast);white-space:nowrap;position:absolute;padding:3px 6px;font-size:12px;font-family:var(--font-body);opacity:1;border-radius:var(--radius-2)}.tl-cursor-chat{position:absolute;color:var(--color-selected-contrast);white-space:nowrap;padding:3px 6px;font-size:12px;font-family:var(--font-body);pointer-events:none;z-index:var(--layer-cursor);margin-top:16px;margin-left:13px;opacity:1;border:none;-webkit-user-select:text;user-select:text;border-radius:var(--radius-2)}.tl-cursor-chat .tl-cursor-chat__bubble{padding-right:12px}.tl-cursor-chat::selection{background:var(--color-selected);color:var(--color-selected-contrast);text-shadow:none}.tl-cursor-chat-fade{opacity:.0001;transition:opacity 5s ease-in-out}.tl-cursor-chat::placeholder{color:var(--color-selected-contrast);opacity:.7}@keyframes spinner{to{transform:rotate(360deg)}}.tl-spinner:after{content:"";box-sizing:border-box;position:absolute;top:50%;left:50%;width:20px;height:20px;margin-top:-10px;margin-left:-10px;border-radius:50%;border:2px solid #ccc;border-top-color:#000;animation:spinner .6s linear infinite;pointer-events:none}.tl-iconshape__icon{pointer-events:all;width:100%;height:100%}.tl-icon-preview{width:14px;height:14px}.tl-text-shape__wrapper{position:relative;font-weight:400;min-width:1px;padding:0;margin:0;border:none;height:100%;font-variant:normal;font-style:normal;pointer-events:all;white-space:pre-wrap;overflow-wrap:break-word;text-shadow:var(--tl-text-outline)}.tl-text-shape__wrapper[data-align=start]{text-align:left}.tl-text-shape__wrapper[data-align=middle]{text-align:center}.tl-text-shape__wrapper[data-align=end]{text-align:right}.tl-text-shape__wrapper[data-font=draw]{font-family:var(--tl-font-draw)}.tl-text-shape__wrapper[data-font=sans]{font-family:var(--tl-font-sans)}.tl-text-shape__wrapper[data-font=serif]{font-family:var(--tl-font-serif)}.tl-text-shape__wrapper[data-font=mono]{font-family:var(--tl-font-mono)}.tl-text-shape__wrapper[data-isediting=true] .tl-text-content{opacity:0}.tl-text{margin:0;padding:0;border:0px;color:inherit;caret-color:var(--color-text);background:none;border-image:none;font-size:inherit;font-family:inherit;font-weight:inherit;line-height:inherit;font-variant:inherit;font-style:inherit;text-align:inherit;letter-spacing:inherit;text-shadow:inherit;outline:none;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:break-word;pointer-events:all;text-rendering:auto;text-transform:none;text-indent:0px;display:inline-block;-webkit-appearance:auto;-moz-appearance:auto;appearance:auto;column-count:initial!important;writing-mode:horizontal-tb!important;word-spacing:0px}.tl-text-measure{position:absolute;z-index:999999;top:-9999px;right:-9999px;opacity:0;width:fit-content;box-sizing:border-box;pointer-events:none;line-break:normal;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:break-word;resize:none;border:none;user-select:none;-webkit-user-select:none}.tl-text-edit-container{position:relative;width:100%;height:100%}.tl-text-input,.tl-text-content{position:absolute;top:0;left:0;width:100%;height:100%;min-width:1px;min-height:1px;overflow:visible}.tl-text-content{pointer-events:none}.tl-text-input{resize:none;user-select:all;-webkit-user-select:text;overflow:hidden;cursor:var(--tl-cursor-text)}.tl-text-input::selection{background:var(--color-selected);color:var(--color-selected-contrast);text-shadow:none}.tl-snap-line,.tl-snap-point{stroke:var(--color-accent);stroke-width:calc(1px * var(--tl-scale));fill:none}.tl-group{stroke:var(--color-text);stroke-width:calc(1px * var(--tl-scale));opacity:.5}.tl-bookmark__container{width:100%;height:100%;position:relative;border:1px solid var(--color-panel-contrast);background-color:var(--color-panel);border-radius:var(--radius-2);display:flex;flex-direction:column;overflow:hidden}.tl-bookmark__image_container{flex:1;overflow:hidden;border-top-left-radius:var(--radius-1);border-top-right-radius:var(--radius-1);width:100%;height:100%;display:flex;justify-content:flex-end;align-items:flex-start}.tl-bookmark__image_container>.tl-hyperlink-button:after{background-color:var(--color-panel)}.tl-bookmark__placeholder{width:100%;height:100%;background-color:var(--color-muted-2);border-bottom:1px solid var(--color-muted-2)}.tl-bookmark__image{width:100%;height:100%;object-fit:cover;object-position:center}.tl-bookmark__copy_container{background-color:var(--color-muted);padding:var(--space-4);pointer-events:all}.tl-bookmark__heading,.tl-bookmark__description,.tl-bookmark__link{margin:0;width:100%;font-family:inherit}.tl-bookmark__heading{font-size:16px;font-weight:700;padding-bottom:var(--space-2);margin:4px 0}.tl-bookmark__description{font-size:12px;padding-bottom:var(--space-4)}.tl-bookmark__link{font-size:14px;pointer-events:all;z-index:999;overflow:hidden;display:block;color:var(--color-text);text-overflow:ellipsis;text-decoration:none;color:var(--color-text-2);cursor:var(--tl-cursor-pointer)}.tl-bookmark__link:hover{color:var(--color-selected)}.tl-hyperlink-button{background:none;margin:0;position:absolute;top:0;right:0;height:44px;width:44px;display:flex;align-items:center;justify-content:center;z-index:200;font-size:12px;font-weight:400;color:var(--color-text-1);padding:13px;cursor:var(--tl-cursor-pointer);border:none;outline:none;pointer-events:all}.tl-hyperlink-button:after{content:"";z-index:-1;position:absolute;right:6px;bottom:6px;display:block;width:calc(100% - 12px);height:calc(100% - 12px);border-radius:var(--radius-1);background-color:var(--color-background);pointer-events:none}.tl-hyperlink-button:hover{color:var(--color-selected)}.tl-hyperlink-button:focus-visible{color:var(--color-selected)}.tl-hyperlink-button__icon{width:18px;height:18px;background-color:currentColor;pointer-events:none}.tl-hyperlink-button__hidden{display:none}.tl-text-label{width:100%;height:100%;display:flex;justify-content:center;align-items:center;color:var(--color-text);text-shadow:var(--tl-text-outline);overflow:hidden;line-height:inherit}.tl-text-label[data-isediting=true] .tl-text-content{opacity:0}.tl-text-label[data-hastext=false][data-isediting=false]>.tl-text-label__inner{width:40px;height:40px}.tl-text-label__inner{position:relative;width:fit-content;height:fit-content;display:flex;align-items:center;justify-content:center;pointer-events:all;min-height:auto}.tl-text-label__inner>.tl-text{position:relative;top:0;left:0;padding:16px;height:fit-content;width:fit-content;border-radius:var(--radius-1);max-width:100%;z-index:3}.tl-text-label__inner>.tl-text-input{position:absolute;top:0;left:0;width:100%;height:100%;padding:16px;z-index:4}.tl-text-label[data-textwrap=true]>.tl-text-label__inner{max-width:100%}.tl-text-label[data-isediting=true]{background-color:none;min-height:auto}.tl-text-label[data-isediting=true] p{opacity:0}.tl-text-label[data-align=start],.tl-text-label[data-align=start-legacy]{text-align:left}.tl-text-label[data-align=middle],.tl-text-label[data-align=middle-legacy]{text-align:center}.tl-text-label[data-align=end],.tl-text-label[data-align=end-legacy]{text-align:right}.tl-arrow-hint{stroke:var(--color-text-1);fill:none;stroke-linecap:round;overflow:visible}.tl-arrow-label[data-font=draw],.tl-text-label[data-font=draw]{font-family:var(--tl-font-draw)}.tl-arrow-label[data-font=sans],.tl-text-label[data-font=sans]{font-family:var(--tl-font-sans)}.tl-arrow-label[data-font=serif],.tl-text-label[data-font=serif]{font-family:var(--tl-font-serif)}.tl-arrow-label[data-font=mono],.tl-text-label[data-font=mono]{font-family:var(--tl-font-mono)}.tl-arrow-label{position:absolute;top:-1px;left:-1px;width:2px;height:2px;padding:0;display:flex;justify-content:center;align-items:center;color:var(--color-text);text-shadow:var(--tl-text-outline)}.tl-arrow-label[data-isediting=true] p{opacity:0}.tl-arrow-label[data-isediting=true]>.tl-arrow-label__inner{background-color:var(--color-background);border:calc(var(--tl-scale) * 1.5px) solid var(--color-selected)}.tl-arrow-label__inner{border-radius:var(--radius-1);box-sizing:content-box;position:relative;height:max-content;width:max-content;pointer-events:all;display:flex;justify-content:center;align-items:center}.tl-arrow-label p,.tl-arrow-label textarea{margin:0;padding:0;border:0px;color:inherit;caret-color:var(--color-text);background:none;border-image:none;font-size:inherit;font-family:inherit;font-weight:inherit;line-height:inherit;font-variant:inherit;font-style:inherit;text-align:inherit;letter-spacing:inherit;text-shadow:inherit;outline:none;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:break-word;pointer-events:all;text-rendering:auto;text-transform:none;text-indent:0px;display:inline-block;-webkit-appearance:auto;-moz-appearance:auto;appearance:auto;column-count:initial!important;writing-mode:horizontal-tb!important;word-spacing:0px}.tl-arrow-label p{position:relative;height:max-content;z-index:2;padding:4px;overflow:visible}.tl-arrow-label textarea{z-index:3;margin:0;padding:4px;height:100%;width:100%;position:absolute;resize:none;border:0px;user-select:all;-webkit-user-select:text;caret-color:var(--color-text);border-image:none;min-width:4px}.tl-note__container{position:relative;width:100%;height:100%;border-radius:var(--radius-2);box-shadow:var(--shadow-1);overflow:hidden;border-color:currentColor;border-style:solid;border-width:1px}.tl-note__container .tl-text-label{text-shadow:none}.tl-note__scrim{position:absolute;z-index:1;top:0;left:0;width:100%;height:100%;background-color:var(--color-background);opacity:.28}.tl-loading{background-color:var(--color-background);color:var(--color-text-1);height:100%;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:var(--space-2);font-size:14px;font-weight:500;opacity:0;animation:fade-in .2s ease-in-out forwards;animation-delay:.2s}@keyframes fade-in{0%{opacity:0}to{opacity:1}}.tl-frame__body{stroke-width:calc(1px * var(--tl-scale))}.tl-frame__hitarea{border-style:solid;border-width:calc(8px * var(--tl-scale));border-color:transparent;background:none;pointer-events:stroke;box-sizing:border-box;top:calc(-8px * var(--tl-scale));left:calc(-8px * var(--tl-scale));width:calc(100% + calc(16px * var(--tl-scale)));height:calc(100% + calc(16px * var(--tl-scale)));z-index:1;position:absolute}.tl-frame-heading{display:flex;align-items:center;position:absolute;transform-origin:0% 100%;overflow:hidden;max-width:100%;min-width:32px;height:auto;font-size:12px;padding-bottom:4px;pointer-events:all}.tl-frame-heading-hit-area{pointer-events:all;transform-origin:0% 100%;display:flex;height:100%;width:100%;align-items:center;border-radius:var(--radius-1);background-color:var(--color-background)}.tl-frame-label{pointer-events:all;overflow:hidden;text-overflow:ellipsis;padding:var(--space-3) var(--space-3);position:relative;font-size:inherit;white-space:pre}.tl-frame-label__editing{color:transparent;outline:1.5px solid var(--color-selection-stroke);white-space:pre;width:auto;overflow:visible;background-color:var(--color-panel);border-radius:var(--radius-1)}.tl-frame-name-input{position:absolute;border:none;background:none;outline:none;padding:var(--space-3) var(--space-3);top:0;right:0;bottom:0;left:0;font-size:inherit;font-family:inherit;font-weight:inherit;width:100%;color:var(--color-text-1);border-radius:var(--radius-1);user-select:all;-webkit-user-select:text;white-space:pre;cursor:var(--tl-cursor-text)}@media (max-width: 600px){.tl-frame-heading{font-size:16px}}.tl-embed{border:none;border-radius:var(--radius-2)}.tl-image__button{padding:4px 8px;color:var(--color-text);background-color:var(--color-panel);border-radius:var(--radius-2);box-shadow:var(--shadow-1);pointer-events:all;cursor:var(--tl-cursor-pointer);outline:none;display:flex}.tl-image__button:disabled{opacity:.5;pointer-events:none}.tl-image__toolbox{position:absolute;top:0;left:0;display:flex;justify-content:flex-end;align-items:flex-end;padding:10px}.tl-image__toolbox__hidden{display:none}.tl-shape-error-boundary{width:100%;height:100%;background-color:var(--color-muted-1);border-width:calc(1px * var(--tl-scale));border-color:var(--color-muted-1);border-style:solid;border-radius:calc(var(--radius-1) * var(--tl-scale));display:flex;align-items:center;justify-content:center;position:relative;pointer-events:all;overflow:hidden;padding:var(--space-2)}.tl-shape-error-boundary:after{transform:scale(var(--tl-scale));content:"Error";font-size:12px;font-family:inherit;color:var(--color-text-0)}.tl-error-boundary{width:100%;height:100%;display:flex;align-items:center;justify-content:center;padding:var(--space-4);background-color:var(--color-background);color:var(--color-text-1);position:absolute;z-index:600}.tl-error-boundary__overlay{position:absolute;top:0;right:0;bottom:0;left:0;z-index:500;background-color:var(--color-overlay)}.tl-error-boundary__content *{user-select:all;-webkit-user-select:text;pointer-events:all}.tl-error-boundary__canvas{pointer-events:none;position:absolute;top:0;right:0;bottom:0;left:0;z-index:-1}.tl-error-boundary__canvas:after{content:" ";display:block;position:absolute;top:0;right:0;bottom:0;left:0;z-index:600;pointer-events:auto}.tl-error-boundary__content{width:fit-content;height:fit-content;max-width:100%;width:400px;max-height:100%;background-color:var(--color-panel);padding:var(--space-6);border-radius:var(--radius-4);box-shadow:var(--shadow-2);font-size:14px;font-weight:400;display:flex;flex-direction:column;gap:var(--space-5);overflow:auto;z-index:600}.tl-error-boundary__content__expanded{width:600px}.tl-error-boundary__content h2{font-size:16px;margin:0;font-weight:500}.tl-error-boundary__content p{line-height:1.5;margin:0}.tl-error-boundary__content pre{background-color:var(--color-muted-2);padding:var(--space-5);border-radius:var(--radius-2);overflow:auto;font-size:12px;max-height:320px;margin:0}.tl-error-boundary__content button{background:none;border:none;font-family:inherit;font-size:14px;font-weight:500;padding:var(--space-4);border-radius:var(--radius-3);cursor:var(--tl-cursor-pointer);color:inherit;background-color:transparent}.tl-error-boundary__content button:hover{background-color:var(--color-low)}.tl-error-boundary__content a{color:var(--color-text-1);font-weight:500;text-decoration:none}.tl-error-boundary__content a:hover{color:var(--color-text-2)}.tl-error-boundary__content__error{position:relative}.tl-error-boundary__content__error button{position:absolute;top:var(--space-2);right:var(--space-2);font-size:12px;padding:var(--space-2) var(--space-3);background-color:var(--color-panel);border-radius:var(--radius-1)}.tl-error-boundary__content__actions{display:flex;justify-content:space-between;gap:var(--space-4);margin:calc(var(--space-4) * -1);margin-top:0}.tl-error-boundary__content__actions__group{display:flex;gap:var(--space-4)}.tl-error-boundary__content .tl-error-boundary__reset{color:var(--color-warn)}.tl-error-boundary__content .tl-error-boundary__refresh{background-color:var(--color-primary);color:var(--color-selected-contrast)}.tl-error-boundary__content .tl-error-boundary__refresh:hover{background-color:var(--color-primary);opacity:.9}@media screen and (pointer: coarse){.tl-canvas__mobile .tl-handle__hint{opacity:1}.tl-canvas__mobile .tl-handle__bg{r:calc(20px / var(--tl-zoom))}}.tl-hidden{opacity:0;pointer-events:none}.debug__ui-logger{position:absolute;top:62px;left:16px;color:#555;font-size:12px;font-family:monospace}.tl-container{--layer-panels: 300;--layer-menus: 400;--layer-overlays: 500;--layer-toasts: 650;--layer-cursor: 700}.tlui-layout{position:relative;display:grid;grid-template-columns:1fr;grid-template-rows:minmax(0px,1fr) auto;grid-auto-rows:auto;height:100%;max-height:100%;overflow:clip;padding:var(--space-2);pointer-events:none;-webkit-user-select:none;user-select:none;z-index:var(--layer-panels);-webkit-transform:translate3d(0,0,0);--sab: env(safe-area-inset-bottom)}.tlui-layout__top{grid-column:1;grid-row:1;display:flex;min-width:0px}.tlui-layout__top__left{display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;width:100%;height:100%;flex-shrink:1}.tlui-layout__top__center{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;width:100%;height:100%;margin-left:var(--space-2);flex-grow:1;min-width:0px}.tlui-layout__top__right{display:flex;flex-direction:column;align-items:flex-end;justify-content:flex-start;width:100%;height:100%;flex-shrink:1;min-width:0px}.scrollable,.scrollable *{pointer-events:all;touch-action:auto;overscroll-behavior:none}.tlui-helper-buttons{position:relative;display:flex;flex-direction:column;justify-content:flex-start;align-items:flex-start;width:min-content;gap:var(--space-3);margin:var(--space-3) var(--space-2);white-space:nowrap;pointer-events:none;z-index:var(--layer-panels)}.tlui-helper-buttons>.tlui-button{pointer-events:all;background-color:var(--color-low);border-radius:var(--radius-3)}.tlui-icon{flex-shrink:0;width:18px;height:18px;background-color:currentColor}.tlui-icon__small{width:15px;height:15px}.tlui-slider{position:relative;display:flex;align-items:center;-webkit-user-select:none;user-select:none;touch-action:none}.tlui-slider__container{width:164px;padding:0px var(--space-4)}.tlui-slider__track{position:relative;flex-grow:1;height:44px;cursor:pointer}.tlui-slider__track:after{display:block;position:absolute;top:calc(50% - 2px);content:"";height:3px;width:100%;background-color:var(--color-muted-1);border-radius:var(--radius-4)}.tlui-slider__range{position:absolute;top:calc(50% - 2px);left:0;height:3px;background-color:var(--color-selected);border-radius:var(--radius-4)}.tlui-slider__thumb{all:unset;cursor:grab;display:block;width:18px;height:18px;position:relative;top:-1px;background-color:var(--color-panel);border-radius:999px;box-shadow:inset 0 0 0 2px var(--color-text-2)}.tlui-slider__thumb:active{cursor:grabbing;box-shadow:inset 0 0 0 2px var(--color-text-2),var(--shadow-1)}.tlui-slider__thumb:focus-visible{box-shadow:inset 0 0 0 2px var(--color-focus)}.tlui-kbd{font-family:inherit;font-size:11px;line-height:11px;display:grid;justify-items:center;grid-auto-flow:column;grid-template-columns:auto;grid-auto-columns:minmax(1em,auto);gap:1px;align-self:bottom;color:var(--color-text-2);margin-left:var(--space-4)}.tlui-kbd>span{width:100%;text-align:center;display:inline;margin:0;padding:2px;border-radius:2px}.tlui-kbd:not(:last-child){margin-right:var(--space-2)}.tlui-button{margin:0;position:relative;z-index:1;height:44px;display:flex;align-items:center;justify-content:center;font-family:inherit;font-size:12px;font-weight:inherit;color:var(--color-text-1);padding:0 13px;cursor:pointer;border:none;outline:none;-webkit-user-select:none;user-select:none;white-space:nowrap;overflow:hidden;background:transparent;text-shadow:1px 1px 0px var(--color-panel)}.tlui-button:after{content:"";z-index:1;position:absolute;right:4px;bottom:4px;display:block;width:calc(100% - 8px);height:calc(100% - 8px);border-radius:var(--radius-3);background-color:transparent;pointer-events:none}.tlui-button>span{text-overflow:ellipsis;overflow:hidden;display:flex;align-items:center}.tlui-button>span:not(:only-child){flex-grow:2}.tlui-button>span>svg{margin-left:var(--space-2)}.tlui-button:disabled{cursor:default;color:var(--color-text-3)}.tlui-button:not([data-state=selected],:disabled):active:after{background:var(--color-muted-2)}@media (hover: hover){.tlui-button:not([data-state=selected],:disabled):hover:after{background:var(--color-muted-2)}}.tlui-icon-left{margin-right:var(--space-4)}.tlui-button>*{position:relative;z-index:100;color:inherit}.tlui-button>svg{width:18px;height:18px;pointer-events:none}.tlui-button:not(:disabled,:focus-visible,[data-state=open]):active{z-index:2;color:var(--color-text-0)}.tlui-button:not(:hover,:disabled,[data-state=open]):focus-visible:after{box-shadow:inset 0 0 0 2px var(--color-focus)}.tlui-button[data-state=selected]:not(:hover,:disabled):focus-visible:after{box-shadow:inset 0 0 0 2px var(--color-focus)}@media (hover: hover){.tlui-button:not(:disabled,:focus-visible):hover{z-index:2;color:var(--color-text-0)}.tlui-button__primary:not(:disabled,:focus-visible):hover{color:var(--color-primary)}.tlui-button__warning:not(:disabled,:focus-visible):hover{color:var(--color-warn)}}.tlui-button:disabled{color:var(--color-text-3)}.tlui-button[data-state=selected]{color:var(--color-selected-contrast)}.tlui-button[data-state=selected]:not(:disabled,:focus-visible):active{color:var(--color-selected-contrast)}@media (hover: hover){.tlui-button[data-state=selected]:not(:disabled,:focus-visible):hover{color:var(--color-selected-contrast)}}.tlui-button[data-state=selected]:not(:disabled):after{background:var(--color-selected)}.tlui-button[data-state=hinted]:after{background:var(--color-hint)}.tlui-button[data-state=hinted]:not(:disabled,:focus-visible):active:after{background:var(--color-hint)}@media (hover: hover){.tlui-button[data-state=hinted]:not(:disabled,:focus-visible):hover:after{background:var(--color-hint)}}.tlui-focus-button{z-index:var(--layer-panels);pointer-events:all}.tlui-button.squished{height:36px;width:44px}.tlui-button__primary{color:var(--color-primary)}.tlui-button__warning,.tlui-button__danger{color:var(--color-warn)}.tlui-popover{position:relative;display:flex;align-content:stretch}.tlui-popover__content{position:relative;max-height:75vh;margin:0;border:none;border-radius:var(--radius-4);background-color:var(--color-panel);box-shadow:var(--shadow-3);z-index:var(--layer-menus);overflow:hidden;overflow-y:auto;touch-action:auto;overscroll-behavior:none;scrollbar-width:none;-ms-overflow-style:none}.tlui-debug-panel{margin-top:var(--space-2);background-color:var(--color-low);width:100%;display:grid;align-items:center;grid-template-columns:1fr auto auto;justify-content:space-between;padding-left:var(--space-4);border-radius:var(--radius-1);font-size:12px;color:var(--color-text-1);z-index:var(--layer-panels);pointer-events:all}.tlui-debug-panel__current-state{white-space:nowrap}.tlui-menu-zone{position:relative;z-index:var(--layer-panels);width:fit-content}.tlui-menu-zone:before{content:"";display:block;position:absolute;top:-4px;right:-4px;bottom:-4px;left:-4px;border:4px solid var(--color-background);border-radius:var(--radius-1) var(--radius-1) var(--radius-5) var(--radius-1);background-color:var(--color-low)}.tlui-menu-zone *[data-state=open]:after{background:linear-gradient(180deg,rgba(144,144,144,0) 0%,var(--color-muted-2) 100%)}.tlui-menu-zone__controls{position:relative;align-items:center;grid-row:1;grid-column:1;width:fit-content;border-radius:var(--radius-1) var(--radius-1) var(--radius-4) var(--radius-1);display:flex;flex-direction:row;z-index:var(--layer-panels);pointer-events:all}.tlui-menu-zone__divider{width:1px;height:18px;background-color:var(--color-muted-1)}.tlui-menu-zone__controls>*{margin:0 -2px}.tlui-menu-zone__controls>*:first-child{margin-left:0}.tlui-menu-zone__controls>*:last-child{margin-right:0}.tlui-menu-zone__controls>.tlui-menu-zone__divider{margin:0}.tlui-menu-zone__controls .tlui-icon{width:15px;height:15px}.tlui-style-panel__wrapper{box-shadow:var(--shadow-2);border-radius:var(--radius-4);pointer-events:all;background-color:var(--color-panel);height:fit-content;max-height:100%;margin:var(--space-3) var(--space-2);overflow:hidden;touch-action:auto;overscroll-behavior:none;overflow-y:auto;color:var(--color-text)}.tlui-style-panel{position:relative;z-index:var(--layer-panels);pointer-events:all}.tlui-style-panel::-webkit-scrollbar{display:none}.tlui-style-panel .tlui-button.select{width:100%}.tlui-style-panel__section{display:flex;position:relative;flex-direction:column}.tlui-style-panel__section:nth-of-type(n+2):not(:last-child){border-bottom:1px solid var(--color-divider)}.tlui-style-panel__section:empty{display:none}.tlui-style-panel__section__common:not(:only-child){margin-bottom:7px;border-bottom:1px solid var(--color-divider)}.tlui-style-panel__row{display:flex}.tlui-style-panel__row>*:nth-child(2){margin-left:-4px}.tlui-style-panel__double-select-picker{display:grid;grid-template-columns:1fr auto auto;align-items:center;padding-left:var(--space-4);font-size:12px;width:164px}.tlui-style-panel__double-select-picker>.tlui-button{min-width:44px;margin-left:-4px}.tlui-style-panel__double-select-picker-label{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.tlui-style-panel__section *[data-state=open]:after{background:var(--color-muted-0)}.tlui-input{background:none;margin:0;position:relative;z-index:1;height:44px;max-height:44px;display:flex;align-items:center;justify-content:center;font-family:inherit;font-size:12px;font-weight:inherit;color:var(--color-text-1);padding:13px 13px 13px 0;border:none;outline:none;text-overflow:ellipsis;width:100%;user-select:all;-webkit-user-select:auto!important}.tlui-input__wrapper{width:100%;height:44px;display:flex;align-items:center;gap:var(--space-4);color:var(--color-text)}.tlui-input__wrapper>.tlui-icon{flex-shrink:0}@media (max-width: 600px){@supports (-webkit-touch-callout: none){.tlui-input{font-size:16px}}}.tlui-prompt__overlay{background:var(--color-overlay);position:fixed;top:0;left:0;right:0;bottom:0;display:grid;place-items:center;overflow-y:auto;z-index:var(--layer-overlays)}.tlui-prompt__content{cursor:default;background-color:var(--color-panel);box-shadow:var(--shadow-3);border-radius:var(--radius-4);padding:var(--space-5);font-size:12px;overflow-y:auto;min-width:300px;max-width:80vw;max-height:80vh}.tlui-prompt__actions{border:none;padding:0;margin:0;display:flex;justify-content:flex-end;margin-right:calc(-1 * var(--space-3));margin-bottom:calc(-1 * var(--space-3))}.tlui-prompt__title{margin:0;font-size:12px}.tlui-prompt__error{color:#d10b0b;display:flex;gap:var(--space-2);align-items:center}.tlui-dialog__overlay{position:absolute;top:0;left:0;width:100%;height:100%;z-index:var(--layer-overlays);background-color:var(--color-overlay);pointer-events:all;animation:fadeIn .12s ease-out;display:grid;place-items:center;overflow-y:auto}.tlui-dialog__content{display:flex;flex-direction:column;position:relative;cursor:default;background-color:var(--color-panel);box-shadow:var(--shadow-3);border-radius:var(--radius-4);font-size:12px;overflow:hidden;min-width:300px;max-width:80vw;max-height:80vh}.tlui-dialog__header{position:relative;display:flex;align-items:center;flex:0;z-index:999;padding-left:var(--space-4);color:var(--color-text);height:44px}.tlui-dialog__header__title{flex:1;font-weight:inherit;font-size:12px;margin:0;color:var(--color-text-1);font-weight:500}.tlui-dialog__header__close{justify-self:flex-end}.tlui-dialog__body{padding:var(--space-4) var(--space-6);flex:0 1;overflow-y:auto;overflow-x:hidden;color:var(--color-text-1);user-select:all;-webkit-user-select:text}.tlui-dialog__footer{position:relative;z-index:999}.tlui-dialog__footer__actions{display:flex;align-items:center;justify-content:flex-end}.tlui-dialog__footer__actions>.tlui-button:nth-last-child(n+2){margin-right:-4px}.tlui-dialog__scrim{display:block;content:"";bottom:0;width:100%;height:40px;position:absolute;background:linear-gradient(transparent,var(--color-panel));border-bottom-left-radius:var(--radius-4);border-bottom-right-radius:var(--radius-4);pointer-events:none}.tlui-shortcuts-dialog__header{border-bottom:1px solid var(--color-divider)}.tlui-shortcuts-dialog__body{position:relative;columns:1;column-gap:var(--space-9);pointer-events:all;touch-action:auto}@media (min-width: 475px){.tlui-shortcuts-dialog__body{columns:2;column-gap:var(--space-9)}}@media (min-width: 960px){.tlui-shortcuts-dialog__body{columns:3;column-gap:var(--space-9)}}.tlui-shortcuts-dialog__group{break-inside:avoid-column;padding-bottom:var(--space-6)}.tlui-shortcuts-dialog__group__title{font-size:inherit;font-weight:500;margin:0;color:var(--color-text-2);letter-spacing:.5px;text-transform:uppercase;font-size:9px;height:32px;display:flex;align-items:center}.tlui-shortcuts-dialog__group__content{display:flex;flex-direction:column;color:var(--color-text-1)}.tlui-shortcuts-dialog__key-pair{display:flex;gap:var(--space-4);align-items:center;justify-content:space-between;height:32px}.tlui-shortcuts-dialog__key-pair__key{flex:1;font-size:12px}.tlui-toolbar{grid-column:1 / span 3;grid-row:1;display:flex;align-items:center;justify-content:center;flex-grow:2;padding-bottom:calc(var(--space-2) + var(--sab))}.tlui-toolbar__inner{position:relative;width:fit-content;display:flex;gap:var(--space-3);align-items:flex-end}.tlui-toolbar__left{width:fit-content}.tlui-toolbar__extras{position:relative;width:100%;height:44px;pointer-events:none}.tlui-toolbar__extras__hidden{display:none}.tlui-toolbar__extras__controls{display:flex;flex-direction:row;background-color:var(--color-low);border-top-left-radius:var(--radius-3);border-top-right-radius:var(--radius-3);position:relative;bottom:-4px;margin-left:8px;margin-right:0;pointer-events:all;width:fit-content}.tlui-toolbar__extras__controls:before{content:"";display:block;position:absolute;z-index:-1;top:-4px;right:-4px;bottom:-4px;left:-4px;border:4px solid var(--color-background);border-radius:var(--radius-4);border-bottom-left-radius:0;border-bottom-right-radius:0;background-color:var(--color-background)}.tlui-toolbar__extras__controls>.tlui-button,.tlui-toolbar__extras__controls>.tlui-popover>.tlui-button{height:40px;width:40px}.tlui-toolbar__extras__controls .tlui-button:after{border-radius:var(--radius-2)}.tlui-toolbar__lock-button{position:absolute;top:0;pointer-events:all;height:40px;width:48px;right:-4px}.tlui-toolbar__lock-button:after{border-radius:100%;top:4px;left:8px;height:32px;width:32px}.tlui-toolbar__lock-button__mobile{right:-8px}.tlui-toolbar__tools{display:flex;flex-direction:row;background-color:var(--color-low);border-radius:var(--radius-4);z-index:var(--layer-panels);pointer-events:all;position:relative;align-items:center;background:var(--color-panel);box-shadow:var(--shadow-2)}.tlui-toolbar__tools__button:nth-of-type(n+2){margin-left:-2px}.tlui-toolbar__tools__button:nth-last-of-type(n+2){margin-right:-2px}.tlui-toolbar__tools__button{height:48px;width:48px}.tlui-layout__mobile .tlui-toolbar__tools__button{height:48px;width:44px}.tlui-layout__mobile .tlui-toolbar__tools__button>.tlui-icon{height:16px;width:16px}.tlui-toolbar__overflow{width:40px}.tlui-layout__mobile .tlui-toolbar__overflow{width:32px;padding:0}.tlui-toolbar *[data-state=open]:after{background:linear-gradient(0deg,rgba(144,144,144,0) 0%,var(--color-muted-2) 100%)}.tlui-toolbar__styles__button{width:44px;height:44px}.tlui-layout__mobile .tlui-toolbar__styles__button{height:48px}.tlui-toolbar__divider{display:block;background:var(--color-divider);height:18px;width:1px}.tlui-help-menu{pointer-events:all;position:absolute;bottom:var(--space-2);right:var(--space-2)}.tlui-help-menu__button{position:relative;border-radius:var(--radius-4);background-color:var(--color-low);border-radius:100%;height:40px;width:40px;overflow:visible;z-index:var(--layer-panels);display:flex;align-items:center;justify-content:center;pointer-events:all}.tlui-help-menu__button:before{display:block;content:"";position:absolute;top:-4px;left:-4px;height:40px;width:40px;border-radius:100%;border:4px solid var(--color-background);z-index:-1}.tlui-help-menu__button:after{border-radius:100%}.tlui-context-menu__move-to-page__name{max-width:min(300px,35vw);overflow:hidden;text-overflow:ellipsis}.tlui-context-menu__move-to-page__name[data-disabled]{color:var(--color-text-3);pointer-events:none}.tlui-menu{z-index:var(--layer-menus);height:fit-content;width:fit-content;max-height:80vh;border-radius:var(--radius-4);pointer-events:all;touch-action:auto;overflow-y:auto;overscroll-behavior:none;background-color:var(--color-panel);box-shadow:var(--shadow-3)}.tlui-menu::-webkit-scrollbar{display:none}.tlui-menu__arrow{position:relative;top:-1px;fill:var(--color-panel);stroke:var(--color-panel-contrast);stroke-width:1px}.tlui-menu__group[data-size=large]{min-width:initial}.tlui-menu__group[data-size=medium]{min-width:144px}.tlui-menu__group[data-size=small]{min-width:96px}.tlui-menu__group[data-size=tiny]{min-width:0px}.tlui-menu__group+.tlui-menu__group{border-top:1px solid var(--color-divider)}.tlui-menu__submenu__trigger[data-state=open]:not(:hover):after{border-radius:var(--radius-1);background:linear-gradient(90deg,rgba(144,144,144,0) 0%,var(--color-muted-2) 100%)}.tlui-menu__submenu__trigger[data-direction=left][data-state=open]:not(:hover):after{border-radius:var(--radius-1);background:linear-gradient(270deg,rgba(144,144,144,0) 0%,var(--color-muted-2) 100%)}.tlui-menu__button{width:100%;justify-content:space-between}.tlui-menu__button__wide{max-width:initial}.tlui-menu__button:nth-child(n+2){margin-top:-8px}.tlui-menu__button:nth-last-child(n+2){margin-bottom:-8px}.tlui-menu__button>span:only-child{text-align:left;flex-grow:2}.tlui-menu__checkbox-item{padding-left:28px}.tlui-menu__checkbox-item__check{position:absolute;left:0;width:24px;padding-left:10px;display:inline-flex;align-items:center;justify-content:center}.tlui-button-grid__button{width:44px;height:44px}.tlui-button-grid__four{display:grid;grid-template-columns:40px 40px 40px 44px}.tlui-button-grid__four>.tlui-button-grid__button:nth-child(n+5){margin-top:-2px}.tlui-button-grid__four>.tlui-button-grid__button:nth-last-child(n+5){margin-bottom:-2px}.tlui-button-grid__three{display:grid;grid-template-columns:40px 40px 44px}.tlui-button-grid__three>.tlui-button-grid__button:nth-child(n+4){margin-top:-2px}.tlui-button-grid__three>.tlui-button-grid__button:nth-last-child(n+4){margin-bottom:-2px}.tlui-button-grid__two{display:grid;grid-template-columns:40px 44px}.tlui-button-grid__two>.tlui-button-grid__button:nth-child(n+3){margin-top:-2px}.tlui-button-grid__two>.tlui-button-grid__button:nth-last-child(n+3){margin-bottom:-2px}.tlui-actions-menu{max-height:calc(100vh - 150px)}.tlui-toast__viewport{position:absolute;top:0;right:0;bottom:0;left:0;margin:0;display:flex;align-items:flex-end;justify-content:flex-end;flex-direction:column;gap:var(--space-3);pointer-events:none;padding:0px var(--space-3) 64px 0px;z-index:var(--layer-toasts)}.tlui-toast__viewport>*{pointer-events:all}.tlui-toast__icon{padding-top:var(--space-4);padding-left:var(--space-4)}.tlui-toast__container{min-width:200px;max-width:280px;display:flex;flex-direction:row;gap:var(--space-3);background-color:var(--color-panel);box-shadow:var(--shadow-2);border-radius:var(--radius-4);font-size:12px}.tlui-toast__main{flex-grow:2}.tlui-toast__main:nth-child(1)>.tlui-toast__content{padding-left:var(--space-4)}.tlui-toast__content{padding-left:0;padding-top:var(--space-4);padding-bottom:var(--space-5);display:flex;flex-direction:column;gap:var(--space-3)}.tlui-toast__content:not(:only-child){padding-bottom:var(--space-2)}.tlui-toast__title{font-weight:600;color:var(--color-text)}.tlui-toast__description{color:var(--color-text-1);padding:var(--space-3);margin:0;padding:0}.tlui-toast__actions{display:flex;flex-direction:row;justify-content:flex-start}.tlui-toast__close{align-self:flex-end}@media (prefers-reduced-motion: no-preference){.tlui-toast__container[data-state=open]{animation:slide-in .2s cubic-bezier(.785,.135,.15,.86)}.tlui-toast__container[data-state=closed]{animation:hide .1s ease-in}.tlui-toast__container[data-swipe=move]{transform:translate(var(--radix-toast-swipe-move-x))}.tlui-toast__container[data-swipe=cancel]{transform:translate(0);transition:transform .2s ease-out}.tlui-toast__container[data-swipe=end]{animation:swipe-out .1s ease-out}}@media (max-width: 640px){.tlui-menu__group .tlui-button{height:40px}.tlui-menu__group .tlui-button>.tlui-kbd{display:none}.tlui-menu__group .tlui-button>.tlui-icon-left{display:none}}.tlui-layout__bottom{grid-row:2}.tlui-layout__bottom__main{width:100%;position:relative;display:flex;align-items:flex-end;justify-content:center}.tlui-share-zone{height:44px;width:auto;display:flex;flex-direction:row;gap:var(--space-3);justify-content:flex-end;z-index:var(--layer-panels);align-items:center}.tlui-share-zone__connection-status{width:8px;height:100%;position:relative;display:flex;align-items:center}.tlui-share-zone__connection-status:after{content:"";width:8px;height:8px;background-color:currentColor;border-radius:100%}.tlui-share-zone__button{font-size:14px;background:var(--color-selected);color:var(--color-selected-contrast);border-radius:var(--radius-1);border-bottom-left-radius:var(--radius-4);pointer-events:all}.tlui-layout__mobile .tlui-share-zone__button{border-radius:var(--radius-1);border-bottom-left-radius:var(--radius-4)}.tlui-share-zone__button:active{color:var(--color-selected-contrast)}@media (hover: hover){.tlui-share-zone__button:hover{color:var(--color-selected-contrast)}.tlui-share-zone__button:not(:disabled,:focus-visible):hover{color:var(--color-selected-contrast)}}.tlui-share-zone__popover{font-size:12px;font-weight:inherit;width:200px;max-width:100%;max-height:100%;position:relative}.tlui-share-zone__qr-code{width:200px;height:200px;cursor:pointer;background:none;background-color:var(--color-muted-2);background-size:cover;border:none}.tlui-share-zone__spinner{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.tlui-share-zone__details{font-size:11px;font-weight:400;padding:var(--space-4);color:var(--color-text-1);line-height:1.5;margin:0}.tlui-share-zone__button{text-shadow:none}.tlui-share-zone__status{height:100%;display:flex;align-items:center;justify-content:center;padding:4px;position:relative;left:-4px}.tlui-share-zone__status>div{width:8px;height:8px;border-radius:100%}.tlui-people-menu__button{display:flex;border-radius:100%;pointer-events:all;overflow:visible;width:40px;height:40px;background-color:var(--color-low)}.tlui-people-menu__button:before{display:block;content:"";position:absolute;height:40px;width:40px;border-radius:100%;border:4px solid var(--color-background);z-index:-1;pointer-events:none}.tlui-people-menu__button:not([data-state=selected],:disabled):active:after{border-radius:100%}@media (hover: hover){.tlui-people-menu__button:not([data-state=selected],:disabled):hover:after{border-radius:100%}}.tlui-people-menu__wrapper{position:relative;display:flex;flex-direction:column;width:220px;height:fit-content;max-height:50vh}.tlui-people-menu__section{position:relative;flex-direction:column;max-height:100%;min-height:44px;overflow-x:hidden;overflow-y:auto;touch-action:auto}.tlui-people-menu__section:not(:last-child){border-bottom:1px solid var(--color-divider)}.tlui-people-menu__user{display:flex;justify-content:flex-start;align-items:center}.tlui-people-menu__user__color-picker{z-index:var(--layer-overlays)}.tlui-people-menu__user__color{flex-shrink:0}.tlui-people-menu__user__name{text-align:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:12px;color:var(--color-text-1);max-width:100%;flex-grow:1;flex-shrink:100}.tlui-people-menu__user__label{text-align:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:12px;color:var(--color-text-3);flex-grow:100;flex-shrink:0;margin-left:4px}.tlui-people-menu__user__input{flex-grow:2;height:100%;padding:0;margin:0}.tlui-people-menu__user__edit{min-width:44px}.tlui-people-menu__user>.tlui-input__wrapper{width:auto;display:flex;align-items:auto;flex-grow:2;gap:8px;padding:0}.tlui-people-menu__item{display:flex;justify-content:flex-start;gap:13px;width:100%;margin:-4px 0}.tlui-people-menu__item>.tlui-menu__button__wide{width:auto;display:flex;align-items:auto;justify-content:flex-start;flex-grow:2;gap:13px;margin-right:-13px}.tlui-people-menu__item:nth-of-type(1){margin-top:0}.tlui-people-menu__item:nth-last-of-type(1){margin-bottom:0}.tlui-people-menu__item__follow{min-width:44px}.tlui-people-menu__item__follow[data-active=true] .tlui-icon{opacity:1}.tlui-people-menu__item__follow:focus-visible .tlui-icon{opacity:1}@media (hover: hover){.tlui-people-menu__item__follow .tlui-icon{opacity:0}.tlui-people-menu__item__follow:hover .tlui-icon{opacity:1}}.tlui-project-menu__wrapper{display:flex;width:100%;align-items:center;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;min-width:0px}.tlui-project-menu__button{display:flex;gap:var(--space-4);pointer-events:all}.tlui-project-menu__button__name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;min-width:0px}.tlui-project-menu__input{min-width:0px;text-align:center;pointer-events:all;margin-left:40px}.tlui-rename-project-dialog__input{background-color:var(--color-muted-2);flex-grow:2;border-radius:var(--radius-2);padding:0px var(--space-4)}.tlui-navigation-zone{display:flex;width:min-content;flex-direction:column;background-color:var(--color-low);z-index:var(--layer-panels);pointer-events:all;position:absolute;left:0;bottom:0}.tlui-navigation-zone:before{content:"";display:block;position:absolute;z-index:-1;top:-4px;right:-4px;bottom:-4px;left:-4px;border:4px solid var(--color-background);border-radius:var(--radius-1);border-top-right-radius:var(--radius-5);background-color:var(--color-low)}.tlui-navigation-zone__controls{display:flex;flex-direction:row;width:min-content;background-color:none;overflow:hidden}.tlui-navigation-zone__controls>.tlui-button{margin-left:-2px;margin-right:-2px}.tlui-navigation-zone__controls>.tlui-button:nth-of-type(1){margin-left:0}.tlui-navigation-zone__controls>.tlui-button:nth-last-of-type(1){margin-right:0}.tlui-navigation-zone__toggle .tlui-icon{opacity:.24;transition:opacity .2s ease-in-out}.tlui-navigation-zone__toggle:active .tlui-icon{opacity:1;transition:opacity .12s ease-in-out}@media (hover: hover){.tlui-navigation-zone__toggle:hover .tlui-icon{opacity:1;transition:opacity .12s ease-in-out}}.tlui-minimap{width:100%;height:96px;min-height:96px;overflow:hidden;padding:var(--space-3);padding-top:0}.tlui-minimap__canvas{position:relative;width:100%;height:100%}.tlui-zoom-menu__button__pct{width:60px;text-align:center}@keyframes hide{0%{opacity:1}to{opacity:0}}@keyframes slide-in{0%{transform:translate(calc(100% + var(--space-3)))}to{transform:translate(0)}}@keyframes swipe-out{0%{transform:translate(var(--radix-toast-swipe-end-x))}to{transform:translate(calc(100% + var(--space-3)))}}.tlui-page-menu__wrapper{position:relative;display:flex;flex-direction:column;width:220px;height:fit-content;max-height:50vh}.tlui-page-menu__trigger{width:128px}.tlui-page-menu__trigger>span{flex-grow:2;margin-right:var(--space-4)}.tlui-page-menu__header{display:flex;flex-direction:row;align-items:center;width:100%;padding-left:var(--space-4);min-height:44px;border-bottom:1px solid var(--color-divider)}.tlui-page-menu__header>.tlui-button:nth-of-type(1){margin-right:-4px}.tlui-page-menu__header__title{color:var(--color-text);font-size:12px;font-weight:500;flex-grow:2}.tlui-page-menu__name{flex-grow:2;text-align:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tlui-page-menu__list{position:relative;flex-direction:column;max-height:100%;overflow-x:hidden;overflow-y:auto;touch-action:auto}.tlui-page-menu__item{display:flex;flex-direction:row;align-items:center;justify-content:space-between}.tlui-page-menu__item:nth-of-type(n+2){margin-top:-4px}.tlui-page-menu__item__button{flex-grow:2}.tlui-page-menu__item__button>span{display:block;flex-grow:2;text-align:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tlui-page-menu__item__button__checkbox{padding-left:36px}.tlui-page-menu__item__button__check{position:absolute;left:0;width:24px;padding-left:10px;display:inline-flex;align-items:center;justify-content:center;color:var(--color-text)}.tlui-page_menu__item__sortable{position:absolute;top:0;left:0;width:100%;height:fit-content;display:flex;flex-direction:row;align-items:center;overflow:hidden;z-index:1}.tlui-page_menu__item__sortable__title{flex:1}.tlui-page_menu__item__sortable__title>.tlui-input__wrapper{height:100%}.tlui-page_menu__item__sortable__button{flex:0}.tlui-page_menu__item__sortable:focus-within{z-index:10}.tlui-page_menu__item__sortable__handle{touch-action:none;width:32px;height:40px;cursor:grab;color:var(--color-text-3);flex-shrink:0;margin-right:-9px}.tlui-page_menu__item__sortable__handle:active{cursor:grabbing}.tlui-page-menu__item__input{margin-left:13px;height:100%}.tlui-page_menu__item__submenu{pointer-events:all;flex:0;cursor:pointer;margin:0;display:none}.tlui-page_menu__item__submenu[data-isediting=true]{display:block}@media (hover: hover){.tlui-page_menu__item__submenu{opacity:0;display:block}.tlui-page_menu__item__submenu:hover,.tlui-page-menu__item:focus-within>.tlui-page_menu__item__submenu,.tlui-page_menu__item__sortable:focus-within>.tlui-page_menu__item__submenu{opacity:1}}.tlui-edit-link-dialog{display:flex;flex-direction:column;gap:var(--space-4);color:var(--color-text)}.tlui-edit-link-dialog__input{background-color:var(--color-muted-2);flex-grow:2;border-radius:var(--radius-2);padding:0px var(--space-4)}.tlui-embed__spacer{flex-grow:2;min-height:0px;margin-left:calc(-1 * var(--space-4));margin-top:calc(-1 * var(--space-4));pointer-events:none}.tlui-embed-dialog__list{display:flex;flex-direction:column;padding-bottom:var(--space-5)}.tlui-embed-dialog__item{position:relative;border:none;background:none;font-family:inherit;display:flex;text-align:left;gap:var(--space-3);cursor:pointer;padding:0;align-items:center;color:var(--color-text);font-size:var(--font-size-1);height:44px}@media (hover: hover){.tlui-embed-dialog__item:hover:after{display:block;content:"";position:absolute;top:0;right:0;bottom:0;left:0;background-color:var(--color-muted-2);border-radius:var(--radius-4)}}.tlui-embed-dialog__item__image{padding:var(--space-3)}.tlui-embed-dialog__item__image__img{width:24px;height:24px;display:flex;align-items:center;justify-content:center;background-size:contain;background-repeat:no-repeat;background-position:center center}.tlui-embed-dialog__enter{display:flex;flex-direction:column;gap:var(--space-4);color:var(--color-text-1)}.tlui-embed-dialog__input{background-color:var(--color-muted-2);flex-grow:2;border-radius:var(--radius-2);padding:0px var(--space-4)}.tlui-embed-dialog__warning{color:var(--color-warn)}.tlui-embed-dialog__instruction__link{display:flex;gap:var(--space-1);margin-top:var(--space-4)}.tlui-embed-dialog__enter a{color:var(--color-text-1)}#root{max-width:1280px;margin:0 auto;padding:2rem;text-align:center}.tldraw__editor{position:fixed;top:0;right:0;bottom:0;left:0;overflow:hidden}:root{font-family:Inter,system-ui,Avenir,Helvetica,Arial,sans-serif;line-height:1.5;font-weight:400;color-scheme:light dark;color:#ffffffde;background-color:#242424;font-synthesis:none;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-text-size-adjust:100%}a{font-weight:500;color:#646cff;text-decoration:inherit}a:hover{color:#535bf2}body{margin:0;display:flex;place-items:center;min-width:320px;min-height:100vh}h1{font-size:3.2em;line-height:1.1}button{border-radius:8px;border:1px solid transparent;padding:.6em 1.2em;font-size:1em;font-weight:500;font-family:inherit;background-color:#1a1a1a;cursor:pointer;transition:border-color .25s}button:hover{border-color:#646cff}button:focus,button:focus-visible{outline:4px auto -webkit-focus-ring-color}@media (prefers-color-scheme: light){:root{color:#213547;background-color:#fff}a:hover{color:#747bff}button{background-color:#f9f9f9}}

</style>
  </head>
  <body>
    <div id="root"></div>
    
  </body>
</html>
